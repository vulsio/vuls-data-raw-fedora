{
	"alias": "FEDORA-EPEL-2015-1458",
	"bugs": [
		{
			"bug_id": 1040573,
			"title": "Invalid bug number",
			"bugzilla": {
				"bug_id": "1040573",
				"creation_ts": "2013-12-11 16:07:30 +0000",
				"short_desc": "mongodb fails to start on the very first run on a slow environment",
				"delta_ts": "2015-05-19 10:19:02 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"priority": "unspecified",
				"bug_severity": "unspecified",
				"blocked": [
					{
						"bug_id": "1028690",
						"creation_ts": "2013-11-09 16:06:50 +0000",
						"short_desc": "packstack requires 2 runs to install ceilometer",
						"delta_ts": "2017-06-17 20:54:57 +0000",
						"bug_status": "CLOSED",
						"resolution": "UPSTREAM",
						"keywords": "Reopened",
						"priority": "unspecified",
						"bug_severity": "unspecified",
						"depends_on": [
							"1040573"
						],
						"blocked": [
							{
								"bug_id": "1036207",
								"creation_ts": "2013-11-29 18:40:32 +0000",
								"short_desc": "packstack requires 2 runs to install ceilometer",
								"delta_ts": "2022-07-09 06:32:54 +0000",
								"bug_status": "CLOSED",
								"resolution": "ERRATA",
								"keywords": "OtherQA, Reopened, Triaged, ZStream",
								"priority": "medium",
								"bug_severity": "unspecified",
								"depends_on": [
									"1028690"
								],
								"blocked": [
									{
										"bug_id": "1032769",
										"creation_ts": "2013-11-20 19:52:29 +0000",
										"short_desc": "Provide guidance on managing Ceilometer data store.",
										"delta_ts": "2015-03-10 03:36:27 +0000",
										"bug_status": "CLOSED",
										"resolution": "CURRENTRELEASE",
										"bug_file_loc": "https://bugs.launchpad.net/openstack-manuals/+bug/1253214",
										"keywords": "Documentation",
										"priority": "unspecified",
										"bug_severity": "unspecified",
										"depends_on": [
											"1036207",
											"1066408",
											"1069798",
											"1100411"
										],
										"long_desc": [
											{
												"isprivate": "0",
												"commentid": "6539647",
												"comment_count": "0",
												"who": {
													"text": "sgordon",
													"name": "Stephen Gordon"
												},
												"bug_when": "2013-11-20 19:52:29 +0000",
												"thetext": "Description of problem:\n\nAfter running an all in one setup for ~ 10 days with minimal activity I found that /var/lib/mongodb/journal contained around 3 G of data.\n\nWe need to confirm that this is within expectations and provide guidance to administrators on managing the size of their Ceilometer data store - advice from the Ceilometer team is required on this point."
											},
											{
												"isprivate": "0",
												"commentid": "6571787",
												"comment_count": "1",
												"who": {
													"text": "sgordon",
													"name": "Stephen Gordon"
												},
												"bug_when": "2013-11-29 18:42:14 +0000",
												"thetext": "Note that Bug # 1028678 may result in different guidance being required for the GSG."
											},
											{
												"isprivate": "0",
												"commentid": "6574577",
												"comment_count": "2",
												"who": {
													"text": "jpichon",
													"name": "Julie Pichon"
												},
												"bug_when": "2013-12-02 09:20:59 +0000",
												"thetext": "Hi Stephen - Are you sure the 'Depends On' points to the right bug? (It's a packstack horizon bug with a clear workaround, that I can't quite link to this one.)"
											},
											{
												"isprivate": "0",
												"commentid": "6719300",
												"comment_count": "3",
												"who": {
													"text": "sradvan",
													"name": "Scott Radvan"
												},
												"bug_when": "2014-01-16 22:54:55 +0000",
												"thetext": "This bug is being assigned to Martin, who is now the designated docs specialist for Telemetry."
											},
											{
												"isprivate": "0",
												"commentid": "6914451",
												"comment_count": "4",
												"who": {
													"text": "ddomingo",
													"name": "Don Domingo"
												},
												"bug_when": "2014-03-14 06:00:47 +0000",
												"thetext": "Upstream fix merged:\n\nhttps://review.openstack.org/#/c/67676/\n\nSetting to MODIFIED."
											}
										]
									},
									{
										"bug_id": "1069798",
										"creation_ts": "2014-02-25 16:48:26 +0000",
										"short_desc": "puppet requires 2 runs to install ceilometer",
										"delta_ts": "2016-04-27 04:19:09 +0000",
										"bug_status": "CLOSED",
										"resolution": "DUPLICATE",
										"keywords": "OtherQA, Reopened, Triaged, ZStream",
										"priority": "high",
										"bug_severity": "urgent",
										"depends_on": [
											"1028690",
											"1036207"
										],
										"blocked": [
											{
												"bug_id": "1032769",
												"creation_ts": "2013-11-20 19:52:29 +0000",
												"short_desc": "Provide guidance on managing Ceilometer data store.",
												"delta_ts": "2015-03-10 03:36:27 +0000",
												"bug_status": "CLOSED",
												"resolution": "CURRENTRELEASE",
												"bug_file_loc": "https://bugs.launchpad.net/openstack-manuals/+bug/1253214",
												"keywords": "Documentation",
												"priority": "unspecified",
												"bug_severity": "unspecified",
												"depends_on": [
													"1036207",
													"1066408",
													"1069798",
													"1100411"
												],
												"long_desc": [
													{
														"isprivate": "0",
														"commentid": "6539647",
														"comment_count": "0",
														"who": {
															"text": "sgordon",
															"name": "Stephen Gordon"
														},
														"bug_when": "2013-11-20 19:52:29 +0000",
														"thetext": "Description of problem:\n\nAfter running an all in one setup for ~ 10 days with minimal activity I found that /var/lib/mongodb/journal contained around 3 G of data.\n\nWe need to confirm that this is within expectations and provide guidance to administrators on managing the size of their Ceilometer data store - advice from the Ceilometer team is required on this point."
													},
													{
														"isprivate": "0",
														"commentid": "6571787",
														"comment_count": "1",
														"who": {
															"text": "sgordon",
															"name": "Stephen Gordon"
														},
														"bug_when": "2013-11-29 18:42:14 +0000",
														"thetext": "Note that Bug # 1028678 may result in different guidance being required for the GSG."
													},
													{
														"isprivate": "0",
														"commentid": "6574577",
														"comment_count": "2",
														"who": {
															"text": "jpichon",
															"name": "Julie Pichon"
														},
														"bug_when": "2013-12-02 09:20:59 +0000",
														"thetext": "Hi Stephen - Are you sure the 'Depends On' points to the right bug? (It's a packstack horizon bug with a clear workaround, that I can't quite link to this one.)"
													},
													{
														"isprivate": "0",
														"commentid": "6719300",
														"comment_count": "3",
														"who": {
															"text": "sradvan",
															"name": "Scott Radvan"
														},
														"bug_when": "2014-01-16 22:54:55 +0000",
														"thetext": "This bug is being assigned to Martin, who is now the designated docs specialist for Telemetry."
													},
													{
														"isprivate": "0",
														"commentid": "6914451",
														"comment_count": "4",
														"who": {
															"text": "ddomingo",
															"name": "Don Domingo"
														},
														"bug_when": "2014-03-14 06:00:47 +0000",
														"thetext": "Upstream fix merged:\n\nhttps://review.openstack.org/#/c/67676/\n\nSetting to MODIFIED."
													}
												]
											},
											{
												"bug_id": "1040649",
												"creation_ts": "2013-12-11 19:16:02 +0000",
												"short_desc": "Tracking Bug for RHOS 4 affecting Ref Arch and Solution Validation",
												"delta_ts": "2022-08-11 16:15:03 +0000",
												"bug_status": "CLOSED",
												"resolution": "CURRENTRELEASE",
												"bug_file_loc": "https://bugzilla.redhat.com/show_bug.cgi?id=1130215",
												"keywords": "Tracking",
												"priority": "unspecified",
												"bug_severity": "unspecified",
												"depends_on": [
													"1006534",
													"1017289",
													"1020002",
													"1020025",
													"1020479",
													"1020483",
													"1020979",
													"1028615",
													"1028621",
													"1030067",
													"1030069",
													"1030209",
													"1036515",
													"1038288",
													"1039650",
													"1039698",
													"1039910",
													"1040021",
													"1040262",
													"1040265",
													"1042933",
													"1045132",
													"1045135",
													"1045137",
													"1045196",
													"1045221",
													"1047653",
													"1052807",
													"1055852",
													"1056055",
													"1056058",
													"1062693",
													"1062699",
													"1062701",
													"1062709",
													"1064050",
													"1064056",
													"1064058",
													"1064061",
													"1064327",
													"1065666",
													"1066408",
													"1066549",
													"1067718",
													"1069798",
													"1073087",
													"1073624",
													"1073628",
													"1076205",
													"1077182",
													"1078279",
													"1078284",
													"1078999",
													"1080071",
													"1080646",
													"1082785",
													"1084133",
													"1084995",
													"1085006",
													"1085124",
													"1085547",
													"1086272",
													"1086349",
													"1087576",
													"1088004",
													"1092072",
													"1092604",
													"1093544",
													"1093759",
													"1094408",
													"1095520",
													"1098570",
													"1100411",
													"1104196",
													"1122569",
													"1123303",
													"1139328"
												],
												"external_bugs": {
													"text": "OSP-5700",
													"name": "Red Hat Issue Tracker"
												},
												"long_desc": [
													{
														"isprivate": "0",
														"commentid": "6607386",
														"comment_count": "0",
														"who": {
															"text": "sreichar",
															"name": "Steve Reichard"
														},
														"bug_when": "2013-12-11 19:16:02 +0000",
														"thetext": "Description of problem:\n\n\nVersion-Release number of selected component (if applicable):\n\n\nHow reproducible:\n\n\nSteps to Reproduce:\n1.\n2.\n3.\n\nActual results:\n\n\nExpected results:\n\n\nAdditional info:"
													},
													{
														"isprivate": "0",
														"commentid": "15244432",
														"comment_count": "3",
														"who": {
															"text": "ykaul",
															"name": "Yaniv Kaul"
														},
														"bug_when": "2021-07-01 09:51:25 +0000",
														"thetext": "Closing. if needed, please re-open."
													}
												]
											}
										],
										"external_bugs": {
											"text": "67261",
											"name": "OpenStack gerrit"
										},
										"long_desc": [
											{
												"isprivate": "0",
												"commentid": "6856071",
												"comment_count": "0",
												"who": {
													"text": "jguiditt",
													"name": "Jason Guiditta"
												},
												"bug_when": "2014-02-25 16:48:26 +0000",
												"thetext": "+++ This bug was initially created as a clone of Bug #1036207 +++\n\nCloning to RHOS, I think for PackStack use we should default to deploying Mongo with small-files enabled. Manual/Foreman configuration should result in \"normal configuration\" and I am cloning to documentation to note the disk space requirement.\n\n+++ This bug was initially created as a clone of Bug #1028690 +++\n\nDescription of problem:\nwhen running packstack and ceilometer is enabled in the answer file. it fails the first time. i have to run it a 2nd time for it to be succesful.\n\nthe error message is ERROR : Error appeared during Puppet run: 192.168.122.254_ceilometer.pp\nError: /Stage[main]/Ceilometer::Db/Exec[ceilometer-dbsync]: Failed to call refresh: ceilometer-dbsync --config-file=/etc/ceilometer/ceilometer.conf returned 1 instead of one of [0]\n\ndid this on 2 fresh installs\n\nVersion-Release number of selected component (if applicable):\n\n\nHow reproducible:\n\n\nSteps to Reproduce:\n1.\n2.\n3.\n\nActual results:\n\n\nExpected results:\n\n\nAdditional info:\n\n--- Additional comment from Mohammed Arafa on 2013-11-09 11:07:28 EST ---\n\n\n\n--- Additional comment from Rushil Chugh on 2013-11-20 12:16:39 EST ---\n\nHi\nI had a few queries about the setup:\nDid you run it in all-in-one configuration? Was the configuration setup on Fedora or RHEL?\nRushil\n\n--- Additional comment from Rushil Chugh on 2013-11-20 12:44:57 EST ---\n\nHi \nCan you also please attach the error log file with this bug? I tried running the same on an all in one file and it worked fine for me.\nThis happens sometimes when sync_db is run before MongoDB service starts. First time MongoDB starts it's slower because of DB initialization.\nRushil\n\n--- Additional comment from Mohammed Arafa on 2013-11-20 15:07:11 EST ---\n\nrushil\n\ni can reproduce it at will. however, i _JUST_ finally managed to get my openstack instace working and do not want to delete it just yet.\n\nso to reproduce it this is my packstack answer file edits:\nhttps://raw.github.com/marafa/openstack/master/openstack-notes.sh \n\nin particular:\n#####modify ~/packstack.answer\nsed -i 's/CONFIG_NTP_SERVERS=/CONFIG_NTP_SERVERS=0.pool.ntp.org,1.pool.ntp.org,2.pool.ntp.org/g' ~/packstack.answer\nsed -i 's/CONFIG_HORIZON_SSL=n/CONFIG_HORIZON_SSL=y/g' ~/packstack.answer \nsed -i 's/PW=.*/PW=password/g' ~/packstack.answer \nsed -i 's/CONFIG_SWIFT_INSTALL=n/CONFIG_SWIFT_INSTALL=y/g' ~/packstack.answer\nsed -i 's/CONFIG_CINDER_VOLUMES_SIZE=20G/CONFIG_CINDER_VOLUMES_SIZE=5G/g' ~/packstack.answer\nsed -i 's,CONFIG_NOVA_NETWORK_FLOATRANGE=10.3.4.0/22,CONFIG_NOVA_NETWORK_FLOATRANGE=192.168.0.0/24,g' ~/packstack.answer\nsed -i 's/CONFIG_PROVISION_DEMO=n/CONFIG_PROVISION_DEMO=y/g' ~/packstack.answer\nsed -i 's,CONFIG_PROVISION_DEMO_FLOATRANGE=172.24.4.224/28,CONFIG_PROVISION_DEMO_FLOATRANGE=192.168.0.0/24,g' ~/packstack.answer\n\n####vlan support\nsed -i 's/CONFIG_NEUTRON_OVS_TENANT_NETWORK_TYPE=local/CONFIG_NEUTRON_OVS_TENANT_NETWORK_TYPE=vlan/g' ~/packstack.answer\nsed -i 's/CONFIG_NEUTRON_OVS_VLAN_RANGES=/CONFIG_NEUTRON_OVS_VLAN_RANGES=physnet1:1000:2999/g' ~/packstack.answer\nsed -i 's/CONFIG_NEUTRON_OVS_BRIDGE_MAPPINGS=/CONFIG_NEUTRON_OVS_BRIDGE_MAPPINGS=physnet1:br-eth0:1/g' ~/packstack.answer\n\n\nand it was on centos6.4 fully patched before installing packstack\n\n--- Additional comment from Mohammed Arafa on 2013-11-20 15:07:48 EST ---\n\nhi again\ni see i attached the packstack answer file previously\n\nthanks\n\n--- Additional comment from Mohammed Arafa on 2013-11-21 21:57:21 EST ---\n\nERROR : Error appeared during Puppet run: 192.168.122.254_ceilometer.pp\nError: /Stage[main]/Ceilometer::Db/Exec[ceilometer-dbsync]: Failed to call refresh: ceilometer-dbsync --config-file=/etc/ceilometer/ceilometer.conf returned 1 instead of one of [0]\n\n[root@openstack ~]# packstack --allinone --nagios-install=n\n\ni changed the parameters of packstack and yet i got the same issue. fresh install\n\n--- Additional comment from Eoghan Glynn on 2013-11-22 04:22:30 EST ---\n\nHi Mohammed,\n\nCan you also attach your /var/log/mongodb/mongodb.log?\n\n(specifically the log fragment from around the time that the problem was encountered)\n\nThanks,\nEoghan\n\n--- Additional comment from Mohammed Arafa on 2013-11-22 06:49:48 EST ---\n\n[root@openstack mongodb]# cat mongodb.log\nFri Nov 22 06:45:15.320 [initandlisten] MongoDB starting : pid=2146 port=27017 dbpath=/var/lib/mongodb 64-bit host=openstack.marafa.vm\nFri Nov 22 06:45:15.321 [initandlisten] db version v2.4.6\nFri Nov 22 06:45:15.321 [initandlisten] git version: nogitversion\nFri Nov 22 06:45:15.321 [initandlisten] build info: Linux buildvm-09.phx2.fedoraproject.org 3.10.9-200.fc19.x86_64 #1 SMP Wed Aug 21 19:27:58 UTC 2013 x86_64 BOOST_LIB_VERSION=1_41\nFri Nov 22 06:45:15.321 [initandlisten] allocator: tcmalloc\nFri Nov 22 06:45:15.321 [initandlisten] options: { bind_ip: \"127.0.0.1\", command: [ \"run\" ], config: \"/etc/mongodb.conf\", dbpath: \"/var/lib/mongodb\", fork: \"true\", journal: \"true\", logpath: \"/var/log/mongodb/mongodb.log\", nohttpinterface: \"true\", pidfilepath: \"/var/run/mongodb/mongodb.pid\", port: 27017, quiet: true }\nFri Nov 22 06:45:15.323 [initandlisten] \nFri Nov 22 06:45:15.323 [initandlisten] ** WARNING: Readahead for /var/lib/mongodb is set to 512KB\nFri Nov 22 06:45:15.323 [initandlisten] **          We suggest setting it to 256KB (512 sectors) or less\nFri Nov 22 06:45:15.323 [initandlisten] **          http://dochub.mongodb.org/core/readahead\nFri Nov 22 06:45:15.344 [initandlisten] journal dir=/var/lib/mongodb/journal\nFri Nov 22 06:45:15.345 [initandlisten] recover : no journal files present, no recovery needed\nFri Nov 22 06:45:15.345 [initandlisten] \nFri Nov 22 06:45:15.345 [initandlisten] ERROR: Insufficient free space for journal files\nFri Nov 22 06:45:15.345 [initandlisten] Please make at least 3379MB available in /var/lib/mongodb/journal or use --smallfiles\nFri Nov 22 06:45:15.345 [initandlisten] \nFri Nov 22 06:45:15.345 [initandlisten] exception in initAndListen: 15926 Insufficient free space for journals, terminating\nFri Nov 22 06:45:15.345 dbexit: \nFri Nov 22 06:45:15.345 [initandlisten] shutdown: going to close listening sockets...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: going to flush diaglog...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: going to close sockets...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: waiting for fs preallocator...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: lock for final commit...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: final commit...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: closing all files...\nFri Nov 22 06:45:15.345 [initandlisten] closeAllFiles() finished\nFri Nov 22 06:45:15.345 [initandlisten] journalCleanup...\nFri Nov 22 06:45:15.345 [initandlisten] removeJournalFiles\nFri Nov 22 06:45:15.354 [initandlisten] shutdown: removing fs lock...\nFri Nov 22 06:45:15.354 dbexit: really exiting now\n[root@openstack mongodb]# df\nFilesystem           1K-blocks      Used Available Use% Mounted on\n/dev/mapper/vg_openstack-lv_root\n                       3874440   1768316   1909312  49% /\ntmpfs                  4029800         0   4029800   0% /dev/shm\n/dev/vda1               495844     87373    382871  19% /boot\n/srv/loopback-device/device1\n                        982936     34056    896452   4% /srv/node/device1\n[root@openstack mongodb]# df -h\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/mapper/vg_openstack-lv_root\n                      3.7G  1.7G  1.9G  49% /\ntmpfs                 3.9G     0  3.9G   0% /dev/shm\n/dev/vda1             485M   86M  374M  19% /boot\n/srv/loopback-device/device1\n                      960M   34M  876M   4% /srv/node/device1\n\n--- Additional comment from Mohammed Arafa on 2013-11-22 06:51:27 EST ---\n\n\n\n--- Additional comment from Mohammed Arafa on 2013-11-22 06:51:57 EST ---\n\n\n\n--- Additional comment from Mohammed Arafa on 2013-11-22 06:52:18 EST ---\n\n\n\n--- Additional comment from Eoghan Glynn on 2013-11-22 07:34:45 EST ---\n\nHi Mohammed,\n\nSo here's your problem I think:\n\n  ERROR: Insufficient free space for journal files\n\nNote that mongodb by default eagerly preallocates journal files.\n\nAre you installing openstack in a highly resource-constrained environment, such as on a small-flavor VM without significant disk space?\n\nThe time taken by mongodb startup in such an environment may also be problematic.\n\nYou can work-around these issues by pre-installing mongo as follows, setting the --smallfiles option to reduce the initial file size to 512Mb, and also increase the startup timeout:\n\n   # pre-install mongodb\n   sudo yum install -y mongodb-server mongodb\n\n   # use smaller initial file size\n   sudo sed -i '/--smallfiles/!s/OPTIONS=\\\"/OPTIONS=\\\"--smallfiles /' /etc/sysconfig/mongod\n\n   # increase the start-up timeout\n   sudo sed -i '/^\\[Service\\]$/ a\\\n     TimeoutStartSec=360' /usr/lib/systemd/system/mongod.service\n\n   # fire up the mongodb service initially to force the journal pre-allocation\n   sudo service mongod start\n   sudo service mongod status\n   sudo service mongod stop\n\nCheers,\nEoghan\n\n--- Additional comment from Mohammed Arafa on 2013-11-24 11:12:31 EST ---\n\nso ..the journal wanted 3.x GB of free space is required?\nor else use --smallfiles ?\n\nthe logic of it escapes me.\n\nhowever, i have another question now, how will having mongodb preinstalled (most likely with a password) affect the packstack installation process?\n\n--- Additional comment from Eoghan Glynn on 2013-11-25 04:29:26 EST ---\n\n\nHi Mohammed,\n\nThe logic of mongodb journal file pre-allocation is an aspect of mongodb that's outside our control, other than via the config options referred to above.\n\nPreinstallation of mongodb will not cause a problem for packstack.\n\nGiven the above information, are you happy for me to close off this issue?\n\n(You would of course be welcome to file another bug if you other related issue crops up for you).\n\nCheers,\nEoghan\n\n--- Additional comment from Mohammed Arafa on 2013-11-25 13:22:46 EST ---\n\nthanks eoghan\n\n--- Additional comment from Stephen Gordon on 2013-11-29 13:38:34 EST ---\n\nI'm re-opening this, I think we should default to --smallfiles to alleviate this somewhat - I'm also cloning to RHOS and the associated documentation components to ensure we note this in the up front requirements.\n\n--- Additional comment from Lon Hohberger on 2014-01-20 11:28:12 EST ---\n\ndevel_ack+ for bug in POST\n\n--- Additional comment from Ami Jeain on 2014-02-09 04:55:07 EST ---\n\nno capacity to test Ceilometer in Havana\n\n--- Additional comment from errata-xmlrpc on 2014-02-13 15:50:03 EST ---\n\nBug report changed to ON_QA status by Errata System.\nA QE request has been submitted for advisory RHBA-2014:17057-01\nhttps://errata.devel.redhat.com/advisory/17057\n\n--- Additional comment from Attila Fazekas on 2014-02-17 06:24:23 EST ---\n\nWith small files (openstack-packstack-2013.2.1-0.23.dev979.el6ost):\ndu -sh /var/lib/mongodb/\n65M     /var/lib/mongodb/\n\nWithout small files (openstack-packstack-2013.2.1-0.22.dev956.el6ost):\ndu -sh /var/lib/mongodb/\n209M    /var/lib/mongodb/\n\n\nI have doubts is it wise to reduce the file-sizes for bigger scale installation,\nbut may be it is ok for small scale test installation.\n\n--- Additional comment from Mohammed Arafa on 2014-02-17 08:29:04 EST ---\n\n@attila\nisnt this a packstack switch?\n\n--- Additional comment from Francesco Vollero on 2014-02-17 09:00:33 EST ---\n\nMohammed, no isn't a switch. Packstack it's meant to be done on small environments. A switch could be done on a future release, but is a design feature.\n\n--- Additional comment from errata-xmlrpc on 2014-02-21 16:28:34 EST ---\n\nThis bug has been dropped from advisory RHBA-2014:17057 by Lon Hohberger (lhh@redhat.com)\n\n--- Additional comment from Lon Hohberger on 2014-02-21 16:38:07 EST ---\n\nThis bug is now part of the following RHSA:\n\nhttps://errata.devel.redhat.com/advisory/17118"
											},
											{
												"isprivate": "0",
												"commentid": "6856089",
												"comment_count": "1",
												"who": {
													"text": "jguiditt",
													"name": "Jason Guiditta"
												},
												"bug_when": "2014-02-25 16:51:57 +0000",
												"thetext": "So, according to Francesco, there is a race condition, wherein mongo doesnt always start in a timely manner, resulting in systemd killing it.  Restart is usually successful.  His patch for packstack (linked) updates to use 'smallfiles' flag from mongo, and also changes use of mongo ->mongo::server in the puppet calls.  Foreman likely needs the same changes in quickstack, as this seems to have fixed it on the packstack side.  Not really sure why the underlying puppet module doesn't just work by default, but that is another issue."
											},
											{
												"isprivate": "0",
												"commentid": "6905492",
												"comment_count": "2",
												"who": {
													"text": "morazi",
													"name": "Mike Orazi"
												},
												"bug_when": "2014-03-12 00:09:19 +0000",
												"thetext": "Moving to mongodb."
											},
											{
												"isprivate": "0",
												"commentid": "6955323",
												"comment_count": "3",
												"who": {
													"text": "morazi",
													"name": "Mike Orazi"
												},
												"bug_when": "2014-03-26 16:37:35 +0000",
												"thetext": "This has a high impact on all foreman installs, with likely more complications around the HA ones."
											},
											{
												"isprivate": "0",
												"commentid": "6969692",
												"comment_count": "4",
												"who": {
													"text": "lhh",
													"name": "Lon Hohberger"
												},
												"bug_when": "2014-03-31 15:52:54 +0000",
												"thetext": "I was pretty sure this was due to a bug in the initscript."
											},
											{
												"isprivate": "0",
												"commentid": "6989071",
												"comment_count": "5",
												"who": {
													"text": "fpercoco",
													"name": "Flavio Percoco"
												},
												"bug_when": "2014-04-07 09:07:53 +0000",
												"thetext": "I'm not happy with shipping mongodb with `smallfiles = true`. This is useful when there are *many* databases with *small* amount of data each. It reduces the size of journal files in order to avoid locking so much space ahead. This is not RHOS case, though.\n\nI agree it's useful for development and testing but I don't think it's ideal for production environments. At least not with the throughput we expect to have in Ceilometer.\n\nI'd recommend setting this from foreman / puppet if needed."
											},
											{
												"isprivate": "0",
												"commentid": "6989777",
												"comment_count": "6",
												"who": {
													"text": "morazi",
													"name": "Mike Orazi"
												},
												"bug_when": "2014-04-07 12:55:43 +0000",
												"thetext": "Personally I don't think we want to depend on smallfiles = true to make this work.  That is probably a reasonable solution for packstack, but I can't imagine we should be doing that in larger installations.\n\nI was hoping we could either confirm/deny that the initscript fully addressed the normal case.  We can try retesting via foreman to confirm whether or not the behavior still exists but I don't think it is the right thing to do to have foreman set smallfiles = true if the condition still exists."
											},
											{
												"isprivate": "0",
												"commentid": "6992082",
												"comment_count": "7",
												"who": {
													"text": "fpercoco",
													"name": "Flavio Percoco"
												},
												"bug_when": "2014-04-08 07:11:47 +0000",
												"thetext": "@Mike, I fully agree! I don't think depending on `smallfiles = true` to make this work is the right thing to do.\n\nIn other places (devstack) we poll from mongodb (or ceilomenter) and wait until it's up. Does this sound reasonable for the foreman case?\n\nAs for mongodb's initscript. It currently addresses the normal case, which is smallfiles = false, and as mentioned in the my other comment I think it should stay that way.\n\nThanks Mike!"
											},
											{
												"isprivate": "0",
												"commentid": "7008955",
												"comment_count": "8",
												"who": {
													"text": "fpercoco",
													"name": "Flavio Percoco"
												},
												"bug_when": "2014-04-14 16:16:46 +0000",
												"thetext": "After reading this bug again, it looks a lot like #1066408\n\nThe fix proposed for that bug should also fix this one here. The fix makes the initscript wait for mongod to be ready to accept new connections, which makes the need of using smallfiles to go away.\n\nI'm closing this bug as a duplicate of #1066408 feel free to open if you think otherwise.\n\n*** This bug has been marked as a duplicate of bug 1066408 ***"
											},
											{
												"isprivate": "0",
												"commentid": "7160899",
												"comment_count": "9",
												"who": {
													"text": "jguiditt",
													"name": "Jason Guiditta"
												},
												"bug_when": "2014-06-09 13:37:28 +0000",
												"thetext": "This is indeed now fixed, with a combination of the above BZ and a fix on our side to ensure proper ordering"
											}
										]
									}
								],
								"external_bugs": {
									"text": "RHSA-2014:0233",
									"name": "Red Hat Product Errata"
								},
								"long_desc": [
									{
										"isprivate": "0",
										"commentid": "6571786",
										"comment_count": "0",
										"who": {
											"text": "sgordon",
											"name": "Stephen Gordon"
										},
										"bug_when": "2013-11-29 18:40:32 +0000",
										"thetext": "Cloning to RHOS, I think for PackStack use we should default to deploying Mongo with small-files enabled. Manual/Foreman configuration should result in \"normal configuration\" and I am cloning to documentation to note the disk space requirement.\n\n+++ This bug was initially created as a clone of Bug #1028690 +++\n\nDescription of problem:\nwhen running packstack and ceilometer is enabled in the answer file. it fails the first time. i have to run it a 2nd time for it to be succesful.\n\nthe error message is ERROR : Error appeared during Puppet run: 192.168.122.254_ceilometer.pp\nError: /Stage[main]/Ceilometer::Db/Exec[ceilometer-dbsync]: Failed to call refresh: ceilometer-dbsync --config-file=/etc/ceilometer/ceilometer.conf returned 1 instead of one of [0]\n\ndid this on 2 fresh installs\n\nVersion-Release number of selected component (if applicable):\n\n\nHow reproducible:\n\n\nSteps to Reproduce:\n1.\n2.\n3.\n\nActual results:\n\n\nExpected results:\n\n\nAdditional info:\n\n--- Additional comment from Mohammed Arafa on 2013-11-09 11:07:28 EST ---\n\n\n\n--- Additional comment from Rushil Chugh on 2013-11-20 12:16:39 EST ---\n\nHi\nI had a few queries about the setup:\nDid you run it in all-in-one configuration? Was the configuration setup on Fedora or RHEL?\nRushil\n\n--- Additional comment from Rushil Chugh on 2013-11-20 12:44:57 EST ---\n\nHi \nCan you also please attach the error log file with this bug? I tried running the same on an all in one file and it worked fine for me.\nThis happens sometimes when sync_db is run before MongoDB service starts. First time MongoDB starts it's slower because of DB initialization.\nRushil\n\n--- Additional comment from Mohammed Arafa on 2013-11-20 15:07:11 EST ---\n\nrushil\n\ni can reproduce it at will. however, i _JUST_ finally managed to get my openstack instace working and do not want to delete it just yet.\n\nso to reproduce it this is my packstack answer file edits:\nhttps://raw.github.com/marafa/openstack/master/openstack-notes.sh \n\nin particular:\n#####modify ~/packstack.answer\nsed -i 's/CONFIG_NTP_SERVERS=/CONFIG_NTP_SERVERS=0.pool.ntp.org,1.pool.ntp.org,2.pool.ntp.org/g' ~/packstack.answer\nsed -i 's/CONFIG_HORIZON_SSL=n/CONFIG_HORIZON_SSL=y/g' ~/packstack.answer \nsed -i 's/PW=.*/PW=password/g' ~/packstack.answer \nsed -i 's/CONFIG_SWIFT_INSTALL=n/CONFIG_SWIFT_INSTALL=y/g' ~/packstack.answer\nsed -i 's/CONFIG_CINDER_VOLUMES_SIZE=20G/CONFIG_CINDER_VOLUMES_SIZE=5G/g' ~/packstack.answer\nsed -i 's,CONFIG_NOVA_NETWORK_FLOATRANGE=10.3.4.0/22,CONFIG_NOVA_NETWORK_FLOATRANGE=192.168.0.0/24,g' ~/packstack.answer\nsed -i 's/CONFIG_PROVISION_DEMO=n/CONFIG_PROVISION_DEMO=y/g' ~/packstack.answer\nsed -i 's,CONFIG_PROVISION_DEMO_FLOATRANGE=172.24.4.224/28,CONFIG_PROVISION_DEMO_FLOATRANGE=192.168.0.0/24,g' ~/packstack.answer\n\n####vlan support\nsed -i 's/CONFIG_NEUTRON_OVS_TENANT_NETWORK_TYPE=local/CONFIG_NEUTRON_OVS_TENANT_NETWORK_TYPE=vlan/g' ~/packstack.answer\nsed -i 's/CONFIG_NEUTRON_OVS_VLAN_RANGES=/CONFIG_NEUTRON_OVS_VLAN_RANGES=physnet1:1000:2999/g' ~/packstack.answer\nsed -i 's/CONFIG_NEUTRON_OVS_BRIDGE_MAPPINGS=/CONFIG_NEUTRON_OVS_BRIDGE_MAPPINGS=physnet1:br-eth0:1/g' ~/packstack.answer\n\n\nand it was on centos6.4 fully patched before installing packstack\n\n--- Additional comment from Mohammed Arafa on 2013-11-20 15:07:48 EST ---\n\nhi again\ni see i attached the packstack answer file previously\n\nthanks\n\n--- Additional comment from Mohammed Arafa on 2013-11-21 21:57:21 EST ---\n\nERROR : Error appeared during Puppet run: 192.168.122.254_ceilometer.pp\nError: /Stage[main]/Ceilometer::Db/Exec[ceilometer-dbsync]: Failed to call refresh: ceilometer-dbsync --config-file=/etc/ceilometer/ceilometer.conf returned 1 instead of one of [0]\n\n[root@openstack ~]# packstack --allinone --nagios-install=n\n\ni changed the parameters of packstack and yet i got the same issue. fresh install\n\n--- Additional comment from Eoghan Glynn on 2013-11-22 04:22:30 EST ---\n\nHi Mohammed,\n\nCan you also attach your /var/log/mongodb/mongodb.log?\n\n(specifically the log fragment from around the time that the problem was encountered)\n\nThanks,\nEoghan\n\n--- Additional comment from Mohammed Arafa on 2013-11-22 06:49:48 EST ---\n\n[root@openstack mongodb]# cat mongodb.log\nFri Nov 22 06:45:15.320 [initandlisten] MongoDB starting : pid=2146 port=27017 dbpath=/var/lib/mongodb 64-bit host=openstack.marafa.vm\nFri Nov 22 06:45:15.321 [initandlisten] db version v2.4.6\nFri Nov 22 06:45:15.321 [initandlisten] git version: nogitversion\nFri Nov 22 06:45:15.321 [initandlisten] build info: Linux buildvm-09.phx2.fedoraproject.org 3.10.9-200.fc19.x86_64 #1 SMP Wed Aug 21 19:27:58 UTC 2013 x86_64 BOOST_LIB_VERSION=1_41\nFri Nov 22 06:45:15.321 [initandlisten] allocator: tcmalloc\nFri Nov 22 06:45:15.321 [initandlisten] options: { bind_ip: \"127.0.0.1\", command: [ \"run\" ], config: \"/etc/mongodb.conf\", dbpath: \"/var/lib/mongodb\", fork: \"true\", journal: \"true\", logpath: \"/var/log/mongodb/mongodb.log\", nohttpinterface: \"true\", pidfilepath: \"/var/run/mongodb/mongodb.pid\", port: 27017, quiet: true }\nFri Nov 22 06:45:15.323 [initandlisten] \nFri Nov 22 06:45:15.323 [initandlisten] ** WARNING: Readahead for /var/lib/mongodb is set to 512KB\nFri Nov 22 06:45:15.323 [initandlisten] **          We suggest setting it to 256KB (512 sectors) or less\nFri Nov 22 06:45:15.323 [initandlisten] **          http://dochub.mongodb.org/core/readahead\nFri Nov 22 06:45:15.344 [initandlisten] journal dir=/var/lib/mongodb/journal\nFri Nov 22 06:45:15.345 [initandlisten] recover : no journal files present, no recovery needed\nFri Nov 22 06:45:15.345 [initandlisten] \nFri Nov 22 06:45:15.345 [initandlisten] ERROR: Insufficient free space for journal files\nFri Nov 22 06:45:15.345 [initandlisten] Please make at least 3379MB available in /var/lib/mongodb/journal or use --smallfiles\nFri Nov 22 06:45:15.345 [initandlisten] \nFri Nov 22 06:45:15.345 [initandlisten] exception in initAndListen: 15926 Insufficient free space for journals, terminating\nFri Nov 22 06:45:15.345 dbexit: \nFri Nov 22 06:45:15.345 [initandlisten] shutdown: going to close listening sockets...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: going to flush diaglog...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: going to close sockets...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: waiting for fs preallocator...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: lock for final commit...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: final commit...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: closing all files...\nFri Nov 22 06:45:15.345 [initandlisten] closeAllFiles() finished\nFri Nov 22 06:45:15.345 [initandlisten] journalCleanup...\nFri Nov 22 06:45:15.345 [initandlisten] removeJournalFiles\nFri Nov 22 06:45:15.354 [initandlisten] shutdown: removing fs lock...\nFri Nov 22 06:45:15.354 dbexit: really exiting now\n[root@openstack mongodb]# df\nFilesystem           1K-blocks      Used Available Use% Mounted on\n/dev/mapper/vg_openstack-lv_root\n                       3874440   1768316   1909312  49% /\ntmpfs                  4029800         0   4029800   0% /dev/shm\n/dev/vda1               495844     87373    382871  19% /boot\n/srv/loopback-device/device1\n                        982936     34056    896452   4% /srv/node/device1\n[root@openstack mongodb]# df -h\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/mapper/vg_openstack-lv_root\n                      3.7G  1.7G  1.9G  49% /\ntmpfs                 3.9G     0  3.9G   0% /dev/shm\n/dev/vda1             485M   86M  374M  19% /boot\n/srv/loopback-device/device1\n                      960M   34M  876M   4% /srv/node/device1\n\n--- Additional comment from Mohammed Arafa on 2013-11-22 06:51:27 EST ---\n\n\n\n--- Additional comment from Mohammed Arafa on 2013-11-22 06:51:57 EST ---\n\n\n\n--- Additional comment from Mohammed Arafa on 2013-11-22 06:52:18 EST ---\n\n\n\n--- Additional comment from Eoghan Glynn on 2013-11-22 07:34:45 EST ---\n\nHi Mohammed,\n\nSo here's your problem I think:\n\n  ERROR: Insufficient free space for journal files\n\nNote that mongodb by default eagerly preallocates journal files.\n\nAre you installing openstack in a highly resource-constrained environment, such as on a small-flavor VM without significant disk space?\n\nThe time taken by mongodb startup in such an environment may also be problematic.\n\nYou can work-around these issues by pre-installing mongo as follows, setting the --smallfiles option to reduce the initial file size to 512Mb, and also increase the startup timeout:\n\n   # pre-install mongodb\n   sudo yum install -y mongodb-server mongodb\n\n   # use smaller initial file size\n   sudo sed -i '/--smallfiles/!s/OPTIONS=\\\"/OPTIONS=\\\"--smallfiles /' /etc/sysconfig/mongod\n\n   # increase the start-up timeout\n   sudo sed -i '/^\\[Service\\]$/ a\\\n     TimeoutStartSec=360' /usr/lib/systemd/system/mongod.service\n\n   # fire up the mongodb service initially to force the journal pre-allocation\n   sudo service mongod start\n   sudo service mongod status\n   sudo service mongod stop\n\nCheers,\nEoghan\n\n--- Additional comment from Mohammed Arafa on 2013-11-24 11:12:31 EST ---\n\nso ..the journal wanted 3.x GB of free space is required?\nor else use --smallfiles ?\n\nthe logic of it escapes me.\n\nhowever, i have another question now, how will having mongodb preinstalled (most likely with a password) affect the packstack installation process?\n\n--- Additional comment from Eoghan Glynn on 2013-11-25 04:29:26 EST ---\n\n\nHi Mohammed,\n\nThe logic of mongodb journal file pre-allocation is an aspect of mongodb that's outside our control, other than via the config options referred to above.\n\nPreinstallation of mongodb will not cause a problem for packstack.\n\nGiven the above information, are you happy for me to close off this issue?\n\n(You would of course be welcome to file another bug if you other related issue crops up for you).\n\nCheers,\nEoghan\n\n--- Additional comment from Mohammed Arafa on 2013-11-25 13:22:46 EST ---\n\nthanks eoghan\n\n--- Additional comment from Stephen Gordon on 2013-11-29 13:38:34 EST ---\n\nI'm re-opening this, I think we should default to --smallfiles to alleviate this somewhat - I'm also cloning to RHOS and the associated documentation components to ensure we note this in the up front requirements."
									},
									{
										"isprivate": "0",
										"commentid": "6825472",
										"comment_count": "4",
										"who": {
											"text": "afazekas",
											"name": "Attila Fazekas"
										},
										"bug_when": "2014-02-17 11:24:23 +0000",
										"thetext": "With small files (openstack-packstack-2013.2.1-0.23.dev979.el6ost):\ndu -sh /var/lib/mongodb/\n65M     /var/lib/mongodb/\n\nWithout small files (openstack-packstack-2013.2.1-0.22.dev956.el6ost):\ndu -sh /var/lib/mongodb/\n209M    /var/lib/mongodb/\n\n\nI have doubts is it wise to reduce the file-sizes for bigger scale installation,\nbut may be it is ok for small scale test installation."
									},
									{
										"isprivate": "0",
										"commentid": "6826014",
										"comment_count": "5",
										"who": {
											"text": "bugzilla",
											"name": "Mohammed Arafa"
										},
										"bug_when": "2014-02-17 13:29:04 +0000",
										"thetext": "@attila\nisnt this a packstack switch?"
									},
									{
										"isprivate": "0",
										"commentid": "6826155",
										"comment_count": "6",
										"who": {
											"text": "fvollero",
											"name": "Francesco Vollero"
										},
										"bug_when": "2014-02-17 14:00:33 +0000",
										"thetext": "Mohammed, no isn't a switch. Packstack it's meant to be done on small environments. A switch could be done on a future release, but is a design feature."
									},
									{
										"isprivate": "0",
										"commentid": "6880610",
										"comment_count": "10",
										"who": {
											"text": "errata-xmlrpc",
											"name": "errata-xmlrpc"
										},
										"bug_when": "2014-03-04 19:12:54 +0000",
										"thetext": "Since the problem described in this bug report should be\nresolved in a recent advisory, it has been closed with a\nresolution of ERRATA.\n\nFor information on the advisory, and where to find the updated\nfiles, follow the link below.\n\nIf the solution does not work for you, open a new bug report.\n\nhttp://rhn.redhat.com/errata/RHSA-2014-0233.html"
									}
								]
							},
							{
								"bug_id": "1069798",
								"creation_ts": "2014-02-25 16:48:26 +0000",
								"short_desc": "puppet requires 2 runs to install ceilometer",
								"delta_ts": "2016-04-27 04:19:09 +0000",
								"bug_status": "CLOSED",
								"resolution": "DUPLICATE",
								"keywords": "OtherQA, Reopened, Triaged, ZStream",
								"priority": "high",
								"bug_severity": "urgent",
								"depends_on": [
									"1028690",
									"1036207"
								],
								"blocked": [
									{
										"bug_id": "1032769",
										"creation_ts": "2013-11-20 19:52:29 +0000",
										"short_desc": "Provide guidance on managing Ceilometer data store.",
										"delta_ts": "2015-03-10 03:36:27 +0000",
										"bug_status": "CLOSED",
										"resolution": "CURRENTRELEASE",
										"bug_file_loc": "https://bugs.launchpad.net/openstack-manuals/+bug/1253214",
										"keywords": "Documentation",
										"priority": "unspecified",
										"bug_severity": "unspecified",
										"depends_on": [
											"1036207",
											"1066408",
											"1069798",
											"1100411"
										],
										"long_desc": [
											{
												"isprivate": "0",
												"commentid": "6539647",
												"comment_count": "0",
												"who": {
													"text": "sgordon",
													"name": "Stephen Gordon"
												},
												"bug_when": "2013-11-20 19:52:29 +0000",
												"thetext": "Description of problem:\n\nAfter running an all in one setup for ~ 10 days with minimal activity I found that /var/lib/mongodb/journal contained around 3 G of data.\n\nWe need to confirm that this is within expectations and provide guidance to administrators on managing the size of their Ceilometer data store - advice from the Ceilometer team is required on this point."
											},
											{
												"isprivate": "0",
												"commentid": "6571787",
												"comment_count": "1",
												"who": {
													"text": "sgordon",
													"name": "Stephen Gordon"
												},
												"bug_when": "2013-11-29 18:42:14 +0000",
												"thetext": "Note that Bug # 1028678 may result in different guidance being required for the GSG."
											},
											{
												"isprivate": "0",
												"commentid": "6574577",
												"comment_count": "2",
												"who": {
													"text": "jpichon",
													"name": "Julie Pichon"
												},
												"bug_when": "2013-12-02 09:20:59 +0000",
												"thetext": "Hi Stephen - Are you sure the 'Depends On' points to the right bug? (It's a packstack horizon bug with a clear workaround, that I can't quite link to this one.)"
											},
											{
												"isprivate": "0",
												"commentid": "6719300",
												"comment_count": "3",
												"who": {
													"text": "sradvan",
													"name": "Scott Radvan"
												},
												"bug_when": "2014-01-16 22:54:55 +0000",
												"thetext": "This bug is being assigned to Martin, who is now the designated docs specialist for Telemetry."
											},
											{
												"isprivate": "0",
												"commentid": "6914451",
												"comment_count": "4",
												"who": {
													"text": "ddomingo",
													"name": "Don Domingo"
												},
												"bug_when": "2014-03-14 06:00:47 +0000",
												"thetext": "Upstream fix merged:\n\nhttps://review.openstack.org/#/c/67676/\n\nSetting to MODIFIED."
											}
										]
									},
									{
										"bug_id": "1040649",
										"creation_ts": "2013-12-11 19:16:02 +0000",
										"short_desc": "Tracking Bug for RHOS 4 affecting Ref Arch and Solution Validation",
										"delta_ts": "2022-08-11 16:15:03 +0000",
										"bug_status": "CLOSED",
										"resolution": "CURRENTRELEASE",
										"bug_file_loc": "https://bugzilla.redhat.com/show_bug.cgi?id=1130215",
										"keywords": "Tracking",
										"priority": "unspecified",
										"bug_severity": "unspecified",
										"depends_on": [
											"1006534",
											"1017289",
											"1020002",
											"1020025",
											"1020479",
											"1020483",
											"1020979",
											"1028615",
											"1028621",
											"1030067",
											"1030069",
											"1030209",
											"1036515",
											"1038288",
											"1039650",
											"1039698",
											"1039910",
											"1040021",
											"1040262",
											"1040265",
											"1042933",
											"1045132",
											"1045135",
											"1045137",
											"1045196",
											"1045221",
											"1047653",
											"1052807",
											"1055852",
											"1056055",
											"1056058",
											"1062693",
											"1062699",
											"1062701",
											"1062709",
											"1064050",
											"1064056",
											"1064058",
											"1064061",
											"1064327",
											"1065666",
											"1066408",
											"1066549",
											"1067718",
											"1069798",
											"1073087",
											"1073624",
											"1073628",
											"1076205",
											"1077182",
											"1078279",
											"1078284",
											"1078999",
											"1080071",
											"1080646",
											"1082785",
											"1084133",
											"1084995",
											"1085006",
											"1085124",
											"1085547",
											"1086272",
											"1086349",
											"1087576",
											"1088004",
											"1092072",
											"1092604",
											"1093544",
											"1093759",
											"1094408",
											"1095520",
											"1098570",
											"1100411",
											"1104196",
											"1122569",
											"1123303",
											"1139328"
										],
										"external_bugs": {
											"text": "OSP-5700",
											"name": "Red Hat Issue Tracker"
										},
										"long_desc": [
											{
												"isprivate": "0",
												"commentid": "6607386",
												"comment_count": "0",
												"who": {
													"text": "sreichar",
													"name": "Steve Reichard"
												},
												"bug_when": "2013-12-11 19:16:02 +0000",
												"thetext": "Description of problem:\n\n\nVersion-Release number of selected component (if applicable):\n\n\nHow reproducible:\n\n\nSteps to Reproduce:\n1.\n2.\n3.\n\nActual results:\n\n\nExpected results:\n\n\nAdditional info:"
											},
											{
												"isprivate": "0",
												"commentid": "15244432",
												"comment_count": "3",
												"who": {
													"text": "ykaul",
													"name": "Yaniv Kaul"
												},
												"bug_when": "2021-07-01 09:51:25 +0000",
												"thetext": "Closing. if needed, please re-open."
											}
										]
									}
								],
								"external_bugs": {
									"text": "67261",
									"name": "OpenStack gerrit"
								},
								"long_desc": [
									{
										"isprivate": "0",
										"commentid": "6856071",
										"comment_count": "0",
										"who": {
											"text": "jguiditt",
											"name": "Jason Guiditta"
										},
										"bug_when": "2014-02-25 16:48:26 +0000",
										"thetext": "+++ This bug was initially created as a clone of Bug #1036207 +++\n\nCloning to RHOS, I think for PackStack use we should default to deploying Mongo with small-files enabled. Manual/Foreman configuration should result in \"normal configuration\" and I am cloning to documentation to note the disk space requirement.\n\n+++ This bug was initially created as a clone of Bug #1028690 +++\n\nDescription of problem:\nwhen running packstack and ceilometer is enabled in the answer file. it fails the first time. i have to run it a 2nd time for it to be succesful.\n\nthe error message is ERROR : Error appeared during Puppet run: 192.168.122.254_ceilometer.pp\nError: /Stage[main]/Ceilometer::Db/Exec[ceilometer-dbsync]: Failed to call refresh: ceilometer-dbsync --config-file=/etc/ceilometer/ceilometer.conf returned 1 instead of one of [0]\n\ndid this on 2 fresh installs\n\nVersion-Release number of selected component (if applicable):\n\n\nHow reproducible:\n\n\nSteps to Reproduce:\n1.\n2.\n3.\n\nActual results:\n\n\nExpected results:\n\n\nAdditional info:\n\n--- Additional comment from Mohammed Arafa on 2013-11-09 11:07:28 EST ---\n\n\n\n--- Additional comment from Rushil Chugh on 2013-11-20 12:16:39 EST ---\n\nHi\nI had a few queries about the setup:\nDid you run it in all-in-one configuration? Was the configuration setup on Fedora or RHEL?\nRushil\n\n--- Additional comment from Rushil Chugh on 2013-11-20 12:44:57 EST ---\n\nHi \nCan you also please attach the error log file with this bug? I tried running the same on an all in one file and it worked fine for me.\nThis happens sometimes when sync_db is run before MongoDB service starts. First time MongoDB starts it's slower because of DB initialization.\nRushil\n\n--- Additional comment from Mohammed Arafa on 2013-11-20 15:07:11 EST ---\n\nrushil\n\ni can reproduce it at will. however, i _JUST_ finally managed to get my openstack instace working and do not want to delete it just yet.\n\nso to reproduce it this is my packstack answer file edits:\nhttps://raw.github.com/marafa/openstack/master/openstack-notes.sh \n\nin particular:\n#####modify ~/packstack.answer\nsed -i 's/CONFIG_NTP_SERVERS=/CONFIG_NTP_SERVERS=0.pool.ntp.org,1.pool.ntp.org,2.pool.ntp.org/g' ~/packstack.answer\nsed -i 's/CONFIG_HORIZON_SSL=n/CONFIG_HORIZON_SSL=y/g' ~/packstack.answer \nsed -i 's/PW=.*/PW=password/g' ~/packstack.answer \nsed -i 's/CONFIG_SWIFT_INSTALL=n/CONFIG_SWIFT_INSTALL=y/g' ~/packstack.answer\nsed -i 's/CONFIG_CINDER_VOLUMES_SIZE=20G/CONFIG_CINDER_VOLUMES_SIZE=5G/g' ~/packstack.answer\nsed -i 's,CONFIG_NOVA_NETWORK_FLOATRANGE=10.3.4.0/22,CONFIG_NOVA_NETWORK_FLOATRANGE=192.168.0.0/24,g' ~/packstack.answer\nsed -i 's/CONFIG_PROVISION_DEMO=n/CONFIG_PROVISION_DEMO=y/g' ~/packstack.answer\nsed -i 's,CONFIG_PROVISION_DEMO_FLOATRANGE=172.24.4.224/28,CONFIG_PROVISION_DEMO_FLOATRANGE=192.168.0.0/24,g' ~/packstack.answer\n\n####vlan support\nsed -i 's/CONFIG_NEUTRON_OVS_TENANT_NETWORK_TYPE=local/CONFIG_NEUTRON_OVS_TENANT_NETWORK_TYPE=vlan/g' ~/packstack.answer\nsed -i 's/CONFIG_NEUTRON_OVS_VLAN_RANGES=/CONFIG_NEUTRON_OVS_VLAN_RANGES=physnet1:1000:2999/g' ~/packstack.answer\nsed -i 's/CONFIG_NEUTRON_OVS_BRIDGE_MAPPINGS=/CONFIG_NEUTRON_OVS_BRIDGE_MAPPINGS=physnet1:br-eth0:1/g' ~/packstack.answer\n\n\nand it was on centos6.4 fully patched before installing packstack\n\n--- Additional comment from Mohammed Arafa on 2013-11-20 15:07:48 EST ---\n\nhi again\ni see i attached the packstack answer file previously\n\nthanks\n\n--- Additional comment from Mohammed Arafa on 2013-11-21 21:57:21 EST ---\n\nERROR : Error appeared during Puppet run: 192.168.122.254_ceilometer.pp\nError: /Stage[main]/Ceilometer::Db/Exec[ceilometer-dbsync]: Failed to call refresh: ceilometer-dbsync --config-file=/etc/ceilometer/ceilometer.conf returned 1 instead of one of [0]\n\n[root@openstack ~]# packstack --allinone --nagios-install=n\n\ni changed the parameters of packstack and yet i got the same issue. fresh install\n\n--- Additional comment from Eoghan Glynn on 2013-11-22 04:22:30 EST ---\n\nHi Mohammed,\n\nCan you also attach your /var/log/mongodb/mongodb.log?\n\n(specifically the log fragment from around the time that the problem was encountered)\n\nThanks,\nEoghan\n\n--- Additional comment from Mohammed Arafa on 2013-11-22 06:49:48 EST ---\n\n[root@openstack mongodb]# cat mongodb.log\nFri Nov 22 06:45:15.320 [initandlisten] MongoDB starting : pid=2146 port=27017 dbpath=/var/lib/mongodb 64-bit host=openstack.marafa.vm\nFri Nov 22 06:45:15.321 [initandlisten] db version v2.4.6\nFri Nov 22 06:45:15.321 [initandlisten] git version: nogitversion\nFri Nov 22 06:45:15.321 [initandlisten] build info: Linux buildvm-09.phx2.fedoraproject.org 3.10.9-200.fc19.x86_64 #1 SMP Wed Aug 21 19:27:58 UTC 2013 x86_64 BOOST_LIB_VERSION=1_41\nFri Nov 22 06:45:15.321 [initandlisten] allocator: tcmalloc\nFri Nov 22 06:45:15.321 [initandlisten] options: { bind_ip: \"127.0.0.1\", command: [ \"run\" ], config: \"/etc/mongodb.conf\", dbpath: \"/var/lib/mongodb\", fork: \"true\", journal: \"true\", logpath: \"/var/log/mongodb/mongodb.log\", nohttpinterface: \"true\", pidfilepath: \"/var/run/mongodb/mongodb.pid\", port: 27017, quiet: true }\nFri Nov 22 06:45:15.323 [initandlisten] \nFri Nov 22 06:45:15.323 [initandlisten] ** WARNING: Readahead for /var/lib/mongodb is set to 512KB\nFri Nov 22 06:45:15.323 [initandlisten] **          We suggest setting it to 256KB (512 sectors) or less\nFri Nov 22 06:45:15.323 [initandlisten] **          http://dochub.mongodb.org/core/readahead\nFri Nov 22 06:45:15.344 [initandlisten] journal dir=/var/lib/mongodb/journal\nFri Nov 22 06:45:15.345 [initandlisten] recover : no journal files present, no recovery needed\nFri Nov 22 06:45:15.345 [initandlisten] \nFri Nov 22 06:45:15.345 [initandlisten] ERROR: Insufficient free space for journal files\nFri Nov 22 06:45:15.345 [initandlisten] Please make at least 3379MB available in /var/lib/mongodb/journal or use --smallfiles\nFri Nov 22 06:45:15.345 [initandlisten] \nFri Nov 22 06:45:15.345 [initandlisten] exception in initAndListen: 15926 Insufficient free space for journals, terminating\nFri Nov 22 06:45:15.345 dbexit: \nFri Nov 22 06:45:15.345 [initandlisten] shutdown: going to close listening sockets...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: going to flush diaglog...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: going to close sockets...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: waiting for fs preallocator...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: lock for final commit...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: final commit...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: closing all files...\nFri Nov 22 06:45:15.345 [initandlisten] closeAllFiles() finished\nFri Nov 22 06:45:15.345 [initandlisten] journalCleanup...\nFri Nov 22 06:45:15.345 [initandlisten] removeJournalFiles\nFri Nov 22 06:45:15.354 [initandlisten] shutdown: removing fs lock...\nFri Nov 22 06:45:15.354 dbexit: really exiting now\n[root@openstack mongodb]# df\nFilesystem           1K-blocks      Used Available Use% Mounted on\n/dev/mapper/vg_openstack-lv_root\n                       3874440   1768316   1909312  49% /\ntmpfs                  4029800         0   4029800   0% /dev/shm\n/dev/vda1               495844     87373    382871  19% /boot\n/srv/loopback-device/device1\n                        982936     34056    896452   4% /srv/node/device1\n[root@openstack mongodb]# df -h\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/mapper/vg_openstack-lv_root\n                      3.7G  1.7G  1.9G  49% /\ntmpfs                 3.9G     0  3.9G   0% /dev/shm\n/dev/vda1             485M   86M  374M  19% /boot\n/srv/loopback-device/device1\n                      960M   34M  876M   4% /srv/node/device1\n\n--- Additional comment from Mohammed Arafa on 2013-11-22 06:51:27 EST ---\n\n\n\n--- Additional comment from Mohammed Arafa on 2013-11-22 06:51:57 EST ---\n\n\n\n--- Additional comment from Mohammed Arafa on 2013-11-22 06:52:18 EST ---\n\n\n\n--- Additional comment from Eoghan Glynn on 2013-11-22 07:34:45 EST ---\n\nHi Mohammed,\n\nSo here's your problem I think:\n\n  ERROR: Insufficient free space for journal files\n\nNote that mongodb by default eagerly preallocates journal files.\n\nAre you installing openstack in a highly resource-constrained environment, such as on a small-flavor VM without significant disk space?\n\nThe time taken by mongodb startup in such an environment may also be problematic.\n\nYou can work-around these issues by pre-installing mongo as follows, setting the --smallfiles option to reduce the initial file size to 512Mb, and also increase the startup timeout:\n\n   # pre-install mongodb\n   sudo yum install -y mongodb-server mongodb\n\n   # use smaller initial file size\n   sudo sed -i '/--smallfiles/!s/OPTIONS=\\\"/OPTIONS=\\\"--smallfiles /' /etc/sysconfig/mongod\n\n   # increase the start-up timeout\n   sudo sed -i '/^\\[Service\\]$/ a\\\n     TimeoutStartSec=360' /usr/lib/systemd/system/mongod.service\n\n   # fire up the mongodb service initially to force the journal pre-allocation\n   sudo service mongod start\n   sudo service mongod status\n   sudo service mongod stop\n\nCheers,\nEoghan\n\n--- Additional comment from Mohammed Arafa on 2013-11-24 11:12:31 EST ---\n\nso ..the journal wanted 3.x GB of free space is required?\nor else use --smallfiles ?\n\nthe logic of it escapes me.\n\nhowever, i have another question now, how will having mongodb preinstalled (most likely with a password) affect the packstack installation process?\n\n--- Additional comment from Eoghan Glynn on 2013-11-25 04:29:26 EST ---\n\n\nHi Mohammed,\n\nThe logic of mongodb journal file pre-allocation is an aspect of mongodb that's outside our control, other than via the config options referred to above.\n\nPreinstallation of mongodb will not cause a problem for packstack.\n\nGiven the above information, are you happy for me to close off this issue?\n\n(You would of course be welcome to file another bug if you other related issue crops up for you).\n\nCheers,\nEoghan\n\n--- Additional comment from Mohammed Arafa on 2013-11-25 13:22:46 EST ---\n\nthanks eoghan\n\n--- Additional comment from Stephen Gordon on 2013-11-29 13:38:34 EST ---\n\nI'm re-opening this, I think we should default to --smallfiles to alleviate this somewhat - I'm also cloning to RHOS and the associated documentation components to ensure we note this in the up front requirements.\n\n--- Additional comment from Lon Hohberger on 2014-01-20 11:28:12 EST ---\n\ndevel_ack+ for bug in POST\n\n--- Additional comment from Ami Jeain on 2014-02-09 04:55:07 EST ---\n\nno capacity to test Ceilometer in Havana\n\n--- Additional comment from errata-xmlrpc on 2014-02-13 15:50:03 EST ---\n\nBug report changed to ON_QA status by Errata System.\nA QE request has been submitted for advisory RHBA-2014:17057-01\nhttps://errata.devel.redhat.com/advisory/17057\n\n--- Additional comment from Attila Fazekas on 2014-02-17 06:24:23 EST ---\n\nWith small files (openstack-packstack-2013.2.1-0.23.dev979.el6ost):\ndu -sh /var/lib/mongodb/\n65M     /var/lib/mongodb/\n\nWithout small files (openstack-packstack-2013.2.1-0.22.dev956.el6ost):\ndu -sh /var/lib/mongodb/\n209M    /var/lib/mongodb/\n\n\nI have doubts is it wise to reduce the file-sizes for bigger scale installation,\nbut may be it is ok for small scale test installation.\n\n--- Additional comment from Mohammed Arafa on 2014-02-17 08:29:04 EST ---\n\n@attila\nisnt this a packstack switch?\n\n--- Additional comment from Francesco Vollero on 2014-02-17 09:00:33 EST ---\n\nMohammed, no isn't a switch. Packstack it's meant to be done on small environments. A switch could be done on a future release, but is a design feature.\n\n--- Additional comment from errata-xmlrpc on 2014-02-21 16:28:34 EST ---\n\nThis bug has been dropped from advisory RHBA-2014:17057 by Lon Hohberger (lhh@redhat.com)\n\n--- Additional comment from Lon Hohberger on 2014-02-21 16:38:07 EST ---\n\nThis bug is now part of the following RHSA:\n\nhttps://errata.devel.redhat.com/advisory/17118"
									},
									{
										"isprivate": "0",
										"commentid": "6856089",
										"comment_count": "1",
										"who": {
											"text": "jguiditt",
											"name": "Jason Guiditta"
										},
										"bug_when": "2014-02-25 16:51:57 +0000",
										"thetext": "So, according to Francesco, there is a race condition, wherein mongo doesnt always start in a timely manner, resulting in systemd killing it.  Restart is usually successful.  His patch for packstack (linked) updates to use 'smallfiles' flag from mongo, and also changes use of mongo ->mongo::server in the puppet calls.  Foreman likely needs the same changes in quickstack, as this seems to have fixed it on the packstack side.  Not really sure why the underlying puppet module doesn't just work by default, but that is another issue."
									},
									{
										"isprivate": "0",
										"commentid": "6905492",
										"comment_count": "2",
										"who": {
											"text": "morazi",
											"name": "Mike Orazi"
										},
										"bug_when": "2014-03-12 00:09:19 +0000",
										"thetext": "Moving to mongodb."
									},
									{
										"isprivate": "0",
										"commentid": "6955323",
										"comment_count": "3",
										"who": {
											"text": "morazi",
											"name": "Mike Orazi"
										},
										"bug_when": "2014-03-26 16:37:35 +0000",
										"thetext": "This has a high impact on all foreman installs, with likely more complications around the HA ones."
									},
									{
										"isprivate": "0",
										"commentid": "6969692",
										"comment_count": "4",
										"who": {
											"text": "lhh",
											"name": "Lon Hohberger"
										},
										"bug_when": "2014-03-31 15:52:54 +0000",
										"thetext": "I was pretty sure this was due to a bug in the initscript."
									},
									{
										"isprivate": "0",
										"commentid": "6989071",
										"comment_count": "5",
										"who": {
											"text": "fpercoco",
											"name": "Flavio Percoco"
										},
										"bug_when": "2014-04-07 09:07:53 +0000",
										"thetext": "I'm not happy with shipping mongodb with `smallfiles = true`. This is useful when there are *many* databases with *small* amount of data each. It reduces the size of journal files in order to avoid locking so much space ahead. This is not RHOS case, though.\n\nI agree it's useful for development and testing but I don't think it's ideal for production environments. At least not with the throughput we expect to have in Ceilometer.\n\nI'd recommend setting this from foreman / puppet if needed."
									},
									{
										"isprivate": "0",
										"commentid": "6989777",
										"comment_count": "6",
										"who": {
											"text": "morazi",
											"name": "Mike Orazi"
										},
										"bug_when": "2014-04-07 12:55:43 +0000",
										"thetext": "Personally I don't think we want to depend on smallfiles = true to make this work.  That is probably a reasonable solution for packstack, but I can't imagine we should be doing that in larger installations.\n\nI was hoping we could either confirm/deny that the initscript fully addressed the normal case.  We can try retesting via foreman to confirm whether or not the behavior still exists but I don't think it is the right thing to do to have foreman set smallfiles = true if the condition still exists."
									},
									{
										"isprivate": "0",
										"commentid": "6992082",
										"comment_count": "7",
										"who": {
											"text": "fpercoco",
											"name": "Flavio Percoco"
										},
										"bug_when": "2014-04-08 07:11:47 +0000",
										"thetext": "@Mike, I fully agree! I don't think depending on `smallfiles = true` to make this work is the right thing to do.\n\nIn other places (devstack) we poll from mongodb (or ceilomenter) and wait until it's up. Does this sound reasonable for the foreman case?\n\nAs for mongodb's initscript. It currently addresses the normal case, which is smallfiles = false, and as mentioned in the my other comment I think it should stay that way.\n\nThanks Mike!"
									},
									{
										"isprivate": "0",
										"commentid": "7008955",
										"comment_count": "8",
										"who": {
											"text": "fpercoco",
											"name": "Flavio Percoco"
										},
										"bug_when": "2014-04-14 16:16:46 +0000",
										"thetext": "After reading this bug again, it looks a lot like #1066408\n\nThe fix proposed for that bug should also fix this one here. The fix makes the initscript wait for mongod to be ready to accept new connections, which makes the need of using smallfiles to go away.\n\nI'm closing this bug as a duplicate of #1066408 feel free to open if you think otherwise.\n\n*** This bug has been marked as a duplicate of bug 1066408 ***"
									},
									{
										"isprivate": "0",
										"commentid": "7160899",
										"comment_count": "9",
										"who": {
											"text": "jguiditt",
											"name": "Jason Guiditta"
										},
										"bug_when": "2014-06-09 13:37:28 +0000",
										"thetext": "This is indeed now fixed, with a combination of the above BZ and a fix on our side to ensure proper ordering"
									}
								]
							}
						],
						"external_bugs": {
							"text": "69638",
							"name": "OpenStack gerrit"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "6504193",
								"comment_count": "0",
								"who": {
									"text": "bugzilla",
									"name": "Mohammed Arafa"
								},
								"bug_when": "2013-11-09 16:06:50 +0000",
								"thetext": "Created attachment 821917\nopenstack setup log\n\nDescription of problem:\nwhen running packstack and ceilometer is enabled in the answer file. it fails the first time. i have to run it a 2nd time for it to be succesful.\n\nthe error message is ERROR : Error appeared during Puppet run: 192.168.122.254_ceilometer.pp\nError: /Stage[main]/Ceilometer::Db/Exec[ceilometer-dbsync]: Failed to call refresh: ceilometer-dbsync --config-file=/etc/ceilometer/ceilometer.conf returned 1 instead of one of [0]\n\ndid this on 2 fresh installs\n\nVersion-Release number of selected component (if applicable):\n\n\nHow reproducible:\n\n\nSteps to Reproduce:\n1.\n2.\n3.\n\nActual results:\n\n\nExpected results:\n\n\nAdditional info:"
							},
							{
								"isprivate": "0",
								"commentid": "6504195",
								"comment_count": "1",
								"who": {
									"text": "bugzilla",
									"name": "Mohammed Arafa"
								},
								"bug_when": "2013-11-09 16:07:28 +0000",
								"thetext": "Created attachment 821918\npackstack answer file"
							},
							{
								"isprivate": "0",
								"commentid": "6538800",
								"comment_count": "2",
								"who": {
									"text": "rchugh",
									"name": "Rushil Chugh"
								},
								"bug_when": "2013-11-20 17:16:39 +0000",
								"thetext": "Hi\nI had a few queries about the setup:\nDid you run it in all-in-one configuration? Was the configuration setup on Fedora or RHEL?\nRushil"
							},
							{
								"isprivate": "0",
								"commentid": "6538960",
								"comment_count": "3",
								"who": {
									"text": "rchugh",
									"name": "Rushil Chugh"
								},
								"bug_when": "2013-11-20 17:44:57 +0000",
								"thetext": "Hi \nCan you also please attach the error log file with this bug? I tried running the same on an all in one file and it worked fine for me.\nThis happens sometimes when sync_db is run before MongoDB service starts. First time MongoDB starts it's slower because of DB initialization.\nRushil"
							},
							{
								"isprivate": "0",
								"commentid": "6539714",
								"comment_count": "4",
								"who": {
									"text": "bugzilla",
									"name": "Mohammed Arafa"
								},
								"bug_when": "2013-11-20 20:07:11 +0000",
								"thetext": "rushil\n\ni can reproduce it at will. however, i _JUST_ finally managed to get my openstack instace working and do not want to delete it just yet.\n\nso to reproduce it this is my packstack answer file edits:\nhttps://raw.github.com/marafa/openstack/master/openstack-notes.sh \n\nin particular:\n#####modify ~/packstack.answer\nsed -i 's/CONFIG_NTP_SERVERS=/CONFIG_NTP_SERVERS=0.pool.ntp.org,1.pool.ntp.org,2.pool.ntp.org/g' ~/packstack.answer\nsed -i 's/CONFIG_HORIZON_SSL=n/CONFIG_HORIZON_SSL=y/g' ~/packstack.answer \nsed -i 's/PW=.*/PW=password/g' ~/packstack.answer \nsed -i 's/CONFIG_SWIFT_INSTALL=n/CONFIG_SWIFT_INSTALL=y/g' ~/packstack.answer\nsed -i 's/CONFIG_CINDER_VOLUMES_SIZE=20G/CONFIG_CINDER_VOLUMES_SIZE=5G/g' ~/packstack.answer\nsed -i 's,CONFIG_NOVA_NETWORK_FLOATRANGE=10.3.4.0/22,CONFIG_NOVA_NETWORK_FLOATRANGE=192.168.0.0/24,g' ~/packstack.answer\nsed -i 's/CONFIG_PROVISION_DEMO=n/CONFIG_PROVISION_DEMO=y/g' ~/packstack.answer\nsed -i 's,CONFIG_PROVISION_DEMO_FLOATRANGE=172.24.4.224/28,CONFIG_PROVISION_DEMO_FLOATRANGE=192.168.0.0/24,g' ~/packstack.answer\n\n####vlan support\nsed -i 's/CONFIG_NEUTRON_OVS_TENANT_NETWORK_TYPE=local/CONFIG_NEUTRON_OVS_TENANT_NETWORK_TYPE=vlan/g' ~/packstack.answer\nsed -i 's/CONFIG_NEUTRON_OVS_VLAN_RANGES=/CONFIG_NEUTRON_OVS_VLAN_RANGES=physnet1:1000:2999/g' ~/packstack.answer\nsed -i 's/CONFIG_NEUTRON_OVS_BRIDGE_MAPPINGS=/CONFIG_NEUTRON_OVS_BRIDGE_MAPPINGS=physnet1:br-eth0:1/g' ~/packstack.answer\n\n\nand it was on centos6.4 fully patched before installing packstack"
							},
							{
								"isprivate": "0",
								"commentid": "6539716",
								"comment_count": "5",
								"who": {
									"text": "bugzilla",
									"name": "Mohammed Arafa"
								},
								"bug_when": "2013-11-20 20:07:48 +0000",
								"thetext": "hi again\ni see i attached the packstack answer file previously\n\nthanks"
							},
							{
								"isprivate": "0",
								"commentid": "6547890",
								"comment_count": "6",
								"who": {
									"text": "bugzilla",
									"name": "Mohammed Arafa"
								},
								"bug_when": "2013-11-22 02:57:21 +0000",
								"thetext": "ERROR : Error appeared during Puppet run: 192.168.122.254_ceilometer.pp\nError: /Stage[main]/Ceilometer::Db/Exec[ceilometer-dbsync]: Failed to call refresh: ceilometer-dbsync --config-file=/etc/ceilometer/ceilometer.conf returned 1 instead of one of [0]\n\n[root@openstack ~]# packstack --allinone --nagios-install=n\n\ni changed the parameters of packstack and yet i got the same issue. fresh install"
							},
							{
								"isprivate": "0",
								"commentid": "6548788",
								"comment_count": "7",
								"who": {
									"text": "eglynn",
									"name": "Eoghan Glynn"
								},
								"bug_when": "2013-11-22 09:22:30 +0000",
								"thetext": "Hi Mohammed,\n\nCan you also attach your /var/log/mongodb/mongodb.log?\n\n(specifically the log fragment from around the time that the problem was encountered)\n\nThanks,\nEoghan"
							},
							{
								"isprivate": "0",
								"commentid": "6549208",
								"comment_count": "8",
								"who": {
									"text": "bugzilla",
									"name": "Mohammed Arafa"
								},
								"bug_when": "2013-11-22 11:49:48 +0000",
								"thetext": "[root@openstack mongodb]# cat mongodb.log\nFri Nov 22 06:45:15.320 [initandlisten] MongoDB starting : pid=2146 port=27017 dbpath=/var/lib/mongodb 64-bit host=openstack.marafa.vm\nFri Nov 22 06:45:15.321 [initandlisten] db version v2.4.6\nFri Nov 22 06:45:15.321 [initandlisten] git version: nogitversion\nFri Nov 22 06:45:15.321 [initandlisten] build info: Linux buildvm-09.phx2.fedoraproject.org 3.10.9-200.fc19.x86_64 #1 SMP Wed Aug 21 19:27:58 UTC 2013 x86_64 BOOST_LIB_VERSION=1_41\nFri Nov 22 06:45:15.321 [initandlisten] allocator: tcmalloc\nFri Nov 22 06:45:15.321 [initandlisten] options: { bind_ip: \"127.0.0.1\", command: [ \"run\" ], config: \"/etc/mongodb.conf\", dbpath: \"/var/lib/mongodb\", fork: \"true\", journal: \"true\", logpath: \"/var/log/mongodb/mongodb.log\", nohttpinterface: \"true\", pidfilepath: \"/var/run/mongodb/mongodb.pid\", port: 27017, quiet: true }\nFri Nov 22 06:45:15.323 [initandlisten] \nFri Nov 22 06:45:15.323 [initandlisten] ** WARNING: Readahead for /var/lib/mongodb is set to 512KB\nFri Nov 22 06:45:15.323 [initandlisten] **          We suggest setting it to 256KB (512 sectors) or less\nFri Nov 22 06:45:15.323 [initandlisten] **          http://dochub.mongodb.org/core/readahead\nFri Nov 22 06:45:15.344 [initandlisten] journal dir=/var/lib/mongodb/journal\nFri Nov 22 06:45:15.345 [initandlisten] recover : no journal files present, no recovery needed\nFri Nov 22 06:45:15.345 [initandlisten] \nFri Nov 22 06:45:15.345 [initandlisten] ERROR: Insufficient free space for journal files\nFri Nov 22 06:45:15.345 [initandlisten] Please make at least 3379MB available in /var/lib/mongodb/journal or use --smallfiles\nFri Nov 22 06:45:15.345 [initandlisten] \nFri Nov 22 06:45:15.345 [initandlisten] exception in initAndListen: 15926 Insufficient free space for journals, terminating\nFri Nov 22 06:45:15.345 dbexit: \nFri Nov 22 06:45:15.345 [initandlisten] shutdown: going to close listening sockets...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: going to flush diaglog...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: going to close sockets...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: waiting for fs preallocator...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: lock for final commit...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: final commit...\nFri Nov 22 06:45:15.345 [initandlisten] shutdown: closing all files...\nFri Nov 22 06:45:15.345 [initandlisten] closeAllFiles() finished\nFri Nov 22 06:45:15.345 [initandlisten] journalCleanup...\nFri Nov 22 06:45:15.345 [initandlisten] removeJournalFiles\nFri Nov 22 06:45:15.354 [initandlisten] shutdown: removing fs lock...\nFri Nov 22 06:45:15.354 dbexit: really exiting now\n[root@openstack mongodb]# df\nFilesystem           1K-blocks      Used Available Use% Mounted on\n/dev/mapper/vg_openstack-lv_root\n                       3874440   1768316   1909312  49% /\ntmpfs                  4029800         0   4029800   0% /dev/shm\n/dev/vda1               495844     87373    382871  19% /boot\n/srv/loopback-device/device1\n                        982936     34056    896452   4% /srv/node/device1\n[root@openstack mongodb]# df -h\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/mapper/vg_openstack-lv_root\n                      3.7G  1.7G  1.9G  49% /\ntmpfs                 3.9G     0  3.9G   0% /dev/shm\n/dev/vda1             485M   86M  374M  19% /boot\n/srv/loopback-device/device1\n                      960M   34M  876M   4% /srv/node/device1"
							},
							{
								"isprivate": "0",
								"commentid": "6549212",
								"comment_count": "9",
								"who": {
									"text": "bugzilla",
									"name": "Mohammed Arafa"
								},
								"bug_when": "2013-11-22 11:51:27 +0000",
								"thetext": "Created attachment 827701\nmongo"
							},
							{
								"isprivate": "0",
								"commentid": "6549213",
								"comment_count": "10",
								"who": {
									"text": "bugzilla",
									"name": "Mohammed Arafa"
								},
								"bug_when": "2013-11-22 11:51:57 +0000",
								"thetext": "Created attachment 827702\nmongo"
							},
							{
								"isprivate": "0",
								"commentid": "6549214",
								"comment_count": "11",
								"who": {
									"text": "bugzilla",
									"name": "Mohammed Arafa"
								},
								"bug_when": "2013-11-22 11:52:18 +0000",
								"thetext": "Created attachment 827703\nmongo"
							},
							{
								"isprivate": "0",
								"commentid": "6549327",
								"comment_count": "12",
								"who": {
									"text": "eglynn",
									"name": "Eoghan Glynn"
								},
								"bug_when": "2013-11-22 12:34:45 +0000",
								"thetext": "Hi Mohammed,\n\nSo here's your problem I think:\n\n  ERROR: Insufficient free space for journal files\n\nNote that mongodb by default eagerly preallocates journal files.\n\nAre you installing openstack in a highly resource-constrained environment, such as on a small-flavor VM without significant disk space?\n\nThe time taken by mongodb startup in such an environment may also be problematic.\n\nYou can work-around these issues by pre-installing mongo as follows, setting the --smallfiles option to reduce the initial file size to 512Mb, and also increase the startup timeout:\n\n   # pre-install mongodb\n   sudo yum install -y mongodb-server mongodb\n\n   # use smaller initial file size\n   sudo sed -i '/--smallfiles/!s/OPTIONS=\\\"/OPTIONS=\\\"--smallfiles /' /etc/sysconfig/mongod\n\n   # increase the start-up timeout\n   sudo sed -i '/^\\[Service\\]$/ a\\\n     TimeoutStartSec=360' /usr/lib/systemd/system/mongod.service\n\n   # fire up the mongodb service initially to force the journal pre-allocation\n   sudo service mongod start\n   sudo service mongod status\n   sudo service mongod stop\n\nCheers,\nEoghan"
							},
							{
								"isprivate": "0",
								"commentid": "6552446",
								"comment_count": "13",
								"who": {
									"text": "bugzilla",
									"name": "Mohammed Arafa"
								},
								"bug_when": "2013-11-24 16:12:31 +0000",
								"thetext": "so ..the journal wanted 3.x GB of free space is required?\nor else use --smallfiles ?\n\nthe logic of it escapes me.\n\nhowever, i have another question now, how will having mongodb preinstalled (most likely with a password) affect the packstack installation process?"
							},
							{
								"isprivate": "0",
								"commentid": "6553816",
								"comment_count": "14",
								"who": {
									"text": "eglynn",
									"name": "Eoghan Glynn"
								},
								"bug_when": "2013-11-25 09:29:26 +0000",
								"thetext": "\nHi Mohammed,\n\nThe logic of mongodb journal file pre-allocation is an aspect of mongodb that's outside our control, other than via the config options referred to above.\n\nPreinstallation of mongodb will not cause a problem for packstack.\n\nGiven the above information, are you happy for me to close off this issue?\n\n(You would of course be welcome to file another bug if you other related issue crops up for you).\n\nCheers,\nEoghan"
							},
							{
								"isprivate": "0",
								"commentid": "6555919",
								"comment_count": "15",
								"who": {
									"text": "bugzilla",
									"name": "Mohammed Arafa"
								},
								"bug_when": "2013-11-25 18:22:46 +0000",
								"thetext": "thanks eoghan"
							},
							{
								"isprivate": "0",
								"commentid": "6571785",
								"comment_count": "16",
								"who": {
									"text": "sgordon",
									"name": "Stephen Gordon"
								},
								"bug_when": "2013-11-29 18:38:34 +0000",
								"thetext": "I'm re-opening this, I think we should default to --smallfiles to alleviate this somewhat - I'm also cloning to RHOS and the associated documentation components to ensure we note this in the up front requirements."
							},
							{
								"isprivate": "0",
								"commentid": "6676738",
								"comment_count": "17",
								"who": {
									"text": "pbrady",
									"name": "Pádraig Brady"
								},
								"bug_when": "2014-01-06 14:42:00 +0000",
								"thetext": "Hmm we might have a race here too.\nI tried openstack-packstack-2013.2.1-0.27.dev936 on Fedora 20,\nand the first time ceilometer errored out with mongodb not running.\nI've loads of space, and a separate mongodb service start command worked,\nafter which a subsequent packstack run proceeded without issue."
							},
							{
								"isprivate": "0",
								"commentid": "6680347",
								"comment_count": "18",
								"who": {
									"text": "gcerami",
									"name": "Gabriele Cerami"
								},
								"bug_when": "2014-01-07 10:27:16 +0000",
								"thetext": "this may be related to https://bugzilla.redhat.com/show_bug.cgi?id=1040573"
							},
							{
								"isprivate": "0",
								"commentid": "6686112",
								"comment_count": "19",
								"who": {
									"text": "lars",
									"name": "Lars Kellogg-Stedman"
								},
								"bug_when": "2014-01-08 14:59:08 +0000",
								"thetext": "On F20, I'm seeing the same error from Puppet:\n\nERROR : Error appeared during Puppet run: 192.168.20.1_ceilometer.pp\nError: Could not start Service[mongodb]: Execution of '/sbin/service mongod start' returned 1: \nYou will find full trace in log /var/tmp/packstack/20140108-141702-KxiKGp/manifests/192.168.20.1_ceilometer.pp.log\nPlease check log file /var/tmp/packstack/20140108-141702-KxiKGp/openstack-setup.log for more information\n\nAnd in  /var/tmp/packstack/20140108-141702-KxiKGp/manifests/192.168.20.1_ceilometer.pp.log:\n\nError: Could not start Service[mongodb]: Execution of '/sbin/service mongod start' returned 1: \nError: /Stage[main]/Mongodb/Service[mongodb]/ensure: change from stopped to running failed: Could not start Service[mongodb]: Execution of '/sbin/service mongod start' returned 1: \nNotice: /Stage[main]/Mongodb/Service[mongodb]/ensure: ensure changed 'stopped' to 'running'\nNotice: /Stage[main]/Mongodb/Service[mongodb]/enable: enable changed 'false' to 'true'\nNotice: /Stage[main]/Mongodb/Service[mongodb]: Triggered 'refresh' from 1 events\n\nBut after packstack exits, mongod is actually running:\n\n# systemctl status mongod\nmongod.service - High-performance, schema-free document-oriented database\n   Loaded: loaded (/usr/lib/systemd/system/mongod.service; enabled)\n   Active: active (running) since Wed 2014-01-08 14:41:58 UTC; 15min ago\n  Process: 18504 ExecStart=/usr/bin/mongod $OPTIONS run (code=exited, status=0/SUCCESS)\n Main PID: 18506 (mongod)\n   CGroup: /system.slice/mongod.service\n           └─18506 /usr/bin/mongod --quiet -f /etc/mongodb.conf run\n\nSo I'm unclear on what is actually causing the error in Puppet.  The mongod log file does not contain any errors:\n\nWed Jan  8 14:41:58.797 [initandlisten] MongoDB starting : pid=18506 port=27017 dbpath=/var/lib/mongodb 64-bit host=os-api.novalocal\nWed Jan  8 14:41:58.797 [initandlisten] db version v2.4.6\nWed Jan  8 14:41:58.797 [initandlisten] git version: nogitversion\nWed Jan  8 14:41:58.797 [initandlisten] build info: Linux buildvm-12.phx2.fedoraproject.org 3.10.9-200.fc19.x86_64 #1 SMP Wed Aug 21 19:27:58 UTC 2013 x86_64 BOOST_LIB_VERSION=1_54\nWed Jan  8 14:41:58.797 [initandlisten] allocator: tcmalloc\nWed Jan  8 14:41:58.797 [initandlisten] options: { bind_ip: \"127.0.0.1\", command: [ \"run\" ], config: \"/etc/mongodb.conf\", dbpath: \"/var/lib/mongodb\", fork: \"true\", journal: \"true\", logpath: \"/var/log/mongodb/mongodb.log\", nohttpinterface: \"true\", pidfilepath: \"/var/run/mongodb/mongodb.pid\", port: 27017, quiet: true }\nWed Jan  8 14:41:58.800 [initandlisten] journal dir=/var/lib/mongodb/journal\nWed Jan  8 14:41:58.800 [initandlisten] recover : no journal files present, no recovery needed\nWed Jan  8 14:41:58.809 [initandlisten] waiting for connections on port 27017"
							},
							{
								"isprivate": "0",
								"commentid": "6728772",
								"comment_count": "20",
								"who": {
									"text": "rjones",
									"name": "Richard W.M. Jones"
								},
								"bug_when": "2014-01-20 19:20:19 +0000",
								"thetext": "I had this error too.  Simply starting mongodb manually, then\nrerunning packstack --answer-file ... fixed it, so it didn't\nseem to have anything to do with disk space (and besides this\nis a physical server with gigabytes of free space)."
							},
							{
								"isprivate": "0",
								"commentid": "6730999",
								"comment_count": "21",
								"who": {
									"text": "fvollero",
									"name": "Francesco Vollero"
								},
								"bug_when": "2014-01-21 09:28:36 +0000",
								"thetext": "There could be other causes that might let packstack fail the installation on the first round:\n\n1) Slow internet connection\n2) Package installation took more than 300 seconds to install (can be tuned with the parameter -t)\n3) Some repository that was temporarily unavailable\n\nIf one of those conditions is met, the result is that you need to re execute packstack with the answer file."
							},
							{
								"isprivate": "0",
								"commentid": "6731060",
								"comment_count": "22",
								"who": {
									"text": "aortega",
									"name": "Alvaro Lopez Ortega"
								},
								"bug_when": "2014-01-21 09:44:38 +0000",
								"thetext": "I'd assume that in any case we should let the user know what happened. Just failing without an error isn't good enough. Eg:\n\n- ERROR: Timeout while download foobar.tgz\n- ERROR: Timeout installing packages x, y and z"
							},
							{
								"isprivate": "0",
								"commentid": "6739605",
								"comment_count": "23",
								"who": {
									"text": "mmagr",
									"name": "Martin Magr"
								},
								"bug_when": "2014-01-22 13:25:33 +0000",
								"thetext": "So, using smallfiles definitely helps with the original problem stated by Mohammed (eg. mongodb is not starting at all with not enough disk space ... I reproduced it and the patch fixed it for me), which means patch posted by Francesco fixes original issue.\n\nBut still mongod did not start at first run when I then used patched packstack on clean VM. I had following in mongod.log:\n\nWed Jan 22 07:25:54.222 [initandlisten] MongoDB starting : pid=21919 port=27017 dbpath=/var/lib/mongodb 64-bit host=localhost.localdomain\nWed Jan 22 07:25:54.222 [initandlisten] db version v2.4.6\nWed Jan 22 07:25:54.222 [initandlisten] git version: nogitversion\nWed Jan 22 07:25:54.222 [initandlisten] build info: Linux buildvm-12.phx2.fedoraproject.org 3.10.9-200.fc19.x86_64 #1 SMP Wed Aug 21 19:27:58 UTC 2013 x86_64 BOOST_LIB_VERSION=1_54\nWed Jan 22 07:25:54.222 [initandlisten] allocator: tcmalloc\nWed Jan 22 07:25:54.222 [initandlisten] options: { bind_ip: \"127.0.0.1\", command: [ \"run\" ], config: \"/etc/mongodb.conf\", dbpath: \"/var/lib/mongodb\", fork: \"true\", journal: \"true\", logappend: \"true\", logpath: \"/var/log/mongodb/mongodb.log\", noauth: \"true\", pidfilepath: \"/var/run/mongodb/mongodb.pid\", port: 27017, quiet: true, smallfiles: \"true\" }\nWed Jan 22 07:25:54.222 [initandlisten]\nWed Jan 22 07:25:54.223 [initandlisten] ** WARNING: Readahead for /var/lib/mongodb is set to 4096KB\nWed Jan 22 07:25:54.223 [initandlisten] **          We suggest setting it to 256KB (512 sectors) or less\nWed Jan 22 07:25:54.223 [initandlisten] **          http://dochub.mongodb.org/core/readahead\nWed Jan 22 07:25:55.511 [initandlisten] journal dir=/var/lib/mongodb/journal\nWed Jan 22 07:25:55.512 [initandlisten] recover : no journal files present, no recovery needed\nWed Jan 22 07:26:14.765 [initandlisten] preallocateIsFaster=true 300.7\nWed Jan 22 07:26:57.498 [initandlisten] preallocateIsFaster=true 443.82\nWed Jan 22 07:27:21.406 [initandlisten] preallocateIsFaster=true 278.24\nWed Jan 22 07:27:21.407 [initandlisten] preallocateIsFaster check took 85.894 secs\nWed Jan 22 07:27:21.412 [initandlisten] preallocating a journal file /var/lib/mongodb/journal/prealloc.0\nWed Jan 22 07:27:30.690 [initandlisten]                 File Preallocator Progress: 104857600/134217728 78%\nWed Jan 22 07:27:30.698 [signalProcessingThread] got signal 15 (Terminated), will terminate after current cmd ends\nWed Jan 22 07:27:30.920 [signalProcessingThread] now exiting\nWed Jan 22 07:27:36.331 dbexit:\nWed Jan 22 07:27:36.331 [signalProcessingThread] shutdown: going to close listening sockets...\nWed Jan 22 07:27:36.331 [signalProcessingThread] shutdown: going to flush diaglog...\nWed Jan 22 07:27:36.331 [signalProcessingThread] shutdown: going to close sockets...\nWed Jan 22 07:27:36.332 [signalProcessingThread] shutdown: waiting for fs preallocator...\nWed Jan 22 07:27:36.332 [signalProcessingThread] shutdown: lock for final commit...\nWed Jan 22 07:27:36.332 [signalProcessingThread] shutdown: final commit...\nWed Jan 22 07:27:36.332 [signalProcessingThread] shutdown: closing all files...\nWed Jan 22 07:27:36.334 [signalProcessingThread] closeAllFiles() finished\nWed Jan 22 07:27:36.335 [signalProcessingThread] journalCleanup...\nWed Jan 22 07:27:36.335 [signalProcessingThread] removeJournalFiles\nWed Jan 22 07:27:37.003 [initandlisten] preallocating a journal file /var/lib/mongodb/journal/prealloc.1\nWed Jan 22 07:27:38.649 [signalProcessingThread] shutdown: removing fs lock...\nWed Jan 22 07:27:42.672 [initandlisten]                 File Preallocator Progress: 52428800/134217728  39%\nWed Jan 22 07:27:43.026 dbexit: really exiting now\n\nEoghan, any hints what's wrong now? I have no idea what could happen that mongod was terminated by the signal 15"
							},
							{
								"isprivate": "0",
								"commentid": "6739722",
								"comment_count": "24",
								"who": {
									"text": "gcerami",
									"name": "Gabriele Cerami"
								},
								"bug_when": "2014-01-22 13:52:10 +0000",
								"thetext": "\n> Wed Jan 22 07:27:21.407 [initandlisten] preallocateIsFaster check took\n> 85.894 secs\n\nDefault timeout on systemd for a service to start is 90 seconds. After that the service is killed with a SIGTERM.\nThis is exactly what happens to me in bz#1040573"
							},
							{
								"isprivate": "0",
								"commentid": "6739749",
								"comment_count": "25",
								"who": {
									"text": "mmagr",
									"name": "Martin Magr"
								},
								"bug_when": "2014-01-22 14:01:45 +0000",
								"thetext": "Thanks Gabriele!"
							},
							{
								"isprivate": "0",
								"commentid": "6740084",
								"comment_count": "26",
								"who": {
									"text": "rjones",
									"name": "Richard W.M. Jones"
								},
								"bug_when": "2014-01-22 15:03:58 +0000",
								"thetext": "(In reply to Gabriele Cerami from comment #24)\n> > Wed Jan 22 07:27:21.407 [initandlisten] preallocateIsFaster check took\n> > 85.894 secs\n> \n> Default timeout on systemd for a service to start is 90 seconds. After that\n> the service is killed with a SIGTERM.\n> This is exactly what happens to me in bz#1040573\n\nFYI I encountered this problem when installing Open Stack on\nan Intel Xeon (baremetal) with 8GB of RAM and local hard disks,\nso I doubt it's anything to do with speed or virtualization\n(although 90s does seem a bit short)."
							},
							{
								"isprivate": "0",
								"commentid": "7710974",
								"comment_count": "27",
								"who": {
									"text": "berendt",
									"name": "Christian Berendt"
								},
								"bug_when": "2014-11-26 15:58:00 +0000",
								"thetext": "The issue still exists on RHEL7. Can we patch the mongod.service file when running packstack? It is annoying that it is not possible to successfully run packstack on a virtual testing environment at the moment.\n\n--- /usr/lib/systemd/system/mongod.service.orig 2014-11-26 15:55:27.334642931 +0000\n+++ /usr/lib/systemd/system/mongod.service      2014-11-26 15:55:36.959615632 +0000\n@@ -10,6 +10,7 @@\n ExecStart=/usr/bin/mongod $OPTIONS run\n PrivateTmp=true\n LimitNOFILE=64000\n+TimeoutStartSec=240\n \n [Install]\n WantedBy=multi-user.target"
							},
							{
								"isprivate": "0",
								"commentid": "7711112",
								"comment_count": "28",
								"who": {
									"text": "berendt",
									"name": "Christian Berendt"
								},
								"bug_when": "2014-11-26 16:36:17 +0000",
								"thetext": "The timeout is not the issue. It looks like the PID file differs. The module puppetlabs-mongodb uses /var/run/mongodb/mongodb.pid by default, but at least RHEL uses /var/run/mongodb/mongod.pid in the unit file of systemd. Fedora uses /var/run/mongodb/mongodb.pid."
							},
							{
								"isprivate": "0",
								"commentid": "7711502",
								"comment_count": "29",
								"who": {
									"text": "berendt",
									"name": "Christian Berendt"
								},
								"bug_when": "2014-11-26 18:30:11 +0000",
								"thetext": "https://review.openstack.org/137440 fixes this issue for me."
							},
							{
								"isprivate": "0",
								"commentid": "9184059",
								"comment_count": "31",
								"who": {
									"text": "mmccune",
									"name": "Mike McCune"
								},
								"bug_when": "2016-03-28 22:37:22 +0000",
								"thetext": "This bug was accidentally moved from POST to MODIFIED via an error in automation, please see mmccune@redhat.com with any questions"
							},
							{
								"isprivate": "0",
								"commentid": "10515253",
								"comment_count": "33",
								"who": {
									"text": "chris.brown",
									"name": "Christopher Brown"
								},
								"bug_when": "2017-06-17 19:07:25 +0000",
								"thetext": "So looks like this was fixed back in 2014. Can someone please close this?"
							},
							{
								"isprivate": "0",
								"commentid": "10515370",
								"comment_count": "34",
								"who": {
									"text": "rjones",
									"name": "Richard W.M. Jones"
								},
								"bug_when": "2017-06-17 20:47:18 +0000",
								"thetext": "Anyone can close bugs."
							},
							{
								"isprivate": "0",
								"commentid": "10515388",
								"comment_count": "35",
								"who": {
									"text": "chris.brown",
									"name": "Christopher Brown"
								},
								"bug_when": "2017-06-17 20:49:20 +0000",
								"thetext": "Hi Richard,\n\n(In reply to Richard W.M. Jones from comment #34)\n> Anyone can close bugs.\n\nNope, otherwise I wouldn't have bothered you. Perhaps anyone @redhat.com can?"
							},
							{
								"isprivate": "0",
								"commentid": "10515390",
								"comment_count": "36",
								"who": {
									"text": "rjones",
									"name": "Richard W.M. Jones"
								},
								"bug_when": "2017-06-17 20:51:59 +0000",
								"thetext": "Possibly.  You cannot change the \"Status:\" field?"
							},
							{
								"isprivate": "0",
								"commentid": "10515392",
								"comment_count": "37",
								"who": {
									"text": "chris.brown",
									"name": "Christopher Brown"
								},
								"bug_when": "2017-06-17 20:54:57 +0000",
								"thetext": "(In reply to Richard W.M. Jones from comment #36)\n> Possibly.  You cannot change the \"Status:\" field?\n\nYou got it. I'm just reviewing old RDO bugs, trying to clear out the cruft and seeing if there are any I can help out with.\n\nI used to possibly have greater permissions when I helped out with the Fedora project as a packager but now I can do very little except NEEDINFO.\n\nIf you, or someone you know, can change something to allow me to manipulate RDO category bugs, then great."
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "6606739",
						"comment_count": "0",
						"who": {
							"text": "gcerami",
							"name": "Gabriele Cerami"
						},
						"bug_when": "2013-12-11 16:07:30 +0000",
						"thetext": "Created attachment 835342\nmongod logs\n\nDescription of problem:\n\nmongod on the very first run preallocates three journal files of size 1G+\n\nIn a busy virtualized environment it could take more than the default 90 seconds systemd allows as a timeout for service to start.\nFortunately subsequent runs continue the preallocation where the previous ones left, but it could take more than one \"start\" command to really start mongodb server.\n\nVersion-Release number of selected component (if applicable):\nName        : mongodb-server\nArch        : x86_64\nVersion     : 2.4.6\nRelease     : 1.fc19\n\nHow reproducible: \n\nbug was hit when testing in a busy low-performance virtualized environment running 6 guests\nThis problem should show on every system with slow disk/slow access to disk\n\n\nSteps to Reproduce:\n1. clean fedora install\n2. yum install mongodb-server\n\nActual results:\n\nJob for mongod.service failed. See 'systemctl status mongod.service' and 'journalctl -xn' for details.\n\n\nExpected results:\n\n(mongodb starts)\n\n\nAdditional info:\n\nattached logs show that preallocation takes more than 90 seconds, after which deamon is killed\n\nI don't know if is an acceptable solution for mongod to detach and signal that has started and *then* start preallocation, but a workaround could be to increase systemd start timeout by adding \n\nTimeoutStartSec=240\n\nin mongod.service file"
					},
					{
						"isprivate": "0",
						"commentid": "7710945",
						"comment_count": "1",
						"who": {
							"text": "berendt",
							"name": "Christian Berendt"
						},
						"bug_when": "2014-11-26 15:53:35 +0000",
						"thetext": "Looks like this issue still exists on RHEL7. Is it possible to increase the default service timeout in the packages?"
					},
					{
						"isprivate": "0",
						"commentid": "7829232",
						"comment_count": "2",
						"who": {
							"text": "bcotton",
							"name": "Fedora End Of Life"
						},
						"bug_when": "2015-01-09 20:50:14 +0000",
						"thetext": "This message is a notice that Fedora 19 is now at end of life. Fedora \nhas stopped maintaining and issuing updates for Fedora 19. It is \nFedora's policy to close all bug reports from releases that are no \nlonger maintained. Approximately 4 (four) weeks from now this bug will\nbe closed as EOL if it remains open with a Fedora 'version' of '19'.\n\nPackage Maintainer: If you wish for this bug to remain open because you\nplan to fix it in a currently maintained version, simply change the 'version' \nto a later Fedora version.\n\nThank you for reporting this issue and we are sorry that we were not \nable to fix it before Fedora 19 is end of life. If you would still like \nto see this bug fixed and are able to reproduce it against a later version \nof Fedora, you are encouraged  change the 'version' to a later Fedora \nversion prior this bug is closed as described in the policy above.\n\nAlthough we aim to fix as many bugs as possible during every release's \nlifetime, sometimes those efforts are overtaken by events. Often a \nmore recent Fedora release includes newer upstream software that fixes \nbugs or makes them obsolete."
					},
					{
						"isprivate": "0",
						"commentid": "7835739",
						"comment_count": "3",
						"who": {
							"text": "mskalick",
							"name": "Marek Skalický"
						},
						"bug_when": "2015-01-12 15:57:50 +0000",
						"thetext": "It is now fixed in rawhide. In epel7 I will fix it soon..."
					},
					{
						"isprivate": "0",
						"commentid": "7941542",
						"comment_count": "4",
						"who": {
							"text": "mskalick",
							"name": "Marek Skalický"
						},
						"bug_when": "2015-02-16 14:03:53 +0000",
						"thetext": "*** Bug 1191965 has been marked as a duplicate of this bug. ***"
					},
					{
						"isprivate": "0",
						"commentid": "8085656",
						"comment_count": "5",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2015-03-26 09:18:29 +0000",
						"thetext": "mongodb-2.6.9-1.el7 has been submitted as an update for Fedora EPEL 7.\nhttps://admin.fedoraproject.org/updates/mongodb-2.6.9-1.el7"
					},
					{
						"isprivate": "0",
						"commentid": "8093546",
						"comment_count": "6",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2015-03-28 18:39:07 +0000",
						"thetext": "Package mongodb-2.6.9-1.el7:\n* should fix your issue,\n* was pushed to the Fedora EPEL 7 testing repository,\n* should be available at your local mirror within two days.\nUpdate it with:\n# su -c 'yum update --enablerepo=epel-testing mongodb-2.6.9-1.el7'\nas soon as you are able to.\nPlease go to the following url:\nhttps://admin.fedoraproject.org/updates/FEDORA-EPEL-2015-1458/mongodb-2.6.9-1.el7\nthen log in and leave karma (feedback)."
					}
				]
			}
		},
		{
			"bug_id": 1200446,
			"parent": true,
			"security": true,
			"title": "Invalid bug number",
			"bugzilla": {
				"bug_id": "1200446",
				"alias": "CVE-2015-1609",
				"creation_ts": "2015-03-10 15:14:42 +0000",
				"short_desc": "CVE-2015-1609 mongodb: DoS due to improper BSON validation",
				"delta_ts": "2021-10-21 00:44:01 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Security",
				"priority": "medium",
				"bug_severity": "medium",
				"depends_on": [
					"1200447",
					"1200448",
					"1200449"
				],
				"blocked": [
					{
						"bug_id": "1200450",
						"error": "NotPermitted"
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "8027670",
						"comment_count": "0",
						"who": {
							"text": "mprpic",
							"name": "Martin Prpič"
						},
						"bug_when": "2015-03-10 15:14:42 +0000",
						"thetext": "It was found that the mongod server did not correctly validate certain malformed BSON requests. A remote, unauthenticated  attacker could use a specially crafted BSON message to crash a mongod server.\n\nUpstream issue:\n\nhttps://jira.mongodb.org/browse/SERVER-17264\n\nUpstream patches:\n\n2.4 -- https://github.com/mongodb/mongo/commit/3a7e85ea1f672f702660e5472566234b1d19038e\n2.6 -- https://github.com/mongodb/mongo/commit/8f1c734c7f1862180f607c241fb167640889efba\n3.0 -- https://github.com/mongodb/mongo/commit/5285225e71c5c0652520ef99d0ae4ca24655f72f"
					},
					{
						"isprivate": "0",
						"commentid": "8027683",
						"comment_count": "1",
						"who": {
							"text": "mprpic",
							"name": "Martin Prpič"
						},
						"bug_when": "2015-03-10 15:15:43 +0000",
						"thetext": "\nCreated mongodb tracking bugs for this issue:\n\nAffects: fedora-all [bug 1200447]\nAffects: epel-6 [bug 1200448]\nAffects: epel-7 [bug 1200449]"
					},
					{
						"isprivate": "0",
						"commentid": "8069276",
						"comment_count": "2",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2015-03-21 05:01:20 +0000",
						"thetext": "mongodb-2.6.8-1.fc22 has been pushed to the Fedora 22 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "8094070",
						"comment_count": "3",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2015-03-29 04:57:06 +0000",
						"thetext": "mongodb-2.4.13-1.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "8132100",
						"comment_count": "5",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2015-04-10 19:15:46 +0000",
						"thetext": "mongodb-2.4.13-1.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report."
					}
				]
			}
		},
		{
			"bug_id": 1200449,
			"security": true,
			"title": "Invalid bug number",
			"bugzilla": {
				"bug_id": "1200449",
				"creation_ts": "2015-03-10 15:15:36 +0000",
				"short_desc": "CVE-2015-1609 mongodb: DoS due to improper BSON validation [epel-7]",
				"delta_ts": "2015-05-19 10:19:47 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Security, SecurityTracking",
				"priority": "medium",
				"bug_severity": "medium",
				"blocked": [
					{
						"bug_id": "1200446",
						"alias": "CVE-2015-1609",
						"creation_ts": "2015-03-10 15:14:42 +0000",
						"short_desc": "CVE-2015-1609 mongodb: DoS due to improper BSON validation",
						"delta_ts": "2021-10-21 00:44:01 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1200447",
							"1200448",
							"1200449"
						],
						"blocked": [
							{
								"bug_id": "1200450",
								"error": "NotPermitted"
							}
						],
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "8027670",
								"comment_count": "0",
								"who": {
									"text": "mprpic",
									"name": "Martin Prpič"
								},
								"bug_when": "2015-03-10 15:14:42 +0000",
								"thetext": "It was found that the mongod server did not correctly validate certain malformed BSON requests. A remote, unauthenticated  attacker could use a specially crafted BSON message to crash a mongod server.\n\nUpstream issue:\n\nhttps://jira.mongodb.org/browse/SERVER-17264\n\nUpstream patches:\n\n2.4 -- https://github.com/mongodb/mongo/commit/3a7e85ea1f672f702660e5472566234b1d19038e\n2.6 -- https://github.com/mongodb/mongo/commit/8f1c734c7f1862180f607c241fb167640889efba\n3.0 -- https://github.com/mongodb/mongo/commit/5285225e71c5c0652520ef99d0ae4ca24655f72f"
							},
							{
								"isprivate": "0",
								"commentid": "8027683",
								"comment_count": "1",
								"who": {
									"text": "mprpic",
									"name": "Martin Prpič"
								},
								"bug_when": "2015-03-10 15:15:43 +0000",
								"thetext": "\nCreated mongodb tracking bugs for this issue:\n\nAffects: fedora-all [bug 1200447]\nAffects: epel-6 [bug 1200448]\nAffects: epel-7 [bug 1200449]"
							},
							{
								"isprivate": "0",
								"commentid": "8069276",
								"comment_count": "2",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2015-03-21 05:01:20 +0000",
								"thetext": "mongodb-2.6.8-1.fc22 has been pushed to the Fedora 22 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "8094070",
								"comment_count": "3",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2015-03-29 04:57:06 +0000",
								"thetext": "mongodb-2.4.13-1.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "8132100",
								"comment_count": "5",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2015-04-10 19:15:46 +0000",
								"thetext": "mongodb-2.4.13-1.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report."
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "8027680",
						"comment_count": "0",
						"who": {
							"text": "mprpic",
							"name": "Martin Prpič"
						},
						"bug_when": "2015-03-10 15:15:36 +0000",
						"thetext": "\nThis is an automatically created tracking bug!  It was created to ensure\nthat one or more security vulnerabilities are fixed in affected versions\nof Fedora EPEL.\n\nFor comments that are specific to the vulnerability please use bugs filed\nagainst the \"Security Response\" product referenced in the \"Blocks\" field.\n\nFor more information see:\nhttp://fedoraproject.org/wiki/Security/TrackingBugs\n\nWhen submitting as an update, use the fedpkg template provided in the next\ncomment(s).  This will include the bug IDs of this tracking bug as well as\nthe relevant top-level CVE bugs.\n\nPlease also mention the CVE IDs being fixed in the RPM changelog and the\nfedpkg commit message.\n\nepel-7 tracking bug for mongodb: see blocks bug list for full details of the security issue(s).\n\nThis bug is never intended to be made public, please put any public notes\nin the blocked bugs.\n\n[bug automatically created by: add-tracking-bugs]"
					},
					{
						"isprivate": "0",
						"commentid": "8027682",
						"comment_count": "1",
						"who": {
							"text": "mprpic",
							"name": "Martin Prpič"
						},
						"bug_when": "2015-03-10 15:15:41 +0000",
						"thetext": "\nUse the following template to for the 'fedpkg update' request to submit an\nupdate for this issue as it contains the top-level parent bug(s) as well as\nthis tracking bug.  This will ensure that all associated bugs get updated\nwhen new packages are pushed to stable.\n\n=====\n\n# bugfix, security, enhancement, newpackage (required)\ntype=security\n\n# testing, stable\nrequest=testing\n\n# Bug numbers: 1234,9876\nbugs=1200446,1200449\n\n# Description of your update\nnotes=Security fix for CVE-2015-1609\n\n# Enable request automation based on the stable/unstable karma thresholds\nautokarma=True\nstable_karma=3\nunstable_karma=-3\n\n# Automatically close bugs when this marked as stable\nclose_bugs=True\n\n# Suggest that users restart after update\nsuggest_reboot=False\n\n======\n\nAdditionally, you may opt to use the bodhi update submission link instead:\n\nhttps://admin.fedoraproject.org/updates/new/?type_=security&bugs=1200446,1200449"
					},
					{
						"isprivate": "0",
						"commentid": "8085655",
						"comment_count": "2",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2015-03-26 09:18:26 +0000",
						"thetext": "mongodb-2.6.9-1.el7 has been submitted as an update for Fedora EPEL 7.\nhttps://admin.fedoraproject.org/updates/mongodb-2.6.9-1.el7"
					},
					{
						"isprivate": "0",
						"commentid": "8093545",
						"comment_count": "3",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2015-03-28 18:39:05 +0000",
						"thetext": "Package mongodb-2.6.9-1.el7:\n* should fix your issue,\n* was pushed to the Fedora EPEL 7 testing repository,\n* should be available at your local mirror within two days.\nUpdate it with:\n# su -c 'yum update --enablerepo=epel-testing mongodb-2.6.9-1.el7'\nas soon as you are able to.\nPlease go to the following url:\nhttps://admin.fedoraproject.org/updates/FEDORA-EPEL-2015-1458/mongodb-2.6.9-1.el7\nthen log in and leave karma (feedback)."
					}
				]
			}
		}
	],
	"builds": [
		{
			"epoch": 0,
			"nvr": "mongodb-2.6.9-1.el7",
			"signed": true,
			"type": "rpm",
			"package": {
				"src": [
					{
						"name": "mongodb",
						"version": "2.6.9",
						"release": "1.el7",
						"arch": "src"
					}
				],
				"x86_64": [
					{
						"name": "mongodb-test",
						"version": "2.6.9",
						"release": "1.el7",
						"arch": "x86_64"
					},
					{
						"name": "mongodb",
						"version": "2.6.9",
						"release": "1.el7",
						"arch": "x86_64"
					},
					{
						"name": "mongodb-server",
						"version": "2.6.9",
						"release": "1.el7",
						"arch": "x86_64"
					},
					{
						"name": "mongodb-debuginfo",
						"version": "2.6.9",
						"release": "1.el7",
						"arch": "x86_64"
					}
				]
			}
		}
	],
	"close_bugs": true,
	"comments": [
		{
			"id": 75215,
			"text": "This update has been submitted for testing by mskalick. ",
			"timestamp": "2015-03-26 09:18:32",
			"update_id": 10484,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 75216,
			"text": "This update is currently being pushed to the Fedora EPEL 7 testing updates repository.",
			"timestamp": "2015-03-27 16:07:35",
			"update_id": 10484,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 75217,
			"text": "This update has been pushed to testing",
			"timestamp": "2015-03-28 18:39:09",
			"update_id": 10484,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 75218,
			"text": "This update has reached 14 days in testing and can be pushed to stable now if the maintainer wishes",
			"timestamp": "2015-04-11 23:14:38",
			"update_id": 10484,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 75219,
			"text": "This update has been submitted for stable by mskalick. ",
			"timestamp": "2015-04-14 15:50:10",
			"update_id": 10484,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 75220,
			"text": "This update is currently being pushed to the Fedora EPEL 7 stable updates repository.",
			"timestamp": "2015-04-14 19:12:10",
			"update_id": 10484,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 75221,
			"text": "This update has been pushed to stable",
			"timestamp": "2015-04-14 22:55:48",
			"update_id": 10484,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		}
	],
	"content_type": "rpm",
	"date_pushed": "2015-04-14 22:55:48",
	"date_stable": "2015-04-14 22:55:48",
	"date_submitted": "2015-03-26 09:18:18",
	"date_testing": "2015-03-28 18:39:09",
	"meets_testing_requirements": true,
	"notes": "Security fix for CVE-2015-1609.\r\nIncrease service timeout.",
	"pushed": true,
	"release": {
		"branch": "epel7",
		"candidate_tag": "epel7-testing-candidate",
		"composed_by_bodhi": true,
		"create_automatic_updates": false,
		"dist_tag": "epel7",
		"id_prefix": "FEDORA-EPEL",
		"long_name": "Fedora EPEL 7",
		"mail_template": "fedora_epel_legacy_errata_template",
		"name": "EPEL-7",
		"override_tag": "epel7-override",
		"package_manager": "unspecified",
		"pending_signing_tag": "epel7-signing-pending",
		"pending_stable_tag": "epel7-pending",
		"pending_testing_tag": "epel7-testing-pending",
		"stable_tag": "epel7",
		"state": "archived",
		"testing_tag": "epel7-testing",
		"version": "7"
	},
	"severity": "unspecified",
	"stable_karma": 3,
	"status": "stable",
	"suggest": "unspecified",
	"title": "mongodb-2.6.9-1.el7",
	"type": "security",
	"url": "https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2015-1458",
	"unstable_karma": -3,
	"updateid": "FEDORA-EPEL-2015-1458",
	"user": {
		"avatar": "https://seccdn.libravatar.org/avatar/00701719f8d14816772f893aefe5e84f2f5a854e5f0d2d40507120d4d29f01eb?s=24&d=retro",
		"email": "mskalicky@seznam.cz",
		"groups": [
			{
				"name": "packager"
			}
		],
		"id": 949,
		"name": "mskalick",
		"openid": "mskalick.id.fedoraproject.org"
	},
	"version_hash": "dc4c466024f444bfbfbd8db9f2a1580ec1eab90f"
}
