{
	"alias": "FEDORA-2014-17601",
	"bugs": [
		{
			"bug_id": 1140037,
			"security": true,
			"title": "CVE-2014-3620 CVE-2014-3613 mingw-curl: various flaws [fedora-all]",
			"bugzilla": {
				"bug_id": "1140037",
				"creation_ts": "2014-09-10 08:34:03 +0000",
				"short_desc": "CVE-2014-3620 CVE-2014-3613 mingw-curl: various flaws [fedora-all]",
				"delta_ts": "2015-01-09 02:58:22 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Security, SecurityTracking",
				"priority": "medium",
				"bug_severity": "medium",
				"blocked": [
					{
						"bug_id": "1136154",
						"alias": "CVE-2014-3613",
						"creation_ts": "2014-09-02 04:15:01 +0000",
						"short_desc": "CVE-2014-3613 curl: incorrect handling of IP addresses in cookie domain",
						"delta_ts": "2023-05-12 04:58:27 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1139453",
							"1139454",
							"1140036",
							"1140037",
							"1140038",
							"1175776",
							"1215062"
						],
						"blocked": [
							{
								"bug_id": "1136155",
								"error": "NotPermitted"
							},
							{
								"bug_id": "1193283",
								"error": "NotPermitted"
							},
							{
								"bug_id": "1210268",
								"error": "NotPermitted"
							}
						],
						"external_bugs": {
							"text": "RHSA-2015:2159",
							"name": "Red Hat Product Errata"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "7437322",
								"comment_count": "0",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-09-02 04:15:01 +0000",
								"thetext": "Daniel Stenberg reported the following vulnerability in cURL that could cause libcurl-based HTTP clients to leak cookie information:\n\nIP address as domain problem\n\n   By not detecting and rejecting domain names for partial literal IP addresses\n   properly when parsing received HTTP cookies, libcurl can be fooled to both\n   sending cookies to wrong sites and into allowing arbitrary sites to set\n   cookies for others.\n\n   For this problem to trigger, the client application must use the numerical\n   IP address in the URL to access the site and the site must send back cookies\n   to the site using domain= and a partial IP address.\n\n   Since libcurl wrongly approaches the IP address like it was a normal domain\n   name, a site at IP address 192.168.0.1 can set cookies for anything ending\n   with .168.0.1 thus fooling libcurl to send them also to for example\n   127.168.0.1.\n\n   The flaw requires dots to be present in the IP address, which restricts the\n   flaw to IPv4 literal addresses or IPv6 addresses using the somewhat unusual\n   \"dotted-quad\" style: \"::ffff:192.0.2.128\"\n\n   This is not believed to be done by typical sites as this is not supported by\n   clients that adhere to the rules of the RFC 6265, and many sites are written\n   to explictly use their own specific named domain when sending cookies.\n\nVersions 7.1 up to and including 7.37.1 are affected.\n\nInformation about how to enable cookies is available from http://curl.haxx.se/docs/http-cookies.html\n\nAcknowledgements:\n\nRed Hat would like to thank the cURL project for reporting this issue. Upstream acknowledges Tim Ruehsen as the original reporter."
							},
							{
								"isprivate": "0",
								"commentid": "7437324",
								"comment_count": "2",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-09-02 04:16:28 +0000",
								"thetext": "Created attachment 933581\npatch from upstream"
							},
							{
								"isprivate": "0",
								"commentid": "7459027",
								"comment_count": "7",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-09-08 18:21:41 +0000",
								"thetext": "This issue can affect applications using curl if they enabled cookie support and are used to access HTTP/HTTPS servers using IP address rather than host name.  To take advantage of the problem, attacker needs to trick victim into connecting to their malicious server using its IP address.  The IP of the malicious server must have the last two or three octets of it match relevant octets of a non-malicious server IP victim normally connects to (i.e. using example from comment 0, if victim normally connects to 192.168.0.1, attack's malicious server must use an IP ending with 168.0.1 or 0.1).  In such case, attacker's server can send cookies with crafted 'domain' attribute that will be sent to the target server.\n\nThis can provide an attacker with a way to exploit other cookie handling bugs on the target server (e.g. session fixation issues, or other issues related to improper sanitization of cookie values).\n\nIt does not seem this issue can lead to leak of cookies in any reasonable use case.  A non-malicious server would have to incorrectly set 'domain' attributes on cookies it returns to risk their expose to other servers."
							},
							{
								"isprivate": "0",
								"commentid": "7459032",
								"comment_count": "8",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-09-08 18:23:22 +0000",
								"thetext": "Statement:\n\nThis issue affects the versions of curl as shipped with Red Hat Enterprise Linux 5 and is not planned to be corrected in future updates.\n\nInktank Ceph Enterprise 1.1 and 1.2 receives only qualified Important and Critical impact security fixes. This issue has been rated as having Moderate security impact and is not currently planned to be addressed in future updates. For additional information, refer to the Inktank Ceph Enterprise Support Matrix:\nhttp://www.inktank.com/enterprise/support/"
							},
							{
								"isprivate": "0",
								"commentid": "7465376",
								"comment_count": "17",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-09-10 08:28:44 +0000",
								"thetext": "This issue is public now.\n\nExternal References:\n\nhttp://curl.haxx.se/docs/adv_20140910A.html"
							},
							{
								"isprivate": "0",
								"commentid": "7465406",
								"comment_count": "18",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-09-10 08:34:37 +0000",
								"thetext": "\nCreated curl tracking bugs for this issue:\n\nAffects: fedora-all [bug 1140036]"
							},
							{
								"isprivate": "0",
								"commentid": "7465408",
								"comment_count": "19",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-09-10 08:34:41 +0000",
								"thetext": "\nCreated mingw-curl tracking bugs for this issue:\n\nAffects: fedora-all [bug 1140037]\nAffects: epel-7 [bug 1140038]"
							},
							{
								"isprivate": "0",
								"commentid": "7477876",
								"comment_count": "20",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-09-14 03:27:26 +0000",
								"thetext": "curl-7.32.0-13.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7508701",
								"comment_count": "21",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-09-23 04:26:20 +0000",
								"thetext": "curl-7.37.0-7.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7555974",
								"comment_count": "22",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-10-08 19:03:42 +0000",
								"thetext": "curl-7.29.0-23.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "8465508",
								"comment_count": "30",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2015-07-22 05:43:35 +0000",
								"thetext": "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 6\n\nVia RHSA-2015:1254 https://rhn.redhat.com/errata/RHSA-2015-1254.html"
							},
							{
								"isprivate": "0",
								"commentid": "8836576",
								"comment_count": "32",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2015-11-19 07:06:38 +0000",
								"thetext": "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7\n\nVia RHSA-2015:2159 https://rhn.redhat.com/errata/RHSA-2015-2159.html"
							}
						]
					},
					{
						"bug_id": "1138846",
						"alias": "CVE-2014-3620",
						"creation_ts": "2014-09-05 18:57:53 +0000",
						"short_desc": "CVE-2014-3620 curl: cookies accepted for TLDs",
						"delta_ts": "2023-05-12 04:56:22 +0000",
						"bug_status": "CLOSED",
						"resolution": "NOTABUG",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1140037",
							"1140038",
							"1140039"
						],
						"blocked": [
							{
								"bug_id": "1136155",
								"error": "NotPermitted"
							}
						],
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "7453882",
								"comment_count": "0",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2014-09-05 18:57:53 +0000",
								"thetext": "Daniel Stenberg reported the following vulnerability in cURL that could cause libcurl-based HTTP clients to leak cookie information:\n\nCookies set for Top Level Domains (TLD)\n\n   libcurl wrongly allows cookies to be set for TLDs, thus making them much\n   broader then they are supposed to be allowed to. This can allow arbitrary\n   sites to set cookies that then would get sent to a different and unrelated\n   site or domain.\n\n   INFO\n\n   Cookie parsing and use is opt-in by applications and is not enabled by\n   default.\n\n   libcurl's cookie parser has no Public Suffix awareness, so apart from\n   rejecting TLDs from being allowed it might still allow cookies for domains\n   that are otherwise widely rejected by ordinary browsers. See\n   https://publicsuffix.org/ for details.\n\nVersions 7.31.0 and later are affected.  Earlier versions are not affected.\n\nInformation about how to enable cookies is available from http://curl.haxx.se/docs/http-cookies.html\n\nAcknowledgements:\n\nRed Hat would like to thank the cURL project for reporting these issues. Upstream acknowledges Tim Ruehsen as the original reporter.\n\n\nStatement:\n\nThis issue did not affect the versions of curl as shipped with Red Hat Enterprise Linux 5, 6, or 7."
							},
							{
								"isprivate": "0",
								"commentid": "7457905",
								"comment_count": "1",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-09-08 13:43:14 +0000",
								"thetext": "(In reply to Vincent Danen from comment #0)\n> Versions 7.31.0 and later are affected.  Earlier versions are not affected.\n\nTo be more specific, upstream identified the following commit as the one that introduced this issue and caused curl to accept cookies for TLDs:\n\nhttps://github.com/bagder/curl/commit/85b9dc8023\n\nThis fix was also backported to curl version 7.29.0 as used in Fedora 19.  Hence all current Fedora releases are affected by this problem.\n\nRed Hat Enterprise Linux 5, 6 and 7 are not affected, as noted above."
							},
							{
								"isprivate": "0",
								"commentid": "7465377",
								"comment_count": "4",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-09-10 08:29:04 +0000",
								"thetext": "This issue is public now.\n\nExternal References:\n\nhttp://curl.haxx.se/docs/adv_20140910B.html"
							},
							{
								"isprivate": "0",
								"commentid": "7465416",
								"comment_count": "5",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-09-10 08:35:42 +0000",
								"thetext": "\nCreated curl tracking bugs for this issue:\n\nAffects: fedora-all [bug 1140039]"
							},
							{
								"isprivate": "0",
								"commentid": "7465417",
								"comment_count": "6",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-09-10 08:35:45 +0000",
								"thetext": "\nCreated mingw-curl tracking bugs for this issue:\n\nAffects: fedora-all [bug 1140037]\nAffects: epel-7 [bug 1140038]"
							},
							{
								"isprivate": "0",
								"commentid": "7477875",
								"comment_count": "7",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-09-14 03:27:25 +0000",
								"thetext": "curl-7.32.0-13.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7508700",
								"comment_count": "8",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-09-23 04:26:08 +0000",
								"thetext": "curl-7.37.0-7.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7555973",
								"comment_count": "9",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-10-08 19:03:39 +0000",
								"thetext": "curl-7.29.0-23.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report."
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "7465400",
						"comment_count": "0",
						"who": {
							"text": "mmcallis",
							"name": "Murray McAllister"
						},
						"bug_when": "2014-09-10 08:34:03 +0000",
						"thetext": "\nThis is an automatically created tracking bug!  It was created to ensure\nthat one or more security vulnerabilities are fixed in affected versions\nof Fedora.\n\nFor comments that are specific to the vulnerability please use bugs filed\nagainst the \"Security Response\" product referenced in the \"Blocks\" field.\n\nFor more information see:\nhttp://fedoraproject.org/wiki/Security/TrackingBugs\n\nWhen submitting as an update, use the fedpkg template provided in the next\ncomment(s).  This will include the bug IDs of this tracking bug as well as\nthe relevant top-level CVE bugs.\n\nPlease also mention the CVE IDs being fixed in the RPM changelog and the\nfedpkg commit message.\n\nNOTE: this issue affects multiple supported versions of Fedora. While only\none tracking bug has been filed, please correct all affected versions at\nthe same time.  If you need to fix the versions independent of each other,\nyou may clone this bug as appropriate.\n\n[bug automatically created by: add-tracking-bugs]"
					},
					{
						"isprivate": "0",
						"commentid": "7465402",
						"comment_count": "1",
						"who": {
							"text": "mmcallis",
							"name": "Murray McAllister"
						},
						"bug_when": "2014-09-10 08:34:14 +0000",
						"thetext": "\nUse the following template to for the 'fedpkg update' request to submit an\nupdate for this issue as it contains the top-level parent bug(s) as well as\nthis tracking bug.  This will ensure that all associated bugs get updated\nwhen new packages are pushed to stable.\n\n=====\n\n# bugfix, security, enhancement, newpackage (required)\ntype=security\n\n# testing, stable\nrequest=testing\n\n# Bug numbers: 1234,9876\nbugs=1136154,1140037\n\n# Description of your update\nnotes=Security fix for CVE-2014-3613\n\n# Enable request automation based on the stable/unstable karma thresholds\nautokarma=True\nstable_karma=3\nunstable_karma=-3\n\n# Automatically close bugs when this marked as stable\nclose_bugs=True\n\n# Suggest that users restart after update\nsuggest_reboot=False\n\n======\n\nAdditionally, you may opt to use the bodhi update submission link instead:\n\nhttps://admin.fedoraproject.org/updates/new/?type_=security&bugs=1136154,1140037"
					},
					{
						"isprivate": "0",
						"commentid": "7465414",
						"comment_count": "2",
						"who": {
							"text": "mmcallis",
							"name": "Murray McAllister"
						},
						"bug_when": "2014-09-10 08:35:22 +0000",
						"thetext": "\nAdding parent bug 1138846 (for CVE-2014-3620).  Please use this new fedpkg update template when submitting the update:\n\n=====\n\n# bugfix, security, enhancement, newpackage (required)\ntype=security\n\n# testing, stable\nrequest=testing\n\n# Bug numbers: 1234,9876\nbugs=1140037,1136154,1138846\n\n# Description of your update\nnotes=Security fix for CVE-2014-3613, CVE-2014-3620\n\n# Enable request automation based on the stable/unstable karma thresholds\nautokarma=True\nstable_karma=3\nunstable_karma=-3\n\n# Automatically close bugs when this marked as stable\nclose_bugs=True\n\n# Suggest that users restart after update\nsuggest_reboot=False\n\n======\n\nAdditionally, you may opt to use the bodhi update submission link instead:\n\nhttps://admin.fedoraproject.org/updates/new/?type_=security&bugs=1140037,1136154,1138846"
					},
					{
						"isprivate": "0",
						"commentid": "7787656",
						"comment_count": "3",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-23 13:56:05 +0000",
						"thetext": "mingw-curl-7.39.0-1.fc21 has been submitted as an update for Fedora 21.\nhttps://admin.fedoraproject.org/updates/mingw-curl-7.39.0-1.fc21"
					},
					{
						"isprivate": "0",
						"commentid": "7787658",
						"comment_count": "4",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-23 13:56:27 +0000",
						"thetext": "mingw-curl-7.39.0-1.fc20 has been submitted as an update for Fedora 20.\nhttps://admin.fedoraproject.org/updates/mingw-curl-7.39.0-1.fc20"
					},
					{
						"isprivate": "0",
						"commentid": "7787662",
						"comment_count": "5",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-23 13:56:55 +0000",
						"thetext": "mingw-curl-7.39.0-1.el7 has been submitted as an update for Fedora EPEL 7.\nhttps://admin.fedoraproject.org/updates/mingw-curl-7.39.0-1.el7"
					},
					{
						"isprivate": "0",
						"commentid": "7790023",
						"comment_count": "6",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-24 17:40:01 +0000",
						"thetext": "Package mingw-curl-7.39.0-1.el7:\n* should fix your issue,\n* was pushed to the Fedora EPEL 7 testing repository,\n* should be available at your local mirror within two days.\nUpdate it with:\n# su -c 'yum update --enablerepo=epel-testing mingw-curl-7.39.0-1.el7'\nas soon as you are able to.\nPlease go to the following url:\nhttps://admin.fedoraproject.org/updates/FEDORA-EPEL-2014-4906/mingw-curl-7.39.0-1.el7\nthen log in and leave karma (feedback)."
					},
					{
						"isprivate": "0",
						"commentid": "7797621",
						"comment_count": "7",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2015-01-02 05:06:27 +0000",
						"thetext": "mingw-curl-7.39.0-1.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7797626",
						"comment_count": "8",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2015-01-02 05:06:51 +0000",
						"thetext": "mingw-curl-7.39.0-1.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7821052",
						"comment_count": "9",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2015-01-09 02:58:22 +0000",
						"thetext": "mingw-curl-7.39.0-1.el7 has been pushed to the Fedora EPEL 7 stable repository.  If problems still persist, please make note of it in this bug report."
					}
				]
			}
		},
		{
			"bug_id": 1160724,
			"security": true,
			"title": "CVE-2014-3707 mingw-curl: curl: incorrect handle duplication after COPYPOSTFIELDS [fedora-all]",
			"bugzilla": {
				"bug_id": "1160724",
				"creation_ts": "2014-11-05 13:49:50 +0000",
				"short_desc": "CVE-2014-3707 mingw-curl: curl: incorrect handle duplication after COPYPOSTFIELDS [fedora-all]",
				"delta_ts": "2015-01-09 02:58:21 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Security, SecurityTracking",
				"priority": "medium",
				"bug_severity": "medium",
				"blocked": [
					{
						"bug_id": "1154941",
						"alias": "CVE-2014-3707",
						"creation_ts": "2014-10-21 05:12:02 +0000",
						"short_desc": "CVE-2014-3707 curl: incorrect handle duplication after COPYPOSTFIELDS",
						"delta_ts": "2023-05-12 05:44:25 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1160724",
							"1160725",
							"1175776",
							"1215062"
						],
						"blocked": [
							{
								"bug_id": "1154942",
								"error": "NotPermitted"
							},
							{
								"bug_id": "1193283",
								"error": "NotPermitted"
							},
							{
								"bug_id": "1210268",
								"error": "NotPermitted"
							}
						],
						"external_bugs": {
							"text": "RHSA-2015:2159",
							"name": "Red Hat Product Errata"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "7593917",
								"comment_count": "0",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-10-21 05:12:02 +0000",
								"thetext": "Daniel Stenberg reported the following vulnerability in cURL:\n\n\"\"\nlibcurl's function curl_easy_duphandle() has a bug that can lead to libcurl\neventually sending off sensitive data that was not intended for sending.\n\nWhen doing an HTTP POST transfer with libcurl, you can use the\n`CURLOPT_COPYPOSTFIELDS` option to specify a memory area holding the data to\nsend to the remote server. The memory area's size is set with a separate\noption, for example `CURLOPT_POSTFIELDSIZE`.\n\nAs the name implies, the data in the specified buffer is copied to a privately\nheld memory buffer that libcurl allocates on the heap. The memory area is\nassociated with the common CURL handle, often referred to as an \"easy handle\".\n\nThis handle can be duplicated by an application to create an identical copy,\nand all the already set options and data is then also similarly cloned and\nwill be associated with the newly returned handle. This also includes the data\nto send in an HTTP POST request.\n\nThe internal libcurl function that duplicates options from the old handle to\nthe new had two problems:\n\n1. It mistakenly treated the post data buffer as if it was a C string. A C\n   string ends with a zero byte, and subsequently strdup() was used to\n   duplicate the post data buffer. A post data buffer can perfectly\n   legitimately contain a zero byte, or it may not contain any zero byte at\n   all (including no trailing one) - leading to strdup() either making a too\n   small duplicate, a too large one or crash due to reading an inaccessible\n   memory area. The strdup() of course allocates memory off the heap.\n\n2. After duplication of the handle data, the pointer used to read from when\n   sending the data was not updated. So when sending off the post, libcurl\n   would still read from the original handle's buffer which at that time could\n   have been freed or reused for other purposes.\n\nWhen libcurl subsequently constructs the HTTP POST request and includes data\nfor the protocol body it will memcpy() data from that pointer using the old\nsize and the old pointer. This makes a read from the wrong place and can lead\nto libcurl inserting data into the request that happens to be stored at that\nplaces in memory at that time.\n\nWe are not aware of anyone having been able to actually exploit this for\nnefarious purposes, but we can't exclude that it is possible or even might\nalready have been exploited.\n\nINFO\n----\n\nThis bug requires `CURLOPT_COPYPOSTFIELDS` and `curl_easy_duphandle()` to be\nused in that order, and then the duplicate handle must be used to perform the\nHTTP POST.\n\nThe curl tool is not affected, it does not use this sequence.\n\"\"\"\n\nThis issue affects versions 7.17.1 up to and including 7.38.0. It has been fixed in version 7.39.0\n\nAcknowledgements:\n\nRed Hat would like to thank the cURL project for reporting this issue. Upstream acknowledges Symeon Paraschoudis as the original reporter."
							},
							{
								"isprivate": "0",
								"commentid": "7593922",
								"comment_count": "2",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-10-21 05:14:16 +0000",
								"thetext": "Created attachment 948796\npreliminary patch from upstream"
							},
							{
								"isprivate": "0",
								"commentid": "7609985",
								"comment_count": "5",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-10-24 19:45:47 +0000",
								"thetext": "This issue affects applications that set CURLOPT_COPYPOSTFIELDS options on a curl handle a subsequently duplicate the handle (using curl_easy_duphandle()).\n\nDuring the handle duplication, libcurl may read memory outside of the bounds of allocated buffer if POST data set using CURLOPT_COPYPOSTFIELDS was not NUL terminated.  The out of bounds access occurs in strdup()/strlen().  This can cause crash if unmapped memory is reached before NUL byte is found, but such crash is unlikely.\n\nDue to another bug in the handle duplication code, POST data in the copied handle is not used even if no new POST data are set before performing the request.  Instead, data from the buffer associated with the original handle is used.  Therefore, if the original handle is freed, or if new POST data is set on it between duplication and the use of the new handle, libcurl may use data from an already freed buffer.\n\nThere are no applications in Red Hat Enterprise Linux that uses libcurl in the way that would make them vulnerable to this issue.  The CURLOPT_COPYPOSTFIELDS option is only used by PHP, when PHP script sets CURLOPT_POSTFIELDS option with data that is not array or object.  As string arguments used with PHP curl_setopt(CURLOPT_POSTFIELDS) are unlikely to be NUL terminated, strdup() out of bounds read is likely to happen in curl_copy_handle().\n\nUpstream advisory lists curl versions 7.17.1 and later to be affected by this problem.  The version 7.17.1 is the one that introduced the CURLOPT_COPYPOSTFIELDS option.  The curl packages in Red Hat Enterprise Linux 5 and earlier are based on older upstream curl versions and hence were not affected by this issue."
							},
							{
								"isprivate": "0",
								"commentid": "7642891",
								"comment_count": "6",
								"who": {
									"text": "mprpic",
									"name": "Martin Prpič"
								},
								"bug_when": "2014-11-05 10:47:33 +0000",
								"thetext": "This issue is now public.\n\nExternal Reference:\n\nhttp://curl.haxx.se/docs/adv_20141105.html"
							},
							{
								"isprivate": "0",
								"commentid": "7643260",
								"comment_count": "7",
								"who": {
									"text": "kdudka",
									"name": "Kamil Dudka"
								},
								"bug_when": "2014-11-05 12:57:51 +0000",
								"thetext": "fixed in curl-7.39.0-1.fc22\n\nfixed in curl-7.37.0-9.fc21\n\nfixed in curl-7.32.0-15.fc20\n\nfixed in curl-7.29.0-25.fc19"
							},
							{
								"isprivate": "0",
								"commentid": "7643522",
								"comment_count": "8",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-11-05 13:47:59 +0000",
								"thetext": "Upstream commit:\n\nhttps://github.com/bagder/curl/commit/b3875606925536f82fc61f3114ac42f29eaf6945"
							},
							{
								"isprivate": "0",
								"commentid": "7643530",
								"comment_count": "9",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-11-05 13:50:03 +0000",
								"thetext": "\nCreated mingw-curl tracking bugs for this issue:\n\nAffects: fedora-all [bug 1160724]\nAffects: epel-7 [bug 1160725]"
							},
							{
								"isprivate": "0",
								"commentid": "7655385",
								"comment_count": "10",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-11-10 06:43:29 +0000",
								"thetext": "curl-7.37.0-9.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7655387",
								"comment_count": "11",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-11-10 06:43:55 +0000",
								"thetext": "curl-7.32.0-15.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7667307",
								"comment_count": "12",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2014-11-12 21:24:53 +0000",
								"thetext": "Statement:\n\nThis issue does not affect the versions of curl as shipped with Red Hat Enterprise Linux 5.\n\nNote that there are no applications provided with Red Hat Enterprise Linux that use the vulnerable CURLOPT_COPYPOSTFIELDS option, except PHP which could only be affected if used in an extremely unlikely scenario or via the script's author."
							},
							{
								"isprivate": "0",
								"commentid": "7721841",
								"comment_count": "13",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-12-01 18:56:46 +0000",
								"thetext": "curl-7.32.0-16.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7761066",
								"comment_count": "14",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-12-13 09:46:33 +0000",
								"thetext": "curl-7.32.0-17.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7763193",
								"comment_count": "15",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-12-15 04:28:15 +0000",
								"thetext": "curl-7.37.0-11.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7799695",
								"comment_count": "18",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2015-01-03 18:59:39 +0000",
								"thetext": "curl-7.29.0-27.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "8465514",
								"comment_count": "21",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2015-07-22 05:43:58 +0000",
								"thetext": "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 6\n\nVia RHSA-2015:1254 https://rhn.redhat.com/errata/RHSA-2015-1254.html"
							},
							{
								"isprivate": "0",
								"commentid": "8836578",
								"comment_count": "23",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2015-11-19 07:07:01 +0000",
								"thetext": "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7\n\nVia RHSA-2015:2159 https://rhn.redhat.com/errata/RHSA-2015-2159.html"
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "7643524",
						"comment_count": "0",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2014-11-05 13:49:50 +0000",
						"thetext": "\nThis is an automatically created tracking bug!  It was created to ensure\nthat one or more security vulnerabilities are fixed in affected versions\nof Fedora.\n\nFor comments that are specific to the vulnerability please use bugs filed\nagainst the \"Security Response\" product referenced in the \"Blocks\" field.\n\nFor more information see:\nhttp://fedoraproject.org/wiki/Security/TrackingBugs\n\nWhen submitting as an update, use the fedpkg template provided in the next\ncomment(s).  This will include the bug IDs of this tracking bug as well as\nthe relevant top-level CVE bugs.\n\nPlease also mention the CVE IDs being fixed in the RPM changelog and the\nfedpkg commit message.\n\nNOTE: this issue affects multiple supported versions of Fedora. While only\none tracking bug has been filed, please correct all affected versions at\nthe same time.  If you need to fix the versions independent of each other,\nyou may clone this bug as appropriate.\n\n[bug automatically created by: add-tracking-bugs]"
					},
					{
						"isprivate": "0",
						"commentid": "7643525",
						"comment_count": "1",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2014-11-05 13:49:55 +0000",
						"thetext": "\nUse the following template to for the 'fedpkg update' request to submit an\nupdate for this issue as it contains the top-level parent bug(s) as well as\nthis tracking bug.  This will ensure that all associated bugs get updated\nwhen new packages are pushed to stable.\n\n=====\n\n# bugfix, security, enhancement, newpackage (required)\ntype=security\n\n# testing, stable\nrequest=testing\n\n# Bug numbers: 1234,9876\nbugs=1154941,1160724\n\n# Description of your update\nnotes=Security fix for CVE-2014-3707\n\n# Enable request automation based on the stable/unstable karma thresholds\nautokarma=True\nstable_karma=3\nunstable_karma=-3\n\n# Automatically close bugs when this marked as stable\nclose_bugs=True\n\n# Suggest that users restart after update\nsuggest_reboot=False\n\n======\n\nAdditionally, you may opt to use the bodhi update submission link instead:\n\nhttps://admin.fedoraproject.org/updates/new/?type_=security&bugs=1154941,1160724"
					},
					{
						"isprivate": "0",
						"commentid": "7787655",
						"comment_count": "2",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-23 13:56:03 +0000",
						"thetext": "mingw-curl-7.39.0-1.fc21 has been submitted as an update for Fedora 21.\nhttps://admin.fedoraproject.org/updates/mingw-curl-7.39.0-1.fc21"
					},
					{
						"isprivate": "0",
						"commentid": "7787659",
						"comment_count": "3",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-23 13:56:28 +0000",
						"thetext": "mingw-curl-7.39.0-1.fc20 has been submitted as an update for Fedora 20.\nhttps://admin.fedoraproject.org/updates/mingw-curl-7.39.0-1.fc20"
					},
					{
						"isprivate": "0",
						"commentid": "7787661",
						"comment_count": "4",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-23 13:56:53 +0000",
						"thetext": "mingw-curl-7.39.0-1.el7 has been submitted as an update for Fedora EPEL 7.\nhttps://admin.fedoraproject.org/updates/mingw-curl-7.39.0-1.el7"
					},
					{
						"isprivate": "0",
						"commentid": "7790022",
						"comment_count": "5",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-24 17:40:00 +0000",
						"thetext": "Package mingw-curl-7.39.0-1.el7:\n* should fix your issue,\n* was pushed to the Fedora EPEL 7 testing repository,\n* should be available at your local mirror within two days.\nUpdate it with:\n# su -c 'yum update --enablerepo=epel-testing mingw-curl-7.39.0-1.el7'\nas soon as you are able to.\nPlease go to the following url:\nhttps://admin.fedoraproject.org/updates/FEDORA-EPEL-2014-4906/mingw-curl-7.39.0-1.el7\nthen log in and leave karma (feedback)."
					},
					{
						"isprivate": "0",
						"commentid": "7797620",
						"comment_count": "6",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2015-01-02 05:06:22 +0000",
						"thetext": "mingw-curl-7.39.0-1.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7797627",
						"comment_count": "7",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2015-01-02 05:06:52 +0000",
						"thetext": "mingw-curl-7.39.0-1.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7821051",
						"comment_count": "8",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2015-01-09 02:58:21 +0000",
						"thetext": "mingw-curl-7.39.0-1.el7 has been pushed to the Fedora EPEL 7 stable repository.  If problems still persist, please make note of it in this bug report."
					}
				]
			}
		}
	],
	"builds": [
		{
			"nvr": "mingw-curl-7.39.0-1.fc21",
			"signed": true,
			"type": "rpm",
			"package": {
				"noarch": [
					{
						"name": "mingw64-curl-static",
						"version": "7.39.0",
						"release": "1.fc21",
						"arch": "noarch"
					},
					{
						"name": "mingw64-curl",
						"version": "7.39.0",
						"release": "1.fc21",
						"arch": "noarch"
					},
					{
						"name": "mingw32-curl-debuginfo",
						"version": "7.39.0",
						"release": "1.fc21",
						"arch": "noarch"
					},
					{
						"name": "mingw32-curl",
						"version": "7.39.0",
						"release": "1.fc21",
						"arch": "noarch"
					},
					{
						"name": "mingw32-curl-static",
						"version": "7.39.0",
						"release": "1.fc21",
						"arch": "noarch"
					},
					{
						"name": "mingw64-curl-debuginfo",
						"version": "7.39.0",
						"release": "1.fc21",
						"arch": "noarch"
					}
				],
				"src": [
					{
						"name": "mingw-curl",
						"version": "7.39.0",
						"release": "1.fc21",
						"arch": "src"
					}
				]
			}
		}
	],
	"close_bugs": true,
	"comments": [
		{
			"id": 266292,
			"text": "This update has been submitted for testing by epienbro. ",
			"timestamp": "2014-12-23 13:56:13",
			"update_id": 32441,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 266293,
			"text": "Taskotron: depcheck test PASSED on i386. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/23315/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2014-12-23 14:07:09",
			"update_id": 32441,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/1c99e8328b68b58a71f5a9d6449baa7cb914591c56cbec0adfac7c50e4abefa4?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 266294,
			"text": "Taskotron: depcheck test PASSED on x86_64. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/23315/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2014-12-23 14:07:30",
			"update_id": 32441,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/1c99e8328b68b58a71f5a9d6449baa7cb914591c56cbec0adfac7c50e4abefa4?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 266295,
			"text": "This update is currently being pushed to the Fedora 21 testing updates repository.",
			"timestamp": "2014-12-24 17:35:37",
			"update_id": 32441,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 266296,
			"text": "This update has been pushed to testing",
			"timestamp": "2014-12-25 05:34:52",
			"update_id": 32441,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 266297,
			"text": "This update has reached 7 days in testing and can be pushed to stable now if the maintainer wishes",
			"timestamp": "2015-01-01 10:24:57",
			"update_id": 32441,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 266298,
			"text": "This update has been submitted for stable by epienbro. ",
			"timestamp": "2015-01-01 11:39:07",
			"update_id": 32441,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 266299,
			"text": "Taskotron: upgradepath test PASSED on noarch. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/24648/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2015-01-01 11:50:37",
			"update_id": 32441,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/1c99e8328b68b58a71f5a9d6449baa7cb914591c56cbec0adfac7c50e4abefa4?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 266300,
			"text": "This update is currently being pushed to the Fedora 21 stable updates repository.",
			"timestamp": "2015-01-01 17:42:25",
			"update_id": 32441,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 266301,
			"text": "This update has been pushed to stable",
			"timestamp": "2015-01-02 05:06:13",
			"update_id": 32441,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		}
	],
	"content_type": "rpm",
	"date_pushed": "2015-01-02 05:06:13",
	"date_stable": "2015-01-02 05:06:13",
	"date_submitted": "2014-12-23 13:56:04",
	"date_testing": "2014-12-25 05:34:52",
	"meets_testing_requirements": true,
	"notes": "* Update to 7.39.0",
	"pushed": true,
	"release": {
		"branch": "f21",
		"candidate_tag": "f21-updates-candidate",
		"composed_by_bodhi": true,
		"dist_tag": "f21",
		"id_prefix": "FEDORA",
		"long_name": "Fedora 21",
		"mail_template": "fedora_errata_template",
		"name": "F21",
		"override_tag": "f21-override",
		"package_manager": "dnf",
		"pending_stable_tag": "f21-updates-pending",
		"pending_testing_tag": "f21-updates-testing-pending",
		"stable_tag": "f21-updates",
		"state": "archived",
		"testing_repository": "updates-testing",
		"testing_tag": "f21-updates-testing",
		"version": "21"
	},
	"severity": "unspecified",
	"stable_karma": 3,
	"status": "stable",
	"suggest": "unspecified",
	"title": "mingw-curl-7.39.0-1.fc21",
	"type": "security",
	"url": "https://bodhi.fedoraproject.org/updates/FEDORA-2014-17601",
	"unstable_karma": -3,
	"updateid": "FEDORA-2014-17601",
	"user": {
		"avatar": "https://seccdn.libravatar.org/avatar/0b2e2432af444125caa89c1c84824761f3445d04a83c5f6543199d8f2e328199?s=24&d=retro",
		"email": "erik-fedora@vanpienbroek.nl",
		"groups": [
			{
				"name": "packager"
			},
			{
				"name": "provenpackager"
			}
		],
		"id": 282,
		"name": "epienbro",
		"openid": "epienbro.id.fedoraproject.org"
	},
	"version_hash": "88d0d458581d170c3a70528e9b3193ed801eb428"
}
