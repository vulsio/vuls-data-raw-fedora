{
	"alias": "FEDORA-2014-14617",
	"bugs": [
		{
			"bug_id": 1064098,
			"parent": true,
			"security": true,
			"title": "CVE-2014-1947 ImageMagick: PSD writing layer name buffer overflow (\"L%02ld\")",
			"bugzilla": {
				"bug_id": "1064098",
				"alias": "CVE-2014-1947",
				"creation_ts": "2014-02-12 02:30:11 +0000",
				"short_desc": "CVE-2014-1947 ImageMagick: PSD writing layer name buffer overflow (\"L%02ld\")",
				"delta_ts": "2019-09-29 13:13:05 +0000",
				"bug_status": "CLOSED",
				"resolution": "WONTFIX",
				"keywords": "Security",
				"priority": "medium",
				"bug_severity": "medium",
				"depends_on": [
					"1083082",
					"1083083",
					"1083084"
				],
				"blocked": [
					{
						"bug_id": "1064101",
						"error": "NotPermitted"
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "6808545",
						"comment_count": "0",
						"who": {
							"text": "mmcallis",
							"name": "Murray McAllister"
						},
						"bug_when": "2014-02-12 02:30:11 +0000",
						"thetext": "A buffer overflow flaw affecting ImageMagick versions prior to 6.8.8-5 when handling PSD images was reported:\n\nhttp://secunia.com/advisories/56844/\n\nDiffing ImageMagick-6.8.7/coders/psd.c and ImageMagick-6.8.8/coders/psd.c, it looks like the flaw may be FormatLocaleString() writing the amount of 6 long integers (approximately 48 bytes) into a buffer (layer_name) that is only 4 bytes:\n\n\"\"\n@@ -1224,7 +1224,7 @@\n               Allocate layered image.\n             */\n             layer_info[i].image=CloneImage(image,layer_info[i].page.width,\n-              layer_info[i].page.height == ~0U ? 1 : layer_info[i].page.height,\n+              layer_info[i].page.height == ~0UL ? 1 : layer_info[i].page.height,\n               MagickFalse,&image->exception);\n             if (layer_info[i].image == (Image *) NULL)\n               {\n@@ -2112,9 +2112,6 @@\n   StringInfo\n     *bim_profile;\n \n-  unsigned char\n-    layer_name[4];\n-\n   /*\n     Open image file.\n   */\n@@ -2372,12 +2369,15 @@\n         property=(const char *) GetImageProperty(next_image,\"label\");\n         if (property == (const char *) NULL)\n           {\n+            char\n+              layer_name[MaxTextExtent];\n+\n             (void) WriteBlobMSBLong(image,16);\n             (void) WriteBlobMSBLong(image,0);\n             (void) WriteBlobMSBLong(image,0);\n-            (void) FormatLocaleString((char *) layer_name,MaxTextExtent,\n-              \"L%06ld\",(long) layer_count++);\n-            WritePascalString( image, (char*)layer_name, 4 );\n+            (void) FormatLocaleString(layer_name,MaxTextExtent,\"L%06ld\",(long)\n+              layer_count++);\n+            WritePascalString(image,layer_name,4);\n           }\n         else\n           {\n\n\"\"\n\nCVE request: http://www.openwall.com/lists/oss-security/2014/02/12/2"
					},
					{
						"isprivate": "0",
						"commentid": "6809763",
						"comment_count": "1",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2014-02-12 10:02:33 +0000",
						"thetext": "(In reply to Murray McAllister from comment #0)\n> Diffing ImageMagick-6.8.7/coders/psd.c and ImageMagick-6.8.8/coders/psd.c,\n> it looks like the flaw may be FormatLocaleString() writing the amount of 6\n> long integers (approximately 48 bytes) into a buffer (layer_name) that is\n> only 4 bytes:\n\nIt's writing less than those mentioned 48 bytes.  It's writing a long integer in a way that at least 6 digits are always printed, prefixed with zeros if needed (e.g. L000001, L000123, or L1234567).  Adding space for 'L' and terminating '\\0', that implies there is at least 4 byte buffer overflow whenever that code is reached.  Depending on actual memory layout, this may only clobber other local variables in WritePSDImage().\n\nThe maximum overflow is architecture dependent.  It seems the maximum number of digits is written if layer_count is LONG_MIN, resulting in layer_name being L-2147483648 (32bit) or L-9223372036854775808 (64bit), yielding the maximum of 18 byte overflow.  As the value printed is layer counter, it may not be possible to provide input image with that many layers.  Practical overflow may not be much longer than the overflow that happens in the non-malicious case mentioned above.\n\nOlder ImageMagick versions have this format string instead \"L%02ld\", so it does not always overflow, it only starts to overflow with 100 layers.\n\nUpstream commit:\nhttp://trac.imagemagick.org/changeset/13736"
					},
					{
						"isprivate": "0",
						"commentid": "6809775",
						"comment_count": "2",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2014-02-12 10:07:17 +0000",
						"thetext": "There is this suspicious commit:\nhttp://trac.imagemagick.org/changeset/14801\n\nEven though no obvious link to RLE decoding mentioned in the Secunia advisory."
					},
					{
						"isprivate": "0",
						"commentid": "6811911",
						"comment_count": "3",
						"who": {
							"text": "vdanen",
							"name": "Vincent Danen"
						},
						"bug_when": "2014-02-12 17:44:13 +0000",
						"thetext": "This was assigned CVE-2014-1947:\n\nhttp://www.openwall.com/lists/oss-security/2014/02/12/13"
					},
					{
						"isprivate": "0",
						"commentid": "6813257",
						"comment_count": "4",
						"who": {
							"text": "peter.hutterer",
							"name": "Peter Hutterer"
						},
						"bug_when": "2014-02-13 04:08:27 +0000",
						"thetext": "As noted in IRC, I believe what Murray found (second and third hunk) is a different issue. Tomas' commit identifies the patch mentioned in the Secunia advisory.\n\nThe fix is in the DecodePSDPixels function and looks RLE-related. RLE is a simple compression using pairs of bytes, first the number of elements, then the value for an element. A pair of [3, a] would produce \"aaa\" on decompression.\n\nRLE can overflow at the pre-allocated target buffer if no size check for the uncompressed length of the current pair is performed. A simple example is allocating a buffer of size 4, then having a encoding pair of [3, a] and [256, b]. After writing 'aaa' the buffer still has room, so (current_index < buffer_length) is true and we decompress the next pair, writing 255 bytes beyond the buffer boundary. That's exactly what happens here.\n\nIn this code: compact_pixels is the set of RLE pairs, number_pixels is the length of the buffer. i is the current pixel index, pixel points to the current characters. Buffer overflow can happen when (i >= number_pixels - 256).\n\nThe patch fixed this by capping the length of the decompressed set to the remainder.\n\nThe other size checks are ok, so an exploit would only be able use one packet to write past the buffer boundary, and the byte values aren't completely arbitrary but somewhat limited by the format. How to exploit that requires more creativity than I have. Max overflow is 256 bytes."
					},
					{
						"isprivate": "0",
						"commentid": "6818180",
						"comment_count": "5",
						"who": {
							"text": "vdanen",
							"name": "Vincent Danen"
						},
						"bug_when": "2014-02-13 23:03:39 +0000",
						"thetext": "(In reply to Tomas Hoger from comment #2)\n> There is this suspicious commit:\n> http://trac.imagemagick.org/changeset/14801\n> \n> Even though no obvious link to RLE decoding mentioned in the Secunia\n> advisory.\n\nThis commit was assigned CVE-2014-1958 as per:\n\nhttp://seclists.org/oss-sec/2014/q1/343\n\nThis one is pretty messy.  It looks like there may be further discussion about this but we probably want to file a second bug for this CVE once it gets detangled a bit."
					},
					{
						"isprivate": "0",
						"commentid": "6837642",
						"comment_count": "6",
						"who": {
							"text": "mmcallis",
							"name": "Murray McAllister"
						},
						"bug_when": "2014-02-20 04:58:57 +0000",
						"thetext": "quoting from MITRE in http://www.openwall.com/lists/oss-security/2014/02/19/13\n\n\"\"\nThe clarified meaning of CVE-2014-1947 is now the vulnerability in\nolder ImageMagick versions (such as 6.5.4) that use the \"L%02ld\"\nstring. The root cause here is that the code did not cover the case of\nmore than 99 layers, which is apparently allowable but relatively\nuncommon. This has a resultant buffer overflow, e.g, L99\\0 is safe but\nL100\\0 is unsafe. When the overflow occurs, it can be described as \"1\nor more bytes too many.\"\n\nA new ID of CVE-2014-2030 is now assigned for the vulnerability in\nnewer ImageMagick versions that use the \"L%06ld\" string. The root\ncause here is that the code did not recognize the relationship between\nthe 8 (or more) characters in \"L%06ld\" and the actual buffer size.\nThis has a resultant buffer overflow of \"4 or more bytes too many.\"\n\"\""
					},
					{
						"isprivate": "0",
						"commentid": "6837687",
						"comment_count": "7",
						"who": {
							"text": "mmcallis",
							"name": "Murray McAllister"
						},
						"bug_when": "2014-02-20 05:24:26 +0000",
						"thetext": "\nCreated ImageMagick tracking bugs for this issue:\n\nAffects: fedora-all [bug 1067278]"
					},
					{
						"isprivate": "0",
						"commentid": "6837695",
						"comment_count": "8",
						"who": {
							"text": "mmcallis",
							"name": "Murray McAllister"
						},
						"bug_when": "2014-02-20 05:28:21 +0000",
						"thetext": "(In reply to Vincent Danen from comment #5)\n> (In reply to Tomas Hoger from comment #2)\n> > There is this suspicious commit:\n> > http://trac.imagemagick.org/changeset/14801\n> > \n> > Even though no obvious link to RLE decoding mentioned in the Secunia\n> > advisory.\n> \n> This commit was assigned CVE-2014-1958 as per:\n> \n> http://seclists.org/oss-sec/2014/q1/343\n> \n> This one is pretty messy.  It looks like there may be further discussion\n> about this but we probably want to file a second bug for this CVE once it\n> gets detangled a bit.\n\nFiled https://bugzilla.redhat.com/show_bug.cgi?id=1067276"
					},
					{
						"isprivate": "0",
						"commentid": "6878803",
						"comment_count": "9",
						"who": {
							"text": "pahan",
							"name": "Pavel Alexeev"
						},
						"bug_when": "2014-03-04 13:26:19 +0000",
						"thetext": "Citing upstream author from upstream bug report ( http://www.imagemagick.org/discourse-server/viewtopic.php?f=3&t=25128 ):\n\"However, we're not sure about CVE-2014-2030. They say \"new ID of CVE-2014-2030 is now assigned for the vulnerability in newer ImageMagick versions that use the \"L%06ld\" string. The root cause here is that the code did not recognize the relationship between the 8 (or more) characters in \"L%06ld\" and the actual buffer size.\" Since the layer_name buffer is now 4096 characters, whereas the maximum label size is 21 characters (i.e. L-9223372036854775808 @ 64-bit). So we're not sure why 2030 is filed as a vulnerability.\"\n\nCould someone answer it?"
					},
					{
						"isprivate": "0",
						"commentid": "6879971",
						"comment_count": "10",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2014-03-04 16:37:27 +0000",
						"thetext": "Both CVEs here are for ImageMagick versions before changeset 13736.\n\nCVE-2014-1947 is for versions that use format string \"L%02ld\".  The layer_name there is layer_name[4] so overflow only occurs if there are more than 99 layers.\n\nFormat was changed from \"L%02ld\" to \"L%06ld\" in r1448:\nhttp://trac.imagemagick.org/changeset/1448\n\nCVE-2014-2030 is applicable to ImageMagick versions after the above r1448, where layer_name is still layer_name[4], but overflow occurs even with a single (unnamed) layer.\n\nFixed in r13736 that made layer_name large enough:\nhttp://trac.imagemagick.org/changeset/13736\n\nr13736 is fix for both CVEs, but anyone shipping pre-r1448 IM versions should use CVE-2014-1947 in released updates instead of CVE-2014-2030."
					},
					{
						"isprivate": "0",
						"commentid": "6891348",
						"comment_count": "11",
						"who": {
							"text": "pahan",
							"name": "Pavel Alexeev"
						},
						"bug_when": "2014-03-07 08:58:46 +0000",
						"thetext": "So, we can then just update it to last version and constatate what all three CVE fixed? Right?"
					},
					{
						"isprivate": "0",
						"commentid": "6973145",
						"comment_count": "13",
						"who": {
							"text": "scorneli",
							"name": "Stefan Cornelius"
						},
						"bug_when": "2014-04-01 12:22:35 +0000",
						"thetext": "CVE-2014-1947 also affects GraphicMagic. Although there are small differences, the root cause is identical and overall the code is similar enough to certain ImageMagick versions to reuse CVE-2014-1947. In GraphicsMagick, the buffer overflow is caught by the fortify source buffer overflow protection."
					},
					{
						"isprivate": "0",
						"commentid": "6973320",
						"comment_count": "15",
						"who": {
							"text": "scorneli",
							"name": "Stefan Cornelius"
						},
						"bug_when": "2014-04-01 12:57:01 +0000",
						"thetext": "\nCreated GraphicsMagick tracking bugs for this issue:\n\nAffects: fedora-all [bug 1083082]\nAffects: epel-5 [bug 1083083]\nAffects: epel-6 [bug 1083084]"
					},
					{
						"isprivate": "0",
						"commentid": "6973333",
						"comment_count": "16",
						"who": {
							"text": "scorneli",
							"name": "Stefan Cornelius"
						},
						"bug_when": "2014-04-01 12:59:41 +0000",
						"thetext": "(In reply to Pavel Alexeev (aka Pahan-Hubbitus) from comment #11)\n> So, we can then just update it to last version and constatate what all three\n> CVE fixed? Right?\n\nYes, the latest version should fix all issues."
					},
					{
						"isprivate": "0",
						"commentid": "6985277",
						"comment_count": "18",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2014-04-04 13:40:02 +0000",
						"thetext": "As CVE-2014-1947 and CVE-2014-2030 affect different versions, tracking of CVE-2014-2030 was split to a separate bug 1083477."
					},
					{
						"isprivate": "0",
						"commentid": "7012213",
						"comment_count": "19",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-04-15 15:38:00 +0000",
						"thetext": "ImageMagick-6.8.6.3-4.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7402335",
						"comment_count": "20",
						"who": {
							"text": "rdieter",
							"name": "Rex Dieter"
						},
						"bug_when": "2014-08-20 14:41:18 +0000",
						"thetext": "Here's what I'm using for GraphicsMagick, adapting a similar fix (I think):\nhttp://pkgs.fedoraproject.org/cgit/GraphicsMagick.git/tree/GraphicsMagick-1.3.20-CVE-2014-1947.patch\n\ndiff -up GraphicsMagick-1.3.20/coders/psd.c.CVE-2014-1947 GraphicsMagick-1.3.20/coders/psd.c\n--- GraphicsMagick-1.3.20/coders/psd.c.CVE-2014-1947\t2014-08-16 15:33:23.000000000 -0500\n+++ GraphicsMagick-1.3.20/coders/psd.c\t2014-08-20 07:30:08.767862041 -0500\n@@ -1719,8 +1719,7 @@ static unsigned int WritePSDImage(const\n     i;\n \n   unsigned char\n-    *pixels,\n-    layer_name[4];\n+    *pixels;\n \n   unsigned int\n     packet_size,\n@@ -1944,8 +1943,9 @@ static unsigned int WritePSDImage(const\n             (void) WriteBlob(image, 3, &layer_name[1]);\n           */ \n         } else {\n-          (void) sprintf((char *) layer_name, \"L%02d\", layer_count++ );\n-          WritePascalString( image, (char*)layer_name, 4 );\n+          char layer_name[4];\n+          (void) sprintf(layer_name, \"L%02d\", layer_count++ );\n+          WritePascalString( image, layer_name, 4 );\n         }\n         tmp_image = tmp_image->next;\n       };"
					},
					{
						"isprivate": "0",
						"commentid": "7414450",
						"comment_count": "21",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2014-08-25 09:50:40 +0000",
						"thetext": "(In reply to Rex Dieter from comment #20)\n> Here's what I'm using for GraphicsMagick\n\nWhat is the change supposed to do?  It does not increase the size of layer_name, so more than 99 layers should still lead to overflow as described in comment 10."
					},
					{
						"isprivate": "0",
						"commentid": "7416124",
						"comment_count": "22",
						"who": {
							"text": "rdieter",
							"name": "Rex Dieter"
						},
						"bug_when": "2014-08-25 18:48:27 +0000",
						"thetext": "Oh, indeed, I'd naively thought the main fix was adjusting to a char array (and avoiding the cast).  Does this look better?\n\n--- GraphicsMagick-1.3.20/coders/psd.c.CVE-2014-1947    2014-08-16 15:33:23.000000000 -0500\n+++ GraphicsMagick-1.3.20/coders/psd.c  2014-08-20 07:30:08.767862041 -0500\n@@ -1719,8 +1719,7 @@ static unsigned int WritePSDImage(const\n     i;\n \n   unsigned char\n-    *pixels,\n-    layer_name[4];\n+    *pixels;\n \n   unsigned int\n     packet_size,\n@@ -1944,8 +1943,9 @@ static unsigned int WritePSDImage(const\n             (void) WriteBlob(image, 3, &layer_name[1]);\n           */ \n         } else {\n-          (void) sprintf((char *) layer_name, \"L%02d\", layer_count++ );\n-          WritePascalString( image, (char*)layer_name, 4 );\n+          char layer_name[MaxTextExtent];\n+          (void) sprintf(layer_name, \"L%06ld\", layer_count++ );\n+          WritePascalString( image, layer_name, 4 );\n         }\n         tmp_image = tmp_image->next;\n       };"
					},
					{
						"isprivate": "0",
						"commentid": "7416194",
						"comment_count": "23",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2014-08-25 19:31:23 +0000",
						"thetext": "(In reply to Rex Dieter from comment #22)\n> Oh, indeed, I'd naively thought the main fix was adjusting to a char array\n> (and avoiding the cast).  Does this look better?\n\nI haven't looked at GM specifically.  In IM, MaxTextExtent is large enough to hold layer name, regardless of whether L%02d or L%06ld format is used."
					},
					{
						"isprivate": "0",
						"commentid": "7426855",
						"comment_count": "24",
						"who": {
							"text": "rdieter",
							"name": "Rex Dieter"
						},
						"bug_when": "2014-08-28 12:51:53 +0000",
						"thetext": "OK, not being intimately familiar with this code either, I'm going back to the original L%02d format variant.  It would appear GM upstream may not be aware of this... I'll try to make some time soon to poke them about it too."
					},
					{
						"isprivate": "0",
						"commentid": "7428016",
						"comment_count": "25",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-08-28 15:34:29 +0000",
						"thetext": "GraphicsMagick-1.3.20-1.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7428268",
						"comment_count": "26",
						"who": {
							"text": "rdieter",
							"name": "Rex Dieter"
						},
						"bug_when": "2014-08-28 15:52:20 +0000",
						"thetext": "This looks like a match,\nhttp://sourceforge.net/p/graphicsmagick/bugs/234/\nadded a comment there, and they responded to me already with some questions."
					},
					{
						"isprivate": "0",
						"commentid": "7429656",
						"comment_count": "27",
						"who": {
							"text": "bfriesen",
							"name": "Bob Friesenhahn"
						},
						"bug_when": "2014-08-29 03:47:12 +0000",
						"thetext": "I just pushed GraphicsMagick changeset 14139:a083f9eeef1d with a patch which is mostly similar to Rex Dieter's patch.  It seems doubtful that this issue is covered by any existing GraphicsMagick bug report.  The PSD code in GraphicsMagick has many unresolved issues."
					},
					{
						"isprivate": "0",
						"commentid": "7463871",
						"comment_count": "28",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-09-09 22:15:43 +0000",
						"thetext": "GraphicsMagick-1.3.20-3.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7477871",
						"comment_count": "29",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-09-14 03:27:04 +0000",
						"thetext": "GraphicsMagick-1.3.20-3.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7497136",
						"comment_count": "30",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-09-18 23:50:39 +0000",
						"thetext": "GraphicsMagick-1.3.20-3.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7497142",
						"comment_count": "31",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-09-18 23:51:04 +0000",
						"thetext": "GraphicsMagick-1.3.20-3.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7673932",
						"comment_count": "32",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-14 12:08:25 +0000",
						"thetext": "GraphicsMagick-1.3.20-3.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
					}
				]
			}
		},
		{
			"bug_id": 1083082,
			"security": true,
			"title": "CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [fedora-all]",
			"bugzilla": {
				"bug_id": "1083082",
				"creation_ts": "2014-04-01 12:56:22 +0000",
				"short_desc": "CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [fedora-all]",
				"delta_ts": "2014-11-14 12:08:21 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Security, SecurityTracking",
				"priority": "medium",
				"bug_severity": "medium",
				"blocked": [
					{
						"bug_id": "1064098",
						"alias": "CVE-2014-1947",
						"creation_ts": "2014-02-12 02:30:11 +0000",
						"short_desc": "CVE-2014-1947 ImageMagick: PSD writing layer name buffer overflow (\"L%02ld\")",
						"delta_ts": "2019-09-29 13:13:05 +0000",
						"bug_status": "CLOSED",
						"resolution": "WONTFIX",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1083082",
							"1083083",
							"1083084"
						],
						"blocked": [
							{
								"bug_id": "1064101",
								"error": "NotPermitted"
							}
						],
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "6808545",
								"comment_count": "0",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-02-12 02:30:11 +0000",
								"thetext": "A buffer overflow flaw affecting ImageMagick versions prior to 6.8.8-5 when handling PSD images was reported:\n\nhttp://secunia.com/advisories/56844/\n\nDiffing ImageMagick-6.8.7/coders/psd.c and ImageMagick-6.8.8/coders/psd.c, it looks like the flaw may be FormatLocaleString() writing the amount of 6 long integers (approximately 48 bytes) into a buffer (layer_name) that is only 4 bytes:\n\n\"\"\n@@ -1224,7 +1224,7 @@\n               Allocate layered image.\n             */\n             layer_info[i].image=CloneImage(image,layer_info[i].page.width,\n-              layer_info[i].page.height == ~0U ? 1 : layer_info[i].page.height,\n+              layer_info[i].page.height == ~0UL ? 1 : layer_info[i].page.height,\n               MagickFalse,&image->exception);\n             if (layer_info[i].image == (Image *) NULL)\n               {\n@@ -2112,9 +2112,6 @@\n   StringInfo\n     *bim_profile;\n \n-  unsigned char\n-    layer_name[4];\n-\n   /*\n     Open image file.\n   */\n@@ -2372,12 +2369,15 @@\n         property=(const char *) GetImageProperty(next_image,\"label\");\n         if (property == (const char *) NULL)\n           {\n+            char\n+              layer_name[MaxTextExtent];\n+\n             (void) WriteBlobMSBLong(image,16);\n             (void) WriteBlobMSBLong(image,0);\n             (void) WriteBlobMSBLong(image,0);\n-            (void) FormatLocaleString((char *) layer_name,MaxTextExtent,\n-              \"L%06ld\",(long) layer_count++);\n-            WritePascalString( image, (char*)layer_name, 4 );\n+            (void) FormatLocaleString(layer_name,MaxTextExtent,\"L%06ld\",(long)\n+              layer_count++);\n+            WritePascalString(image,layer_name,4);\n           }\n         else\n           {\n\n\"\"\n\nCVE request: http://www.openwall.com/lists/oss-security/2014/02/12/2"
							},
							{
								"isprivate": "0",
								"commentid": "6809763",
								"comment_count": "1",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-02-12 10:02:33 +0000",
								"thetext": "(In reply to Murray McAllister from comment #0)\n> Diffing ImageMagick-6.8.7/coders/psd.c and ImageMagick-6.8.8/coders/psd.c,\n> it looks like the flaw may be FormatLocaleString() writing the amount of 6\n> long integers (approximately 48 bytes) into a buffer (layer_name) that is\n> only 4 bytes:\n\nIt's writing less than those mentioned 48 bytes.  It's writing a long integer in a way that at least 6 digits are always printed, prefixed with zeros if needed (e.g. L000001, L000123, or L1234567).  Adding space for 'L' and terminating '\\0', that implies there is at least 4 byte buffer overflow whenever that code is reached.  Depending on actual memory layout, this may only clobber other local variables in WritePSDImage().\n\nThe maximum overflow is architecture dependent.  It seems the maximum number of digits is written if layer_count is LONG_MIN, resulting in layer_name being L-2147483648 (32bit) or L-9223372036854775808 (64bit), yielding the maximum of 18 byte overflow.  As the value printed is layer counter, it may not be possible to provide input image with that many layers.  Practical overflow may not be much longer than the overflow that happens in the non-malicious case mentioned above.\n\nOlder ImageMagick versions have this format string instead \"L%02ld\", so it does not always overflow, it only starts to overflow with 100 layers.\n\nUpstream commit:\nhttp://trac.imagemagick.org/changeset/13736"
							},
							{
								"isprivate": "0",
								"commentid": "6809775",
								"comment_count": "2",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-02-12 10:07:17 +0000",
								"thetext": "There is this suspicious commit:\nhttp://trac.imagemagick.org/changeset/14801\n\nEven though no obvious link to RLE decoding mentioned in the Secunia advisory."
							},
							{
								"isprivate": "0",
								"commentid": "6811911",
								"comment_count": "3",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2014-02-12 17:44:13 +0000",
								"thetext": "This was assigned CVE-2014-1947:\n\nhttp://www.openwall.com/lists/oss-security/2014/02/12/13"
							},
							{
								"isprivate": "0",
								"commentid": "6813257",
								"comment_count": "4",
								"who": {
									"text": "peter.hutterer",
									"name": "Peter Hutterer"
								},
								"bug_when": "2014-02-13 04:08:27 +0000",
								"thetext": "As noted in IRC, I believe what Murray found (second and third hunk) is a different issue. Tomas' commit identifies the patch mentioned in the Secunia advisory.\n\nThe fix is in the DecodePSDPixels function and looks RLE-related. RLE is a simple compression using pairs of bytes, first the number of elements, then the value for an element. A pair of [3, a] would produce \"aaa\" on decompression.\n\nRLE can overflow at the pre-allocated target buffer if no size check for the uncompressed length of the current pair is performed. A simple example is allocating a buffer of size 4, then having a encoding pair of [3, a] and [256, b]. After writing 'aaa' the buffer still has room, so (current_index < buffer_length) is true and we decompress the next pair, writing 255 bytes beyond the buffer boundary. That's exactly what happens here.\n\nIn this code: compact_pixels is the set of RLE pairs, number_pixels is the length of the buffer. i is the current pixel index, pixel points to the current characters. Buffer overflow can happen when (i >= number_pixels - 256).\n\nThe patch fixed this by capping the length of the decompressed set to the remainder.\n\nThe other size checks are ok, so an exploit would only be able use one packet to write past the buffer boundary, and the byte values aren't completely arbitrary but somewhat limited by the format. How to exploit that requires more creativity than I have. Max overflow is 256 bytes."
							},
							{
								"isprivate": "0",
								"commentid": "6818180",
								"comment_count": "5",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2014-02-13 23:03:39 +0000",
								"thetext": "(In reply to Tomas Hoger from comment #2)\n> There is this suspicious commit:\n> http://trac.imagemagick.org/changeset/14801\n> \n> Even though no obvious link to RLE decoding mentioned in the Secunia\n> advisory.\n\nThis commit was assigned CVE-2014-1958 as per:\n\nhttp://seclists.org/oss-sec/2014/q1/343\n\nThis one is pretty messy.  It looks like there may be further discussion about this but we probably want to file a second bug for this CVE once it gets detangled a bit."
							},
							{
								"isprivate": "0",
								"commentid": "6837642",
								"comment_count": "6",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-02-20 04:58:57 +0000",
								"thetext": "quoting from MITRE in http://www.openwall.com/lists/oss-security/2014/02/19/13\n\n\"\"\nThe clarified meaning of CVE-2014-1947 is now the vulnerability in\nolder ImageMagick versions (such as 6.5.4) that use the \"L%02ld\"\nstring. The root cause here is that the code did not cover the case of\nmore than 99 layers, which is apparently allowable but relatively\nuncommon. This has a resultant buffer overflow, e.g, L99\\0 is safe but\nL100\\0 is unsafe. When the overflow occurs, it can be described as \"1\nor more bytes too many.\"\n\nA new ID of CVE-2014-2030 is now assigned for the vulnerability in\nnewer ImageMagick versions that use the \"L%06ld\" string. The root\ncause here is that the code did not recognize the relationship between\nthe 8 (or more) characters in \"L%06ld\" and the actual buffer size.\nThis has a resultant buffer overflow of \"4 or more bytes too many.\"\n\"\""
							},
							{
								"isprivate": "0",
								"commentid": "6837687",
								"comment_count": "7",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-02-20 05:24:26 +0000",
								"thetext": "\nCreated ImageMagick tracking bugs for this issue:\n\nAffects: fedora-all [bug 1067278]"
							},
							{
								"isprivate": "0",
								"commentid": "6837695",
								"comment_count": "8",
								"who": {
									"text": "mmcallis",
									"name": "Murray McAllister"
								},
								"bug_when": "2014-02-20 05:28:21 +0000",
								"thetext": "(In reply to Vincent Danen from comment #5)\n> (In reply to Tomas Hoger from comment #2)\n> > There is this suspicious commit:\n> > http://trac.imagemagick.org/changeset/14801\n> > \n> > Even though no obvious link to RLE decoding mentioned in the Secunia\n> > advisory.\n> \n> This commit was assigned CVE-2014-1958 as per:\n> \n> http://seclists.org/oss-sec/2014/q1/343\n> \n> This one is pretty messy.  It looks like there may be further discussion\n> about this but we probably want to file a second bug for this CVE once it\n> gets detangled a bit.\n\nFiled https://bugzilla.redhat.com/show_bug.cgi?id=1067276"
							},
							{
								"isprivate": "0",
								"commentid": "6878803",
								"comment_count": "9",
								"who": {
									"text": "pahan",
									"name": "Pavel Alexeev"
								},
								"bug_when": "2014-03-04 13:26:19 +0000",
								"thetext": "Citing upstream author from upstream bug report ( http://www.imagemagick.org/discourse-server/viewtopic.php?f=3&t=25128 ):\n\"However, we're not sure about CVE-2014-2030. They say \"new ID of CVE-2014-2030 is now assigned for the vulnerability in newer ImageMagick versions that use the \"L%06ld\" string. The root cause here is that the code did not recognize the relationship between the 8 (or more) characters in \"L%06ld\" and the actual buffer size.\" Since the layer_name buffer is now 4096 characters, whereas the maximum label size is 21 characters (i.e. L-9223372036854775808 @ 64-bit). So we're not sure why 2030 is filed as a vulnerability.\"\n\nCould someone answer it?"
							},
							{
								"isprivate": "0",
								"commentid": "6879971",
								"comment_count": "10",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-03-04 16:37:27 +0000",
								"thetext": "Both CVEs here are for ImageMagick versions before changeset 13736.\n\nCVE-2014-1947 is for versions that use format string \"L%02ld\".  The layer_name there is layer_name[4] so overflow only occurs if there are more than 99 layers.\n\nFormat was changed from \"L%02ld\" to \"L%06ld\" in r1448:\nhttp://trac.imagemagick.org/changeset/1448\n\nCVE-2014-2030 is applicable to ImageMagick versions after the above r1448, where layer_name is still layer_name[4], but overflow occurs even with a single (unnamed) layer.\n\nFixed in r13736 that made layer_name large enough:\nhttp://trac.imagemagick.org/changeset/13736\n\nr13736 is fix for both CVEs, but anyone shipping pre-r1448 IM versions should use CVE-2014-1947 in released updates instead of CVE-2014-2030."
							},
							{
								"isprivate": "0",
								"commentid": "6891348",
								"comment_count": "11",
								"who": {
									"text": "pahan",
									"name": "Pavel Alexeev"
								},
								"bug_when": "2014-03-07 08:58:46 +0000",
								"thetext": "So, we can then just update it to last version and constatate what all three CVE fixed? Right?"
							},
							{
								"isprivate": "0",
								"commentid": "6973145",
								"comment_count": "13",
								"who": {
									"text": "scorneli",
									"name": "Stefan Cornelius"
								},
								"bug_when": "2014-04-01 12:22:35 +0000",
								"thetext": "CVE-2014-1947 also affects GraphicMagic. Although there are small differences, the root cause is identical and overall the code is similar enough to certain ImageMagick versions to reuse CVE-2014-1947. In GraphicsMagick, the buffer overflow is caught by the fortify source buffer overflow protection."
							},
							{
								"isprivate": "0",
								"commentid": "6973320",
								"comment_count": "15",
								"who": {
									"text": "scorneli",
									"name": "Stefan Cornelius"
								},
								"bug_when": "2014-04-01 12:57:01 +0000",
								"thetext": "\nCreated GraphicsMagick tracking bugs for this issue:\n\nAffects: fedora-all [bug 1083082]\nAffects: epel-5 [bug 1083083]\nAffects: epel-6 [bug 1083084]"
							},
							{
								"isprivate": "0",
								"commentid": "6973333",
								"comment_count": "16",
								"who": {
									"text": "scorneli",
									"name": "Stefan Cornelius"
								},
								"bug_when": "2014-04-01 12:59:41 +0000",
								"thetext": "(In reply to Pavel Alexeev (aka Pahan-Hubbitus) from comment #11)\n> So, we can then just update it to last version and constatate what all three\n> CVE fixed? Right?\n\nYes, the latest version should fix all issues."
							},
							{
								"isprivate": "0",
								"commentid": "6985277",
								"comment_count": "18",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-04-04 13:40:02 +0000",
								"thetext": "As CVE-2014-1947 and CVE-2014-2030 affect different versions, tracking of CVE-2014-2030 was split to a separate bug 1083477."
							},
							{
								"isprivate": "0",
								"commentid": "7012213",
								"comment_count": "19",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-04-15 15:38:00 +0000",
								"thetext": "ImageMagick-6.8.6.3-4.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7402335",
								"comment_count": "20",
								"who": {
									"text": "rdieter",
									"name": "Rex Dieter"
								},
								"bug_when": "2014-08-20 14:41:18 +0000",
								"thetext": "Here's what I'm using for GraphicsMagick, adapting a similar fix (I think):\nhttp://pkgs.fedoraproject.org/cgit/GraphicsMagick.git/tree/GraphicsMagick-1.3.20-CVE-2014-1947.patch\n\ndiff -up GraphicsMagick-1.3.20/coders/psd.c.CVE-2014-1947 GraphicsMagick-1.3.20/coders/psd.c\n--- GraphicsMagick-1.3.20/coders/psd.c.CVE-2014-1947\t2014-08-16 15:33:23.000000000 -0500\n+++ GraphicsMagick-1.3.20/coders/psd.c\t2014-08-20 07:30:08.767862041 -0500\n@@ -1719,8 +1719,7 @@ static unsigned int WritePSDImage(const\n     i;\n \n   unsigned char\n-    *pixels,\n-    layer_name[4];\n+    *pixels;\n \n   unsigned int\n     packet_size,\n@@ -1944,8 +1943,9 @@ static unsigned int WritePSDImage(const\n             (void) WriteBlob(image, 3, &layer_name[1]);\n           */ \n         } else {\n-          (void) sprintf((char *) layer_name, \"L%02d\", layer_count++ );\n-          WritePascalString( image, (char*)layer_name, 4 );\n+          char layer_name[4];\n+          (void) sprintf(layer_name, \"L%02d\", layer_count++ );\n+          WritePascalString( image, layer_name, 4 );\n         }\n         tmp_image = tmp_image->next;\n       };"
							},
							{
								"isprivate": "0",
								"commentid": "7414450",
								"comment_count": "21",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-08-25 09:50:40 +0000",
								"thetext": "(In reply to Rex Dieter from comment #20)\n> Here's what I'm using for GraphicsMagick\n\nWhat is the change supposed to do?  It does not increase the size of layer_name, so more than 99 layers should still lead to overflow as described in comment 10."
							},
							{
								"isprivate": "0",
								"commentid": "7416124",
								"comment_count": "22",
								"who": {
									"text": "rdieter",
									"name": "Rex Dieter"
								},
								"bug_when": "2014-08-25 18:48:27 +0000",
								"thetext": "Oh, indeed, I'd naively thought the main fix was adjusting to a char array (and avoiding the cast).  Does this look better?\n\n--- GraphicsMagick-1.3.20/coders/psd.c.CVE-2014-1947    2014-08-16 15:33:23.000000000 -0500\n+++ GraphicsMagick-1.3.20/coders/psd.c  2014-08-20 07:30:08.767862041 -0500\n@@ -1719,8 +1719,7 @@ static unsigned int WritePSDImage(const\n     i;\n \n   unsigned char\n-    *pixels,\n-    layer_name[4];\n+    *pixels;\n \n   unsigned int\n     packet_size,\n@@ -1944,8 +1943,9 @@ static unsigned int WritePSDImage(const\n             (void) WriteBlob(image, 3, &layer_name[1]);\n           */ \n         } else {\n-          (void) sprintf((char *) layer_name, \"L%02d\", layer_count++ );\n-          WritePascalString( image, (char*)layer_name, 4 );\n+          char layer_name[MaxTextExtent];\n+          (void) sprintf(layer_name, \"L%06ld\", layer_count++ );\n+          WritePascalString( image, layer_name, 4 );\n         }\n         tmp_image = tmp_image->next;\n       };"
							},
							{
								"isprivate": "0",
								"commentid": "7416194",
								"comment_count": "23",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-08-25 19:31:23 +0000",
								"thetext": "(In reply to Rex Dieter from comment #22)\n> Oh, indeed, I'd naively thought the main fix was adjusting to a char array\n> (and avoiding the cast).  Does this look better?\n\nI haven't looked at GM specifically.  In IM, MaxTextExtent is large enough to hold layer name, regardless of whether L%02d or L%06ld format is used."
							},
							{
								"isprivate": "0",
								"commentid": "7426855",
								"comment_count": "24",
								"who": {
									"text": "rdieter",
									"name": "Rex Dieter"
								},
								"bug_when": "2014-08-28 12:51:53 +0000",
								"thetext": "OK, not being intimately familiar with this code either, I'm going back to the original L%02d format variant.  It would appear GM upstream may not be aware of this... I'll try to make some time soon to poke them about it too."
							},
							{
								"isprivate": "0",
								"commentid": "7428016",
								"comment_count": "25",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-08-28 15:34:29 +0000",
								"thetext": "GraphicsMagick-1.3.20-1.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7428268",
								"comment_count": "26",
								"who": {
									"text": "rdieter",
									"name": "Rex Dieter"
								},
								"bug_when": "2014-08-28 15:52:20 +0000",
								"thetext": "This looks like a match,\nhttp://sourceforge.net/p/graphicsmagick/bugs/234/\nadded a comment there, and they responded to me already with some questions."
							},
							{
								"isprivate": "0",
								"commentid": "7429656",
								"comment_count": "27",
								"who": {
									"text": "bfriesen",
									"name": "Bob Friesenhahn"
								},
								"bug_when": "2014-08-29 03:47:12 +0000",
								"thetext": "I just pushed GraphicsMagick changeset 14139:a083f9eeef1d with a patch which is mostly similar to Rex Dieter's patch.  It seems doubtful that this issue is covered by any existing GraphicsMagick bug report.  The PSD code in GraphicsMagick has many unresolved issues."
							},
							{
								"isprivate": "0",
								"commentid": "7463871",
								"comment_count": "28",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-09-09 22:15:43 +0000",
								"thetext": "GraphicsMagick-1.3.20-3.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7477871",
								"comment_count": "29",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-09-14 03:27:04 +0000",
								"thetext": "GraphicsMagick-1.3.20-3.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7497136",
								"comment_count": "30",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-09-18 23:50:39 +0000",
								"thetext": "GraphicsMagick-1.3.20-3.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7497142",
								"comment_count": "31",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-09-18 23:51:04 +0000",
								"thetext": "GraphicsMagick-1.3.20-3.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7673932",
								"comment_count": "32",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-11-14 12:08:25 +0000",
								"thetext": "GraphicsMagick-1.3.20-3.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "6973311",
						"comment_count": "0",
						"who": {
							"text": "scorneli",
							"name": "Stefan Cornelius"
						},
						"bug_when": "2014-04-01 12:56:22 +0000",
						"thetext": "\nThis is an automatically created tracking bug!  It was created to ensure\nthat one or more security vulnerabilities are fixed in affected versions\nof Fedora.\n\nFor comments that are specific to the vulnerability please use bugs filed\nagainst the \"Security Response\" product referenced in the \"Blocks\" field.\n\nFor more information see:\nhttp://fedoraproject.org/wiki/Security/TrackingBugs\n\nWhen creating a Bodhi update request, please use the bodhi submission link\nnoted in the next comment(s).  This will include the bug IDs of this\ntracking bug as well as the relevant top-level CVE bugs.\n\nPlease also mention the CVE IDs being fixed in the RPM changelog and the\nBodhi notes field when available.\n\nPlease note: this issue affects multiple supported versions of Fedora.\nOnly one tracking bug has been filed; please ensure that it is only closed\nwhen all affected versions are fixed.\n\n[bug automatically created by: add-tracking-bugs]"
					},
					{
						"isprivate": "0",
						"commentid": "6973313",
						"comment_count": "1",
						"who": {
							"text": "scorneli",
							"name": "Stefan Cornelius"
						},
						"bug_when": "2014-04-01 12:56:33 +0000",
						"thetext": "\nPlease use the following update submission link to create the Bodhi\nrequest for this issue as it contains the top-level parent bug(s) as well\nas this tracking bug.  This will ensure that all associated bugs get\nupdated when new packages are pushed to stable.\n\nPlease also ensure that the \"Close bugs when update is stable\" option\nremains checked.\n\nBodhi update submission link:\nhttps://admin.fedoraproject.org/updates/new/?type_=security&bugs=1064098,1083082"
					},
					{
						"isprivate": "0",
						"commentid": "7402303",
						"comment_count": "2",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-08-20 14:36:18 +0000",
						"thetext": "GraphicsMagick-1.3.20-1.fc20 has been submitted as an update for Fedora 20.\nhttps://admin.fedoraproject.org/updates/GraphicsMagick-1.3.20-1.fc20"
					},
					{
						"isprivate": "0",
						"commentid": "7402306",
						"comment_count": "3",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-08-20 14:36:46 +0000",
						"thetext": "GraphicsMagick-1.3.20-1.fc19 has been submitted as an update for Fedora 19.\nhttps://admin.fedoraproject.org/updates/GraphicsMagick-1.3.20-1.fc19"
					},
					{
						"isprivate": "0",
						"commentid": "7405371",
						"comment_count": "4",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-08-21 09:42:27 +0000",
						"thetext": "Package GraphicsMagick-1.3.20-1.fc20:\n* should fix your issue,\n* was pushed to the Fedora 20 testing repository,\n* should be available at your local mirror within two days.\nUpdate it with:\n# su -c 'yum update --enablerepo=updates-testing GraphicsMagick-1.3.20-1.fc20'\nas soon as you are able to.\nPlease go to the following url:\nhttps://admin.fedoraproject.org/updates/FEDORA-2014-9596/GraphicsMagick-1.3.20-1.fc20\nthen log in and leave karma (feedback)."
					},
					{
						"isprivate": "0",
						"commentid": "7428015",
						"comment_count": "5",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-08-28 15:34:26 +0000",
						"thetext": "GraphicsMagick-1.3.20-1.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7428263",
						"comment_count": "6",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-08-28 15:50:15 +0000",
						"thetext": "GraphicsMagick-1.3.20-3.fc20 has been submitted as an update for Fedora 20.\nhttps://admin.fedoraproject.org/updates/GraphicsMagick-1.3.20-3.fc20"
					},
					{
						"isprivate": "0",
						"commentid": "7463870",
						"comment_count": "7",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-09-09 22:15:41 +0000",
						"thetext": "GraphicsMagick-1.3.20-3.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7477870",
						"comment_count": "8",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-09-14 03:27:02 +0000",
						"thetext": "GraphicsMagick-1.3.20-3.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7653499",
						"comment_count": "9",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-08 18:34:19 +0000",
						"thetext": "GraphicsMagick-1.3.20-3.fc21 has been submitted as an update for Fedora 21.\nhttps://admin.fedoraproject.org/updates/GraphicsMagick-1.3.20-3.fc21"
					},
					{
						"isprivate": "0",
						"commentid": "7673930",
						"comment_count": "10",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-14 12:08:21 +0000",
						"thetext": "GraphicsMagick-1.3.20-3.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
					}
				]
			}
		},
		{
			"bug_id": 1161869,
			"title": "GraphicsMagick-1.3.20-3 requires jbigkit-libs and libwepb",
			"bugzilla": {
				"bug_id": "1161869",
				"creation_ts": "2014-11-08 16:26:26 +0000",
				"short_desc": "GraphicsMagick-1.3.20-3 requires jbigkit-libs and libwepb",
				"delta_ts": "2014-11-14 12:08:23 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"priority": "unspecified",
				"bug_severity": "unspecified",
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "7653419",
						"comment_count": "0",
						"who": {
							"text": "casper",
							"name": "Matthieu Saulnier"
						},
						"bug_when": "2014-11-08 16:26:26 +0000",
						"thetext": "Description of problem:\nFedup f20 => f21 by network with nonproduct options fail because of this broken dependancy\n\n\nVersion-Release number of selected component (if applicable):\nGraphicsMagick-1.3.20-3.fc20.x86_64 requires jbigkit-libs2.0-10.fc20.x86_64 and\nlibwepb-0.3.1-3.fc20.x86_64\n\n\nHow reproducible:\nalways\n\n\nSteps to Reproduce:\n1.\n2.\n3.\n\nActual results:\n\n\nExpected results:\n\n\nAdditional info:"
					},
					{
						"isprivate": "0",
						"commentid": "7653497",
						"comment_count": "1",
						"who": {
							"text": "rdieter",
							"name": "Rex Dieter"
						},
						"bug_when": "2014-11-08 18:32:14 +0000",
						"thetext": "OK, looks like upgrade path issue, I'll issue f21 updates."
					},
					{
						"isprivate": "0",
						"commentid": "7653500",
						"comment_count": "2",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-08 18:35:17 +0000",
						"thetext": "GraphicsMagick-1.3.20-3.fc21 has been submitted as an update for Fedora 21.\nhttps://admin.fedoraproject.org/updates/GraphicsMagick-1.3.20-3.fc21"
					},
					{
						"isprivate": "0",
						"commentid": "7655347",
						"comment_count": "3",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-10 06:39:05 +0000",
						"thetext": "Package GraphicsMagick-1.3.20-3.fc21:\n* should fix your issue,\n* was pushed to the Fedora 21 testing repository,\n* should be available at your local mirror within two days.\nUpdate it with:\n# su -c 'yum update --enablerepo=updates-testing GraphicsMagick-1.3.20-3.fc21'\nas soon as you are able to.\nPlease go to the following url:\nhttps://admin.fedoraproject.org/updates/FEDORA-2014-14617/GraphicsMagick-1.3.20-3.fc21\nthen log in and leave karma (feedback)."
					},
					{
						"isprivate": "0",
						"commentid": "7673931",
						"comment_count": "4",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-14 12:08:23 +0000",
						"thetext": "GraphicsMagick-1.3.20-3.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
					}
				]
			}
		}
	],
	"builds": [
		{
			"nvr": "GraphicsMagick-1.3.20-3.fc21",
			"signed": true,
			"type": "rpm",
			"package": {
				"armv7hl": [
					{
						"name": "GraphicsMagick-devel",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "armv7hl"
					},
					{
						"name": "GraphicsMagick-debuginfo",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "armv7hl"
					},
					{
						"name": "GraphicsMagick-perl",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "armv7hl"
					},
					{
						"name": "GraphicsMagick-c++-devel",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "armv7hl"
					},
					{
						"name": "GraphicsMagick",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "armv7hl"
					},
					{
						"name": "GraphicsMagick-c++",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "armv7hl"
					}
				],
				"i686": [
					{
						"name": "GraphicsMagick-debuginfo",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "i686"
					},
					{
						"name": "GraphicsMagick-c++-devel",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "i686"
					},
					{
						"name": "GraphicsMagick-perl",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "i686"
					},
					{
						"name": "GraphicsMagick-c++",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "i686"
					},
					{
						"name": "GraphicsMagick",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "i686"
					},
					{
						"name": "GraphicsMagick-devel",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "i686"
					}
				],
				"noarch": [
					{
						"name": "GraphicsMagick-doc",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "noarch"
					}
				],
				"src": [
					{
						"name": "GraphicsMagick",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "src"
					}
				],
				"x86_64": [
					{
						"name": "GraphicsMagick-devel",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "x86_64"
					},
					{
						"name": "GraphicsMagick-c++-devel",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "x86_64"
					},
					{
						"name": "GraphicsMagick-c++",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "x86_64"
					},
					{
						"name": "GraphicsMagick-debuginfo",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "x86_64"
					},
					{
						"name": "GraphicsMagick-perl",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "x86_64"
					},
					{
						"name": "GraphicsMagick",
						"version": "1.3.20",
						"release": "3.fc21",
						"arch": "x86_64"
					}
				]
			}
		}
	],
	"close_bugs": true,
	"comments": [
		{
			"id": 220867,
			"text": "This update has been submitted for testing by rdieter. ",
			"timestamp": "2014-11-08 18:34:23",
			"update_id": 27904,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 220868,
			"text": "Taskotron: depcheck test PASSED on i386. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/9986/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2014-11-08 18:51:48",
			"update_id": 27904,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/8cba34b3793397cca75782c70d6a4c3af6fc4c8e7d502fad36609e3b4b4670f9?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 220869,
			"text": "Taskotron: depcheck test PASSED on x86_64. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/9986/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2014-11-08 18:53:02",
			"update_id": 27904,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/8cba34b3793397cca75782c70d6a4c3af6fc4c8e7d502fad36609e3b4b4670f9?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 220870,
			"text": "This update is currently being pushed to the Fedora 21 testing updates repository.",
			"timestamp": "2014-11-09 17:41:17",
			"update_id": 27904,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 220871,
			"text": "This update is currently being pushed to the Fedora 21 testing updates repository.",
			"timestamp": "2014-11-09 17:55:50",
			"update_id": 27904,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 220872,
			"text": "This update has been pushed to testing",
			"timestamp": "2014-11-10 06:39:05",
			"update_id": 27904,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 220873,
			"text": "This update has reached 3 days in testing and can be pushed to stable now if the maintainer wishes",
			"timestamp": "2014-11-13 12:12:35",
			"update_id": 27904,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 220874,
			"text": "This update has been submitted for stable by rdieter. ",
			"timestamp": "2014-11-13 12:16:05",
			"update_id": 27904,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 220875,
			"text": "Taskotron: upgradepath test PASSED on noarch. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/12251/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2014-11-13 12:27:30",
			"update_id": 27904,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/8cba34b3793397cca75782c70d6a4c3af6fc4c8e7d502fad36609e3b4b4670f9?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 220876,
			"text": "This update is currently being pushed to the Fedora 21 stable updates repository.",
			"timestamp": "2014-11-13 22:31:35",
			"update_id": 27904,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 220877,
			"text": "This update has been pushed to stable",
			"timestamp": "2014-11-14 12:08:26",
			"update_id": 27904,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		}
	],
	"content_type": "rpm",
	"date_modified": "2014-11-08 18:35:15",
	"date_pushed": "2014-11-14 12:08:26",
	"date_stable": "2014-11-14 12:08:26",
	"date_submitted": "2014-11-08 18:34:17",
	"date_testing": "2014-11-10 06:39:05",
	"notes": "Fix for psd security issue, and upgrade path to f21.",
	"pushed": true,
	"release": {
		"branch": "f21",
		"candidate_tag": "f21-updates-candidate",
		"composed_by_bodhi": true,
		"dist_tag": "f21",
		"id_prefix": "FEDORA",
		"long_name": "Fedora 21",
		"mail_template": "fedora_errata_template",
		"name": "F21",
		"override_tag": "f21-override",
		"package_manager": "dnf",
		"pending_stable_tag": "f21-updates-pending",
		"pending_testing_tag": "f21-updates-testing-pending",
		"stable_tag": "f21-updates",
		"state": "archived",
		"testing_repository": "updates-testing",
		"testing_tag": "f21-updates-testing",
		"version": "21"
	},
	"severity": "unspecified",
	"stable_karma": 3,
	"status": "stable",
	"suggest": "unspecified",
	"title": "GraphicsMagick-1.3.20-3.fc21",
	"type": "security",
	"url": "https://bodhi.fedoraproject.org/updates/FEDORA-2014-14617",
	"unstable_karma": -3,
	"updateid": "FEDORA-2014-14617",
	"user": {
		"avatar": "https://seccdn.libravatar.org/avatar/e00cfde0448d2d8a114d4ec742fd1981de0a23cab380b73bafea35a78bc0c663?s=24&d=retro",
		"email": "rdieter@gmail.com",
		"groups": [
			{
				"name": "proventesters"
			},
			{
				"name": "provenpackager"
			},
			{
				"name": "packager"
			},
			{
				"name": "kde-sig"
			},
			{
				"name": "lxqt-sig"
			},
			{
				"name": "gitthemes"
			},
			{
				"name": "gitkde"
			},
			{
				"name": "svnfedora-kde-artwork"
			},
			{
				"name": "gitfedora-mate"
			},
			{
				"name": "fedorabugs"
			},
			{
				"name": "gitspin-kickstarts"
			},
			{
				"name": "fedora-contributor"
			},
			{
				"name": "signed_fpca"
			},
			{
				"name": "epel-wranglers"
			},
			{
				"name": "ambassadors"
			},
			{
				"name": "scitech_sig"
			},
			{
				"name": "gitlivecd"
			},
			{
				"name": "svnkde-settings"
			},
			{
				"name": "scitech"
			},
			{
				"name": "ipausers"
			},
			{
				"name": "designteam"
			}
		],
		"id": 155,
		"name": "rdieter",
		"openid": "rdieter.id.fedoraproject.org"
	},
	"version_hash": "691d5d012b59dca5020c6814833fdc58504a1f99"
}
