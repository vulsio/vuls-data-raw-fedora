{
	"alias": "FEDORA-2014-14347",
	"bugs": [
		{
			"bug_id": 1038413,
			"title": "fedup stage2 keymap will always be US again for F20-F21 due to anaconda not writing vconsole.keymap kernel parameter any more (#1035316)",
			"bugzilla": {
				"bug_id": "1038413",
				"creation_ts": "2013-12-05 05:14:28 +0000",
				"short_desc": "fedup stage2 keymap will always be US again for F20-F21 due to anaconda not writing vconsole.keymap kernel parameter any more (#1035316)",
				"delta_ts": "2014-11-10 06:02:48 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "i18n",
				"priority": "unspecified",
				"bug_severity": "high",
				"blocked": [
					{
						"bug_id": "1043124",
						"alias": "F21BetaBlocker",
						"creation_ts": "2013-12-14 01:46:29 +0000",
						"short_desc": "Fedora 21 Beta blocker bug tracker",
						"delta_ts": "2020-08-12 13:11:45 +0000",
						"bug_status": "CLOSED",
						"resolution": "CURRENTRELEASE",
						"keywords": "Tracking",
						"priority": "unspecified",
						"bug_severity": "unspecified",
						"depends_on": [
							"811967",
							"1003122",
							"1038413",
							"1068802",
							"1083867",
							"1088933",
							"1099299",
							"1101341",
							"1116316",
							"1118504",
							"1121383",
							"1121409",
							"1127510",
							"1128605",
							"1129629",
							"1130247",
							"1130758",
							"1131651",
							"1134389",
							"1138967",
							"1139962",
							"1141398",
							"1141707",
							"1142512",
							"1143864",
							"1144040",
							"1145664",
							"1145783",
							"1146580",
							"1147998",
							"1148087",
							"1148923",
							"1148930",
							"1150147",
							"1153813",
							"1153816",
							"1154138",
							"1154235",
							"1155014",
							"1155301",
							"1155304",
							"1155329",
							"1156073",
							"1156198",
							"1156354",
							"1156378",
							"1156380",
							"1156603",
							"1157864",
							"1158592"
						],
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "6619466",
								"comment_count": "0",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2013-12-14 01:46:29 +0000",
								"thetext": "Fedora 21 Beta blocker tracker bug, as per http://fedoraproject.org/wiki/BugZappers/HouseKeeping/Trackers\n\nTo propose a bug as blocking the Fedora 21 Beta release, mark it as blocking this bug (or use the webapp: https://qa.fedoraproject.org/blockerbugs/propose_bug ). It will be reviewed per https://fedoraproject.org/wiki/QA:SOP_blocker_bug_process . To propose a bug as a 'freeze exception' for the Beta release - allowing a fix to go through the Alpha freeze, but not blocking the release - mark it as blocking the bug F21BetaFreezeException . See https://fedoraproject.org/wiki/QA:SOP_freeze_exception_bug_process for the freeze exception process."
							},
							{
								"isprivate": "0",
								"commentid": "7738191",
								"comment_count": "3",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2014-12-05 18:50:57 +0000",
								"thetext": "F21 is done."
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "6587118",
						"comment_count": "0",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2013-12-05 05:14:28 +0000",
						"thetext": "In https://bugzilla.redhat.com/show_bug.cgi?id=1035316 , we decided to stop writing vconsole.keymap=(user's layout) to grub2.cfg again, because it's no longer needed for the original purpose, and doing it was preventing you changing the layout post-install cleanly.\n\nHowever, after working on https://bugzilla.redhat.com/show_bug.cgi?id=881624 for the last two days, I think that unless we compensate, this change will unfortunately break that *again*, for yet another different reason.\n\nupgrade.img, being a generic initramfs, does not include a vconsole.conf that reflects the configuration of the system being upgraded. Obviously, we can't read vconsole.conf from the installed system before decrypting it if it's encrypted. But fedup uses new-kernel-pkg to set up its grub2.cfg line, so as long as anaconda's writing 'vconsole.keymap' to grub2.cfg (and the user doesn't remove it), fedup's boot entry will get it too. So when we boot to fedup stage2, we do know what the user's chosen layout is (or at least, the one they chose when first installing the system...) because it's on the cmdline. Whew.\n\nNow we're not going to write that any more, though, I think fedup stage2 will have no keyboard layout configuration to read from anywhere.\n\nThe only way I can think of to deal with this would be for fedup to somehow get the configuration into the stage2 environment somehow: either modify the initramfs, or read it from vconsole.conf and write it into grub.cfg. But maybe there's a possibility I missed.\n\nAs we took this as a blocker for F20, nominating it as an F21 Beta blocker pre-emptively."
					},
					{
						"isprivate": "0",
						"commentid": "6587120",
						"comment_count": "1",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2013-12-05 05:15:29 +0000",
						"thetext": "well, shoot, I didn't create the F21 blocker trackers yet..."
					},
					{
						"isprivate": "0",
						"commentid": "6589936",
						"comment_count": "2",
						"who": {
							"text": "wwoods",
							"name": "Will Woods"
						},
						"bug_when": "2013-12-05 18:55:38 +0000",
						"thetext": "The plan for future fedup stuff is to have a facility for grabbing files from the local system and cramming them into the initramfs before reboot.\n\nThis facility would want to do exactly what dracut does when it pulls system files into the initramfs it's building. Which suggests that stuff should be factored out of dracut (or at least made available outside of dracut).\n\nThis would also be needed in the case of, say, 3rd party storage modules - you're going to need some way to get your module crammed into the upgrade.img if you want upgrade.img to be able to mount the root device.\n\n\nAside about \"stage2\": Fedup only uses one image, so there's no stage1/stage2 split like anaconda. There *is* a split between:\n  1) the part that sets up the system (\"fedup\", \"fedup-cli\", \"download tool\")\n  2) the part that actually does the upgrade (\"fedup-dracut\", \"upgrade.img\"),\n     which (confusingly) has *three* stages:\n     a) initramfs finds, maybe unlocks, and mounts root \n     b) inside the root device, we set up all the system's mounts\n     c) back in initramfs, with the disks all mounted, we run the upgrade\nSo \"stage2\" is kind of ambiguous, but I assume you mean 2a) - upgrade.img trying to mount root."
					},
					{
						"isprivate": "0",
						"commentid": "6589969",
						"comment_count": "3",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2013-12-05 19:13:10 +0000",
						"thetext": "OK. So, do we need an RFE on dracut (probably upstream) to factor that out? Or were you planning on submitting a patch or something?\n\nIn the scenario where that doesn't get done in time for F21, can we consider something which checks via localed or reading vconsole.conf what the keyboard layout is, and writing it into the kernel parameters? This shouldn't be too hard, as new-kernel-pkg has a parameter for it: \"--kernel-args=args\" . So the bare bones would just be to read 'KEYMAP=' out of vconsole.conf or ask localed for the VC keymap (it has a python interface IIRC, or you can grep localectl output, I guess), and pass the value found (if anything) to --kernel-args rd.vconsole.keymap= or --kernel-args vconsole.keymap= in fedup's new-kernel-pkg call, I think. \n\nIf there's already a vconsole.keymap parameter in the cmdline...I guess we shouldn't write any additional parameter, to be consistent with what would be the normal case in such a configuration...\n\nOn the aside: thanks, I wasn't sure what the terminology was. Indeed, by 'stage2' I meant your '2a)'."
					},
					{
						"isprivate": "0",
						"commentid": "6589971",
						"comment_count": "4",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2013-12-05 19:14:57 +0000",
						"thetext": "oh, hum, now I look at it, --kernel-args might not be 'add these args' but 'only use these args', which wouldn't be what we want. I see a '--remove-args' but not a '--add-args' or anything. Still, I haven't tested, just reading the manpage."
					},
					{
						"isprivate": "0",
						"commentid": "6601652",
						"comment_count": "5",
						"who": {
							"text": "harald",
							"name": "Harald Hoyer"
						},
						"bug_when": "2013-12-10 12:20:41 +0000",
						"thetext": "The dracut package of https://bugzilla.redhat.com/show_bug.cgi?id=881624#c64 _does_ include vconsole.conf in the generic initramfs as mentioned in https://bugzilla.redhat.com/show_bug.cgi?id=881624#c60"
					},
					{
						"isprivate": "0",
						"commentid": "6602789",
						"comment_count": "6",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2013-12-10 16:36:25 +0000",
						"thetext": "Not really relevant here. Upgrades use an initramfs built by releng via pungi. It is not built on the host being upgraded. If the upgrade initramfs environment needs to know something about the host configuration, fedup has to provide that information to it somehow, which is what we talked about in c#2."
					},
					{
						"isprivate": "0",
						"commentid": "7045423",
						"comment_count": "7",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-04-28 15:00:42 +0000",
						"thetext": "I believe Michael Catanzaro may be hitting this now: https://bugzilla.redhat.com/show_bug.cgi?id=881624#c71 ."
					},
					{
						"isprivate": "0",
						"commentid": "7046609",
						"comment_count": "8",
						"who": {
							"text": "mcatanzaro+wrong-account-do-not-cc",
							"name": "Michael Catanzaro"
						},
						"bug_when": "2014-04-28 22:16:56 +0000",
						"thetext": "*** Bug 1091615 has been marked as a duplicate of this bug. ***"
					},
					{
						"isprivate": "0",
						"commentid": "7060323",
						"comment_count": "9",
						"who": {
							"text": "mcatanzaro+wrong-account-do-not-cc",
							"name": "Michael Catanzaro"
						},
						"bug_when": "2014-05-05 00:56:14 +0000",
						"thetext": "I can confirm Adam's theory. When booting the \"Upgrade System\" entry while attempting to upgrade from F20 to rawhide using Fedup, I am able to decrypt my disk if and only if I manually specify vconsole.keymap on the kernel command line."
					},
					{
						"isprivate": "0",
						"commentid": "7062652",
						"comment_count": "10",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-05-05 15:40:10 +0000",
						"thetext": "nominating as an F21 Beta blocker, criterion \"For each one of the release-blocking package sets, it must be possible to successfully complete an upgrade from a fully updated installation of the previous stable Fedora release with that package set installed.\", https://fedoraproject.org/wiki/Fedora_21_Beta_Release_Criteria#Upgrade_requirements\n\nThis is a partial violation affecting cases where a storage volume is encrypted using a password that is entered differently on the systemwide configured keyboard layout than it is on the US English layout. \n\nNote the last incarnation of https://bugzilla.redhat.com/show_bug.cgi?id=881624 was accepted as an F20 Final blocker."
					},
					{
						"isprivate": "0",
						"commentid": "7065817",
						"comment_count": "11",
						"who": {
							"text": "wwoods",
							"name": "Will Woods"
						},
						"bug_when": "2014-05-06 13:57:44 +0000",
						"thetext": "So, what file(s) are needed to make this work?"
					},
					{
						"isprivate": "0",
						"commentid": "7066187",
						"comment_count": "12",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-05-06 15:28:57 +0000",
						"thetext": "For this particular case, /etc/vconsole.conf . I suppose it's possible the upgrade environment may also benefit from having the correct /etc/locale.conf available, though I can't immediately see how it'd be significant (locale-dependent behaviour in package scripts?)"
					},
					{
						"isprivate": "0",
						"commentid": "7477347",
						"comment_count": "13",
						"who": {
							"text": "mcatanzaro+wrong-account-do-not-cc",
							"name": "Michael Catanzaro"
						},
						"bug_when": "2014-09-13 02:40:50 +0000",
						"thetext": "I can boot my newly-installed F21 as long as I pick my keyboard layout before typing my encryption password... so this seems to have somehow been fixed."
					},
					{
						"isprivate": "0",
						"commentid": "7512226",
						"comment_count": "14",
						"who": {
							"text": "mcatanzaro+wrong-account-do-not-cc",
							"name": "Michael Catanzaro"
						},
						"bug_when": "2014-09-23 21:02:02 +0000",
						"thetext": "(In reply to Michael Catanzaro from comment #13)\n> I can boot my newly-installed F21 as long as I pick my keyboard layout\n> before typing my encryption password... so this seems to have somehow been\n> fixed.\n\nIgnore me; I wasn't using fedup...."
					},
					{
						"isprivate": "0",
						"commentid": "7544064",
						"comment_count": "15",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-10-03 16:18:41 +0000",
						"thetext": "Discussed at 2014-10-03 blocker review meeting: http://meetbot.fedoraproject.org/fedora-blocker-review/2014-10-03/f21-blocker-review.2014-10-03-15.58.log.txt . Accepted as a blocker as proposed in c#10, though once fedup is fixed for other bugs, we should verify it's broken 'as expected'."
					},
					{
						"isprivate": "0",
						"commentid": "7555504",
						"comment_count": "16",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-10-08 17:01:36 +0000",
						"thetext": "Discussed at 2014-10-08 blocker review meeting: http://meetbot.fedoraproject.org/fedora-blocker-review/2014-10-08/f21-blocker-review.2014-10-08-15.58.log.txt . We're still waiting on fedup fixes to test this one."
					},
					{
						"isprivate": "0",
						"commentid": "7568451",
						"comment_count": "17",
						"who": {
							"text": "wwoods",
							"name": "Will Woods"
						},
						"bug_when": "2014-10-13 17:50:27 +0000",
						"thetext": "This should be fixed by commit c2cc421 in fedup: \n  \n  https://github.com/wgwoods/fedup/commit/c2cc421"
					},
					{
						"isprivate": "0",
						"commentid": "7580731",
						"comment_count": "18",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-10-15 21:13:07 +0000",
						"thetext": "Thanks, Will. I'll test it once we have a fix for the udev issue."
					},
					{
						"isprivate": "0",
						"commentid": "7623818",
						"comment_count": "19",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-10-29 21:10:24 +0000",
						"thetext": "fedup-0.9.0-1.fc21 has been submitted as an update for Fedora 21.\nhttps://admin.fedoraproject.org/updates/fedup-0.9.0-1.fc21"
					},
					{
						"isprivate": "0",
						"commentid": "7623836",
						"comment_count": "20",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-10-29 21:11:40 +0000",
						"thetext": "fedup-0.9.0-1.fc20 has been submitted as an update for Fedora 20.\nhttps://admin.fedoraproject.org/updates/fedup-0.9.0-1.fc20"
					},
					{
						"isprivate": "0",
						"commentid": "7623840",
						"comment_count": "21",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-10-29 21:12:41 +0000",
						"thetext": "fedup-0.9.0-1.fc19 has been submitted as an update for Fedora 19.\nhttps://admin.fedoraproject.org/updates/fedup-0.9.0-1.fc19"
					},
					{
						"isprivate": "0",
						"commentid": "7625227",
						"comment_count": "22",
						"who": {
							"text": "kparal",
							"name": "Kamil Páral"
						},
						"bug_when": "2014-10-30 09:08:40 +0000",
						"thetext": "This is fixed with fedup-0.9.0-1.fc20."
					},
					{
						"isprivate": "0",
						"commentid": "7631468",
						"comment_count": "23",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-01 01:40:02 +0000",
						"thetext": "fedup-0.9.0-1.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7636180",
						"comment_count": "24",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-03 18:05:32 +0000",
						"thetext": "fedup-0.9.0-2.fc19 has been submitted as an update for Fedora 19.\nhttps://admin.fedoraproject.org/updates/fedup-0.9.0-2.fc19"
					},
					{
						"isprivate": "0",
						"commentid": "7636188",
						"comment_count": "25",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-03 18:05:49 +0000",
						"thetext": "fedup-0.9.0-2.fc21 has been submitted as an update for Fedora 21.\nhttps://admin.fedoraproject.org/updates/fedup-0.9.0-2.fc21"
					},
					{
						"isprivate": "0",
						"commentid": "7641585",
						"comment_count": "26",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-05 02:31:02 +0000",
						"thetext": "The update is stable for 19 and 20 already, Will can push it stable for 21 soon enough."
					},
					{
						"isprivate": "0",
						"commentid": "7641691",
						"comment_count": "27",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-05 03:57:25 +0000",
						"thetext": "fedup-0.9.0-2.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7655072",
						"comment_count": "28",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-10 06:02:48 +0000",
						"thetext": "fedup-0.9.0-2.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
					}
				]
			}
		},
		{
			"bug_id": 1066679,
			"parent": true,
			"security": true,
			"title": "CVE-2013-6494 fedup: /var/tmp/fedora-upgrade temporary directory creation vulnerability",
			"bugzilla": {
				"bug_id": "1066679",
				"alias": "CVE-2013-6494",
				"creation_ts": "2014-02-18 21:50:24 +0000",
				"short_desc": "CVE-2013-6494 fedup: /var/tmp/fedora-upgrade temporary directory creation vulnerability",
				"delta_ts": "2019-09-29 13:13:54 +0000",
				"bug_status": "CLOSED",
				"resolution": "CURRENTRELEASE",
				"keywords": "Security",
				"priority": "low",
				"bug_severity": "low",
				"depends_on": [
					"1067295"
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "6832301",
						"comment_count": "0",
						"who": {
							"text": "kseifried",
							"name": "Kurt Seifried"
						},
						"bug_when": "2014-02-18 21:50:24 +0000",
						"thetext": "Michael Scherer of Red Hat reports:\n\nWhile trying to upgrade my F19 to F20 using fedup, I noticed that it use\na directory in /var/tmp/, with a fixed known name.\n\ncachedir = '/var/tmp/fedora-upgrade'"
					},
					{
						"isprivate": "0",
						"commentid": "6837863",
						"comment_count": "1",
						"who": {
							"text": "kseifried",
							"name": "Kurt Seifried"
						},
						"bug_when": "2014-02-20 07:08:50 +0000",
						"thetext": "One note, in fedup 0.8.0 (F20) the directory is now /var/tmp/system-upgrade"
					},
					{
						"isprivate": "0",
						"commentid": "6837885",
						"comment_count": "2",
						"who": {
							"text": "kseifried",
							"name": "Kurt Seifried"
						},
						"bug_when": "2014-02-20 07:17:37 +0000",
						"thetext": "Filed a bug upstream:\n\nhttps://github.com/wgwoods/fedup/issues/44"
					},
					{
						"isprivate": "0",
						"commentid": "6837892",
						"comment_count": "3",
						"who": {
							"text": "kseifried",
							"name": "Kurt Seifried"
						},
						"bug_when": "2014-02-20 07:18:31 +0000",
						"thetext": "\nCreated fedup tracking bugs for this issue:\n\nAffects: fedora-all [bug 1067295]"
					},
					{
						"isprivate": "0",
						"commentid": "7631470",
						"comment_count": "4",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-01 01:40:06 +0000",
						"thetext": "fedup-0.9.0-1.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7641693",
						"comment_count": "5",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-05 03:57:29 +0000",
						"thetext": "fedup-0.9.0-2.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7655074",
						"comment_count": "6",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-10 06:02:53 +0000",
						"thetext": "fedup-0.9.0-2.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "8128456",
						"comment_count": "7",
						"who": {
							"text": "wwoods",
							"name": "Will Woods"
						},
						"bug_when": "2015-04-09 18:19:30 +0000",
						"thetext": "Fixed in fedup-0.9.0:\n\n   https://admin.fedoraproject.org/updates/search/CVE-2013-6494"
					}
				]
			}
		},
		{
			"bug_id": 1153816,
			"title": "Fedup needs to support upgrading into a Productized Fedora 21",
			"bugzilla": {
				"bug_id": "1153816",
				"creation_ts": "2014-10-16 20:58:11 +0000",
				"short_desc": "Fedup needs to support upgrading into a Productized Fedora 21",
				"delta_ts": "2014-11-10 06:02:51 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"priority": "unspecified",
				"bug_severity": "urgent",
				"blocked": [
					{
						"bug_id": "1043124",
						"alias": "F21BetaBlocker",
						"creation_ts": "2013-12-14 01:46:29 +0000",
						"short_desc": "Fedora 21 Beta blocker bug tracker",
						"delta_ts": "2020-08-12 13:11:45 +0000",
						"bug_status": "CLOSED",
						"resolution": "CURRENTRELEASE",
						"keywords": "Tracking",
						"priority": "unspecified",
						"bug_severity": "unspecified",
						"depends_on": [
							"811967",
							"1003122",
							"1038413",
							"1068802",
							"1083867",
							"1088933",
							"1099299",
							"1101341",
							"1116316",
							"1118504",
							"1121383",
							"1121409",
							"1127510",
							"1128605",
							"1129629",
							"1130247",
							"1130758",
							"1131651",
							"1134389",
							"1138967",
							"1139962",
							"1141398",
							"1141707",
							"1142512",
							"1143864",
							"1144040",
							"1145664",
							"1145783",
							"1146580",
							"1147998",
							"1148087",
							"1148923",
							"1148930",
							"1150147",
							"1153813",
							"1153816",
							"1154138",
							"1154235",
							"1155014",
							"1155301",
							"1155304",
							"1155329",
							"1156073",
							"1156198",
							"1156354",
							"1156378",
							"1156380",
							"1156603",
							"1157864",
							"1158592"
						],
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "6619466",
								"comment_count": "0",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2013-12-14 01:46:29 +0000",
								"thetext": "Fedora 21 Beta blocker tracker bug, as per http://fedoraproject.org/wiki/BugZappers/HouseKeeping/Trackers\n\nTo propose a bug as blocking the Fedora 21 Beta release, mark it as blocking this bug (or use the webapp: https://qa.fedoraproject.org/blockerbugs/propose_bug ). It will be reviewed per https://fedoraproject.org/wiki/QA:SOP_blocker_bug_process . To propose a bug as a 'freeze exception' for the Beta release - allowing a fix to go through the Alpha freeze, but not blocking the release - mark it as blocking the bug F21BetaFreezeException . See https://fedoraproject.org/wiki/QA:SOP_freeze_exception_bug_process for the freeze exception process."
							},
							{
								"isprivate": "0",
								"commentid": "7738191",
								"comment_count": "3",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2014-12-05 18:50:57 +0000",
								"thetext": "F21 is done."
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "7584158",
						"comment_count": "0",
						"who": {
							"text": "sgallagh",
							"name": "Stephen Gallagher"
						},
						"bug_when": "2014-10-16 20:58:11 +0000",
						"thetext": "Fedora 20 -> 21 upgrades requires that the user select which product (or nonproduct) that they want to upgrade to. Fedup needs to be updated to support this.\n\nThis BZ is a tracker for that effort so we get it done in time for F21 Beta."
					},
					{
						"isprivate": "0",
						"commentid": "7584159",
						"comment_count": "1",
						"who": {
							"text": "blockerbugs",
							"name": "Fedora Blocker Bugs Application"
						},
						"bug_when": "2014-10-16 20:59:40 +0000",
						"thetext": "Proposed as a Blocker for 21-beta by Fedora user sgallagh using the blocker tracking app because:\n\n \"For each one of the release-blocking package sets, it must be possible to successfully complete an upgrade from a fully updated installation of the previous stable Fedora release with that package set installed. The user must be made to specify which Product (or none) they wish to have running when upgrade is complete.\" (Proposed critertion in discussion)\n\nThis fix will go into F20, not F21 so it is not technically bound by the freeze, but since we should not ship Beta without this working, it should be on the blocker lists for tracking purposes."
					},
					{
						"isprivate": "0",
						"commentid": "7587826",
						"comment_count": "2",
						"who": {
							"text": "wwoods",
							"name": "Will Woods"
						},
						"bug_when": "2014-10-17 19:40:43 +0000",
						"thetext": "This is fixed in fedup git:\n\n  https://github.com/wgwoods/fedup/commit/28c71ea\n\nIf you're testing from git, note that the full upgrade process might not work as expected at the moment because:\n\n  a) platform packages don't have the right names/Provides (bug 1153813)\n  b) systemd/udevd troubles (bug 1146140)\n\nStill, the code's all there and it seems to be doing the thing, so this will be fixed by the next fedup build."
					},
					{
						"isprivate": "0",
						"commentid": "7592308",
						"comment_count": "3",
						"who": {
							"text": "kparal",
							"name": "Kamil Páral"
						},
						"bug_when": "2014-10-20 16:24:37 +0000",
						"thetext": "Discussed in 2014-10-20 Blocker Review meeting [1]. Accepted as a blocker. Upgrades from Fedora 20 to Fedora 21 requires the selection of a Product or an explicit choice to remain non-productized. This criteria must be satisfied for Beta release.\n\n[1] http://meetbot.fedoraproject.org/fedora-blocker-review/2014-10-20/"
					},
					{
						"isprivate": "0",
						"commentid": "7611726",
						"comment_count": "4",
						"who": {
							"text": "kevin",
							"name": "Kevin Kofler"
						},
						"bug_when": "2014-10-26 05:58:34 +0000",
						"thetext": "Why do we want to force users to explicitly opt-out of the new Products when upgrading? If they haven't explicitly asked for a Product, they should just get upgraded to nonproduct by default. They have installed Fedora, not \"Fedora Workstation\", \"Fedora Server\" nor \"Fedora Cloud\".\n\nThe point of an upgrade is to preserve the existing installed package set as much as possible. (Otherwise, the user would be doing a reinstall.) So installing the whole @^%s-product-environment group is a very unexpected behavior (and also not clear from the upgrading message that that will happen if the user doesn't opt out). And if the user had a working GNOME, server or cloud installation of the existing Fedora, that should continue working just fine after the upgrade even without being a Product nor forcing its default package set to be added.\n\nIn addition, due to the wording of the message, which not only does not clearly present the implications of selecting a Product (nor the non-implications of the scary \"nonproduct\" option, which is actually what 99% of users upgrading will want: an upgrade preserving the existing package selection), but also does not make it clear that \"workstation\" is GNOME, I suspect that we will get many user complaints about FedUp adding the whole GNOME on upgrades of Fedora KDE 20 to Fedora 21. I also suspect that even GNOME, server and cloud users will complain about having packages added that they didn't ask for (e.g. because they explicitly removed unneeded desktop applications in the past, or because they did a minimum netinstall for their server and now got talked into using the \"server\" Product by the misleading message)."
					},
					{
						"isprivate": "0",
						"commentid": "7611727",
						"comment_count": "5",
						"who": {
							"text": "kevin",
							"name": "Kevin Kofler"
						},
						"bug_when": "2014-10-26 06:01:08 +0000",
						"thetext": "(PS: To be clear, \"@^%s\" is not supposed to be an expletive, but the string literally found in the linked commit, a combination of the environment marker and the Python string placeholder.)"
					},
					{
						"isprivate": "0",
						"commentid": "7611729",
						"comment_count": "6",
						"who": {
							"text": "sudhir",
							"name": "Sudhir Khanger"
						},
						"bug_when": "2014-10-26 06:40:30 +0000",
						"thetext": "Users who are running non-product release should be by default upgraded to non-product release. There is no reason to push users to one of the product releases if they have decided not to participate in mainstreaming. If I am running Fedora 20 KDE that should be simply upgraded to Fedora 21 KDE. Since I have spent month curating this system and I would I highly appreciate if unnecessary packages are not installed just because we have new products. It would be disastrous if 100s of GNOME packages are installed on my system. Maybe we should keep how things are and fedora-release should go from non-product to non-product. The users who want to go to products can choose fedora-release-workstation, etc.\n\nsudo yum update fedup fedora-release\nsudo fedup --network 20"
					},
					{
						"isprivate": "0",
						"commentid": "7614514",
						"comment_count": "7",
						"who": {
							"text": "sgallagh",
							"name": "Stephen Gallagher"
						},
						"bug_when": "2014-10-27 12:03:04 +0000",
						"thetext": "We had this conversation with a lot of the stakeholders (the yum/dnf guys, the fedup team, most of FESCo and all of the WGs).\n\nThe major points were this:\n\n1) The focus of Fedora 21 is on the Products. It was determined that, with all the marketing efforts and so on, it would be clearly unexpected to most users if when they upgraded, they didn't end up on one of the Products.\n\n2) From a technical standpoint, there is no appropriate heuristic for determining automatically which Product (or none) is appropriate to upgrade to. \n\n3) We cannot just pick one of the Products and upgrade to it, as we have plenty of people using alternative desktops as well as people using Fedora 20 as a server or cloud image.\n\nWith those criteria in place, we decided that the *only* fair approach was that everyone must make the decision for themselves at upgrade time. If fedup is not passed a --product=<something> command, it will print a message indicating what the choices are and instruct the user to re-run the command.\n\nThe current text displayed to the end-user is as follows:\n\n{{{\nThis installation of Fedora does not belong to a product, so you\nmust provide the --product=PRODUCTNAME option to specify what product\nyou want to upgrade to. PRODUCTNAME should be one of:\n\n workstation: the default Fedora experience for laptops and desktops\n server: the default Fedora experience for servers\n cloud: a base image for use on public and private clouds\n nonproduct: choose this if none of the above apply; in particular,\n   choose this if you are using an alternate-desktop spin of Fedora\n}}}\n\n\nIf you feel that we should alter the text of \"workstation\" to something like \"The default Fedora experience for laptops and desktops, powered by GNOME\", then that's a perfectly reasonable request. I'd ask you kindly to open a new bug on that, since this bug is strictly about the upgrade mechanism. That's essentially a documentation change."
					},
					{
						"isprivate": "0",
						"commentid": "7615095",
						"comment_count": "8",
						"who": {
							"text": "wwoods",
							"name": "Will Woods"
						},
						"bug_when": "2014-10-27 14:08:03 +0000",
						"thetext": "The design of Fedora's products dictates the expected behavior, i.e.:\n\n  `--product=<PRODUCT>` should install '@^<PRODUCT>-product-environment'\n  `--product=nonproduct` should install 'fedora-release-standard'\n\nThis bug is about implementing that behavior in fedup.\n\nIf there's a bug in the implementation, please let me know, but discussion of the design/policy/help text is *outside the scope of this report*. \nPlease take that to the mailing lists."
					},
					{
						"isprivate": "0",
						"commentid": "7616020",
						"comment_count": "9",
						"who": {
							"text": "kevin",
							"name": "Kevin Kofler"
						},
						"bug_when": "2014-10-27 17:36:05 +0000",
						"thetext": "> We had this conversation with a lot of the stakeholders (the yum/dnf guys, the > fedup team, most of FESCo and all of the WGs).\n\nClearly not all the stakeholders. As far as I know, the KDE SIG was not asked at all. And have you tried asking actual users, too? Of course, if you discuss this only with the Product WGs, they'll tell you that everyone wants a Product…\n\n> 1) The focus of Fedora 21 is on the Products. It was determined that, with all\n> the marketing efforts and so on, it would be clearly unexpected to most users\n> if when they upgraded, they didn't end up on one of the Products.\n\nAnd this is what I cannot possibly agree with. To me, it is obvious that a user who installed with Fedora 20 will expect to keep the package set he/she had installed Fedora 20 with, unless he/she explicitly asks for --product=something. This is how upgrades have always worked since Red Hat Linux days. They have NEVER pulled in new packages (that are not either required by existing packages or obsolete existing packages).\n\n> The design of Fedora's products dictates the expected behavior\n\nSorry, but I don't see how it does. The expected behavior is clearly that --product=nonproduct is the automatic default.\n\n> Please take that to the mailing lists.\n\nBut we will take this to the devel mailing list."
					},
					{
						"isprivate": "0",
						"commentid": "7616099",
						"comment_count": "10",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-10-27 18:19:26 +0000",
						"thetext": "\"`--product=nonproduct` should install 'fedora-release-standard'\"\n\nthe package was re-named to fedora-release-nonproduct recently and that change is in Beta TC4/RC1 and has recently been pushed stable."
					},
					{
						"isprivate": "0",
						"commentid": "7616202",
						"comment_count": "11",
						"who": {
							"text": "sgallagh",
							"name": "Stephen Gallagher"
						},
						"bug_when": "2014-10-27 18:49:55 +0000",
						"thetext": "I've opened https://github.com/wgwoods/fedup/pull/52 with an improved warning message and a change of fedora-release-standard to fedora-release-nonproduct."
					},
					{
						"isprivate": "0",
						"commentid": "7616263",
						"comment_count": "12",
						"who": {
							"text": "kevin",
							"name": "Kevin Kofler"
						},
						"bug_when": "2014-10-27 19:22:25 +0000",
						"thetext": "As said on IRC, I support the improved warning message from https://github.com/wgwoods/fedup/pull/52 : it will allow the users to make an informed decision."
					},
					{
						"isprivate": "0",
						"commentid": "7623819",
						"comment_count": "13",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-10-29 21:10:26 +0000",
						"thetext": "fedup-0.9.0-1.fc21 has been submitted as an update for Fedora 21.\nhttps://admin.fedoraproject.org/updates/fedup-0.9.0-1.fc21"
					},
					{
						"isprivate": "0",
						"commentid": "7623837",
						"comment_count": "14",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-10-29 21:11:42 +0000",
						"thetext": "fedup-0.9.0-1.fc20 has been submitted as an update for Fedora 20.\nhttps://admin.fedoraproject.org/updates/fedup-0.9.0-1.fc20"
					},
					{
						"isprivate": "0",
						"commentid": "7623841",
						"comment_count": "15",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-10-29 21:12:42 +0000",
						"thetext": "fedup-0.9.0-1.fc19 has been submitted as an update for Fedora 19.\nhttps://admin.fedoraproject.org/updates/fedup-0.9.0-1.fc19"
					},
					{
						"isprivate": "0",
						"commentid": "7625061",
						"comment_count": "16",
						"who": {
							"text": "kparal",
							"name": "Kamil Páral"
						},
						"bug_when": "2014-10-30 08:21:22 +0000",
						"thetext": "I tried --product=server, worked well."
					},
					{
						"isprivate": "0",
						"commentid": "7625161",
						"comment_count": "17",
						"who": {
							"text": "pschindl",
							"name": "Petr Schindler"
						},
						"bug_when": "2014-10-30 08:46:23 +0000",
						"thetext": "I tried --product=workstation and it worked for me too."
					},
					{
						"isprivate": "0",
						"commentid": "7626042",
						"comment_count": "18",
						"who": {
							"text": "rz",
							"name": "Richard Z."
						},
						"bug_when": "2014-10-30 12:30:10 +0000",
						"thetext": "(In reply to Stephen Gallagher from comment #7)\n> We had this conversation with a lot of the stakeholders (the yum/dnf guys,\n> the fedup team, most of FESCo and all of the WGs).\n> \n> The major points were this:\n> \n> 1) The focus of Fedora 21 is on the Products. It was determined that, with\n> all the marketing efforts and so on, it would be clearly unexpected to most\n> users if when they upgraded, they didn't end up on one of the Products.\n\nthe opposite is also unexpected for most users who want to use upgrade as opposed to reinstall.\n\nThe wiki and other documentation should be enhanced well in advance to describe the new behaviour.\n\nAlso, will this change be pushed into F19 fedup? The current manpage in that version does not document it in any way."
					},
					{
						"isprivate": "0",
						"commentid": "7627259",
						"comment_count": "19",
						"who": {
							"text": "wwoods",
							"name": "Will Woods"
						},
						"bug_when": "2014-10-30 16:15:28 +0000",
						"thetext": "(In reply to Richard Zidlicky from comment #18)\n\n> Also, will this change be pushed into F19 fedup? The current manpage in that\n> version does not document it in any way.\n\nYes, but on F19 the option is *only* required if we can tell that you're upgrading to F21+ - so if you use:\n\n  --network [21|22|rawhide]\n\nthen you'll get the error message. But it's not required for F19->F20 upgrades.\n\nAlso note for F19: right now the error message won't appear for DVD/ISO upgrades to F21+ *without* --network, because we can't tell at CLI-parsing time what distro version the DVD/ISO is.\n\nBut I'm pretty sure network-disconnected leap-upgrades are rare, and officially they're not supported so that doesn't *need* to be fixed. Would probably be better if it was, but that's low-priority at this point. Patches welcome, though."
					},
					{
						"isprivate": "0",
						"commentid": "7631469",
						"comment_count": "20",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-01 01:40:04 +0000",
						"thetext": "fedup-0.9.0-1.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7636181",
						"comment_count": "21",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-03 18:05:34 +0000",
						"thetext": "fedup-0.9.0-2.fc19 has been submitted as an update for Fedora 19.\nhttps://admin.fedoraproject.org/updates/fedup-0.9.0-2.fc19"
					},
					{
						"isprivate": "0",
						"commentid": "7636189",
						"comment_count": "22",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-03 18:05:51 +0000",
						"thetext": "fedup-0.9.0-2.fc21 has been submitted as an update for Fedora 21.\nhttps://admin.fedoraproject.org/updates/fedup-0.9.0-2.fc21"
					},
					{
						"isprivate": "0",
						"commentid": "7636751",
						"comment_count": "23",
						"who": {
							"text": "mael.lavault",
							"name": "Maël Lavault"
						},
						"bug_when": "2014-11-03 20:27:20 +0000",
						"thetext": "I tried using \"sudo fedup --product=workstation --network=21\", but no matter what I do, I get :\n\nCould not parse metalink https://mirrors.fedoraproject.org/metalink?repo=fedora-install-21&arch=x86_64 error was \nNo repomd file\n\n(the url looks wrong, should'nt it be fedora-workstation-21 instead of fedora-install-21?)\n\nI use fedup-0.9.0-2.fc20, any ideas ?"
					},
					{
						"isprivate": "0",
						"commentid": "7636778",
						"comment_count": "24",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-03 20:37:07 +0000",
						"thetext": "It's not really the wrong URL, we don't have per-product upgrade images. mirrormanager is not set up for F21 fedup yet: this is partly because we didn't get around to it but as of now, we're *intentionally* not getting round to it until https://bugzilla.redhat.com/show_bug.cgi?id=1159292 is fixed.\n\nFor now, pass --instrepo https://dl.fedoraproject.org/pub/alt/stage/21_Beta_RC1/Server/x86_64/os/ (and make really sure you're using fedup 0.9.0-2)."
					},
					{
						"isprivate": "0",
						"commentid": "7636781",
						"comment_count": "25",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-03 20:37:41 +0000",
						"thetext": "Sorry, that should be --instrepo https://dl.fedoraproject.org/pub/alt/stage/21_Beta_RC4/Server/x86_64/os/ ."
					},
					{
						"isprivate": "0",
						"commentid": "7636826",
						"comment_count": "26",
						"who": {
							"text": "mael.lavault",
							"name": "Maël Lavault"
						},
						"bug_when": "2014-11-03 20:53:26 +0000",
						"thetext": "Are you sure about the Server part ?"
					},
					{
						"isprivate": "0",
						"commentid": "7637240",
						"comment_count": "27",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-03 22:54:17 +0000",
						"thetext": "yes. it's just somewhere to get the upgrade.img from."
					},
					{
						"isprivate": "0",
						"commentid": "7641586",
						"comment_count": "28",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-05 02:31:21 +0000",
						"thetext": "The update is stable for 19 and 20 already, Will can push it stable for 21 soon enough."
					},
					{
						"isprivate": "0",
						"commentid": "7641692",
						"comment_count": "29",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-05 03:57:27 +0000",
						"thetext": "fedup-0.9.0-2.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7655073",
						"comment_count": "30",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-10 06:02:51 +0000",
						"thetext": "fedup-0.9.0-2.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
					}
				]
			}
		},
		{
			"bug_id": 1159292,
			"title": "Machine automatically shutdown during upgrade in less than 15 minutes",
			"bugzilla": {
				"bug_id": "1159292",
				"creation_ts": "2014-10-31 12:00:43 +0000",
				"short_desc": "Machine automatically shutdown during upgrade in less than 15 minutes",
				"delta_ts": "2015-05-04 19:23:05 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "CommonBugs, Reopened",
				"priority": "unspecified",
				"bug_severity": "unspecified",
				"blocked": [
					{
						"bug_id": "1043129",
						"alias": "F21FinalBlocker",
						"creation_ts": "2013-12-14 01:52:24 +0000",
						"short_desc": "Fedora 21 Final blocker bug tracker",
						"delta_ts": "2020-08-12 13:12:00 +0000",
						"bug_status": "CLOSED",
						"resolution": "CURRENTRELEASE",
						"keywords": "Tracking",
						"priority": "unspecified",
						"bug_severity": "unspecified",
						"depends_on": [
							"1024071",
							"1103496",
							"1114207",
							"1114786",
							"1121294",
							"1123549",
							"1130794",
							"1133394",
							"1134128",
							"1140303",
							"1141414",
							"1143755",
							"1144657",
							"1146156",
							"1148889",
							"1148895",
							"1150122",
							"1151429",
							"1152796",
							"1153676",
							"1153804",
							"1154206",
							"1155576",
							"1158442",
							"1158968",
							"1159292",
							"1160289",
							"1160429",
							"1160499",
							"1160931",
							"1161592",
							"1161779",
							"1161883",
							"1162068",
							"1162215",
							"1162856",
							"1163660",
							"1163698",
							"1164889",
							"1165261",
							"1165430",
							"1165714",
							"1167959",
							"1168443",
							"1168568",
							"1168748",
							"1169020",
							"1169023",
							"1169541",
							"1170153",
							"1170245",
							"1170623"
						],
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "6619473",
								"comment_count": "0",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2013-12-14 01:52:24 +0000",
								"thetext": "Fedora 21 Final blocker tracker bug, as per http://fedoraproject.org/wiki/BugZappers/HouseKeeping/Trackers\n\nTo propose a bug as blocking the Fedora 21 release, mark it as blocking this bug (or use the webapp: https://qa.fedoraproject.org/blockerbugs/propose_bug ). It will be reviewed per https://fedoraproject.org/wiki/QA:SOP_blocker_bug_process . To propose a bug as a 'freeze exception' for the release - allowing a fix to go through the freeze, but not blocking the release - mark it as blocking the bug F21FinalFreezeException . See https://fedoraproject.org/wiki/QA:SOP_freeze_exception_bug_process for the freeze exception process."
							},
							{
								"isprivate": "0",
								"commentid": "7738233",
								"comment_count": "3",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2014-12-05 19:09:58 +0000",
								"thetext": "F21 is done."
							}
						]
					}
				],
				"external_bugs": {
					"text": "1154768",
					"name": "Red Hat Bugzilla"
				},
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "7629905",
						"comment_count": "0",
						"who": {
							"text": "robinlee.sysu",
							"name": "Robin Lee"
						},
						"bug_when": "2014-10-31 12:00:43 +0000",
						"thetext": "Description of problem:\nAfter fedup was setup, machine rebooted and entered upgrade process. After less than 15 minutes, the machine suddenly halted. The grub entry added by fedup had been removed.\n\nVersion-Release number of selected component (if applicable):\nfedup-0.8.1-1.fc20\n\nHow reproducible:\n\nSteps to Reproduce:\n1. fedup --network 21 --instrepo http://dl.fedoraproject.org/pub/alt/stage/21_Beta_RC4/Server/x86_64/os/\n2. reboot\n\nActual results:\nUpgrade succeeded."
					},
					{
						"isprivate": "0",
						"commentid": "7630778",
						"comment_count": "1",
						"who": {
							"text": "kparal",
							"name": "Kamil Páral"
						},
						"bug_when": "2014-10-31 17:03:51 +0000",
						"thetext": "I can confirm this issue, and it is not rare. Yesterday, we have seen it on a bare metal machine when upgrading F20 desktop to F21 workstation. Today, we have seen it in a VM and on a bare metal machine, when upgrading F19 desktop to F21 workstation. Unfortunately we didn't catch this before F21 Beta release, because yesterday we considered it to be a hardware issue. Another information worth noting is that we saw it both with fedup 0.8.1 and fedup 0.9.0. The only thing which was common for all these cases is RC4 upgrade.img (also the OP used this image). We have not seen this issue in the past with older upgrade.img files. Quite interestingly, we haven't hit this issue quite a few times even with RC4, otherwise it would be considered a blocker bug. So maybe this issue is only triggered with RC4 upgrade.img *and* if some particular package is present during the upgrade? Not sure.\n\nRight now I have a VM with F19 (default desktop installation) snapshot and I have hit this issue 2 times out of 2 attempts. I have recorded the VM output and found out what are the last lines before the machine shuts down (btw, it seems to shut down hard, like poweroff -f). See attached screenshot. The log line is:\n\n> upgrade[1004]: [707/1287] (89%) cleaning at-spi2-atk-2.8.1-1.fc19...\n> cgroup: option or name mismatch, new: 0x0 \"\", old: 0x4 \"systemd\"\n\nIn a second after printing this, the machine powers off. So the issue might be related to fedup-dracut, systemd or at-spi2-atk. Or all of them.\n\nAfter starting and booting into the machine again, the results are non-deterministic. Because lots of packages were not cleaned properly, yum complains a lot (in my case, something about 600 duplicate packages). My F19->F21 machine at least booted, but lbrabec's F20->F21 machine didn't even boot to graphics and network didn't work (maybe his machine turned off during actual update phase, not clean phase). Also, there is no /var/log/upgrade.log in my case, so I can't provide it. I can only provide fedup.log. Maybe the upgrade logging wasn't really solved for F19, just for F20?"
					},
					{
						"isprivate": "0",
						"commentid": "7630779",
						"comment_count": "2",
						"who": {
							"text": "kparal",
							"name": "Kamil Páral"
						},
						"bug_when": "2014-10-31 17:04:45 +0000",
						"thetext": "Created attachment 952550\nfedup output directly before reboot"
					},
					{
						"isprivate": "0",
						"commentid": "7630798",
						"comment_count": "3",
						"who": {
							"text": "kparal",
							"name": "Kamil Páral"
						},
						"bug_when": "2014-10-31 17:08:15 +0000",
						"thetext": "Created attachment 952552\nfedup.log from F19->F21"
					},
					{
						"isprivate": "0",
						"commentid": "7630800",
						"comment_count": "4",
						"who": {
							"text": "kparal",
							"name": "Kamil Páral"
						},
						"bug_when": "2014-10-31 17:08:46 +0000",
						"thetext": "Created attachment 952553\n\"yum check\" output from F19->F21 after unsuccessful upgrade"
					},
					{
						"isprivate": "0",
						"commentid": "7630806",
						"comment_count": "5",
						"who": {
							"text": "kparal",
							"name": "Kamil Páral"
						},
						"bug_when": "2014-10-31 17:12:05 +0000",
						"thetext": "Since 4 people hit this already (OP and 3 of us in our office), it seems it isn't a random occurrence. Proposing as a blocker bug. Upgrade criterion."
					},
					{
						"isprivate": "0",
						"commentid": "7630872",
						"comment_count": "6",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-10-31 17:35:33 +0000",
						"thetext": "davidshea and I both had the thought that this may possibly be related to https://bugzilla.redhat.com/show_bug.cgi?id=1154768 somehow."
					},
					{
						"isprivate": "0",
						"commentid": "7630940",
						"comment_count": "7",
						"who": {
							"text": "kparal",
							"name": "Kamil Páral"
						},
						"bug_when": "2014-10-31 18:07:32 +0000",
						"thetext": "zdzichu told me about a new systemd feature: http://cgit.freedesktop.org/systemd/systemd/tree/NEWS#n25\n\nAnd bingo, the reboot is time-based. It's after exactly 15 minutes after start. See attached video. To confirm this even further, this time it rebooted after a different package (PackageKit), so it's not a problem with at-spi2-atk.\n\nEither this is a bug in systemd, or there is some service in the background which uses JobTimeoutAction and JobTimeoutRebootArgument, and causes the reboot. The question is what service, and whether fedup-dracut should prevent it."
					},
					{
						"isprivate": "0",
						"commentid": "7630944",
						"comment_count": "8",
						"who": {
							"text": "kparal",
							"name": "Kamil Páral"
						},
						"bug_when": "2014-10-31 18:08:43 +0000",
						"thetext": "Created attachment 952567\nvideo showing poweroff right after 15th minute mark"
					},
					{
						"isprivate": "0",
						"commentid": "7631057",
						"comment_count": "9",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-10-31 19:18:44 +0000",
						"thetext": "Kamil: that's pretty much exactly what #1154768 is about, I believe. It's a problem with that 'feature' when TimeoutSec is used in a unit file - that feature shouldn't trigger a shutdown if the unit which hasn't completed or whatever specifies TimeoutSec, but it does."
					},
					{
						"isprivate": "0",
						"commentid": "7631092",
						"comment_count": "10",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-10-31 19:33:55 +0000",
						"thetext": "http://cgit.freedesktop.org/systemd/systemd/commit/?id=2928b0a863091f8f291fddb168988711afd389ef is the commit that added the timeout.\n\nIt rather looks like settings were added to /etc/systemd/system.conf to control this behaviour:\n\n+#StartTimeoutSec=15min\n+#StartTimeoutAction=reboot-force\n+#StartTimeoutRebootArgument=\n\nso might we be able to fix this for Beta by having fedup insert those settings into the /etc/systemd/system.conf in the upgrade environment?"
					},
					{
						"isprivate": "0",
						"commentid": "7631249",
						"comment_count": "11",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-10-31 21:16:00 +0000",
						"thetext": "So, I wanted to try something to see if it would fix this:\n\ndiff --git a/fedup/sysprep.py b/fedup/sysprep.py\nindex f7fbe25..bda50e7 100644\n--- a/fedup/sysprep.py\n+++ b/fedup/sysprep.py\n@@ -150,6 +150,10 @@ def customize_initrd(initrd):\n         for f in wantfiles: log.debug(\"%s\",f)\n         with TemporaryDirectory(prefix=\"fedup.initramfs.\") as tmpdir:\n             curimg.extract(wantfiles, root=tmpdir)\n+            sysdconf = os.path.join(tmpdir, 'etc', 'systemd', 'system.conf')\n+            log.debug(\"Editing %s\", sysdconf)\n+            sysdout = open(sysdconf, 'a')\n+            sysdout.write('\\nStartTimeoutAction=none\\n')\n             newimg.append(wantfiles, root=tmpdir)\n \n     # look for updates, and add them to initrd if found\n\n(obviously not a clean fix, but enough to test the idea). However, I ran into a bit of a problem: it seems /etc/systemd/system.conf never actually winds up in the fedup initramfs. It *should* do. If you print out the 'list of files to be appended' both in customize_initrd() and in newimg.append(), all the way through, etc/systemd/system.conf shows up. I can even print out the contents of the file after my patch edits it, showing that it gets properly extracted from curimg (and it wouldn't be in newimg.append's 'filelist' unless it was there in the temp directory, but it *is* in newimg.append's 'filelist'). But somehow, it doesn't make it in when newimg.append() actually writes the files into the new initramfs. lsinitrd on fedup-initramfs.img never shows it. This is the case even with an unmodified fedup 0.9 (without my patch above).\n\nIt occurs to me that I'm not sure whether systemd when running the fedup upgrade step will read from the copy of /etc/systemd/system.conf in the initramfs, or the one in sysroot.\n\nAnyway, I *think* what we need to do is get that setting set in the fedup environment one way or another. And we really need this fix ASAP, because it's causing broken systems on upgrade."
					},
					{
						"isprivate": "0",
						"commentid": "7631250",
						"comment_count": "12",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-10-31 21:16:36 +0000",
						"thetext": "oh, there's actually a sysdout.close() in there too."
					},
					{
						"isprivate": "0",
						"commentid": "7631251",
						"comment_count": "13",
						"who": {
							"text": "mruckman",
							"name": "Mike Ruckman"
						},
						"bug_when": "2014-10-31 21:19:49 +0000",
						"thetext": "I wasn't able to reproduce this with either fedup versions when using fedup on a i386 F19 box."
					},
					{
						"isprivate": "0",
						"commentid": "7631301",
						"comment_count": "14",
						"who": {
							"text": "wwoods",
							"name": "Will Woods"
						},
						"bug_when": "2014-10-31 22:28:23 +0000",
						"thetext": "https://bugzilla.redhat.com/show_bug.cgi?id=1154416#c10 claims this systemd feature going to be shut off in F21 anyway, so it's probably not something fedup actually needs to worry about permanently.\n\nI also haven't been able to reproduce this in my testing, so it's being triggered by either a very recent change in F21 *or* something special about your system(s). The question is: what's the cause?\n\nCan you start an upgrade with 'rd.break' and use the dracut emergency shell to check the contents of:\n\n  /etc/systemd/system.conf         (this is the initramfs one)\n  /sysroot/etc/systemd/system.conf (this is your system's version)\n\n(In reply to Adam Williamson (Red Hat) from comment #11)\n> [...] it doesn't make it in when\n> newimg.append() actually writes the files into the new initramfs. lsinitrd\n> on fedup-initramfs.img never shows it. This is the case even with an\n> unmodified fedup 0.9 (without my patch above).\n\nlsinitrd doesn't handle concatenated initramfs images the way the kernel does, so the files that were appended by fedup may not show up in lsinitrd.\n\nTo confirm whether the files are actually in the initramfs you need to boot with 'rd.break' and check the contents of the live initramfs, as described above."
					},
					{
						"isprivate": "0",
						"commentid": "7631309",
						"comment_count": "15",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-10-31 22:37:28 +0000",
						"thetext": "Hum, it looks like the edit actually worked fine, if I reboot and drop to a dracut shell I see it. looks like just lsinitrd can't read the initramfs properly after fedup edits it.\n\nUnfortunately roshi can run an upgrade that takes more than 15 mins without hitting the bug, so it looks like reproduction isn't 100% so I'm not totally sure I can test my 'fix'. If anyone wants to try it, though, try patching sysprep.py as above (plus the sysdout.close() after the write) and see if that gets you past the shutdown..."
					},
					{
						"isprivate": "0",
						"commentid": "7631311",
						"comment_count": "16",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-10-31 22:40:41 +0000",
						"thetext": "Will: it won't be a permanent problem no, but the upgrade.img in the Beta tree is now built with the systemd that contains this timeout, and we can't change it. Anyone running a fedup against that tree may hit the problem.\n\nI suspect the difference between cases where the bug happens and cases where it doesn't is whether the boot reached a far enough point to consider the boot 'complete' and turn off the timer, but I can't quite grok the systemd code well enough to understand exactly when it does that."
					},
					{
						"isprivate": "0",
						"commentid": "7631343",
						"comment_count": "17",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-10-31 22:57:20 +0000",
						"thetext": "wwood: I believe the bug is triggered by a very recent change in systemd. It landed upstream after 216 was released, but systemd-216-2 in fedora has in its changelog \"- Update to latest git, but without the readahead removal patch\" , so I'm guessing we got it there. We pulled 216-4 into Beta TC4. So I believe only tests using an instroot from Beta TC4, Beta RC1, Beta RC4, or development/21 since 10-28 would show this bug.\n\nroshi I think misunderstood, and was expect the timeout to happen during fedup *package download*, so I think his failure to reproduce is bogus.\n\nI currently have a fedup upgrade stage that's been running for 19 minutes and hasn't shut down, with my patch. I actually see the timeout kicking in, in the journal:\n\nOct 31 22:52:11 test1.happyassassin.net systemd[1]: Startup timed out.\n\n(but it doesn't *do* anything because my patch sets the action on timeout to 'none'). That seems like pretty good confirmation both of the cause, and that my approach should work around the problem.\n\nHowever, just to be sure, I'll test that the same procedure but without my patch causes the bug, next."
					},
					{
						"isprivate": "0",
						"commentid": "7631362",
						"comment_count": "18",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-10-31 23:33:15 +0000",
						"thetext": "There's an f20 scratch build of fedup with my test fix here:\n\nhttp://koji.fedoraproject.org/koji/taskinfo?taskID=7995328\n\nand an f19 one here:\n\nhttp://koji.fedoraproject.org/koji/taskinfo?taskID=7995397\n\ncan folks who can reproduce this bug reliably please test with that fedup? You should see that the upgrade installation stage survives past 15 minutes, and around that time you should see the 'Startup timed out' message appear in the journal."
					},
					{
						"isprivate": "0",
						"commentid": "7631382",
						"comment_count": "19",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-01 00:05:20 +0000",
						"thetext": "For the record, looks like I'm right about when we got this change:\n\n[adamw@adam systemd (f21 %)]$ git log 0038-core-add-support-for-a-configurable-system-wide-star.patch \ncommit 708deb95da792cb4515da4ceaf79458bdcc09f7a\nAuthor: Zbigniew Jędrzejewski-Szmek <zbyszek@in.waw.pl>\nDate:   Fri Oct 3 22:43:52 2014 -0400\n\n    Update to latest git\n[adamw@adam systemd (f21 %)]$ \n\nThat commit is 216-2. The update, https://admin.fedoraproject.org/updates/FEDORA-2014-12688 , was submitted as 216-2 then edited to -3, -4 and finally -5. It was pulled into TC4 as -4, and into RC1 and RC4 as -5. -5 was pushed stable on 10-28. So as I wrote above, only TC4, RC1, RC2 and RC4 trees, and the development/21 tree from 10-29 on, would have the issue. You also only hit the issue if the 'update installation' stage of fedup takes more than 15 minutes, which it doesn't on a fast disk with a standard package set. I'm installing KDE with a bunch of optional sub-groups in order to make the upgrade take longer, for testing.\n\nThe timeout was only reverted upstream four days ago, the reversion has not yet reached the Fedora package."
					},
					{
						"isprivate": "0",
						"commentid": "7631386",
						"comment_count": "20",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-01 00:55:19 +0000",
						"thetext": "I can reproduce the problem when running an upgrade of a big installation without my patched fedup. If you boot into the broken system (might need 1 or rescue) and run 'journalctl -b-1' you can see the problem quite clearly, the log ends with:\n\nStartup timed out.\nForcibly powering off as a result of failure.\nShutting down.\nJournal stopped\n\nI snapshotted before rebooting to fedup 'stage2'. I've just run the snapshot, updated to my scratch fedup, and re-run fedup to re-generate the initramfs, and kicked off 'stage2' again to confirm that it completes this time. I've gotta run out for dinner now, will post the results when I return."
					},
					{
						"isprivate": "0",
						"commentid": "7631548",
						"comment_count": "21",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-01 03:35:50 +0000",
						"thetext": "As expected, running the same upgrade but using fedup with my hack results in a successful upgrade. 'journalctl -b-1' shows the 'Startup timed out.' message in the middle of package installation. Seems pretty clear what the cause is, at this point.\n\nIt'd be good to decide on a proper fix for this and get it out there on Monday if possible, we want to be ahead of release on Tuesday."
					},
					{
						"isprivate": "0",
						"commentid": "7632428",
						"comment_count": "22",
						"who": {
							"text": "wwoods",
							"name": "Will Woods"
						},
						"bug_when": "2014-11-01 20:19:34 +0000",
						"thetext": "Okay so, if I understand right: we never saw this in upgrade testing before now 'cuz the offending/buggy code was:\n\n  * never in an upstream systemd release\n  * not in F21 updates until Oct 28 (so my test builds didn't have it), and\n  * not in TC1/2/3 or RC2/3\n\nBut it *did* get pulled into RC4, which is causing this and bug 1154768.\n\nIf we had another day or two the obvious fix would just be to add\n\n  \"StartTimeoutAction=none\"\n\nto /etc/systemd/systemd.conf, in the systemd package.\n\nBut since it's technically feasible for fedup to fix *anything* during an upgrade, and we don't have a week, we're now fixing this in fedup. Okay, fine.\n\nNow: since the 'StartTimeoutAction' configuration item has been removed from systemd upstream, just adding that line to systemd.conf will cause a \"Unknown lvalue 'StartTimeoutAction' ...\" warning for every version of systemd *other* than 216-{2,3,4,5}. Ugh.\n\nOn the other hand, this can probably also be fixed by adjusting the systemd units in the initramfs so that systemd properly considers startup to be finished before the upgrade starts.. which would probably be the intended behavior for dealing with this feature anyway."
					},
					{
						"isprivate": "0",
						"commentid": "7632430",
						"comment_count": "23",
						"who": {
							"text": "zbyszek",
							"name": "Zbigniew Jędrzejewski-Szmek"
						},
						"bug_when": "2014-11-01 20:27:56 +0000",
						"thetext": "(In reply to Adam Williamson (Red Hat) from comment #11)\n> So, I wanted to try something to see if it would fix this:\n> \n> diff --git a/fedup/sysprep.py b/fedup/sysprep.py\n> index f7fbe25..bda50e7 100644\n> --- a/fedup/sysprep.py\n> +++ b/fedup/sysprep.py\n> @@ -150,6 +150,10 @@ def customize_initrd(initrd):\n>          for f in wantfiles: log.debug(\"%s\",f)\n>          with TemporaryDirectory(prefix=\"fedup.initramfs.\") as tmpdir:\n>              curimg.extract(wantfiles, root=tmpdir)\n> +            sysdconf = os.path.join(tmpdir, 'etc', 'systemd', 'system.conf')\n> +            log.debug(\"Editing %s\", sysdconf)\n> +            sysdout = open(sysdconf, 'a')\n> +            sysdout.write('\\nStartTimeoutAction=none\\n')\n>              newimg.append(wantfiles, root=tmpdir)\n>  \n>      # look for updates, and add them to initrd if found\n\nYes, this seems to be the most reasonable way without changing the systemd package.\n\n> Author: Zbigniew Jędrzejewski-Szmek <zbyszek@in.waw.pl>\n> Date:   Fri Oct 3 22:43:52 2014 -0400\n> \n>     Update to latest git\n> [adamw@adam systemd (f21 %)]$ \n> \n> That commit is 216-2.\nMy fault. I'm sorry for that. This update *was* supposed to go to stable before the\nfreeze started, but was delayed by bugs (and the -3, -4, ... updates)."
					},
					{
						"isprivate": "0",
						"commentid": "7632431",
						"comment_count": "24",
						"who": {
							"text": "zbyszek",
							"name": "Zbigniew Jędrzejewski-Szmek"
						},
						"bug_when": "2014-11-01 20:30:30 +0000",
						"thetext": "(In reply to Will Woods from comment #22)\n> Now: since the 'StartTimeoutAction' configuration item has been removed from\n> systemd upstream, just adding that line to systemd.conf will cause a\n> \"Unknown lvalue 'StartTimeoutAction' ...\" warning for every version of\n> systemd *other* than 216-{2,3,4,5}. Ugh.\nI'll add a compatibility patch to ignore StartTimeoutAction=none in subsequent versions.\nThat should be fine, since StartTimeoutAction=none is equivalent to the new behaviour.\n\n> On the other hand, this can probably also be fixed by adjusting the systemd\n> units in the initramfs so that systemd properly considers startup to be\n> finished before the upgrade starts.. which would probably be the intended\n> behavior for dealing with this feature anyway.\nThat would be hard, changes to the the boot order are inherently fragile. Adam's fix seems to be much safer."
					},
					{
						"isprivate": "0",
						"commentid": "7632432",
						"comment_count": "25",
						"who": {
							"text": "zbyszek",
							"name": "Zbigniew Jędrzejewski-Szmek"
						},
						"bug_when": "2014-11-01 20:36:09 +0000",
						"thetext": "(In reply to Adam Williamson (Red Hat) from comment #11)\n> So, I wanted to try something to see if it would fix this:\n> \n> diff --git a/fedup/sysprep.py b/fedup/sysprep.py\n> index f7fbe25..bda50e7 100644\n> --- a/fedup/sysprep.py\n> +++ b/fedup/sysprep.py\n> @@ -150,6 +150,10 @@ def customize_initrd(initrd):\n>          for f in wantfiles: log.debug(\"%s\",f)\n>          with TemporaryDirectory(prefix=\"fedup.initramfs.\") as tmpdir:\n>              curimg.extract(wantfiles, root=tmpdir)\n> +            sysdconf = os.path.join(tmpdir, 'etc', 'systemd', 'system.conf')\n> +            log.debug(\"Editing %s\", sysdconf)\n> +            sysdout = open(sysdconf, 'a')\n> +            sysdout.write('\\nStartTimeoutAction=none\\n')\n>              newimg.append(wantfiles, root=tmpdir)\n\nThis will cause an unnecessary message in the logs. Something like this would be nicer:\n\n  sysdconf = os.path.join(tmpdir, 'etc/systemd/system.conf')\n  log.debug(\"Editing %s\", sysdconf)\n  with open(sysdconf, 'a') as sysdout:\n      sysdout.write('\\nStartTimeoutSec=0\\n')"
					},
					{
						"isprivate": "0",
						"commentid": "7632438",
						"comment_count": "26",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-01 20:51:19 +0000",
						"thetext": "Will: sorry, I guess I didn't quite explain the timeline quite right, let me give it one more shot. The change landed in F21 in systemd-216-2.fc21 and is in all subsequent F21 systemd builds so far. That build or a later one:\n\n* Was in F21 updates-testing from 2014-10-08\n* Was in F21 stable from 2014-10-28 (plus whatever time it took to sync mirrors)\n* Was in F21 Beta TC4 onwards (RC2 and RC3 were kind of 'DOA' builds which is why I don't always mention them). This means the upgrade.img in TC4, RC1, RC2 and RC4 trees on stage/ (there is no RC3 tree) have the bug.\n\nThe development/21 tree is built from the F21 'stable' package set, AIUI. That means the upgrade.img in that tree would not have had this bug until, probably, 2014-10-29.\n\nObviously to hit the bug you still need the fedup package installation stage to take more than 15 minutes. If you have an SSD and a typical GNOME install, for instance, it probably won't, which is why we didn't see this bug in RC4 validation (I ran two upgrade tests on RC4 and didn't hit this bug either time, because the package update stage was fast enough to not hit it). In order to reproduce it I had to install a VM with 1900+ packages (I installed KDE plus a bunch of optional package groups). It's not that unusual to have a lot of packages installed, though, and it's much much easier to run into the bug if you have an HDD not an SSD, I'd expect most 'normal sized' installs to an HDD would hit it.\n\nZbsyzek: thanks for the suggestion. I actually did it precisely because I *wanted* the message in the logs for testing purposes (makes it much easier to check/prove the bug is what we think it is). For a production fix I agree it'd make sense to change the timeout rather than the action.\n\nI don't know what the current plan is upstream to replace the timeout - I know you're planning to re-implement it in some different way. To me it would make sense for the config parameters to stay valid, not just add a compatibility patch to silently ignore them. I would expect that StartTimeoutSec=0 should just always disable any kind of system-wide 'boot timeout' of this kind. Having thought about it a bit I think the hack I came up with on the fly actually kind of makes sense in the long term: so long as it has any kind of 'system-wide' boot timeout mechanism, systemd should always treat the setting StartTimeoutSec=0 as disabling it, and things like fedup should always set it. That should avoid any kind of recurrence of this problem in future. Of course, for the long term we'd want to bake the setting into fedup's initramfs at generation time, not have the fedup binary stuff it in on the fly like my patch does. If we do go with my patch I'd expect we'd just leave it in until Final, when we could fix it properly in fedup-dracut."
					},
					{
						"isprivate": "0",
						"commentid": "7632456",
						"comment_count": "27",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-01 21:01:31 +0000",
						"thetext": "\"If we had another day or two the obvious fix would just be to add\"\n\nIt's not about time exactly - it's about the fact that we've signed off on Beta, so the Beta upgrade.img is now set in stone. We cannot change anything in https://dl.fedoraproject.org/pub/alt/stage/21_Beta_RC4/Server/x86_64/os/images/pxeboot/upgrade.img , it is done, irrevocably. On Tuesday it will become https://dl.fedoraproject.org/pub/fedora/linux/releases/test/21-Beta/Server/x86_64/os/images/pxeboot/upgrade.img . It has this bug, and we cannot change that. So we're stuck working around it somewhere else, and fedup is about the only viable place.\n\nObviously we can fix it for the upgrade.img that lives at https://dl.fedoraproject.org/pub/fedora/linux/development/21/x86_64/os/images/pxeboot/upgrade.img - again AIUI, as soon as a systemd without this 'feature' goes into 21 stable, that image will no longer have this bug. But we have instructions in various places telling people to use the image from the milestone tree (not the development/21 tree), and I think that's probably what mirrormanager will wind up pointing to, so we can't really leave things in the state where you hit this bug if you run fedup against the upgrade.img in our official frozen Beta tree."
					},
					{
						"isprivate": "0",
						"commentid": "7632458",
						"comment_count": "28",
						"who": {
							"text": "zbyszek",
							"name": "Zbigniew Jędrzejewski-Szmek"
						},
						"bug_when": "2014-11-01 21:10:39 +0000",
						"thetext": "The system wide timeout was changed to a unit-specific timeouts (see http://cgit.freedesktop.org/systemd/systemd/commit/?id=3898b80d40). This is more flexible, because different values make sense for different targets, and also it ties more naturally into existing configuration scheme. One or two options (JobTimeoutSec, JobTimeoutAction) are added to specific units for which the timeouts are wanted.\n\nIn the new scheme, there's a 15 min timeout on basic.target (not default.target like before), and 30 min timeout for reboot/poweroff. The first one shouldn't matter for fedup, but the second one *might* have to be adjusted for jobs which e.g. download lots of packages during shutdown.\n\nHm, now that I think about it, fedora-autorelabel.service might trigger the boot timeout. So it seems that this requires more thinking before being enabled."
					},
					{
						"isprivate": "0",
						"commentid": "7632517",
						"comment_count": "29",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-01 23:54:47 +0000",
						"thetext": "Will: I realized after posting that last comment that you're suggesting we can change systemd in f19 and f20 so the setting to disable the timeout is in the /etc/systemd/system.conf that will get copied into the initramfs. That's possibly viable, but I see a couple of problems aside from the tight timeline to try and get an update into stable before Beta goes out:\n\ni) system.conf really is a *config* file, i.e. people might have modified it. If they have, the change will come in a .rpmnew, and people often don't bother checking for and merging rpmnew files, especially if the system appears to be working. (I've just checked, it definitely is marked as %config(noreplace) in the spec.)\n\nii) people who just don't update the system before running fedup. We say you ought to, but there's nothing to enforce it, and I know people sometimes don't."
					},
					{
						"isprivate": "0",
						"commentid": "7633536",
						"comment_count": "30",
						"who": {
							"text": "error",
							"name": "Michael Hampton"
						},
						"bug_when": "2014-11-03 05:19:28 +0000",
						"thetext": "(In reply to Adam Williamson (Red Hat) from comment #18)\n> There's an f20 scratch build of fedup with my test fix here:\n> \n> http://koji.fedoraproject.org/koji/taskinfo?taskID=7995328\n...\n> can folks who can reproduce this bug reliably please test with that fedup?\n> You should see that the upgrade installation stage survives past 15 minutes,\n> and around that time you should see the 'Startup timed out' message appear\n> in the journal.\n\nI can reproduce this reliably, and I can confirm that this build of fedup allows for installation to complete successfully, though for some reason it seemed to run much slower. Might have just been an overly abused qcow2 snapshot though...\n\nAfter running into this issue on three different systems, and spending most of the day figuring out how to make them usable again, I can say that recovering from it ranges from straightforward to nightmarish, depending on what packages were installed and where exactly the upgrade stopped. Bet on nightmarish, though, especially for a multilib system.\n\nI would recommend adding this to Common F21 bugs on the wiki, as this has the potential to leave systems in a semi-usable or even unusable state. (For instance, NetworkManager on one affected system could not connect to any networks. Xorg failed to start on another one.)"
					},
					{
						"isprivate": "0",
						"commentid": "7634625",
						"comment_count": "31",
						"who": {
							"text": "kparal",
							"name": "Kamil Páral"
						},
						"bug_when": "2014-11-03 11:33:44 +0000",
						"thetext": "I tested patched fedup (fc19) from comment 18 and it fixes the problem for me. I see this message in upgrade.log:\n> Nov 03 09:41:36 localhost.localdomain systemd[1]: Startup timed out.\nbut the upgrade process continued and the machine was correctly upgraded.\n\n(In reply to Adam Williamson (Red Hat) from comment #27)\n> It's not about time exactly - it's about the fact that we've signed off on\n> Beta, so the Beta upgrade.img is now set in stone. We cannot change anything\n> in\n> https://dl.fedoraproject.org/pub/alt/stage/21_Beta_RC4/Server/x86_64/os/\n> images/pxeboot/upgrade.img , it is done, irrevocably. On Tuesday it will\n> become\n> https://dl.fedoraproject.org/pub/fedora/linux/releases/test/21-Beta/Server/\n> x86_64/os/images/pxeboot/upgrade.img . It has this bug, and we cannot change\n> that. So we're stuck working around it somewhere else, and fedup is about\n> the only viable place.\n\nWell, is it really that unreasonable rebuilding the upgrade.img with a newer systemd a replacing it in test/21-Beta location? Before it is published, of course.\n\nAlternatively, we can also create a fixed compose (might not even be a full compose) and redirecting mirrormanager to it, instead of test/21-Beta. IIRC, we never asked end users to use --instrepo, even with Alpha/Beta upgrades. We use mirrormanager for that, the url is http://mirrors.fedoraproject.org/mirrorlist?repo=fedora-install-21&arch=x86_64 . (That doesn't work yet, which I believe is an omission, because I think it used to work even for F20 Alpha. But you can try the link with an older release number). Fedora Infra used to update the link from Alpha location, to Beta location, to Final location.\n\nSo, if it is easier than to hack fedup, we can create something like test/21-Beta-fedup-fix with just the necessary files included, and point the mirrormanager to it."
					},
					{
						"isprivate": "0",
						"commentid": "7635496",
						"comment_count": "32",
						"who": {
							"text": "wwoods",
							"name": "Will Woods"
						},
						"bug_when": "2014-11-03 14:47:33 +0000",
						"thetext": "(In reply to Adam Williamson (Red Hat) from comment #29)\n> Will: I realized after posting that last comment that you're suggesting we\n> can change systemd in f19 and f20 so the setting to disable the timeout is\n> in the /etc/systemd/system.conf that will get copied into the initramfs.\n\nNo, sorry - to clarify a bit, I'm suggesting a new systemd package for *F21* that has \"StartTimeoutAction=none\" in systemd.conf. That'd be a one-line change that adds no new code and disables something that's already disabled/removed upstream.\n\nThen we'd rebuild upgrade.img and everything's done. So, roughly what Kamil's saying in comment 31.\n\nAlso, a note: fedup doesn't add files from the host's /etc, it adds files from the /etc in the host's *initramfs*. \n\n[This is necessary because dracut cherry-picks files (and modifies a few of them) when it builds an initramfs, and there's no way to reproduce that behavior outside of dracut.]\n\nSo: updating systemd in F19/F20 has the problems you mentioned, *plus* it still wouldn't reliably fix the problem unless we also forced the system to rebuild its initramfs (to get the updated systemd.conf) before running fedup (which then pulls the updated file into upgrade.img)."
					},
					{
						"isprivate": "0",
						"commentid": "7635715",
						"comment_count": "33",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-03 15:29:13 +0000",
						"thetext": "That'd be viable, yeah, but it'd still worry me that people *could* use the Beta tree and hit the bug. It's a bit hard to remember what instructions we've written down where for doing pre-release upgrades, at this point, we may well have pointed people at the frozen milestone tree as a source of stable, 'known-OK' upgrade images.\n\nThe only other viable place we have to point mirrormanager, BTW, at least up until Final TC1, is into development/21 , where the image might conceivably be broken or missing some days (missing isn't that likely, but possible, I guess). It's something we'd have to worry about every time it got rebuilt.\n\nI knew about the initramfs wrinkle of course (bit hard not to when writing that patch :>) but forgot about the impact it'd have on the F20 solution.\n\nI'm still kind of liking something like my approach, tbh, however we want to try and 'bound' it so it's not around forever (only put it in fedup builds till Final TC1, conditionalize it in the code somehow, whatever)."
					},
					{
						"isprivate": "0",
						"commentid": "7635716",
						"comment_count": "34",
						"who": {
							"text": "wwoods",
							"name": "Will Woods"
						},
						"bug_when": "2014-11-03 15:29:37 +0000",
						"thetext": "(In reply to Zbigniew Jędrzejewski-Szmek from comment #28)\n> The system wide timeout was changed to a unit-specific timeouts (see\n> http://cgit.freedesktop.org/systemd/systemd/commit/?id=3898b80d40). This is\n> more flexible, because different values make sense for different targets,\n> and also it ties more naturally into existing configuration scheme. One or\n> two options (JobTimeoutSec, JobTimeoutAction) are added to specific units\n> for which the timeouts are wanted.\n>\n> In the new scheme, there's a 15 min timeout on basic.target (not\n> default.target like before), and 30 min timeout for reboot/poweroff. The\n> first one shouldn't matter for fedup\n\nRight. We have two sets of targets:\n\nHost: \n* system-upgrade-generator links \"system-upgrade.target\" to default.target\n* system-upgrade.target Requires sysinit.target, Wants upgrade-prep.service\n* upgrade-prep.service (on ExecStopPost) isolates upgrade-switch-root.target\n\n[Here we switch-root back to upgrade.img to run the upgrade..]\n\nUpgrade.img:\n* initrd-system-upgrade-generator links \"upgrade.target\" to default.target\n* upgrade.target Requires sysinit.target and sockets.target\n\n[And now the upgrade actually starts.]\n\nSo, yes: we don't use basic.target in either case, which means we shouldn't need to worry about this after Beta.\n\n(In reply to Zbigniew Jędrzejewski-Szmek from comment #24)\n> (In reply to Will Woods from comment #22)\n> > On the other hand, this can probably also be fixed by adjusting the systemd\n> > units in the initramfs so that systemd properly considers startup to be\n> > finished before the upgrade starts.. which would probably be the intended\n> > behavior for dealing with this feature anyway.\n> That would be hard, changes to the the boot order are inherently fragile.\n> Adam's fix seems to be much safer.\n\nI don't think I need to change the existing boot ordering, I think I just need to tweak the ordering for 'system-upgrade.target' in the \"Host\" section above.\n\nIf I understand the StartTimeoutAction implementation correctly, the timeout happens if systemd's initial job queue doesn't empty after 15 minutes; I just need to fix the units that fedup ships so that the job queue correctly empties (i.e. systemd considers the system started) before we do the switch-root."
					},
					{
						"isprivate": "0",
						"commentid": "7635792",
						"comment_count": "35",
						"who": {
							"text": "wwoods",
							"name": "Will Woods"
						},
						"bug_when": "2014-11-03 15:46:48 +0000",
						"thetext": "Testing to confirm now, but if I've read the systemd code right, this will solve the problem:\n\ndiff --git a/systemd/upgrade-prep.service.in b/systemd/upgrade-prep.service.in\nindex af39946..a28837b 100644\n--- a/systemd/upgrade-prep.service.in\n+++ b/systemd/upgrade-prep.service.in\n@@ -7,7 +7,7 @@ OnFailureIsolate=true\n DefaultDependencies=no\n \n [Service]\n-Type=oneshot\n+Type=idle\n ExecStart=@LIBEXECDIR@/upgrade-prep.sh\n ExecStopPost=-/usr/bin/systemctl --no-block isolate upgrade-switch-root.target\n StandardOutput=journal+console"
					},
					{
						"isprivate": "0",
						"commentid": "7635896",
						"comment_count": "36",
						"who": {
							"text": "wwoods",
							"name": "Will Woods"
						},
						"bug_when": "2014-11-03 16:23:14 +0000",
						"thetext": "Well, my test upgrade is 40% complete after 23 minutes and still going, so I think the above patch works.\n\nFurther confirmation would be appreciated, of course; to try this workaround, just edit /lib/systemd/system/upgrade-prep.service and change the Type to 'idle' before you reboot. Or just:\n\n sudo sed -i 's/Type=oneshot/Type=idle/' /lib/systemd/system/upgrade-prep.service\n\nAlso, just to be clear: the systemd bug is still in the RC4 upgrade.img. We can push this workaround as an update, but if we don't fix upgrade.img anyone who upgrades to F21 Beta without updating fedup first will have their systems mangled."
					},
					{
						"isprivate": "0",
						"commentid": "7635938",
						"comment_count": "37",
						"who": {
							"text": "zbyszek",
							"name": "Zbigniew Jędrzejewski-Szmek"
						},
						"bug_when": "2014-11-03 16:31:44 +0000",
						"thetext": "The problem is that systemd will consider upgrade-prep.service failed after it exits. Might now matter though."
					},
					{
						"isprivate": "0",
						"commentid": "7635955",
						"comment_count": "38",
						"who": {
							"text": "zbyszek",
							"name": "Zbigniew Jędrzejewski-Szmek"
						},
						"bug_when": "2014-11-03 16:34:52 +0000",
						"thetext": "(In reply to Zbigniew Jędrzejewski-Szmek from comment #37)\n> The problem is that systemd will consider upgrade-prep.service failed after\n> it exits. Might now matter though.\nNevermind, it exits with 0 so everything is fine."
					},
					{
						"isprivate": "0",
						"commentid": "7636165",
						"comment_count": "39",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-03 18:01:42 +0000",
						"thetext": "fedup-0.9.0-2.fc20 has been submitted as an update for Fedora 20.\nhttps://admin.fedoraproject.org/updates/fedup-0.9.0-2.fc20"
					},
					{
						"isprivate": "0",
						"commentid": "7636179",
						"comment_count": "40",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-03 18:05:30 +0000",
						"thetext": "fedup-0.9.0-2.fc19 has been submitted as an update for Fedora 19.\nhttps://admin.fedoraproject.org/updates/fedup-0.9.0-2.fc19"
					},
					{
						"isprivate": "0",
						"commentid": "7636187",
						"comment_count": "41",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-03 18:05:47 +0000",
						"thetext": "fedup-0.9.0-2.fc21 has been submitted as an update for Fedora 21.\nhttps://admin.fedoraproject.org/updates/fedup-0.9.0-2.fc21"
					},
					{
						"isprivate": "0",
						"commentid": "7636301",
						"comment_count": "42",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-03 18:43:54 +0000",
						"thetext": "0.9.0-2 looks good in a test from my reproducer, I got a complete upgrade from my reproducer snapshot. Note 0.9.0-2 uses the fix wwoods sugested in c#35, not the one I suggested, so tests of my scratch build do not validate 0.9.0-2. It'd be great if others who can reproduce can test with 0.9.0-2, confirm the fix, and provide karma ASAP - we want to get this pushed stable by tomorrow."
					},
					{
						"isprivate": "0",
						"commentid": "7636377",
						"comment_count": "43",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-03 19:16:33 +0000",
						"thetext": "systemd-216-8.fc21 has been submitted as an update for Fedora 21.\nhttps://admin.fedoraproject.org/updates/systemd-216-8.fc21"
					},
					{
						"isprivate": "0",
						"commentid": "7636402",
						"comment_count": "44",
						"who": {
							"text": "error",
							"name": "Michael Hampton"
						},
						"bug_when": "2014-11-03 19:27:16 +0000",
						"thetext": "(In reply to Adam Williamson (Red Hat) from comment #42)\n> 0.9.0-2 looks good in a test from my reproducer, I got a complete upgrade\n> from my reproducer snapshot. Note 0.9.0-2 uses the fix wwoods sugested in\n> c#35, not the one I suggested, so tests of my scratch build do not validate\n> 0.9.0-2. It'd be great if others who can reproduce can test with 0.9.0-2,\n> confirm the fix, and provide karma ASAP - we want to get this pushed stable\n> by tomorrow.\n\nI've put in my good karma. 0.9.0-2 not only works, it is not slow for me like the scratch build was."
					},
					{
						"isprivate": "0",
						"commentid": "7637547",
						"comment_count": "45",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-04 02:29:16 +0000",
						"thetext": "fedup-0.9.0-2.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7637567",
						"comment_count": "46",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-04 02:35:13 +0000",
						"thetext": "Let's keep this open while we track all the changes and close it manually when we're sure everything's good (expect a few more close/re-open bounces like this)."
					},
					{
						"isprivate": "0",
						"commentid": "7637614",
						"comment_count": "47",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-04 02:48:06 +0000",
						"thetext": "systemd-216-8.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7637895",
						"comment_count": "48",
						"who": {
							"text": "mruckman",
							"name": "Mike Ruckman"
						},
						"bug_when": "2014-11-04 05:55:42 +0000",
						"thetext": "Reopening per comment #46."
					},
					{
						"isprivate": "0",
						"commentid": "7640614",
						"comment_count": "49",
						"who": {
							"text": "michael.monreal",
							"name": "Michael Monreal"
						},
						"bug_when": "2014-11-04 17:33:32 +0000",
						"thetext": "Is this fixed now when upgrading a F20 desktop to F21 beta?"
					},
					{
						"isprivate": "0",
						"commentid": "7640619",
						"comment_count": "50",
						"who": {
							"text": "error",
							"name": "Michael Hampton"
						},
						"bug_when": "2014-11-04 17:36:08 +0000",
						"thetext": "(In reply to Michael Monreal from comment #49)\n> Is this fixed now when upgrading a F20 desktop to F21 beta?\n\nYes, provided the updates have reached your local mirror (which they should have by now)."
					},
					{
						"isprivate": "0",
						"commentid": "7640649",
						"comment_count": "51",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-04 17:46:48 +0000",
						"thetext": "It's a slightly complex question. See https://fedoraproject.org/wiki/Common_F21_bugs#no-fedup-beta .\n\nTo upgrade you need a copy of fedup on your F20 install, and that fedup needs to find a copy of 'upgrade.img', which is the initramfs containing the upgrade environment.\n\nAs of this moment, we've made it so that when fedup goes and looks for an upgrade.img , it can't find one. Right now you can't do a fedup to F21 at all without explicitly providing an upgrade.img location with the '--instrepo' parameter.\n\nWe've also implemented a fedup-side workaround and a systemd-side fix for this bug. The fedup-side workaround should mean that if you upgrade with fedup 0.9.0-2, regardless what upgrade.img you use, you should not be able to hit this bug. upgrade.img files that could still be affected by this bug are in the Beta TC4 through Beta RC4 trees on the staging server. It *should* be safe to upgrade using one of those trees with fedup 0.9.0-2.\n\nThe systemd-side fix requires upgrade.img to be rebuilt. The systemd fix was pushed stable yesterday, so the upgrade.img files in the development/21 tree on the mirrors will contain the systemd-side fix from today onwards - roughly. It depends on mirror sync times. I don't believe anyone's explicitly tested with that upgrade.img yet.\n\nThe Final TC1 tree should also contain an upgrade.img with the systemd-side fix. I am currently running a test of that. Our plan is to make the pointer fedup uses to find upgrade.img point to the Final TC1 tree, assuming it tests out OK, as a 'stable' source of an upgrade.img which is known not to contain the bug.\n\nRight now I'm not willing to say with absolute certainty 'you should upgrade this way', but if I had to upgrade a system RIGHT NOW with a gun to my head I'd say use fedup 0.9.0-2 and pass --instrepo https://dl.fedoraproject.org/pub/alt/stage/21_TC1/Server/x86_64/os/ (or i386 or armhpf, as appropriate). It'd probably be best to wait until we've tested it a bit more and updated the redirects so fedup 'just works', though. Shouldn't be too long (later today)."
					},
					{
						"isprivate": "0",
						"commentid": "7640695",
						"comment_count": "52",
						"who": {
							"text": "michael.monreal",
							"name": "Michael Monreal"
						},
						"bug_when": "2014-11-04 18:04:59 +0000",
						"thetext": "(In reply to Adam Williamson (Red Hat) from comment #51)\n> It's a slightly complex question. See\n> https://fedoraproject.org/wiki/Common_F21_bugs#no-fedup-beta .\n> ...\n\nThanks for explaining in detail."
					},
					{
						"isprivate": "0",
						"commentid": "7640717",
						"comment_count": "53",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-04 18:14:51 +0000",
						"thetext": "I tested an upgrade using fedup 0.9.0-1 (i.e. intentionally avoiding the fedup workaround) against the upgrade.img from Final TC1 tree and it doesn't hit the bug. If a few other folks can confirm, I think we can use that as the mirrormanager target."
					},
					{
						"isprivate": "0",
						"commentid": "7641164",
						"comment_count": "54",
						"who": {
							"text": "milan.kerslager",
							"name": "Milan Kerslager"
						},
						"bug_when": "2014-11-04 21:22:54 +0000",
						"thetext": "I took fedup-0.9.0-1.fc21.noarch from http://arm.koji.fedoraproject.org/koji/buildinfo?buildID=247899 because I didn't know where to take 0.9.0-1 for FC20. Then (after rpm -Uvh --oldpackage fedup*):\n\nfedup --product=workstation --network 21 --instrepo https://dl.fedoraproject.org/pub/alt/stage/21_TC1/Server/x86_64/os/\n\nThe upgrade went correcly, it took 18 mins 50 secs (2123 packages, I have SSD) on my primary machine (ie. on baremetal, no virtualization).\n\nYou good guys. I feel happy now :-) Thank you for fixing bugs."
					},
					{
						"isprivate": "0",
						"commentid": "7641184",
						"comment_count": "55",
						"who": {
							"text": "milan.kerslager",
							"name": "Milan Kerslager"
						},
						"bug_when": "2014-11-04 21:31:30 +0000",
						"thetext": "BTW: I saw nice ASCII art at the end of the transaction, it told me that the transaction finished succesfully and the machine will be rebooted then. So no prelimitary reboot occurred."
					},
					{
						"isprivate": "0",
						"commentid": "7641187",
						"comment_count": "56",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-04 21:34:28 +0000",
						"thetext": "Yup, if you see Beefy it means it worked right. =) Thanks for testing!"
					},
					{
						"isprivate": "0",
						"commentid": "7641471",
						"comment_count": "57",
						"who": {
							"text": "satellitgo"
						},
						"bug_when": "2014-11-05 00:58:44 +0000",
						"thetext": "I saw it also f20 > f21\nhttp://wiki.sugarlabs.org/go/Fedora_21#fedup_Updating_f20_desktop_to_f21_workstation\n\nyum update\nyum install fedup\nfedup --nogpgcheck --network 21 --product workstation --instrepo https://dl.fedoraproject.org/pub/alt/stage/21_TC1/Server/x86_64/os/\n\n    Download 1415 files \n\n    reboot system\n    \"System Upgrade Fedup\" on boot menu\n\n    fedup-dracut-0.9.0\n\n        Update 1415 files \n\n    NOTE: Terminal display stops updating at about 68%\n\n    FIX: switch to {alt-f2} then {alt-f1} \n\n    Successful Upgrade."
					},
					{
						"isprivate": "0",
						"commentid": "7641598",
						"comment_count": "58",
						"who": {
							"text": "satellitgo"
						},
						"bug_when": "2014-11-05 02:46:38 +0000",
						"thetext": "(In reply to satellitgo from comment #57)\n> I saw it also f20 > f21\n> http://wiki.sugarlabs.org/go/\n> Fedora_21#fedup_Updating_f20_desktop_to_f21_workstation\n> \n> yum update\n> yum install fedup\n> fedup --nogpgcheck --network 21 --product workstation --instrepo\n> https://dl.fedoraproject.org/pub/alt/stage/21_TC1/Server/x86_64/os/\n> \n>     Download 1415 files \n> \n>     reboot system\n>     \"System Upgrade Fedup\" on boot menu\n> \n>     fedup-dracut-0.9.0\n> \n>         Update 1415 files \n> \n>     NOTE: Terminal display stops updating at about 68%\n> \n>     FIX: switch to {alt-f2} then {alt-f1} \n> \n>     Successful Upgrade.\n\nfedup of KDE f20 also worked"
					},
					{
						"isprivate": "0",
						"commentid": "7641690",
						"comment_count": "59",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-05 03:57:23 +0000",
						"thetext": "fedup-0.9.0-2.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7644519",
						"comment_count": "60",
						"who": {
							"text": "kparal",
							"name": "Kamil Páral"
						},
						"bug_when": "2014-11-05 17:32:52 +0000",
						"thetext": "The updates have been pushed and multiple people verified the fix, closing."
					},
					{
						"isprivate": "0",
						"commentid": "7644557",
						"comment_count": "61",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2014-11-05 17:44:37 +0000",
						"thetext": "I was actually tracking multiple 'fixes' in multiple places, but I think the mirrormanager redirects to TC1 are up now which is the last thing we needed, so closed is probably fine. It'd be good to test a straight 'fedup --network 21 --product (foo)' from 19 and 20, with both 0.9.0-1 and 0.9.0-2, to verify everything is in place as expected."
					},
					{
						"isprivate": "0",
						"commentid": "7647212",
						"comment_count": "62",
						"who": {
							"text": "kparal",
							"name": "Kamil Páral"
						},
						"bug_when": "2014-11-06 13:25:52 +0000",
						"thetext": "(In reply to Adam Williamson (Red Hat) from comment #61)\n> I was actually tracking multiple 'fixes' in multiple places, but I think the\n> mirrormanager redirects to TC1 are up now\n\nThey are still missing.\nhttps://mirrors.fedoraproject.org/mirrorlist?repo=fedora-install-21&arch=x86_64\nreturns\n> # repo = fedora-install-21 arch = x86_64 error: invalid repo or arch"
					},
					{
						"isprivate": "0",
						"commentid": "7648142",
						"comment_count": "63",
						"who": {
							"text": "adamw+fedora",
							"name": "DO NOT USE account not monitored (old adamwill)"
						},
						"bug_when": "2014-11-06 16:40:26 +0000",
						"thetext": "Yeah - sorry, I followed that up later but didn't update this bug. See https://fedoraproject.org/wiki/Common_F21_bugs#no-fedup-beta and bug #1160931."
					},
					{
						"isprivate": "0",
						"commentid": "7655071",
						"comment_count": "64",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-10 06:02:45 +0000",
						"thetext": "fedup-0.9.0-2.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
					}
				]
			}
		}
	],
	"builds": [
		{
			"nvr": "fedup-0.9.0-2.fc21",
			"signed": true,
			"type": "rpm",
			"package": {
				"noarch": [
					{
						"name": "fedup",
						"version": "0.9.0",
						"release": "2.fc21",
						"arch": "noarch"
					}
				],
				"src": [
					{
						"name": "fedup",
						"version": "0.9.0",
						"release": "2.fc21",
						"arch": "src"
					}
				]
			}
		}
	],
	"close_bugs": true,
	"comments": [
		{
			"id": 238392,
			"text": "This update has been submitted for testing by wwoods. ",
			"timestamp": "2014-11-03 18:06:15",
			"update_id": 29661,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 238393,
			"text": "Taskotron: depcheck test PASSED on i386. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/8091/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2014-11-03 18:14:22",
			"update_id": 29661,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/1c99e8328b68b58a71f5a9d6449baa7cb914591c56cbec0adfac7c50e4abefa4?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 238394,
			"text": "Taskotron: depcheck test PASSED on x86_64. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/8091/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2014-11-03 18:14:34",
			"update_id": 29661,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/1c99e8328b68b58a71f5a9d6449baa7cb914591c56cbec0adfac7c50e4abefa4?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 238395,
			"text": "This update is currently being pushed to the Fedora 21 testing updates repository.",
			"timestamp": "2014-11-05 17:20:03",
			"update_id": 29661,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 238396,
			"text": "This update has been pushed to testing",
			"timestamp": "2014-11-05 19:26:02",
			"update_id": 29661,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 238397,
			"karma": 1,
			"text": "no regression",
			"timestamp": "2014-11-06 15:21:13",
			"update_id": 29661,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/f8db9b35a53624d807b2dd11c2109d12585c5852f0ff616077f8ed9348854fb1?s=24&d=retro",
				"email": "marttikuosmanen@yahoo.co.uk",
				"groups": [
					{
						"name": "ipausers"
					},
					{
						"name": "signed_fpca"
					}
				],
				"id": 417,
				"name": "kuosmanen",
				"openid": "kuosmanen.id.fedoraproject.org"
			},
			"user_id": 417
		},
		{
			"id": 238398,
			"karma": 1,
			"timestamp": "2014-11-06 23:53:35",
			"update_id": 29661,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/59992dace52d139450ee0f5b7a5cc1559825f576b38f86551e5b0b3dfaa5618b?s=24&d=retro",
				"email": "hansmueller183@yahoo.com",
				"groups": [
					{
						"name": "ipausers"
					},
					{
						"name": "signed_fpca"
					}
				],
				"id": 284,
				"name": "cairo",
				"openid": "cairo.id.fedoraproject.org"
			},
			"user_id": 284
		},
		{
			"id": 238399,
			"karma": 1,
			"timestamp": "2014-11-08 11:44:21",
			"update_id": 29661,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/2f2b587171cdabe19e85c9fdbad151effb8675add0763640b9fd57bb67c02e65?s=24&d=retro",
				"email": "smithpeter835@yahoo.co.uk",
				"groups": [
					{
						"name": "ipausers"
					}
				],
				"id": 506,
				"name": "smithp",
				"openid": "smithp.id.fedoraproject.org"
			},
			"user_id": 506
		},
		{
			"id": 238400,
			"text": "This update has reached the stable karma threshold and will be pushed to the stable updates repository",
			"timestamp": "2014-11-08 11:44:25",
			"update_id": 29661,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 238401,
			"text": "Taskotron: upgradepath test PASSED on noarch. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/9896/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2014-11-08 12:05:11",
			"update_id": 29661,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/1c99e8328b68b58a71f5a9d6449baa7cb914591c56cbec0adfac7c50e4abefa4?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 238402,
			"karma": 1,
			"timestamp": "2014-11-08 17:40:28",
			"update_id": 29661,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/8565c2dfa53d10789f72ad8acb147dcde3c431f668cde1916a812d1d8f945875?s=24&d=retro",
				"email": "pnemade@redhat.com",
				"groups": [
					{
						"name": "provenpackager"
					},
					{
						"name": "packager"
					},
					{
						"name": "giti18n"
					},
					{
						"name": "gitinscript2"
					},
					{
						"name": "gitwordxtr"
					},
					{
						"name": "gityum-langpacks"
					},
					{
						"name": "svnsystem-config-language"
					},
					{
						"name": "ipausers"
					},
					{
						"name": "gitutrrs-web"
					},
					{
						"name": "svnlohit"
					},
					{
						"name": "fedora-contributor"
					},
					{
						"name": "svniok"
					},
					{
						"name": "fedorabugs"
					},
					{
						"name": "signed_fpca"
					},
					{
						"name": "gitiok2"
					},
					{
						"name": "gitfontpackages"
					},
					{
						"name": "gitredhatlsb"
					},
					{
						"name": "cla_redhat"
					},
					{
						"name": "cvslohit-fonts"
					},
					{
						"name": "trust admins"
					}
				],
				"id": 262,
				"name": "pnemade",
				"openid": "pnemade.id.fedoraproject.org"
			},
			"user_id": 262
		},
		{
			"id": 238403,
			"text": "This update is currently being pushed to the Fedora 21 stable updates repository.",
			"timestamp": "2014-11-09 17:42:07",
			"update_id": 29661,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 238404,
			"text": "This update is currently being pushed to the Fedora 21 stable updates repository.",
			"timestamp": "2014-11-09 17:56:30",
			"update_id": 29661,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 238405,
			"text": "This update has been pushed to stable",
			"timestamp": "2014-11-10 06:02:53",
			"update_id": 29661,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		}
	],
	"content_type": "rpm",
	"date_modified": "2014-11-03 18:07:08",
	"date_pushed": "2014-11-10 06:02:53",
	"date_stable": "2014-11-10 06:02:53",
	"date_submitted": "2014-11-03 18:06:03",
	"date_testing": "2014-11-05 19:26:02",
	"karma": 4,
	"meets_testing_requirements": true,
	"notes": "This update works around a serious problem in Fedora 21 Beta which makes systems automatically shut down 15 minutes into the upgrade.\r\n\r\nOther improvements:\r\n\r\n* Adds `--product=PRODUCT` flag, required for upgrades to F21\r\n* Uses host's config files in `upgrade.img`, which should fix various upgrade problems (e.g. incorrect keyboard layout when unlocking disks due to missing `vconsole.conf`)\r\n* Logging improvements: complete upgrade log should appear in system journal",
	"pushed": true,
	"release": {
		"branch": "f21",
		"candidate_tag": "f21-updates-candidate",
		"composed_by_bodhi": true,
		"dist_tag": "f21",
		"id_prefix": "FEDORA",
		"long_name": "Fedora 21",
		"mail_template": "fedora_errata_template",
		"name": "F21",
		"override_tag": "f21-override",
		"package_manager": "dnf",
		"pending_stable_tag": "f21-updates-pending",
		"pending_testing_tag": "f21-updates-testing-pending",
		"stable_tag": "f21-updates",
		"state": "archived",
		"testing_repository": "updates-testing",
		"testing_tag": "f21-updates-testing",
		"version": "21"
	},
	"severity": "unspecified",
	"stable_karma": 3,
	"status": "stable",
	"suggest": "unspecified",
	"title": "fedup-0.9.0-2.fc21",
	"type": "security",
	"url": "https://bodhi.fedoraproject.org/updates/FEDORA-2014-14347",
	"unstable_karma": -3,
	"updateid": "FEDORA-2014-14347",
	"user": {
		"avatar": "https://seccdn.libravatar.org/avatar/766d5d596eb1501cc61492cde0684a3f91deb8079352042e4bd5b9810427ce94?s=24&d=retro",
		"email": "wwoods@redhat.com",
		"groups": [
			{
				"name": "proventesters"
			},
			{
				"name": "packager"
			}
		],
		"id": 1025,
		"name": "wwoods",
		"openid": "wwoods.id.fedoraproject.org"
	},
	"version_hash": "0b95b8cddb3ed21decba13acfde1aa9781a0c747"
}
