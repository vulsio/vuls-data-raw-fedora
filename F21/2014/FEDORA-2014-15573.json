{
	"alias": "FEDORA-2014-15573",
	"bugs": [
		{
			"bug_id": 1165626,
			"security": true,
			"title": "Heap overflow while matching against an expression with an assertion with a zero minimum repeat as the condition in a conditional group.",
			"bugzilla": {
				"bug_id": "1165626",
				"creation_ts": "2014-11-19 11:44:34 +0000",
				"short_desc": "Heap overflow while matching against an expression with an assertion with a zero minimum repeat as the condition in a conditional group.",
				"delta_ts": "2014-12-19 18:28:56 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"bug_file_loc": "http://bugs.exim.org/show_bug.cgi?id=1546",
				"keywords": "Security, SecurityTracking",
				"priority": "unspecified",
				"bug_severity": "unspecified",
				"blocked": [
					{
						"bug_id": "1166147",
						"alias": "CVE-2014-8964",
						"creation_ts": "2014-11-20 13:17:00 +0000",
						"short_desc": "CVE-2014-8964 pcre: incorrect handling of zero-repeat assertion conditions",
						"delta_ts": "2021-10-20 10:47:40 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Security",
						"priority": "low",
						"bug_severity": "low",
						"depends_on": [
							"1165626",
							"1169797",
							"1177278"
						],
						"blocked": [
							{
								"bug_id": "1166148",
								"error": "NotPermitted"
							}
						],
						"external_bugs": {
							"text": "RHSA-2015:0330",
							"name": "Red Hat Product Errata"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "7691088",
								"comment_count": "0",
								"who": {
									"text": "vkaigoro",
									"name": "Vasyl Kaigorodov"
								},
								"bug_when": "2014-11-20 13:17:00 +0000",
								"thetext": "Heap buffer overflow issue was reported in PCRE when processing a specially crafted regular expressions:\nhttp://bugs.exim.org/show_bug.cgi?id=1546\n\nUpstream patch for this:\nhttp://www.exim.org/viewvc/pcre2?view=rev&revision=154\n\nThe next upstream release that will contain the above fix is likely to be around Feb/Mar next year (2015)."
							},
							{
								"isprivate": "0",
								"commentid": "7691133",
								"comment_count": "1",
								"who": {
									"text": "vkaigoro",
									"name": "Vasyl Kaigorodov"
								},
								"bug_when": "2014-11-20 13:24:48 +0000",
								"thetext": "Original report along with the patch:\n...\necho \"a\" | /tmp/pcre-8.36/pcregrep \"((?=(?(?=(?(?=(?(?=())))*))))){2}\" -\n=================================================================\n==29857==ERROR: AddressSanitizer: heap-buffer-overflow on address\n0x61000000fb94 at pc 0x7faf416f0dc6 bp 0x7fff9c91d3b0 sp 0x7fff9c91d3a8\nREAD of size 1 at 0x61000000fb94 thread T0\n    #0 0x7faf416f0dc5 in match /tmp/pcre-8.36/pcre_exec.c:1410:9\n    #1 0x7faf416dfe35 in match /tmp/pcre-8.36/pcre_exec.c:1538:7\n    #2 0x7faf416e46de in match /tmp/pcre-8.36/pcre_exec.c:1399:7\n    #3 0x7faf416dfe35 in match /tmp/pcre-8.36/pcre_exec.c:1538:7\n    #4 0x7faf416ee260 in match /tmp/pcre-8.36/pcre_exec.c:983:9\n    #5 0x7faf416dcd49 in pcre_exec /tmp/pcre-8.36/pcre_exec.c:6923:8\n    #6 0x4a4580 in match_patterns /tmp/pcre-8.36/pcregrep.c:1449:10\n    #7 0x4a13ca in pcregrep /tmp/pcre-8.36/pcregrep.c:1679:11\n    #8 0x4a3624 in grep_or_recurse /tmp/pcre-8.36/pcregrep.c:2122:10\n    #9 0x49efbf in main /tmp/pcre-8.36/pcregrep.c:3251:13\n    #10 0x7faf405b7ec4 in __libc_start_main\n/build/buildd/eglibc-2.19/csu/libc-start.c:287\n    #11 0x4172a6 in _start (/tmp/pcre-8.36/.libs/lt-pcregrep+0x4172a6)\n\nUpstream prepared a fix:\n\n--- pcre_exec.c (revision 1512)\n+++ pcre_exec.c (working copy)\n@@ -1404,8 +1404,11 @@\n         condition = TRUE;\n\n         /* Advance ecode past the assertion to the start of the first branch,\n-        but adjust it so that the general choosing code below works. */\n-\n+        but adjust it so that the general choosing code below works. If the \n+        assertion has a quantifier that allows zero repeats we must skip over \n+        the BRAZERO. This is a lunatic thing to do, but somebody did! */\n+        \n+        if (*ecode == OP_BRAZERO) ecode++; \n         ecode += GET(ecode, 1);\n         while (*ecode == OP_ALT) ecode += GET(ecode, 1);\n         ecode += 1 + LINK_SIZE - PRIV(OP_lengths)[condcode];"
							},
							{
								"isprivate": "0",
								"commentid": "7691145",
								"comment_count": "2",
								"who": {
									"text": "ppisar",
									"name": "Petr Pisar"
								},
								"bug_when": "2014-11-20 13:27:48 +0000",
								"thetext": "I fixed it in Fedora 22 and 21. I cannot fix it in older Fedoras because the fix depends on another extensive change which I do not want to back-port. If you have different opinion we could try to involve the upstream, but I believe this is not necessary."
							},
							{
								"isprivate": "0",
								"commentid": "7691220",
								"comment_count": "3",
								"who": {
									"text": "vkaigoro",
									"name": "Vasyl Kaigorodov"
								},
								"bug_when": "2014-11-20 13:39:59 +0000",
								"thetext": "(In reply to Petr Pisar from comment #2)\n> I fixed it in Fedora 22 and 21. I cannot fix it in older Fedoras because the\n> fix depends on another extensive change which I do not want to back-port. If\n> you have different opinion we could try to involve the upstream, but I\n> believe this is not necessary.\n\nTaking the Low impact - I would say it's not necessary.\nUnless a real exploit is found for this I'd say let's leave it for now as it is."
							},
							{
								"isprivate": "0",
								"commentid": "7691638",
								"comment_count": "4",
								"who": {
									"text": "vkaigoro",
									"name": "Vasyl Kaigorodov"
								},
								"bug_when": "2014-11-20 14:56:27 +0000",
								"thetext": "CVE request: http://seclists.org/oss-sec/2014/q4/714"
							},
							{
								"isprivate": "0",
								"commentid": "7694529",
								"comment_count": "5",
								"who": {
									"text": "mprpic",
									"name": "Martin Prpič"
								},
								"bug_when": "2014-11-21 09:07:43 +0000",
								"thetext": "CVE-2014-8964 was assigned to this issue:\n\nhttp://seclists.org/oss-sec/2014/q4/746"
							},
							{
								"isprivate": "0",
								"commentid": "7720158",
								"comment_count": "6",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-12-01 11:56:07 +0000",
								"thetext": "(In reply to Vasyl Kaigorodov from comment #0)\n> Upstream patch for this:\n> http://www.exim.org/viewvc/pcre2?view=rev&revision=154\n\nUpstream patch in pcre / pcre1 repository:\nhttp://www.exim.org/viewvc/pcre?view=revision&revision=1513"
							},
							{
								"isprivate": "0",
								"commentid": "7722153",
								"comment_count": "7",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-12-01 20:46:21 +0000",
								"thetext": "The problem here is that malicious regular expression may cause an op code pointer to point outside of the buffer that holds compiled regular expression.  This happens because the unexpected OP_BRAZERO code makes pcre use the following code (OP_ASSERT in the regular expressions from the upstream bugs) as part of the value that indicate the number of bytes to advance the code pointer by.  In the worst case, pcre may end up interpreting malicious compiled regex op code.  While pcre seems to preform bounds checking when performing write operations while interpreting op code, it may be possible to (indirectly) disclose some portions of the process memory."
							},
							{
								"isprivate": "0",
								"commentid": "7722159",
								"comment_count": "8",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-12-01 20:52:03 +0000",
								"thetext": "(In reply to Petr Pisar from comment #2)\n> I fixed it in Fedora 22 and 21. I cannot fix it in older Fedoras because the\n> fix depends on another extensive change which I do not want to back-port.\n\nIsn't this equivalent change for PCRE 8.32?\n\n--- pcre-8.32/pcre_exec.c.orig\n+++ pcre-8.32/pcre_exec.c\n@@ -1459,7 +1459,9 @@ for (;;)\n         if (md->end_offset_top > offset_top)\n           offset_top = md->end_offset_top;  /* Captures may have happened */\n         condition = TRUE;\n-        ecode += 1 + LINK_SIZE + GET(ecode, LINK_SIZE + 2);\n+        ecode += 1 + LINK_SIZE;\n+        if (*ecode == OP_BRAZERO) ecode++;\n+        ecode += GET(ecode, 1);\n         while (*ecode == OP_ALT) ecode += GET(ecode, 1);\n         }\n \nCode in the more recent PCRE versions increment ecode by 1 + LINK_SIZE earlier, near the beginning of the OP_COND / OP_SCOND case."
							},
							{
								"isprivate": "0",
								"commentid": "7724285",
								"comment_count": "12",
								"who": {
									"text": "ppisar",
									"name": "Petr Pisar"
								},
								"bug_when": "2014-12-02 12:06:22 +0000",
								"thetext": "(In reply to Tomas Hoger from comment #8)\n> --- pcre-8.32/pcre_exec.c.orig\n> +++ pcre-8.32/pcre_exec.c\n> @@ -1459,7 +1459,9 @@ for (;;)\n>          if (md->end_offset_top > offset_top)\n>            offset_top = md->end_offset_top;  /* Captures may have happened */\n>          condition = TRUE;\n> -        ecode += 1 + LINK_SIZE + GET(ecode, LINK_SIZE + 2);\n> +        ecode += 1 + LINK_SIZE;\n> +        if (*ecode == OP_BRAZERO) ecode++;\n> +        ecode += GET(ecode, 1);\n>          while (*ecode == OP_ALT) ecode += GET(ecode, 1);\n>          }\n>  \n> Code in the more recent PCRE versions increment ecode by 1 + LINK_SIZE\n> earlier, near the beginning of the OP_COND / OP_SCOND case.\n\nGreat. That makes the trick. I will push it."
							},
							{
								"isprivate": "0",
								"commentid": "7757478",
								"comment_count": "14",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-12-12 04:16:06 +0000",
								"thetext": "pcre-8.35-8.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7782047",
								"comment_count": "15",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-12-19 18:27:18 +0000",
								"thetext": "pcre-8.32-12.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7782062",
								"comment_count": "16",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2014-12-19 18:28:58 +0000",
								"thetext": "pcre-8.33-8.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "7790042",
								"comment_count": "17",
								"who": {
									"text": "yselkowi",
									"name": "Yaakov Selkowitz"
								},
								"bug_when": "2014-12-24 17:54:18 +0000",
								"thetext": "Does this apply also to mingw-pcre?"
							},
							{
								"isprivate": "0",
								"commentid": "7790979",
								"comment_count": "18",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-12-25 16:11:45 +0000",
								"thetext": "(In reply to Yaakov Selkowitz from comment #17)\n> Does this apply also to mingw-pcre?\n\nIt most likely does.  Versions 8.32 - 8.35 were confirmed as affected, mingw-pcre versions currently in Fedora are all within the range."
							},
							{
								"isprivate": "0",
								"commentid": "7790982",
								"comment_count": "19",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2014-12-25 16:13:58 +0000",
								"thetext": "\nCreated mingw-pcre tracking bugs for this issue:\n\nAffects: fedora-all [bug 1177278]"
							},
							{
								"isprivate": "0",
								"commentid": "8008959",
								"comment_count": "21",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2015-03-05 07:14:59 +0000",
								"thetext": "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7\n\nVia RHSA-2015:0330 https://rhn.redhat.com/errata/RHSA-2015-0330.html"
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "7687010",
						"comment_count": "0",
						"who": {
							"text": "ppisar",
							"name": "Petr Pisar"
						},
						"bug_when": "2014-11-19 11:44:34 +0000",
						"thetext": "The is a bug in the PCRE library as reported to upstream <http://bugs.exim.org/show_bug.cgi?id=1546>:\n\necho \"a\" | /tmp/pcre-8.36/pcregrep \"((?=(?(?=(?(?=(?(?=())))*))))){2}\" -\n=================================================================\n==29857==ERROR: AddressSanitizer: heap-buffer-overflow on address\n0x61000000fb94 at pc 0x7faf416f0dc6 bp 0x7fff9c91d3b0 sp 0x7fff9c91d3a8\nREAD of size 1 at 0x61000000fb94 thread T0\n    #0 0x7faf416f0dc5 in match /tmp/pcre-8.36/pcre_exec.c:1410:9\n    #1 0x7faf416dfe35 in match /tmp/pcre-8.36/pcre_exec.c:1538:7\n    #2 0x7faf416e46de in match /tmp/pcre-8.36/pcre_exec.c:1399:7\n    #3 0x7faf416dfe35 in match /tmp/pcre-8.36/pcre_exec.c:1538:7\n    #4 0x7faf416ee260 in match /tmp/pcre-8.36/pcre_exec.c:983:9\n    #5 0x7faf416dcd49 in pcre_exec /tmp/pcre-8.36/pcre_exec.c:6923:8\n    #6 0x4a4580 in match_patterns /tmp/pcre-8.36/pcregrep.c:1449:10\n    #7 0x4a13ca in pcregrep /tmp/pcre-8.36/pcregrep.c:1679:11\n    #8 0x4a3624 in grep_or_recurse /tmp/pcre-8.36/pcregrep.c:2122:10\n    #9 0x49efbf in main /tmp/pcre-8.36/pcregrep.c:3251:13\n    #10 0x7faf405b7ec4 in __libc_start_main\n/build/buildd/eglibc-2.19/csu/libc-start.c:287\n    #11 0x4172a6 in _start (/tmp/pcre-8.36/.libs/lt-pcregrep+0x4172a6)\n\nUpstream prepared a fix:\n\n--- pcre_exec.c (revision 1512)\n+++ pcre_exec.c (working copy)\n@@ -1404,8 +1404,11 @@\n         condition = TRUE;\n\n         /* Advance ecode past the assertion to the start of the first branch,\n-        but adjust it so that the general choosing code below works. */\n-\n+        but adjust it so that the general choosing code below works. If the \n+        assertion has a quantifier that allows zero repeats we must skip over \n+        the BRAZERO. This is a lunatic thing to do, but somebody did! */\n+        \n+        if (*ecode == OP_BRAZERO) ecode++; \n         ecode += GET(ecode, 1);\n         while (*ecode == OP_ALT) ecode += GET(ecode, 1);\n         ecode += 1 + LINK_SIZE - PRIV(OP_lengths)[condcode];\n\nWhich has not yet been pushed into the repository. Unfortunately, I cannot reproduce the bug.\n\nThe patch will be applied after it emerges in the repository."
					},
					{
						"isprivate": "0",
						"commentid": "7689873",
						"comment_count": "1",
						"who": {
							"text": "ppisar",
							"name": "Petr Pisar"
						},
						"bug_when": "2014-11-20 07:10:01 +0000",
						"thetext": "All Fedoras are affected. I can reproduce it now. Valgrind catches it too. The is visible in the upstream repository now."
					},
					{
						"isprivate": "0",
						"commentid": "7690330",
						"comment_count": "2",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-20 09:46:27 +0000",
						"thetext": "pcre-8.35-8.fc21 has been submitted as an update for Fedora 21.\nhttps://admin.fedoraproject.org/updates/pcre-8.35-8.fc21"
					},
					{
						"isprivate": "0",
						"commentid": "7690983",
						"comment_count": "3",
						"who": {
							"text": "ppisar",
							"name": "Petr Pisar"
						},
						"bug_when": "2014-11-20 12:52:24 +0000",
						"thetext": "The fix requires extensive change which happens just after 8.33:\n\ncommit e0f44ec0903da7ad9c56eec0a0e5c8b02ce6ccb3\nAuthor: ph10 <ph10@2f5784b3-3f2a-0410-8824-cb99058d5e15>\nDate:   Sun Oct 6 18:33:56 2013 +0000\n\n    Refactor named group handling for conditional tests.\n    \n    \n    git-svn-id: svn://vcs.exim.org/pcre/code/trunk@1365 2f5784b3-3f2a-0410-8824-cb99058d5e15\n\n12 files changed, 197 insertions(+), 228 deletions(-)\n\nSo this fix will not applied to F19 and F20. Only F21 and newer will be fixed."
					},
					{
						"isprivate": "0",
						"commentid": "7691126",
						"comment_count": "4",
						"who": {
							"text": "vkaigoro",
							"name": "Vasyl Kaigorodov"
						},
						"bug_when": "2014-11-20 13:23:28 +0000",
						"thetext": "Turning this into Fedora security tracker"
					},
					{
						"isprivate": "0",
						"commentid": "7698583",
						"comment_count": "5",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-11-22 20:20:11 +0000",
						"thetext": "Package pcre-8.35-8.fc21:\n* should fix your issue,\n* was pushed to the Fedora 21 testing repository,\n* should be available at your local mirror within two days.\nUpdate it with:\n# su -c 'yum update --enablerepo=updates-testing pcre-8.35-8.fc21'\nas soon as you are able to.\nPlease go to the following url:\nhttps://admin.fedoraproject.org/updates/FEDORA-2014-15573/pcre-8.35-8.fc21\nthen log in and leave karma (feedback)."
					},
					{
						"isprivate": "0",
						"commentid": "7724476",
						"comment_count": "6",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-02 12:43:47 +0000",
						"thetext": "pcre-8.33-8.fc20 has been submitted as an update for Fedora 20.\nhttps://admin.fedoraproject.org/updates/pcre-8.33-8.fc20"
					},
					{
						"isprivate": "0",
						"commentid": "7724478",
						"comment_count": "7",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-02 12:44:08 +0000",
						"thetext": "pcre-8.32-12.fc19 has been submitted as an update for Fedora 19.\nhttps://admin.fedoraproject.org/updates/pcre-8.32-12.fc19"
					},
					{
						"isprivate": "0",
						"commentid": "7757477",
						"comment_count": "8",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-12 04:16:03 +0000",
						"thetext": "pcre-8.35-8.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7782046",
						"comment_count": "9",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-19 18:27:15 +0000",
						"thetext": "pcre-8.32-12.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7782061",
						"comment_count": "10",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-19 18:28:56 +0000",
						"thetext": "pcre-8.33-8.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
					}
				]
			}
		},
		{
			"bug_id": 1166147,
			"parent": true,
			"security": true,
			"title": "CVE-2014-8964 pcre: incorrect handling of zero-repeat assertion conditions",
			"bugzilla": {
				"bug_id": "1166147",
				"alias": "CVE-2014-8964",
				"creation_ts": "2014-11-20 13:17:00 +0000",
				"short_desc": "CVE-2014-8964 pcre: incorrect handling of zero-repeat assertion conditions",
				"delta_ts": "2021-10-20 10:47:40 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Security",
				"priority": "low",
				"bug_severity": "low",
				"depends_on": [
					"1165626",
					"1169797",
					"1177278"
				],
				"blocked": [
					{
						"bug_id": "1166148",
						"error": "NotPermitted"
					}
				],
				"external_bugs": {
					"text": "RHSA-2015:0330",
					"name": "Red Hat Product Errata"
				},
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "7691088",
						"comment_count": "0",
						"who": {
							"text": "vkaigoro",
							"name": "Vasyl Kaigorodov"
						},
						"bug_when": "2014-11-20 13:17:00 +0000",
						"thetext": "Heap buffer overflow issue was reported in PCRE when processing a specially crafted regular expressions:\nhttp://bugs.exim.org/show_bug.cgi?id=1546\n\nUpstream patch for this:\nhttp://www.exim.org/viewvc/pcre2?view=rev&revision=154\n\nThe next upstream release that will contain the above fix is likely to be around Feb/Mar next year (2015)."
					},
					{
						"isprivate": "0",
						"commentid": "7691133",
						"comment_count": "1",
						"who": {
							"text": "vkaigoro",
							"name": "Vasyl Kaigorodov"
						},
						"bug_when": "2014-11-20 13:24:48 +0000",
						"thetext": "Original report along with the patch:\n...\necho \"a\" | /tmp/pcre-8.36/pcregrep \"((?=(?(?=(?(?=(?(?=())))*))))){2}\" -\n=================================================================\n==29857==ERROR: AddressSanitizer: heap-buffer-overflow on address\n0x61000000fb94 at pc 0x7faf416f0dc6 bp 0x7fff9c91d3b0 sp 0x7fff9c91d3a8\nREAD of size 1 at 0x61000000fb94 thread T0\n    #0 0x7faf416f0dc5 in match /tmp/pcre-8.36/pcre_exec.c:1410:9\n    #1 0x7faf416dfe35 in match /tmp/pcre-8.36/pcre_exec.c:1538:7\n    #2 0x7faf416e46de in match /tmp/pcre-8.36/pcre_exec.c:1399:7\n    #3 0x7faf416dfe35 in match /tmp/pcre-8.36/pcre_exec.c:1538:7\n    #4 0x7faf416ee260 in match /tmp/pcre-8.36/pcre_exec.c:983:9\n    #5 0x7faf416dcd49 in pcre_exec /tmp/pcre-8.36/pcre_exec.c:6923:8\n    #6 0x4a4580 in match_patterns /tmp/pcre-8.36/pcregrep.c:1449:10\n    #7 0x4a13ca in pcregrep /tmp/pcre-8.36/pcregrep.c:1679:11\n    #8 0x4a3624 in grep_or_recurse /tmp/pcre-8.36/pcregrep.c:2122:10\n    #9 0x49efbf in main /tmp/pcre-8.36/pcregrep.c:3251:13\n    #10 0x7faf405b7ec4 in __libc_start_main\n/build/buildd/eglibc-2.19/csu/libc-start.c:287\n    #11 0x4172a6 in _start (/tmp/pcre-8.36/.libs/lt-pcregrep+0x4172a6)\n\nUpstream prepared a fix:\n\n--- pcre_exec.c (revision 1512)\n+++ pcre_exec.c (working copy)\n@@ -1404,8 +1404,11 @@\n         condition = TRUE;\n\n         /* Advance ecode past the assertion to the start of the first branch,\n-        but adjust it so that the general choosing code below works. */\n-\n+        but adjust it so that the general choosing code below works. If the \n+        assertion has a quantifier that allows zero repeats we must skip over \n+        the BRAZERO. This is a lunatic thing to do, but somebody did! */\n+        \n+        if (*ecode == OP_BRAZERO) ecode++; \n         ecode += GET(ecode, 1);\n         while (*ecode == OP_ALT) ecode += GET(ecode, 1);\n         ecode += 1 + LINK_SIZE - PRIV(OP_lengths)[condcode];"
					},
					{
						"isprivate": "0",
						"commentid": "7691145",
						"comment_count": "2",
						"who": {
							"text": "ppisar",
							"name": "Petr Pisar"
						},
						"bug_when": "2014-11-20 13:27:48 +0000",
						"thetext": "I fixed it in Fedora 22 and 21. I cannot fix it in older Fedoras because the fix depends on another extensive change which I do not want to back-port. If you have different opinion we could try to involve the upstream, but I believe this is not necessary."
					},
					{
						"isprivate": "0",
						"commentid": "7691220",
						"comment_count": "3",
						"who": {
							"text": "vkaigoro",
							"name": "Vasyl Kaigorodov"
						},
						"bug_when": "2014-11-20 13:39:59 +0000",
						"thetext": "(In reply to Petr Pisar from comment #2)\n> I fixed it in Fedora 22 and 21. I cannot fix it in older Fedoras because the\n> fix depends on another extensive change which I do not want to back-port. If\n> you have different opinion we could try to involve the upstream, but I\n> believe this is not necessary.\n\nTaking the Low impact - I would say it's not necessary.\nUnless a real exploit is found for this I'd say let's leave it for now as it is."
					},
					{
						"isprivate": "0",
						"commentid": "7691638",
						"comment_count": "4",
						"who": {
							"text": "vkaigoro",
							"name": "Vasyl Kaigorodov"
						},
						"bug_when": "2014-11-20 14:56:27 +0000",
						"thetext": "CVE request: http://seclists.org/oss-sec/2014/q4/714"
					},
					{
						"isprivate": "0",
						"commentid": "7694529",
						"comment_count": "5",
						"who": {
							"text": "mprpic",
							"name": "Martin Prpič"
						},
						"bug_when": "2014-11-21 09:07:43 +0000",
						"thetext": "CVE-2014-8964 was assigned to this issue:\n\nhttp://seclists.org/oss-sec/2014/q4/746"
					},
					{
						"isprivate": "0",
						"commentid": "7720158",
						"comment_count": "6",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2014-12-01 11:56:07 +0000",
						"thetext": "(In reply to Vasyl Kaigorodov from comment #0)\n> Upstream patch for this:\n> http://www.exim.org/viewvc/pcre2?view=rev&revision=154\n\nUpstream patch in pcre / pcre1 repository:\nhttp://www.exim.org/viewvc/pcre?view=revision&revision=1513"
					},
					{
						"isprivate": "0",
						"commentid": "7722153",
						"comment_count": "7",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2014-12-01 20:46:21 +0000",
						"thetext": "The problem here is that malicious regular expression may cause an op code pointer to point outside of the buffer that holds compiled regular expression.  This happens because the unexpected OP_BRAZERO code makes pcre use the following code (OP_ASSERT in the regular expressions from the upstream bugs) as part of the value that indicate the number of bytes to advance the code pointer by.  In the worst case, pcre may end up interpreting malicious compiled regex op code.  While pcre seems to preform bounds checking when performing write operations while interpreting op code, it may be possible to (indirectly) disclose some portions of the process memory."
					},
					{
						"isprivate": "0",
						"commentid": "7722159",
						"comment_count": "8",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2014-12-01 20:52:03 +0000",
						"thetext": "(In reply to Petr Pisar from comment #2)\n> I fixed it in Fedora 22 and 21. I cannot fix it in older Fedoras because the\n> fix depends on another extensive change which I do not want to back-port.\n\nIsn't this equivalent change for PCRE 8.32?\n\n--- pcre-8.32/pcre_exec.c.orig\n+++ pcre-8.32/pcre_exec.c\n@@ -1459,7 +1459,9 @@ for (;;)\n         if (md->end_offset_top > offset_top)\n           offset_top = md->end_offset_top;  /* Captures may have happened */\n         condition = TRUE;\n-        ecode += 1 + LINK_SIZE + GET(ecode, LINK_SIZE + 2);\n+        ecode += 1 + LINK_SIZE;\n+        if (*ecode == OP_BRAZERO) ecode++;\n+        ecode += GET(ecode, 1);\n         while (*ecode == OP_ALT) ecode += GET(ecode, 1);\n         }\n \nCode in the more recent PCRE versions increment ecode by 1 + LINK_SIZE earlier, near the beginning of the OP_COND / OP_SCOND case."
					},
					{
						"isprivate": "0",
						"commentid": "7724285",
						"comment_count": "12",
						"who": {
							"text": "ppisar",
							"name": "Petr Pisar"
						},
						"bug_when": "2014-12-02 12:06:22 +0000",
						"thetext": "(In reply to Tomas Hoger from comment #8)\n> --- pcre-8.32/pcre_exec.c.orig\n> +++ pcre-8.32/pcre_exec.c\n> @@ -1459,7 +1459,9 @@ for (;;)\n>          if (md->end_offset_top > offset_top)\n>            offset_top = md->end_offset_top;  /* Captures may have happened */\n>          condition = TRUE;\n> -        ecode += 1 + LINK_SIZE + GET(ecode, LINK_SIZE + 2);\n> +        ecode += 1 + LINK_SIZE;\n> +        if (*ecode == OP_BRAZERO) ecode++;\n> +        ecode += GET(ecode, 1);\n>          while (*ecode == OP_ALT) ecode += GET(ecode, 1);\n>          }\n>  \n> Code in the more recent PCRE versions increment ecode by 1 + LINK_SIZE\n> earlier, near the beginning of the OP_COND / OP_SCOND case.\n\nGreat. That makes the trick. I will push it."
					},
					{
						"isprivate": "0",
						"commentid": "7757478",
						"comment_count": "14",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-12 04:16:06 +0000",
						"thetext": "pcre-8.35-8.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7782047",
						"comment_count": "15",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-19 18:27:18 +0000",
						"thetext": "pcre-8.32-12.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7782062",
						"comment_count": "16",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2014-12-19 18:28:58 +0000",
						"thetext": "pcre-8.33-8.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "7790042",
						"comment_count": "17",
						"who": {
							"text": "yselkowi",
							"name": "Yaakov Selkowitz"
						},
						"bug_when": "2014-12-24 17:54:18 +0000",
						"thetext": "Does this apply also to mingw-pcre?"
					},
					{
						"isprivate": "0",
						"commentid": "7790979",
						"comment_count": "18",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2014-12-25 16:11:45 +0000",
						"thetext": "(In reply to Yaakov Selkowitz from comment #17)\n> Does this apply also to mingw-pcre?\n\nIt most likely does.  Versions 8.32 - 8.35 were confirmed as affected, mingw-pcre versions currently in Fedora are all within the range."
					},
					{
						"isprivate": "0",
						"commentid": "7790982",
						"comment_count": "19",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2014-12-25 16:13:58 +0000",
						"thetext": "\nCreated mingw-pcre tracking bugs for this issue:\n\nAffects: fedora-all [bug 1177278]"
					},
					{
						"isprivate": "0",
						"commentid": "8008959",
						"comment_count": "21",
						"who": {
							"text": "errata-xmlrpc",
							"name": "errata-xmlrpc"
						},
						"bug_when": "2015-03-05 07:14:59 +0000",
						"thetext": "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7\n\nVia RHSA-2015:0330 https://rhn.redhat.com/errata/RHSA-2015-0330.html"
					}
				]
			}
		}
	],
	"builds": [
		{
			"nvr": "pcre-8.35-8.fc21",
			"signed": true,
			"type": "rpm",
			"package": {
				"armv7hl": [
					{
						"name": "pcre",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "armv7hl"
					},
					{
						"name": "pcre-devel",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "armv7hl"
					},
					{
						"name": "pcre-debuginfo",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "armv7hl"
					},
					{
						"name": "pcre-tools",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "armv7hl"
					},
					{
						"name": "pcre-static",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "armv7hl"
					}
				],
				"i686": [
					{
						"name": "pcre",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "i686"
					},
					{
						"name": "pcre-static",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "i686"
					},
					{
						"name": "pcre-devel",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "i686"
					},
					{
						"name": "pcre-tools",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "i686"
					},
					{
						"name": "pcre-debuginfo",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "i686"
					}
				],
				"src": [
					{
						"name": "pcre",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "src"
					}
				],
				"x86_64": [
					{
						"name": "pcre-tools",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "x86_64"
					},
					{
						"name": "pcre-devel",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "x86_64"
					},
					{
						"name": "pcre-debuginfo",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "x86_64"
					},
					{
						"name": "pcre",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "x86_64"
					},
					{
						"name": "pcre-static",
						"version": "8.35",
						"release": "8.fc21",
						"arch": "x86_64"
					}
				]
			}
		}
	],
	"close_bugs": true,
	"comments": [
		{
			"id": 233955,
			"text": "This update has been submitted for testing by ppisar. ",
			"timestamp": "2014-11-20 09:46:30",
			"update_id": 29215,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 233956,
			"text": "Taskotron: depcheck test PASSED on i386. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/14400/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2014-11-20 10:02:24",
			"update_id": 29215,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/1c99e8328b68b58a71f5a9d6449baa7cb914591c56cbec0adfac7c50e4abefa4?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 233957,
			"text": "Taskotron: depcheck test PASSED on x86_64. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/14400/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2014-11-20 10:02:50",
			"update_id": 29215,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/1c99e8328b68b58a71f5a9d6449baa7cb914591c56cbec0adfac7c50e4abefa4?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 233958,
			"text": "Taskotron: depcheck test PASSED on i386. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/14524/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2014-11-20 16:59:56",
			"update_id": 29215,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/1c99e8328b68b58a71f5a9d6449baa7cb914591c56cbec0adfac7c50e4abefa4?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 233959,
			"text": "Taskotron: depcheck test PASSED on x86_64. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/14524/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2014-11-20 17:02:23",
			"update_id": 29215,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/1c99e8328b68b58a71f5a9d6449baa7cb914591c56cbec0adfac7c50e4abefa4?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 233960,
			"text": "This update is currently being pushed to the Fedora 21 testing updates repository.",
			"timestamp": "2014-11-22 18:05:51",
			"update_id": 29215,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 233961,
			"text": "This update has been pushed to testing",
			"timestamp": "2014-11-22 20:20:09",
			"update_id": 29215,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 233962,
			"text": "This update has reached 14 days in testing and can be pushed to stable now if the maintainer wishes",
			"timestamp": "2014-12-06 20:49:51",
			"update_id": 29215,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 233963,
			"text": "This update has been submitted for stable by ppisar. ",
			"timestamp": "2014-12-08 09:20:26",
			"update_id": 29215,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 233964,
			"text": "Taskotron: upgradepath test PASSED on noarch. Result log:\nhttps://taskotron.fedoraproject.org/taskmaster//builders/x86_64/builds/19041/steps/runtask/logs/stdio\n(results are informative only)",
			"timestamp": "2014-12-08 09:28:51",
			"update_id": 29215,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/1c99e8328b68b58a71f5a9d6449baa7cb914591c56cbec0adfac7c50e4abefa4?s=24&d=retro",
				"email": "taskotron@fedoraproject.org",
				"groups": [
					{}
				],
				"id": 100,
				"name": "taskotron",
				"openid": "taskotron.id.fedoraproject.org"
			},
			"user_id": 100
		},
		{
			"id": 233965,
			"text": "This update is currently being pushed to the Fedora 21 stable updates repository.",
			"timestamp": "2014-12-11 05:17:18",
			"update_id": 29215,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 233966,
			"text": "This update has been pushed to stable",
			"timestamp": "2014-12-12 04:15:45",
			"update_id": 29215,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		}
	],
	"content_type": "rpm",
	"critpath": true,
	"date_modified": "2014-11-20 16:35:49",
	"date_pushed": "2014-12-12 04:15:45",
	"date_stable": "2014-12-12 04:15:45",
	"date_submitted": "2014-11-20 09:46:24",
	"date_testing": "2014-11-22 20:20:09",
	"meets_testing_requirements": true,
	"notes": "This release fixes CVE-2014-8964 (an unused memory usage on zero-repeat assertion condition).",
	"pushed": true,
	"release": {
		"branch": "f21",
		"candidate_tag": "f21-updates-candidate",
		"composed_by_bodhi": true,
		"dist_tag": "f21",
		"id_prefix": "FEDORA",
		"long_name": "Fedora 21",
		"mail_template": "fedora_errata_template",
		"name": "F21",
		"override_tag": "f21-override",
		"package_manager": "dnf",
		"pending_stable_tag": "f21-updates-pending",
		"pending_testing_tag": "f21-updates-testing-pending",
		"stable_tag": "f21-updates",
		"state": "archived",
		"testing_repository": "updates-testing",
		"testing_tag": "f21-updates-testing",
		"version": "21"
	},
	"severity": "unspecified",
	"stable_karma": 3,
	"status": "stable",
	"suggest": "unspecified",
	"title": "pcre-8.35-8.fc21",
	"type": "security",
	"url": "https://bodhi.fedoraproject.org/updates/FEDORA-2014-15573",
	"unstable_karma": -3,
	"updateid": "FEDORA-2014-15573",
	"user": {
		"avatar": "https://seccdn.libravatar.org/avatar/12f13283140a3e56271e48fbe0cdccc1fd09b0859759f11ac65baf89dae48515?s=24&d=retro",
		"email": "ppisar@redhat.com",
		"groups": [
			{
				"name": "packager"
			},
			{
				"name": "provenpackager"
			},
			{
				"name": "ipausers"
			},
			{
				"name": "fedora-contributor"
			},
			{
				"name": "signed_fpca"
			},
			{
				"name": "fedorabugs"
			},
			{
				"name": "modularity-wg"
			},
			{
				"name": "l10n"
			},
			{
				"name": "cvsl10n"
			},
			{
				"name": "perl-maint-sig"
			},
			{
				"name": "rpm-software-management-sig"
			},
			{
				"name": "trust admins"
			}
		],
		"id": 227,
		"name": "ppisar",
		"openid": "ppisar.id.fedoraproject.org"
	},
	"version_hash": "3df9136d343abba518a98f60a73cbacf451a6392"
}
