{
	"alias": "FEDORA-2016-7942ee2cc5",
	"autokarma": true,
	"bugs": [
		{
			"bug_id": 1306021,
			"feedback": [
				{
					"bug_id": 1306021,
					"comment": {
						"id": 395381,
						"karma": 1,
						"karma_critpath": 1,
						"text": "No regressions detected",
						"timestamp": "2016-03-02 01:35:09",
						"update_id": 51363,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/fcb5557e40d60080262130572d0b0cf030582aee1c544dd53c361841e6c0b3e9?s=24&d=retro",
							"email": "henning.noren@gmail.com",
							"groups": [
								{
									"name": "ipausers"
								},
								{
									"name": "signed_fpca"
								}
							],
							"id": 195,
							"name": "norenh",
							"openid": "norenh.id.fedoraproject.org"
						},
						"user_id": 195
					},
					"comment_id": 395381
				}
			],
			"parent": true,
			"security": true,
			"title": "CVE-2016-0787 libssh2: bits/bytes confusion resulting in truncated Diffie-Hellman secret length",
			"bugzilla": {
				"bug_id": "1306021",
				"alias": "CVE-2016-0787",
				"creation_ts": "2016-02-09 20:56:22 +0000",
				"short_desc": "CVE-2016-0787 libssh2: bits/bytes confusion resulting in truncated Diffie-Hellman secret length",
				"delta_ts": "2021-02-17 04:21:56 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Security",
				"priority": "medium",
				"bug_severity": "medium",
				"depends_on": [
					"1310049",
					"1310050",
					"1310051",
					"1310053",
					"1311214",
					"1311215",
					"1311216",
					"1311217"
				],
				"blocked": [
					{
						"bug_id": "1306023",
						"error": "NotPermitted"
					}
				],
				"external_bugs": {
					"text": "RHSA-2016:0428",
					"name": "Red Hat Product Errata"
				},
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "9047324",
						"comment_count": "0",
						"who": {
							"text": "kseifried",
							"name": "Kurt Seifried"
						},
						"bug_when": "2016-02-09 20:56:22 +0000",
						"thetext": "It was found that during the SSHv2 handshake when libssh2 is to get a suitable value for 'group order' in the Diffle Hellman negotiation, it would pass in number of bytes to a function that expected number of bits. This would result in the library generating numbers using only an 8th the number of random bits than what were intended: 128 or 256 bits instead of 1023 or 2047. Using such drastically reduced amount of random bits for Diffie Hellman weakended the handshake security significantly."
					},
					{
						"isprivate": "0",
						"commentid": "9047522",
						"comment_count": "1",
						"who": {
							"text": "asn",
							"name": "Andreas Schneider"
						},
						"bug_when": "2016-02-09 21:52:51 +0000",
						"thetext": "There is a bits/bytes confusion bug and generate the an anormaly short ephemeral secret for the diffie-hellman-group1 and diffie-hellman-group14 key exchange methods.\nThe resulting secret is 128 bits long, instead of the recommended sizes of 1024\nand 2048 bits respectively. There are practical algorithms (Baby steps/Giant\nsteps, Pollard's rho) that can solve this problem in O(2^63) operations.\n\nThe group_order value in diffie_hellman_sha1() passed to _libssh2_bn_rand() should be in bits. The values used are 128 and 256."
					},
					{
						"isprivate": "0",
						"commentid": "9049578",
						"comment_count": "2",
						"who": {
							"text": "kdudka",
							"name": "Kamil Dudka"
						},
						"bug_when": "2016-02-10 14:18:51 +0000",
						"thetext": "Is this already being communicated with libssh2 upstream?"
					},
					{
						"isprivate": "0",
						"commentid": "9049597",
						"comment_count": "3",
						"who": {
							"text": "daniel",
							"name": "Daniel Stenberg"
						},
						"bug_when": "2016-02-10 14:22:08 +0000",
						"thetext": "Yeps, I'm CC'ed here and I think I count as upstream! :-)"
					},
					{
						"isprivate": "0",
						"commentid": "9049620",
						"comment_count": "4",
						"who": {
							"text": "kdudka",
							"name": "Kamil Dudka"
						},
						"bug_when": "2016-02-10 14:26:28 +0000",
						"thetext": "Indeed!  I should have looked before asking..."
					},
					{
						"isprivate": "0",
						"commentid": "9052842",
						"comment_count": "5",
						"who": {
							"text": "asn",
							"name": "Andreas Schneider"
						},
						"bug_when": "2016-02-11 14:21:10 +0000",
						"thetext": "Daniel, for libssh the embargo is currently set for Feb 23rd, 2016 14:00 CET. Are you fine with this or should we move it?"
					},
					{
						"isprivate": "0",
						"commentid": "9054333",
						"comment_count": "6",
						"who": {
							"text": "daniel",
							"name": "Daniel Stenberg"
						},
						"bug_when": "2016-02-11 23:01:37 +0000",
						"thetext": "That's probably gonna work out fine. We have a new release in the works since forever but we should be in sync with this pretty good."
					},
					{
						"isprivate": "0",
						"commentid": "9062442",
						"comment_count": "7",
						"who": {
							"text": "daniel",
							"name": "Daniel Stenberg"
						},
						"bug_when": "2016-02-14 10:27:01 +0000",
						"thetext": "So have you identified/written any particular fix to this problem other than multiplying the number of bytes by 8 to pass in bits correctly? Like below\n\n\ndiff --git a/src/kex.c b/src/kex.c\nindex 6349457..99362f8 100644\n--- a/src/kex.c\n+++ b/src/kex.c\n@@ -751,11 +751,11 @@ static int diffie_hellman_sha256(LIBSSH2_SESSION *session,\n \n         /* Zero the whole thing out */\n         memset(&exchange_state->req_state, 0, sizeof(packet_require_state_t));\n \n         /* Generate x and e */\n-        _libssh2_bn_rand(exchange_state->x, group_order, 0, -1);\n+        _libssh2_bn_rand(exchange_state->x, group_order * 8, 0, -1);\n         _libssh2_bn_mod_exp(exchange_state->e, g, exchange_state->x, p,\n                             exchange_state->ctx);\n \n         /* Send KEX init */\n         /* packet_type(1) + String Length(4) + leading 0(1) */"
					},
					{
						"isprivate": "0",
						"commentid": "9064418",
						"comment_count": "8",
						"who": {
							"text": "asn",
							"name": "Andreas Schneider"
						},
						"bug_when": "2016-02-15 13:05:46 +0000",
						"thetext": "In libssh we solved it like this:\n\nif (key_type == DH_GROUP1_SHA1) {\n  group_order = 1023;\n} else {\n  group_order = 2047;\n}\nbignum_rand(x, group_order);\n\nWe want to ensure x and y are selected in an uniform distribution between 1 and (p-1)/2, that is the advised range for DH private keys. Choosing a 1024 or 2048 bits secret wouldn't be wrong, but has a risk of being above p and very likely to be above p/2. Removing a bit ensures it doesn't wrap above p, and is easy to write, so it's a good tradeoff.\n\nMakes sense?"
					},
					{
						"isprivate": "0",
						"commentid": "9071291",
						"comment_count": "9",
						"who": {
							"text": "asn",
							"name": "Andreas Schneider"
						},
						"bug_when": "2016-02-17 09:43:28 +0000",
						"thetext": "The embargo is currently set for Feb 23rd, 2016 14:00 CET."
					},
					{
						"isprivate": "0",
						"commentid": "9071302",
						"comment_count": "10",
						"who": {
							"text": "daniel",
							"name": "Daniel Stenberg"
						},
						"bug_when": "2016-02-17 09:45:38 +0000",
						"thetext": "But based on what? Who asked for that embargo and why so long?\n\nYour involvement in/driving of this problem is very puzzling to me."
					},
					{
						"isprivate": "0",
						"commentid": "9071322",
						"comment_count": "11",
						"who": {
							"text": "asn",
							"name": "Andreas Schneider"
						},
						"bug_when": "2016-02-17 09:53:29 +0000",
						"thetext": "See comment #5 and comment #6."
					},
					{
						"isprivate": "0",
						"commentid": "9071329",
						"comment_count": "12",
						"who": {
							"text": "daniel",
							"name": "Daniel Stenberg"
						},
						"bug_when": "2016-02-17 09:55:29 +0000",
						"thetext": "So to whom have you offered/promised this embargo? Redhat?"
					},
					{
						"isprivate": "0",
						"commentid": "9071338",
						"comment_count": "13",
						"who": {
							"text": "asn",
							"name": "Andreas Schneider"
						},
						"bug_when": "2016-02-17 09:57:45 +0000",
						"thetext": "I just tried to help. libssh will release on that date. If you want another date, then talk to secalert@redhat.com. I will leave that all to you now ..."
					},
					{
						"isprivate": "0",
						"commentid": "9071364",
						"comment_count": "14",
						"who": {
							"text": "daniel",
							"name": "Daniel Stenberg"
						},
						"bug_when": "2016-02-17 10:02:43 +0000",
						"thetext": "You're helping out, sure, and I'm grateful for the notification of this problem but you're also leaving out information that makes this hard to understand.\n\nI've worked in open source for decades, I've done security advisories with CVEs over 40 times in several projects. This is the first time ever for me where a vendor announces the problem, already has the CVE and already has an embargo - for the upstream project.\n\nAnd then you're not even telling me who you've told about this or who for the embargo is.\n\nDid you inform distros@openwall? Should I?"
					},
					{
						"isprivate": "0",
						"commentid": "9072425",
						"comment_count": "15",
						"who": {
							"text": "kdudka",
							"name": "Kamil Dudka"
						},
						"bug_when": "2016-02-17 15:38:36 +0000",
						"thetext": "Daniel, unless you did it already, please send your questions/requests to secalert@redhat.com , which is the channel with guaranteed service level."
					},
					{
						"isprivate": "0",
						"commentid": "9074609",
						"comment_count": "16",
						"who": {
							"text": "mprpic",
							"name": "Martin Prpiƒç"
						},
						"bug_when": "2016-02-18 09:22:54 +0000",
						"thetext": "Upstream patch:\n\nhttp://www.libssh2.org/CVE-2016-0787.patch\n\nExternal References:\n\nhttp://www.libssh2.org/adv_20160223.html"
					},
					{
						"isprivate": "0",
						"commentid": "9076442",
						"comment_count": "17",
						"who": {
							"text": "cperry",
							"name": "Clifford Perry"
						},
						"bug_when": "2016-02-18 17:06:13 +0000",
						"thetext": "(In reply to Daniel Stenberg from comment #14)\n> You're helping out, sure, and I'm grateful for the notification of this\n> problem but you're also leaving out information that makes this hard to\n> understand.\n> \n> I've worked in open source for decades, I've done security advisories with\n> CVEs over 40 times in several projects. This is the first time ever for me\n> where a vendor announces the problem, already has the CVE and already has an\n> embargo - for the upstream project.\n> \n> And then you're not even telling me who you've told about this or who for\n> the embargo is.\n> \n> Did you inform distros@openwall? Should I?\n\nHi Daniel, \nKurt is attending a conference today. So if this requires a reply sooner, then the general secalert@ address has a 24hr SLA to get replies. \n\nThat being said, since the issue was reported to Red Hat, we aim to provide this upfront co-ordination as you described. I /assume/ that yes, Kurt has communicated to the distro list to this date, giving them appropriate time to react. \n\nI'll chase down on my end to see if Kurt can provide additional information, or another member of our team.\n\nRegards,\nCliff"
					},
					{
						"isprivate": "0",
						"commentid": "9076758",
						"comment_count": "18",
						"who": {
							"text": "daniel",
							"name": "Daniel Stenberg"
						},
						"bug_when": "2016-02-18 19:34:44 +0000",
						"thetext": "I'm all good. I emailed distros@, I have the CVE, I have a drafted advisory and the release will go out on Feb 23."
					},
					{
						"isprivate": "0",
						"commentid": "9088099",
						"comment_count": "20",
						"who": {
							"text": "daniel",
							"name": "Daniel Stenberg"
						},
						"bug_when": "2016-02-23 13:42:13 +0000",
						"thetext": "libssh2 1.7.0 was released upstream with this fix included."
					},
					{
						"isprivate": "0",
						"commentid": "9088583",
						"comment_count": "21",
						"who": {
							"text": "amaris",
							"name": "Adam Mari≈°"
						},
						"bug_when": "2016-02-23 15:29:05 +0000",
						"thetext": "Public via:\n\nhttps://www.libssh2.org/adv_20160223.html"
					},
					{
						"isprivate": "0",
						"commentid": "9088609",
						"comment_count": "22",
						"who": {
							"text": "amaris",
							"name": "Adam Mari≈°"
						},
						"bug_when": "2016-02-23 15:33:46 +0000",
						"thetext": "\nCreated mingw-libssh2 tracking bugs for this issue:\n\nAffects: fedora-all [bug 1311215]\nAffects: epel-7 [bug 1311217]"
					},
					{
						"isprivate": "0",
						"commentid": "9088610",
						"comment_count": "23",
						"who": {
							"text": "amaris",
							"name": "Adam Mari≈°"
						},
						"bug_when": "2016-02-23 15:33:54 +0000",
						"thetext": "\nCreated libssh2 tracking bugs for this issue:\n\nAffects: fedora-all [bug 1311214]\nAffects: epel-5 [bug 1311216]"
					},
					{
						"isprivate": "0",
						"commentid": "9088716",
						"comment_count": "24",
						"who": {
							"text": "amaris",
							"name": "Adam Mari≈°"
						},
						"bug_when": "2016-02-23 15:54:06 +0000",
						"thetext": "Acknowledgments:\n\nName: Aris Adamantiadis"
					},
					{
						"isprivate": "0",
						"commentid": "9089197",
						"comment_count": "25",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2016-02-23 18:24:16 +0000",
						"thetext": "Upstream commit:\n\nhttps://github.com/libssh2/libssh2/commit/ca5222ea819cc5ed797860070b4c6c1aeeb28420"
					},
					{
						"isprivate": "0",
						"commentid": "9101742",
						"comment_count": "27",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2016-02-26 19:22:01 +0000",
						"thetext": "libssh2-1.6.0-4.fc23 has been pushed to the Fedora 23 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "9133929",
						"comment_count": "28",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2016-03-09 16:22:56 +0000",
						"thetext": "libssh2-1.5.0-2.fc22 has been pushed to the Fedora 22 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "9134880",
						"comment_count": "29",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2016-03-09 20:12:41 +0000",
						"thetext": "libssh2-1.5.0-2.fc22 has been pushed to the Fedora 22 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "9136579",
						"comment_count": "30",
						"who": {
							"text": "errata-xmlrpc",
							"name": "errata-xmlrpc"
						},
						"bug_when": "2016-03-10 07:41:03 +0000",
						"thetext": "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7\n  Red Hat Enterprise Linux 6\n\nVia RHSA-2016:0428 https://rhn.redhat.com/errata/RHSA-2016-0428.html"
					}
				]
			}
		},
		{
			"bug_id": 1311214,
			"feedback": [
				{
					"bug_id": 1311214,
					"comment": {
						"id": 395381,
						"karma": 1,
						"karma_critpath": 1,
						"text": "No regressions detected",
						"timestamp": "2016-03-02 01:35:09",
						"update_id": 51363,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/fcb5557e40d60080262130572d0b0cf030582aee1c544dd53c361841e6c0b3e9?s=24&d=retro",
							"email": "henning.noren@gmail.com",
							"groups": [
								{
									"name": "ipausers"
								},
								{
									"name": "signed_fpca"
								}
							],
							"id": 195,
							"name": "norenh",
							"openid": "norenh.id.fedoraproject.org"
						},
						"user_id": 195
					},
					"comment_id": 395381
				}
			],
			"security": true,
			"title": "CVE-2016-0787 libssh2: bits/bytes confusion resulting in truncated Diffie-Hellman secret length [fedora-all]",
			"bugzilla": {
				"bug_id": "1311214",
				"creation_ts": "2016-02-23 15:33:12 +0000",
				"short_desc": "CVE-2016-0787 libssh2: bits/bytes confusion resulting in truncated Diffie-Hellman secret length [fedora-all]",
				"delta_ts": "2016-03-09 20:12:37 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Security, SecurityTracking",
				"priority": "medium",
				"bug_severity": "medium",
				"blocked": [
					{
						"bug_id": "1306021",
						"alias": "CVE-2016-0787",
						"creation_ts": "2016-02-09 20:56:22 +0000",
						"short_desc": "CVE-2016-0787 libssh2: bits/bytes confusion resulting in truncated Diffie-Hellman secret length",
						"delta_ts": "2021-02-17 04:21:56 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1310049",
							"1310050",
							"1310051",
							"1310053",
							"1311214",
							"1311215",
							"1311216",
							"1311217"
						],
						"blocked": [
							{
								"bug_id": "1306023",
								"error": "NotPermitted"
							}
						],
						"external_bugs": {
							"text": "RHSA-2016:0428",
							"name": "Red Hat Product Errata"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "9047324",
								"comment_count": "0",
								"who": {
									"text": "kseifried",
									"name": "Kurt Seifried"
								},
								"bug_when": "2016-02-09 20:56:22 +0000",
								"thetext": "It was found that during the SSHv2 handshake when libssh2 is to get a suitable value for 'group order' in the Diffle Hellman negotiation, it would pass in number of bytes to a function that expected number of bits. This would result in the library generating numbers using only an 8th the number of random bits than what were intended: 128 or 256 bits instead of 1023 or 2047. Using such drastically reduced amount of random bits for Diffie Hellman weakended the handshake security significantly."
							},
							{
								"isprivate": "0",
								"commentid": "9047522",
								"comment_count": "1",
								"who": {
									"text": "asn",
									"name": "Andreas Schneider"
								},
								"bug_when": "2016-02-09 21:52:51 +0000",
								"thetext": "There is a bits/bytes confusion bug and generate the an anormaly short ephemeral secret for the diffie-hellman-group1 and diffie-hellman-group14 key exchange methods.\nThe resulting secret is 128 bits long, instead of the recommended sizes of 1024\nand 2048 bits respectively. There are practical algorithms (Baby steps/Giant\nsteps, Pollard's rho) that can solve this problem in O(2^63) operations.\n\nThe group_order value in diffie_hellman_sha1() passed to _libssh2_bn_rand() should be in bits. The values used are 128 and 256."
							},
							{
								"isprivate": "0",
								"commentid": "9049578",
								"comment_count": "2",
								"who": {
									"text": "kdudka",
									"name": "Kamil Dudka"
								},
								"bug_when": "2016-02-10 14:18:51 +0000",
								"thetext": "Is this already being communicated with libssh2 upstream?"
							},
							{
								"isprivate": "0",
								"commentid": "9049597",
								"comment_count": "3",
								"who": {
									"text": "daniel",
									"name": "Daniel Stenberg"
								},
								"bug_when": "2016-02-10 14:22:08 +0000",
								"thetext": "Yeps, I'm CC'ed here and I think I count as upstream! :-)"
							},
							{
								"isprivate": "0",
								"commentid": "9049620",
								"comment_count": "4",
								"who": {
									"text": "kdudka",
									"name": "Kamil Dudka"
								},
								"bug_when": "2016-02-10 14:26:28 +0000",
								"thetext": "Indeed!  I should have looked before asking..."
							},
							{
								"isprivate": "0",
								"commentid": "9052842",
								"comment_count": "5",
								"who": {
									"text": "asn",
									"name": "Andreas Schneider"
								},
								"bug_when": "2016-02-11 14:21:10 +0000",
								"thetext": "Daniel, for libssh the embargo is currently set for Feb 23rd, 2016 14:00 CET. Are you fine with this or should we move it?"
							},
							{
								"isprivate": "0",
								"commentid": "9054333",
								"comment_count": "6",
								"who": {
									"text": "daniel",
									"name": "Daniel Stenberg"
								},
								"bug_when": "2016-02-11 23:01:37 +0000",
								"thetext": "That's probably gonna work out fine. We have a new release in the works since forever but we should be in sync with this pretty good."
							},
							{
								"isprivate": "0",
								"commentid": "9062442",
								"comment_count": "7",
								"who": {
									"text": "daniel",
									"name": "Daniel Stenberg"
								},
								"bug_when": "2016-02-14 10:27:01 +0000",
								"thetext": "So have you identified/written any particular fix to this problem other than multiplying the number of bytes by 8 to pass in bits correctly? Like below\n\n\ndiff --git a/src/kex.c b/src/kex.c\nindex 6349457..99362f8 100644\n--- a/src/kex.c\n+++ b/src/kex.c\n@@ -751,11 +751,11 @@ static int diffie_hellman_sha256(LIBSSH2_SESSION *session,\n \n         /* Zero the whole thing out */\n         memset(&exchange_state->req_state, 0, sizeof(packet_require_state_t));\n \n         /* Generate x and e */\n-        _libssh2_bn_rand(exchange_state->x, group_order, 0, -1);\n+        _libssh2_bn_rand(exchange_state->x, group_order * 8, 0, -1);\n         _libssh2_bn_mod_exp(exchange_state->e, g, exchange_state->x, p,\n                             exchange_state->ctx);\n \n         /* Send KEX init */\n         /* packet_type(1) + String Length(4) + leading 0(1) */"
							},
							{
								"isprivate": "0",
								"commentid": "9064418",
								"comment_count": "8",
								"who": {
									"text": "asn",
									"name": "Andreas Schneider"
								},
								"bug_when": "2016-02-15 13:05:46 +0000",
								"thetext": "In libssh we solved it like this:\n\nif (key_type == DH_GROUP1_SHA1) {\n  group_order = 1023;\n} else {\n  group_order = 2047;\n}\nbignum_rand(x, group_order);\n\nWe want to ensure x and y are selected in an uniform distribution between 1 and (p-1)/2, that is the advised range for DH private keys. Choosing a 1024 or 2048 bits secret wouldn't be wrong, but has a risk of being above p and very likely to be above p/2. Removing a bit ensures it doesn't wrap above p, and is easy to write, so it's a good tradeoff.\n\nMakes sense?"
							},
							{
								"isprivate": "0",
								"commentid": "9071291",
								"comment_count": "9",
								"who": {
									"text": "asn",
									"name": "Andreas Schneider"
								},
								"bug_when": "2016-02-17 09:43:28 +0000",
								"thetext": "The embargo is currently set for Feb 23rd, 2016 14:00 CET."
							},
							{
								"isprivate": "0",
								"commentid": "9071302",
								"comment_count": "10",
								"who": {
									"text": "daniel",
									"name": "Daniel Stenberg"
								},
								"bug_when": "2016-02-17 09:45:38 +0000",
								"thetext": "But based on what? Who asked for that embargo and why so long?\n\nYour involvement in/driving of this problem is very puzzling to me."
							},
							{
								"isprivate": "0",
								"commentid": "9071322",
								"comment_count": "11",
								"who": {
									"text": "asn",
									"name": "Andreas Schneider"
								},
								"bug_when": "2016-02-17 09:53:29 +0000",
								"thetext": "See comment #5 and comment #6."
							},
							{
								"isprivate": "0",
								"commentid": "9071329",
								"comment_count": "12",
								"who": {
									"text": "daniel",
									"name": "Daniel Stenberg"
								},
								"bug_when": "2016-02-17 09:55:29 +0000",
								"thetext": "So to whom have you offered/promised this embargo? Redhat?"
							},
							{
								"isprivate": "0",
								"commentid": "9071338",
								"comment_count": "13",
								"who": {
									"text": "asn",
									"name": "Andreas Schneider"
								},
								"bug_when": "2016-02-17 09:57:45 +0000",
								"thetext": "I just tried to help. libssh will release on that date. If you want another date, then talk to secalert@redhat.com. I will leave that all to you now ..."
							},
							{
								"isprivate": "0",
								"commentid": "9071364",
								"comment_count": "14",
								"who": {
									"text": "daniel",
									"name": "Daniel Stenberg"
								},
								"bug_when": "2016-02-17 10:02:43 +0000",
								"thetext": "You're helping out, sure, and I'm grateful for the notification of this problem but you're also leaving out information that makes this hard to understand.\n\nI've worked in open source for decades, I've done security advisories with CVEs over 40 times in several projects. This is the first time ever for me where a vendor announces the problem, already has the CVE and already has an embargo - for the upstream project.\n\nAnd then you're not even telling me who you've told about this or who for the embargo is.\n\nDid you inform distros@openwall? Should I?"
							},
							{
								"isprivate": "0",
								"commentid": "9072425",
								"comment_count": "15",
								"who": {
									"text": "kdudka",
									"name": "Kamil Dudka"
								},
								"bug_when": "2016-02-17 15:38:36 +0000",
								"thetext": "Daniel, unless you did it already, please send your questions/requests to secalert@redhat.com , which is the channel with guaranteed service level."
							},
							{
								"isprivate": "0",
								"commentid": "9074609",
								"comment_count": "16",
								"who": {
									"text": "mprpic",
									"name": "Martin Prpiƒç"
								},
								"bug_when": "2016-02-18 09:22:54 +0000",
								"thetext": "Upstream patch:\n\nhttp://www.libssh2.org/CVE-2016-0787.patch\n\nExternal References:\n\nhttp://www.libssh2.org/adv_20160223.html"
							},
							{
								"isprivate": "0",
								"commentid": "9076442",
								"comment_count": "17",
								"who": {
									"text": "cperry",
									"name": "Clifford Perry"
								},
								"bug_when": "2016-02-18 17:06:13 +0000",
								"thetext": "(In reply to Daniel Stenberg from comment #14)\n> You're helping out, sure, and I'm grateful for the notification of this\n> problem but you're also leaving out information that makes this hard to\n> understand.\n> \n> I've worked in open source for decades, I've done security advisories with\n> CVEs over 40 times in several projects. This is the first time ever for me\n> where a vendor announces the problem, already has the CVE and already has an\n> embargo - for the upstream project.\n> \n> And then you're not even telling me who you've told about this or who for\n> the embargo is.\n> \n> Did you inform distros@openwall? Should I?\n\nHi Daniel, \nKurt is attending a conference today. So if this requires a reply sooner, then the general secalert@ address has a 24hr SLA to get replies. \n\nThat being said, since the issue was reported to Red Hat, we aim to provide this upfront co-ordination as you described. I /assume/ that yes, Kurt has communicated to the distro list to this date, giving them appropriate time to react. \n\nI'll chase down on my end to see if Kurt can provide additional information, or another member of our team.\n\nRegards,\nCliff"
							},
							{
								"isprivate": "0",
								"commentid": "9076758",
								"comment_count": "18",
								"who": {
									"text": "daniel",
									"name": "Daniel Stenberg"
								},
								"bug_when": "2016-02-18 19:34:44 +0000",
								"thetext": "I'm all good. I emailed distros@, I have the CVE, I have a drafted advisory and the release will go out on Feb 23."
							},
							{
								"isprivate": "0",
								"commentid": "9088099",
								"comment_count": "20",
								"who": {
									"text": "daniel",
									"name": "Daniel Stenberg"
								},
								"bug_when": "2016-02-23 13:42:13 +0000",
								"thetext": "libssh2 1.7.0 was released upstream with this fix included."
							},
							{
								"isprivate": "0",
								"commentid": "9088583",
								"comment_count": "21",
								"who": {
									"text": "amaris",
									"name": "Adam Mari≈°"
								},
								"bug_when": "2016-02-23 15:29:05 +0000",
								"thetext": "Public via:\n\nhttps://www.libssh2.org/adv_20160223.html"
							},
							{
								"isprivate": "0",
								"commentid": "9088609",
								"comment_count": "22",
								"who": {
									"text": "amaris",
									"name": "Adam Mari≈°"
								},
								"bug_when": "2016-02-23 15:33:46 +0000",
								"thetext": "\nCreated mingw-libssh2 tracking bugs for this issue:\n\nAffects: fedora-all [bug 1311215]\nAffects: epel-7 [bug 1311217]"
							},
							{
								"isprivate": "0",
								"commentid": "9088610",
								"comment_count": "23",
								"who": {
									"text": "amaris",
									"name": "Adam Mari≈°"
								},
								"bug_when": "2016-02-23 15:33:54 +0000",
								"thetext": "\nCreated libssh2 tracking bugs for this issue:\n\nAffects: fedora-all [bug 1311214]\nAffects: epel-5 [bug 1311216]"
							},
							{
								"isprivate": "0",
								"commentid": "9088716",
								"comment_count": "24",
								"who": {
									"text": "amaris",
									"name": "Adam Mari≈°"
								},
								"bug_when": "2016-02-23 15:54:06 +0000",
								"thetext": "Acknowledgments:\n\nName: Aris Adamantiadis"
							},
							{
								"isprivate": "0",
								"commentid": "9089197",
								"comment_count": "25",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2016-02-23 18:24:16 +0000",
								"thetext": "Upstream commit:\n\nhttps://github.com/libssh2/libssh2/commit/ca5222ea819cc5ed797860070b4c6c1aeeb28420"
							},
							{
								"isprivate": "0",
								"commentid": "9101742",
								"comment_count": "27",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2016-02-26 19:22:01 +0000",
								"thetext": "libssh2-1.6.0-4.fc23 has been pushed to the Fedora 23 stable repository. If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "9133929",
								"comment_count": "28",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2016-03-09 16:22:56 +0000",
								"thetext": "libssh2-1.5.0-2.fc22 has been pushed to the Fedora 22 stable repository. If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "9134880",
								"comment_count": "29",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2016-03-09 20:12:41 +0000",
								"thetext": "libssh2-1.5.0-2.fc22 has been pushed to the Fedora 22 stable repository. If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "9136579",
								"comment_count": "30",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2016-03-10 07:41:03 +0000",
								"thetext": "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7\n  Red Hat Enterprise Linux 6\n\nVia RHSA-2016:0428 https://rhn.redhat.com/errata/RHSA-2016-0428.html"
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "9088600",
						"comment_count": "0",
						"who": {
							"text": "amaris",
							"name": "Adam Mari≈°"
						},
						"bug_when": "2016-02-23 15:33:12 +0000",
						"thetext": "\nThis is an automatically created tracking bug!  It was created to ensure\nthat one or more security vulnerabilities are fixed in affected versions\nof Fedora.\n\nFor comments that are specific to the vulnerability please use bugs filed\nagainst the \"Security Response\" product referenced in the \"Blocks\" field.\n\nFor more information see:\nhttp://fedoraproject.org/wiki/Security/TrackingBugs\n\nWhen submitting as an update, use the fedpkg template provided in the next\ncomment(s).  This will include the bug IDs of this tracking bug as well as\nthe relevant top-level CVE bugs.\n\nPlease also mention the CVE IDs being fixed in the RPM changelog and the\nfedpkg commit message.\n\nNOTE: this issue affects multiple supported versions of Fedora. While only\none tracking bug has been filed, please correct all affected versions at\nthe same time.  If you need to fix the versions independent of each other,\nyou may clone this bug as appropriate.\n\n[bug automatically created by: add-tracking-bugs]"
					},
					{
						"isprivate": "0",
						"commentid": "9088602",
						"comment_count": "1",
						"who": {
							"text": "amaris",
							"name": "Adam Mari≈°"
						},
						"bug_when": "2016-02-23 15:33:20 +0000",
						"thetext": "\nUse the following template to for the 'fedpkg update' request to submit an\nupdate for this issue as it contains the top-level parent bug(s) as well as\nthis tracking bug.  This will ensure that all associated bugs get updated\nwhen new packages are pushed to stable.\n\n=====\n\n# bugfix, security, enhancement, newpackage (required)\ntype=security\n\n# testing, stable\nrequest=testing\n\n# Bug numbers: 1234,9876\nbugs=1306021,1311214\n\n# Description of your update\nnotes=Security fix for CVE-2016-0787\n\n# Enable request automation based on the stable/unstable karma thresholds\nautokarma=True\nstable_karma=3\nunstable_karma=-3\n\n# Automatically close bugs when this marked as stable\nclose_bugs=True\n\n# Suggest that users restart after update\nsuggest_reboot=False\n\n======\n\nAdditionally, you may opt to use the bodhi web interface to submit updates:\n\nhttps://bodhi.fedoraproject.org/updates/new"
					},
					{
						"isprivate": "0",
						"commentid": "9091305",
						"comment_count": "2",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2016-02-24 11:45:19 +0000",
						"thetext": "libssh2-1.5.0-2.fc22 has been submitted as an update to Fedora 22. https://bodhi.fedoraproject.org/updates/FEDORA-2016-7942ee2cc5"
					},
					{
						"isprivate": "0",
						"commentid": "9096577",
						"comment_count": "3",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2016-02-25 08:30:45 +0000",
						"thetext": "libssh2-1.6.0-4.fc23 has been submitted as an update to Fedora 23. https://bodhi.fedoraproject.org/updates/FEDORA-2016-215a2219b1"
					},
					{
						"isprivate": "0",
						"commentid": "9101741",
						"comment_count": "4",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2016-02-26 19:21:57 +0000",
						"thetext": "libssh2-1.6.0-4.fc23 has been pushed to the Fedora 23 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "9133928",
						"comment_count": "5",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2016-03-09 16:22:53 +0000",
						"thetext": "libssh2-1.5.0-2.fc22 has been pushed to the Fedora 22 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "9134878",
						"comment_count": "6",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2016-03-09 20:12:37 +0000",
						"thetext": "libssh2-1.5.0-2.fc22 has been pushed to the Fedora 22 stable repository. If problems still persist, please make note of it in this bug report."
					}
				]
			}
		}
	],
	"builds": [
		{
			"nvr": "libssh2-1.5.0-2.fc22",
			"release_id": 12,
			"signed": true,
			"type": "rpm",
			"package": {
				"armv7hl": [
					{
						"name": "libssh2-devel",
						"version": "1.5.0",
						"release": "2.fc22",
						"arch": "armv7hl"
					},
					{
						"name": "libssh2-debuginfo",
						"version": "1.5.0",
						"release": "2.fc22",
						"arch": "armv7hl"
					},
					{
						"name": "libssh2",
						"version": "1.5.0",
						"release": "2.fc22",
						"arch": "armv7hl"
					}
				],
				"i686": [
					{
						"name": "libssh2-debuginfo",
						"version": "1.5.0",
						"release": "2.fc22",
						"arch": "i686"
					},
					{
						"name": "libssh2",
						"version": "1.5.0",
						"release": "2.fc22",
						"arch": "i686"
					},
					{
						"name": "libssh2-devel",
						"version": "1.5.0",
						"release": "2.fc22",
						"arch": "i686"
					}
				],
				"noarch": [
					{
						"name": "libssh2-docs",
						"version": "1.5.0",
						"release": "2.fc22",
						"arch": "noarch"
					}
				],
				"src": [
					{
						"name": "libssh2",
						"version": "1.5.0",
						"release": "2.fc22",
						"arch": "src"
					}
				],
				"x86_64": [
					{
						"name": "libssh2-devel",
						"version": "1.5.0",
						"release": "2.fc22",
						"arch": "x86_64"
					},
					{
						"name": "libssh2-debuginfo",
						"version": "1.5.0",
						"release": "2.fc22",
						"arch": "x86_64"
					},
					{
						"name": "libssh2",
						"version": "1.5.0",
						"release": "2.fc22",
						"arch": "x86_64"
					}
				]
			}
		}
	],
	"close_bugs": true,
	"comments": [
		{
			"id": 392534,
			"text": "This update has been submitted for testing by pghmcfc. ",
			"timestamp": "2016-02-23 12:31:06",
			"update_id": 51363,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 392685,
			"text": "This update has been pushed to testing.",
			"timestamp": "2016-02-23 21:26:54",
			"update_id": 51363,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 392921,
			"text": "pghmcfc edited this update.",
			"timestamp": "2016-02-24 11:45:11",
			"update_id": 51363,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"bug_feedback": [
				{
					"bug": {
						"bug_id": 1311214,
						"security": true,
						"title": "CVE-2016-0787 libssh2: bits/bytes confusion resulting in truncated Diffie-Hellman secret length [fedora-all]"
					},
					"bug_id": 1311214,
					"comment_id": 395381
				},
				{
					"bug": {
						"bug_id": 1306021,
						"parent": true,
						"security": true,
						"title": "CVE-2016-0787 libssh2: bits/bytes confusion resulting in truncated Diffie-Hellman secret length"
					},
					"bug_id": 1306021,
					"comment_id": 395381
				}
			],
			"id": 395381,
			"karma": 1,
			"karma_critpath": 1,
			"text": "No regressions detected",
			"timestamp": "2016-03-02 01:35:09",
			"update_id": 51363,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/fcb5557e40d60080262130572d0b0cf030582aee1c544dd53c361841e6c0b3e9?s=24&d=retro",
				"email": "henning.noren@gmail.com",
				"groups": [
					{
						"name": "ipausers"
					},
					{
						"name": "signed_fpca"
					}
				],
				"id": 195,
				"name": "norenh",
				"openid": "norenh.id.fedoraproject.org"
			},
			"user_id": 195
		},
		{
			"id": 397019,
			"karma": 1,
			"text": "No regressions noted.",
			"timestamp": "2016-03-06 08:19:04",
			"update_id": 51363,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/871f8f99d613480ae403c3c35e93c1a8d69615380a872bc5526a5303ce322215?s=24&d=retro",
				"email": "kakoskin@gmail.com",
				"groups": [
					{}
				],
				"id": 2158,
				"name": "kakoskin",
				"openid": "kakoskin.id.fedoraproject.org"
			},
			"user_id": 2158
		},
		{
			"id": 397848,
			"text": "This update has reached 14 days in testing and can be pushed to stable now if the maintainer wishes",
			"timestamp": "2016-03-09 00:00:26",
			"update_id": 51363,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 397910,
			"text": "This update has been submitted for stable by pghmcfc. ",
			"timestamp": "2016-03-09 08:20:45",
			"update_id": 51363,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 398236,
			"text": "This update has been pushed to stable.",
			"timestamp": "2016-03-09 20:13:38",
			"update_id": 51363,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		}
	],
	"content_type": "rpm",
	"critpath": true,
	"date_modified": "2016-02-24 11:45:14",
	"date_pushed": "2016-03-09 20:10:36",
	"date_stable": "2016-03-09 20:10:36",
	"date_submitted": "2016-02-23 12:31:06",
	"date_testing": "2016-02-23 19:52:02",
	"karma": 2,
	"meets_testing_requirements": true,
	"notes": "During the SSHv2 handshake when libssh2 is to get a suitable value for 'group order' in the Diffle Hellman negotiation, it would pass in number of bytes to a function that expected number of bits. This would result in the library generating numbers using only an 8th the number of random bits than what were intended: 128 or 256 bits instead of 1023 or 2047\n\nUsing such drastically reduced amount of random bits for Diffie Hellman weakened the handshake security significantly.\n\nThe Common Vulnerabilities and Exposures (CVE) project has assigned the name CVE-2016-0787 to this issue.\n",
	"pushed": true,
	"release": {
		"branch": "f22",
		"candidate_tag": "f22-updates-candidate",
		"composed_by_bodhi": true,
		"dist_tag": "f22",
		"id_prefix": "FEDORA",
		"long_name": "Fedora 22",
		"mail_template": "fedora_errata_template",
		"name": "F22",
		"override_tag": "f22-override",
		"package_manager": "dnf",
		"pending_stable_tag": "f22-updates-pending",
		"pending_testing_tag": "f22-updates-testing-pending",
		"stable_tag": "f22-updates",
		"state": "archived",
		"testing_repository": "updates-testing",
		"testing_tag": "f22-updates-testing",
		"version": "22"
	},
	"severity": "medium",
	"stable_karma": 3,
	"status": "stable",
	"suggest": "unspecified",
	"title": "libssh2-1.5.0-2.fc22",
	"type": "security",
	"url": "https://bodhi.fedoraproject.org/updates/FEDORA-2016-7942ee2cc5",
	"unstable_karma": -1,
	"updateid": "FEDORA-2016-7942ee2cc5",
	"user": {
		"avatar": "https://seccdn.libravatar.org/avatar/f9800f2daf8aabc0b33bca9b4033019c74db77b3baca2d9f98cc629147430e20?s=24&d=retro",
		"email": "paul@city-fan.org",
		"groups": [
			{
				"name": "packager"
			},
			{
				"name": "provenpackager"
			},
			{
				"name": "ipausers"
			},
			{
				"name": "fedora-contributor"
			},
			{
				"name": "signed_fpca"
			},
			{
				"name": "fedorabugs"
			},
			{
				"name": "perl-maint-sig"
			}
		],
		"id": 165,
		"name": "pghmcfc",
		"openid": "pghmcfc.id.fedoraproject.org"
	},
	"version_hash": "873776ea37d606bcdc9c43918d9a04a832594135"
}
