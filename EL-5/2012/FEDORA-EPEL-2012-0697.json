{
	"alias": "FEDORA-EPEL-2012-0697",
	"bugs": [
		{
			"bug_id": 705849,
			"parent": true,
			"security": true,
			"title": "CVE-2010-4666 CVE-2011-1777 CVE-2011-1778 CVE-2011-1779 Libarchive multiple security issues",
			"bugzilla": {
				"bug_id": "705849",
				"alias": "CVE-2011-1779",
				"creation_ts": "2011-05-18 17:20:03 +0000",
				"short_desc": "CVE-2010-4666 CVE-2011-1777 CVE-2011-1778 CVE-2011-1779 Libarchive multiple security issues",
				"delta_ts": "2021-02-24 15:26:08 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Security",
				"priority": "medium",
				"bug_severity": "medium",
				"depends_on": [
					"705850",
					"739939",
					"739940",
					"773505"
				],
				"blocked": [
					{
						"bug_id": "734550",
						"error": "NotPermitted"
					}
				],
				"external_bugs": {
					"text": "RHSA-2011:1507",
					"name": "Red Hat Product Errata"
				},
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "3741565",
						"comment_count": "0",
						"who": {
							"text": "vdanen",
							"name": "Vincent Danen"
						},
						"bug_when": "2011-05-18 17:20:03 +0000",
						"thetext": "A number of flaws have been corrected in upstream libarchive that have not yet been included in a public release of libarchive (latest version is 2.8.4).\n\nA buffer overflow at reading bit lengths of huffman code of LZX when reading a broken CAB file (CVE-2010-4666) [1].\n\nBuffer overflows in various functions related to reading archives (in archive_read_support_format_iso9660.c) (CVE-2011-1777) [2].\n\nBuffer overflow in reading tar archives (CVE-2011-1778) [3].\n\nUse-after-free bugs (CVE-2011-1779) [4].\n\n[1] http://code.google.com/p/libarchive/source/detail?r=2842\n[2] http://code.google.com/p/libarchive/source/detail?r=3158\n[3] http://code.google.com/p/libarchive/source/detail?r=3160\n[4] http://code.google.com/p/libarchive/source/detail?r=3038"
					},
					{
						"isprivate": "0",
						"commentid": "3741568",
						"comment_count": "1",
						"who": {
							"text": "vdanen",
							"name": "Vincent Danen"
						},
						"bug_when": "2011-05-18 17:21:52 +0000",
						"thetext": "Created libarchive tracking bugs for this issue\n\nAffects: fedora-all [bug 705850]"
					},
					{
						"isprivate": "0",
						"commentid": "3749481",
						"comment_count": "2",
						"who": {
							"text": "tbzatek",
							"name": "Tomáš Bžatek"
						},
						"bug_when": "2011-05-20 12:09:52 +0000",
						"thetext": "What about libarchive-2.8.3-2.el6, included in RHEL 6.0 gold?"
					},
					{
						"isprivate": "0",
						"commentid": "3749983",
						"comment_count": "3",
						"who": {
							"text": "vdanen",
							"name": "Vincent Danen"
						},
						"bug_when": "2011-05-20 16:11:42 +0000",
						"thetext": "Yes, libarchive in RHEL6 would be affected by this.  We have not yet fully triaged the issue to know how it affects what uses it in RHEL6, which will be the determining factor on when this gets addressed."
					},
					{
						"isprivate": "0",
						"commentid": "3990205",
						"comment_count": "4",
						"who": {
							"text": "tbzatek",
							"name": "Tomáš Bžatek"
						},
						"bug_when": "2011-08-31 14:46:01 +0000",
						"thetext": "(In reply to comment #0)\n> A buffer overflow at reading bit lengths of huffman code of LZX when reading a\n> broken CAB file (CVE-2010-4666) [1].\nDoesn't apply for libarchive-2.8.4, no CAB support yet\n\n> Buffer overflows in various functions related to reading archives (in\n> archive_read_support_format_iso9660.c) (CVE-2011-1777) [2].\n> \n> Buffer overflow in reading tar archives (CVE-2011-1778) [3].\n> \n> Use-after-free bugs (CVE-2011-1779) [4].\n\nThese three patches are way too far from the 2.8.4 release and don't apply; the internal structure of the particular source files have changed a lot and even if we somehow make the patches apply, I don't trust the resulting functionality.\n\nWe probably can't even rebase to latest snapshot as long as the API has changed in preparation to the 3.x series.\n\nI suggest to close this bugreport or make someone to look deep in the sources and come up with working patches."
					},
					{
						"isprivate": "0",
						"commentid": "3993853",
						"comment_count": "5",
						"who": {
							"text": "vdanen",
							"name": "Vincent Danen"
						},
						"bug_when": "2011-09-02 03:46:20 +0000",
						"thetext": "(In reply to comment #4)\n> (In reply to comment #0)\n> > A buffer overflow at reading bit lengths of huffman code of LZX when reading a\n> > broken CAB file (CVE-2010-4666) [1].\n> Doesn't apply for libarchive-2.8.4, no CAB support yet\n\nOk, this works in our favour.\n \n> > Buffer overflows in various functions related to reading archives (in\n> > archive_read_support_format_iso9660.c) (CVE-2011-1777) [2].\n> > \n> > Buffer overflow in reading tar archives (CVE-2011-1778) [3].\n> > \n> > Use-after-free bugs (CVE-2011-1779) [4].\n> \n> These three patches are way too far from the 2.8.4 release and don't apply; the\n> internal structure of the particular source files have changed a lot and even\n> if we somehow make the patches apply, I don't trust the resulting\n> functionality.\n> \n> We probably can't even rebase to latest snapshot as long as the API has changed\n> in preparation to the 3.x series.\n> \n> I suggest to close this bugreport or make someone to look deep in the sources\n> and come up with working patches.\n\nI don't see closing this as an option.  You are effectively saying that, because it's difficult, we won't do it.  Maybe the impact is low enough that it won't matter if we don't fix it, but we need to look into it.  At a quick glance, there are a few important packages that link to libarchive: PackageKit, kdeutils, gvfs-archive, and anaconda (the last probably isn't very significant in this context).\n\nIf none of these packages use the vulnerable functionality, then I have no problem with closing this (once it is corrected in Fedora).  If they do, however, then we will need to come up with our own fix and backport what is applicable to close the hole."
					},
					{
						"isprivate": "0",
						"commentid": "3994518",
						"comment_count": "6",
						"who": {
							"text": "tbzatek",
							"name": "Tomáš Bžatek"
						},
						"bug_when": "2011-09-02 12:13:05 +0000",
						"thetext": "Okay, let's keep this open. I'm flooded with work, perhaps somebody else could come up with the patches."
					},
					{
						"isprivate": "0",
						"commentid": "3995785",
						"comment_count": "7",
						"who": {
							"text": "vdanen",
							"name": "Vincent Danen"
						},
						"bug_when": "2011-09-03 00:25:30 +0000",
						"thetext": "Fair enough.  This isn't a high-impact flaw, so we don't need to worry about this right away, but we will probably want to take care of it at some point.  Thanks."
					},
					{
						"isprivate": "0",
						"commentid": "4020989",
						"comment_count": "8",
						"who": {
							"text": "rcvalle",
							"name": "Ramon de C Valle"
						},
						"bug_when": "2011-09-15 19:48:33 +0000",
						"thetext": "(In reply to comment #0)\n> A number of flaws have been corrected in upstream libarchive that have not yet\n> been included in a public release of libarchive (latest version is 2.8.4).\n> \n> A buffer overflow at reading bit lengths of huffman code of LZX when reading a\n> broken CAB file (CVE-2010-4666) [1].\n> \n> Buffer overflows in various functions related to reading archives (in\n> archive_read_support_format_iso9660.c) (CVE-2011-1777) [2].\n> \n> Buffer overflow in reading tar archives (CVE-2011-1778) [3].\n> \n> Use-after-free bugs (CVE-2011-1779) [4].\n> \n> [1] http://code.google.com/p/libarchive/source/detail?r=2842\nArk, PackageKit, and GVFS archive mounter currently don't support cab format.\n\n> [2]\n> http://code.google.com/p/libarchive/source/detail?r=3158&path=/trunk/libarchive/archive_read_support_format_iso9660.c\nArk, and PackageKit don't support ISO9660 format. However, GVFS archive mounter do support ISO9660 format.\n\n> [3] http://code.google.com/p/libarchive/source/detail?r=3160\nBoth Ark and PackageKit use libarchive for tar format.\n\n> [4] http://code.google.com/p/libarchive/source/detail?r=3038\nGVFS archive mounter supports tar format.\n\nThe GVFS archive mounter can be used to enter and examine iso9660 and tar archives via the file manager by simply right-clicking and choosing ‘Open with Archive mounter.’. Thus, increasing the severity of this."
					},
					{
						"isprivate": "0",
						"commentid": "4024183",
						"comment_count": "9",
						"who": {
							"text": "rcvalle",
							"name": "Ramon de C Valle"
						},
						"bug_when": "2011-09-16 18:20:30 +0000",
						"thetext": "Created attachment 523601\nCVE-2011-1777.patch"
					},
					{
						"isprivate": "0",
						"commentid": "4024185",
						"comment_count": "10",
						"who": {
							"text": "rcvalle",
							"name": "Ramon de C Valle"
						},
						"bug_when": "2011-09-16 18:21:06 +0000",
						"thetext": "Created attachment 523602\nCVE-2011-1778.patch"
					},
					{
						"isprivate": "0",
						"commentid": "4024188",
						"comment_count": "11",
						"who": {
							"text": "rcvalle",
							"name": "Ramon de C Valle"
						},
						"bug_when": "2011-09-16 18:23:00 +0000",
						"thetext": "Attached are patches for CVE-2011-1777 and CVE-2011-1778, libarchive 2.8.3 is not affected by CVE-2010-4666 and CVE-2011-1779."
					},
					{
						"isprivate": "0",
						"commentid": "4029970",
						"comment_count": "13",
						"who": {
							"text": "rcvalle",
							"name": "Ramon de C Valle"
						},
						"bug_when": "2011-09-20 14:29:28 +0000",
						"thetext": "Statement CVE-2010-4666, CVE-2011-1779:\n\nNot vulnerable. This issue did not affect the versions of libarchive as shipped with Red Hat Enterprise Linux 4, 5, and 6."
					},
					{
						"isprivate": "0",
						"commentid": "4054798",
						"comment_count": "14",
						"who": {
							"text": "tbzatek",
							"name": "Tomáš Bžatek"
						},
						"bug_when": "2011-10-03 11:12:28 +0000",
						"thetext": "Created attachment 526022\nCVE-2011-1778.patch\n\n(In reply to comment #11)\n> Attached are patches for CVE-2011-1777 and CVE-2011-1778, libarchive 2.8.3 is\n> not affected by CVE-2010-4666 and CVE-2011-1779.\n\nThanks, however F16/rawhide has libarchive 2.8.5 where the patches don't apply and RHEL 6 has libarchive 2.8.3 where the patches don't compile.\n\nAlso, the CVE-2011-1778.patch is missing corrected function prototypes and some calls are missing the required arguments. I was wondering how did you manage to compile it? Attaching new patch, untested."
					},
					{
						"isprivate": "0",
						"commentid": "4054919",
						"comment_count": "15",
						"who": {
							"text": "rcvalle",
							"name": "Ramon de C Valle"
						},
						"bug_when": "2011-10-03 12:11:12 +0000",
						"thetext": "Both patches wfm with checked out sources for RHEL 6 from our CVS repository after running \"make prep\". For the CVE-2011-1778.patch, what are the function calls and function prototypes that were missing and why they also should be patched?"
					},
					{
						"isprivate": "0",
						"commentid": "4054986",
						"comment_count": "16",
						"who": {
							"text": "rcvalle",
							"name": "Ramon de C Valle"
						},
						"bug_when": "2011-10-03 12:37:24 +0000",
						"thetext": "After checking again, I realized that I attached a bad generated patch instead of the correct patch for CVE-2011-1778. Thanks for fixing it."
					},
					{
						"isprivate": "0",
						"commentid": "4184799",
						"comment_count": "17",
						"who": {
							"text": "errata-xmlrpc",
							"name": "errata-xmlrpc"
						},
						"bug_when": "2011-12-01 16:35:52 +0000",
						"thetext": "This issue has been addressed in following products:\n\n  Red Hat Enterprise Linux 6\n\nVia RHSA-2011:1507 https://rhn.redhat.com/errata/RHSA-2011-1507.html"
					},
					{
						"isprivate": "0",
						"commentid": "4184861",
						"comment_count": "18",
						"who": {
							"text": "vdanen",
							"name": "Vincent Danen"
						},
						"bug_when": "2011-12-01 17:05:04 +0000",
						"thetext": "Has this been corrected in Fedora yet?"
					},
					{
						"isprivate": "0",
						"commentid": "4184874",
						"comment_count": "19",
						"who": {
							"text": "tbzatek",
							"name": "Tomáš Bžatek"
						},
						"bug_when": "2011-12-01 17:09:06 +0000",
						"thetext": "(In reply to comment #18)\n> Has this been corrected in Fedora yet?\n\nIn Rawhide, yes, in released Fedoras, no, patches don't apply cleanly."
					},
					{
						"isprivate": "0",
						"commentid": "4185218",
						"comment_count": "20",
						"who": {
							"text": "vdanen",
							"name": "Vincent Danen"
						},
						"bug_when": "2011-12-01 19:38:39 +0000",
						"thetext": "(In reply to comment #19)\n> (In reply to comment #18)\n> > Has this been corrected in Fedora yet?\n> \n> In Rawhide, yes, in released Fedoras, no, patches don't apply cleanly.\n\nDo you intend to correct it in Fedora 15 and 16?  I'm not sure if it's plausible to rebase in those versions or not, but it would be fantastic if we could get it resolved.  Thanks."
					},
					{
						"isprivate": "0",
						"commentid": "4187190",
						"comment_count": "21",
						"who": {
							"text": "tbzatek",
							"name": "Tomáš Bžatek"
						},
						"bug_when": "2011-12-02 17:38:29 +0000",
						"thetext": "(In reply to comment #20)\n> (In reply to comment #19)\n> > (In reply to comment #18)\n> > > Has this been corrected in Fedora yet?\n> > \n> > In Rawhide, yes, in released Fedoras, no, patches don't apply cleanly.\n> \n> Do you intend to correct it in Fedora 15 and 16?  I'm not sure if it's\n> plausible to rebase in those versions or not, but it would be fantastic if we\n> could get it resolved.  Thanks.\n\nNot anytime in the short term unfortunately, my TODO list is quite long these days with higher-priority things. Last time I checked the patched didn't apply cleanly on 2.8.5 release which would involve further work. I'd be happy to package new patches however."
					},
					{
						"isprivate": "0",
						"commentid": "4187225",
						"comment_count": "22",
						"who": {
							"text": "vdanen",
							"name": "Vincent Danen"
						},
						"bug_when": "2011-12-02 17:48:00 +0000",
						"thetext": "The RHEL6 update was to patch 2.8.3.. would not the same patch apply to 2.8.4/2.8.5?  (I don't know, I've not looked).  I don't know what changed between 2.8.5 and 3.0.0, so perhaps rebasing may be out of the question of it introduces some ABI changes.  But if we're able to patch 2.8.3, surely that patch should apply to the other releases with minimal fuss?\n\nHaving said that, this isn't a high impact security flaw, so some delay is not a problem."
					},
					{
						"isprivate": "0",
						"commentid": "4280956",
						"comment_count": "23",
						"who": {
							"text": "anssi.hannula",
							"name": "Anssi Hannula"
						},
						"bug_when": "2012-01-01 01:32:17 +0000",
						"thetext": "The CVE-2011-1777.patch attached to this report (attachment #523601) is broken and breaks ISO support (found out by Mageia QA, https://bugs.mageia.org/show_bug.cgi?id=3941 ).\n\nThe upstream commit added braces to several 'if' statements, but in two places those are missing from this patch, causing the execution to enter the parent 'else' code blocks which are now wrongly associated with the added 'if' statements.\n\nAdditionally, the patch adds a return value to the heap_add_entry() function. However, there is an additional return statement in the function which should also now be changed to return ARCHIVE_OK, but this was missed.\n\nFor the record, here are the changes I made to the patch:\nhttp://svnweb.mageia.org/packages/updates/1/libarchive/current/SOURCES/libarchive-CVE-2011-1777.diff?r1=188950&r2=189404"
					},
					{
						"isprivate": "0",
						"commentid": "4292352",
						"comment_count": "24",
						"who": {
							"text": "ndevos",
							"name": "Niels de Vos"
						},
						"bug_when": "2012-01-06 20:45:52 +0000",
						"thetext": "EPEL5 contains libarchive-2.8.4-3.el5, this package does not contain any patches against the CVE's, can someone confirm it is vulnerable? If it needs fixing, please clone the bug and assign it to me."
					},
					{
						"isprivate": "0",
						"commentid": "4303381",
						"comment_count": "25",
						"who": {
							"text": "vdanen",
							"name": "Vincent Danen"
						},
						"bug_when": "2012-01-12 02:16:51 +0000",
						"thetext": "Thanks, Anssi!  I think we should use the patch Mageia is using for our Fedora/EPEL updates:\n\nhttp://svnweb.mageia.org/packages/updates/1/libarchive/current/SOURCES/libarchive-CVE-2011-1777.diff?revision=189404&view=co\n\nNeils, I will file a tracker for you.  2.8.4 should be affected as well."
					},
					{
						"isprivate": "0",
						"commentid": "4303384",
						"comment_count": "26",
						"who": {
							"text": "vdanen",
							"name": "Vincent Danen"
						},
						"bug_when": "2012-01-12 02:17:33 +0000",
						"thetext": "Created libarchive tracking bugs for this issue\n\nAffects: epel-5 [bug 773505]"
					},
					{
						"isprivate": "0",
						"commentid": "4365959",
						"comment_count": "28",
						"who": {
							"text": "rcvalle",
							"name": "Ramon de C Valle"
						},
						"bug_when": "2012-01-16 10:56:20 +0000",
						"thetext": "This regression affects the latest version of libarchive package released via RHSA-2011:1507. I've cloned this to Bug 782008."
					},
					{
						"isprivate": "0",
						"commentid": "4546731",
						"comment_count": "29",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2012-03-24 19:08:32 +0000",
						"thetext": "libarchive-2.8.4-5.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report."
					}
				]
			}
		},
		{
			"bug_id": 773505,
			"security": true,
			"title": "CVE-2010-4666 CVE-2011-1777 CVE-2011-1778 CVE-2011-1779 Libarchive multiple security issues [epel-5]",
			"bugzilla": {
				"bug_id": "773505",
				"creation_ts": "2012-01-12 02:17:27 +0000",
				"short_desc": "CVE-2010-4666 CVE-2011-1777 CVE-2011-1778 CVE-2011-1779 Libarchive multiple security issues [epel-5]",
				"delta_ts": "2012-03-24 19:08:21 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Security, SecurityTracking",
				"priority": "medium",
				"bug_severity": "medium",
				"blocked": [
					{
						"bug_id": "705849",
						"alias": "CVE-2011-1779",
						"creation_ts": "2011-05-18 17:20:03 +0000",
						"short_desc": "CVE-2010-4666 CVE-2011-1777 CVE-2011-1778 CVE-2011-1779 Libarchive multiple security issues",
						"delta_ts": "2021-02-24 15:26:08 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"705850",
							"739939",
							"739940",
							"773505"
						],
						"blocked": [
							{
								"bug_id": "734550",
								"error": "NotPermitted"
							}
						],
						"external_bugs": {
							"text": "RHSA-2011:1507",
							"name": "Red Hat Product Errata"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "3741565",
								"comment_count": "0",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2011-05-18 17:20:03 +0000",
								"thetext": "A number of flaws have been corrected in upstream libarchive that have not yet been included in a public release of libarchive (latest version is 2.8.4).\n\nA buffer overflow at reading bit lengths of huffman code of LZX when reading a broken CAB file (CVE-2010-4666) [1].\n\nBuffer overflows in various functions related to reading archives (in archive_read_support_format_iso9660.c) (CVE-2011-1777) [2].\n\nBuffer overflow in reading tar archives (CVE-2011-1778) [3].\n\nUse-after-free bugs (CVE-2011-1779) [4].\n\n[1] http://code.google.com/p/libarchive/source/detail?r=2842\n[2] http://code.google.com/p/libarchive/source/detail?r=3158\n[3] http://code.google.com/p/libarchive/source/detail?r=3160\n[4] http://code.google.com/p/libarchive/source/detail?r=3038"
							},
							{
								"isprivate": "0",
								"commentid": "3741568",
								"comment_count": "1",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2011-05-18 17:21:52 +0000",
								"thetext": "Created libarchive tracking bugs for this issue\n\nAffects: fedora-all [bug 705850]"
							},
							{
								"isprivate": "0",
								"commentid": "3749481",
								"comment_count": "2",
								"who": {
									"text": "tbzatek",
									"name": "Tomáš Bžatek"
								},
								"bug_when": "2011-05-20 12:09:52 +0000",
								"thetext": "What about libarchive-2.8.3-2.el6, included in RHEL 6.0 gold?"
							},
							{
								"isprivate": "0",
								"commentid": "3749983",
								"comment_count": "3",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2011-05-20 16:11:42 +0000",
								"thetext": "Yes, libarchive in RHEL6 would be affected by this.  We have not yet fully triaged the issue to know how it affects what uses it in RHEL6, which will be the determining factor on when this gets addressed."
							},
							{
								"isprivate": "0",
								"commentid": "3990205",
								"comment_count": "4",
								"who": {
									"text": "tbzatek",
									"name": "Tomáš Bžatek"
								},
								"bug_when": "2011-08-31 14:46:01 +0000",
								"thetext": "(In reply to comment #0)\n> A buffer overflow at reading bit lengths of huffman code of LZX when reading a\n> broken CAB file (CVE-2010-4666) [1].\nDoesn't apply for libarchive-2.8.4, no CAB support yet\n\n> Buffer overflows in various functions related to reading archives (in\n> archive_read_support_format_iso9660.c) (CVE-2011-1777) [2].\n> \n> Buffer overflow in reading tar archives (CVE-2011-1778) [3].\n> \n> Use-after-free bugs (CVE-2011-1779) [4].\n\nThese three patches are way too far from the 2.8.4 release and don't apply; the internal structure of the particular source files have changed a lot and even if we somehow make the patches apply, I don't trust the resulting functionality.\n\nWe probably can't even rebase to latest snapshot as long as the API has changed in preparation to the 3.x series.\n\nI suggest to close this bugreport or make someone to look deep in the sources and come up with working patches."
							},
							{
								"isprivate": "0",
								"commentid": "3993853",
								"comment_count": "5",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2011-09-02 03:46:20 +0000",
								"thetext": "(In reply to comment #4)\n> (In reply to comment #0)\n> > A buffer overflow at reading bit lengths of huffman code of LZX when reading a\n> > broken CAB file (CVE-2010-4666) [1].\n> Doesn't apply for libarchive-2.8.4, no CAB support yet\n\nOk, this works in our favour.\n \n> > Buffer overflows in various functions related to reading archives (in\n> > archive_read_support_format_iso9660.c) (CVE-2011-1777) [2].\n> > \n> > Buffer overflow in reading tar archives (CVE-2011-1778) [3].\n> > \n> > Use-after-free bugs (CVE-2011-1779) [4].\n> \n> These three patches are way too far from the 2.8.4 release and don't apply; the\n> internal structure of the particular source files have changed a lot and even\n> if we somehow make the patches apply, I don't trust the resulting\n> functionality.\n> \n> We probably can't even rebase to latest snapshot as long as the API has changed\n> in preparation to the 3.x series.\n> \n> I suggest to close this bugreport or make someone to look deep in the sources\n> and come up with working patches.\n\nI don't see closing this as an option.  You are effectively saying that, because it's difficult, we won't do it.  Maybe the impact is low enough that it won't matter if we don't fix it, but we need to look into it.  At a quick glance, there are a few important packages that link to libarchive: PackageKit, kdeutils, gvfs-archive, and anaconda (the last probably isn't very significant in this context).\n\nIf none of these packages use the vulnerable functionality, then I have no problem with closing this (once it is corrected in Fedora).  If they do, however, then we will need to come up with our own fix and backport what is applicable to close the hole."
							},
							{
								"isprivate": "0",
								"commentid": "3994518",
								"comment_count": "6",
								"who": {
									"text": "tbzatek",
									"name": "Tomáš Bžatek"
								},
								"bug_when": "2011-09-02 12:13:05 +0000",
								"thetext": "Okay, let's keep this open. I'm flooded with work, perhaps somebody else could come up with the patches."
							},
							{
								"isprivate": "0",
								"commentid": "3995785",
								"comment_count": "7",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2011-09-03 00:25:30 +0000",
								"thetext": "Fair enough.  This isn't a high-impact flaw, so we don't need to worry about this right away, but we will probably want to take care of it at some point.  Thanks."
							},
							{
								"isprivate": "0",
								"commentid": "4020989",
								"comment_count": "8",
								"who": {
									"text": "rcvalle",
									"name": "Ramon de C Valle"
								},
								"bug_when": "2011-09-15 19:48:33 +0000",
								"thetext": "(In reply to comment #0)\n> A number of flaws have been corrected in upstream libarchive that have not yet\n> been included in a public release of libarchive (latest version is 2.8.4).\n> \n> A buffer overflow at reading bit lengths of huffman code of LZX when reading a\n> broken CAB file (CVE-2010-4666) [1].\n> \n> Buffer overflows in various functions related to reading archives (in\n> archive_read_support_format_iso9660.c) (CVE-2011-1777) [2].\n> \n> Buffer overflow in reading tar archives (CVE-2011-1778) [3].\n> \n> Use-after-free bugs (CVE-2011-1779) [4].\n> \n> [1] http://code.google.com/p/libarchive/source/detail?r=2842\nArk, PackageKit, and GVFS archive mounter currently don't support cab format.\n\n> [2]\n> http://code.google.com/p/libarchive/source/detail?r=3158&path=/trunk/libarchive/archive_read_support_format_iso9660.c\nArk, and PackageKit don't support ISO9660 format. However, GVFS archive mounter do support ISO9660 format.\n\n> [3] http://code.google.com/p/libarchive/source/detail?r=3160\nBoth Ark and PackageKit use libarchive for tar format.\n\n> [4] http://code.google.com/p/libarchive/source/detail?r=3038\nGVFS archive mounter supports tar format.\n\nThe GVFS archive mounter can be used to enter and examine iso9660 and tar archives via the file manager by simply right-clicking and choosing ‘Open with Archive mounter.’. Thus, increasing the severity of this."
							},
							{
								"isprivate": "0",
								"commentid": "4024183",
								"comment_count": "9",
								"who": {
									"text": "rcvalle",
									"name": "Ramon de C Valle"
								},
								"bug_when": "2011-09-16 18:20:30 +0000",
								"thetext": "Created attachment 523601\nCVE-2011-1777.patch"
							},
							{
								"isprivate": "0",
								"commentid": "4024185",
								"comment_count": "10",
								"who": {
									"text": "rcvalle",
									"name": "Ramon de C Valle"
								},
								"bug_when": "2011-09-16 18:21:06 +0000",
								"thetext": "Created attachment 523602\nCVE-2011-1778.patch"
							},
							{
								"isprivate": "0",
								"commentid": "4024188",
								"comment_count": "11",
								"who": {
									"text": "rcvalle",
									"name": "Ramon de C Valle"
								},
								"bug_when": "2011-09-16 18:23:00 +0000",
								"thetext": "Attached are patches for CVE-2011-1777 and CVE-2011-1778, libarchive 2.8.3 is not affected by CVE-2010-4666 and CVE-2011-1779."
							},
							{
								"isprivate": "0",
								"commentid": "4029970",
								"comment_count": "13",
								"who": {
									"text": "rcvalle",
									"name": "Ramon de C Valle"
								},
								"bug_when": "2011-09-20 14:29:28 +0000",
								"thetext": "Statement CVE-2010-4666, CVE-2011-1779:\n\nNot vulnerable. This issue did not affect the versions of libarchive as shipped with Red Hat Enterprise Linux 4, 5, and 6."
							},
							{
								"isprivate": "0",
								"commentid": "4054798",
								"comment_count": "14",
								"who": {
									"text": "tbzatek",
									"name": "Tomáš Bžatek"
								},
								"bug_when": "2011-10-03 11:12:28 +0000",
								"thetext": "Created attachment 526022\nCVE-2011-1778.patch\n\n(In reply to comment #11)\n> Attached are patches for CVE-2011-1777 and CVE-2011-1778, libarchive 2.8.3 is\n> not affected by CVE-2010-4666 and CVE-2011-1779.\n\nThanks, however F16/rawhide has libarchive 2.8.5 where the patches don't apply and RHEL 6 has libarchive 2.8.3 where the patches don't compile.\n\nAlso, the CVE-2011-1778.patch is missing corrected function prototypes and some calls are missing the required arguments. I was wondering how did you manage to compile it? Attaching new patch, untested."
							},
							{
								"isprivate": "0",
								"commentid": "4054919",
								"comment_count": "15",
								"who": {
									"text": "rcvalle",
									"name": "Ramon de C Valle"
								},
								"bug_when": "2011-10-03 12:11:12 +0000",
								"thetext": "Both patches wfm with checked out sources for RHEL 6 from our CVS repository after running \"make prep\". For the CVE-2011-1778.patch, what are the function calls and function prototypes that were missing and why they also should be patched?"
							},
							{
								"isprivate": "0",
								"commentid": "4054986",
								"comment_count": "16",
								"who": {
									"text": "rcvalle",
									"name": "Ramon de C Valle"
								},
								"bug_when": "2011-10-03 12:37:24 +0000",
								"thetext": "After checking again, I realized that I attached a bad generated patch instead of the correct patch for CVE-2011-1778. Thanks for fixing it."
							},
							{
								"isprivate": "0",
								"commentid": "4184799",
								"comment_count": "17",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2011-12-01 16:35:52 +0000",
								"thetext": "This issue has been addressed in following products:\n\n  Red Hat Enterprise Linux 6\n\nVia RHSA-2011:1507 https://rhn.redhat.com/errata/RHSA-2011-1507.html"
							},
							{
								"isprivate": "0",
								"commentid": "4184861",
								"comment_count": "18",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2011-12-01 17:05:04 +0000",
								"thetext": "Has this been corrected in Fedora yet?"
							},
							{
								"isprivate": "0",
								"commentid": "4184874",
								"comment_count": "19",
								"who": {
									"text": "tbzatek",
									"name": "Tomáš Bžatek"
								},
								"bug_when": "2011-12-01 17:09:06 +0000",
								"thetext": "(In reply to comment #18)\n> Has this been corrected in Fedora yet?\n\nIn Rawhide, yes, in released Fedoras, no, patches don't apply cleanly."
							},
							{
								"isprivate": "0",
								"commentid": "4185218",
								"comment_count": "20",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2011-12-01 19:38:39 +0000",
								"thetext": "(In reply to comment #19)\n> (In reply to comment #18)\n> > Has this been corrected in Fedora yet?\n> \n> In Rawhide, yes, in released Fedoras, no, patches don't apply cleanly.\n\nDo you intend to correct it in Fedora 15 and 16?  I'm not sure if it's plausible to rebase in those versions or not, but it would be fantastic if we could get it resolved.  Thanks."
							},
							{
								"isprivate": "0",
								"commentid": "4187190",
								"comment_count": "21",
								"who": {
									"text": "tbzatek",
									"name": "Tomáš Bžatek"
								},
								"bug_when": "2011-12-02 17:38:29 +0000",
								"thetext": "(In reply to comment #20)\n> (In reply to comment #19)\n> > (In reply to comment #18)\n> > > Has this been corrected in Fedora yet?\n> > \n> > In Rawhide, yes, in released Fedoras, no, patches don't apply cleanly.\n> \n> Do you intend to correct it in Fedora 15 and 16?  I'm not sure if it's\n> plausible to rebase in those versions or not, but it would be fantastic if we\n> could get it resolved.  Thanks.\n\nNot anytime in the short term unfortunately, my TODO list is quite long these days with higher-priority things. Last time I checked the patched didn't apply cleanly on 2.8.5 release which would involve further work. I'd be happy to package new patches however."
							},
							{
								"isprivate": "0",
								"commentid": "4187225",
								"comment_count": "22",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2011-12-02 17:48:00 +0000",
								"thetext": "The RHEL6 update was to patch 2.8.3.. would not the same patch apply to 2.8.4/2.8.5?  (I don't know, I've not looked).  I don't know what changed between 2.8.5 and 3.0.0, so perhaps rebasing may be out of the question of it introduces some ABI changes.  But if we're able to patch 2.8.3, surely that patch should apply to the other releases with minimal fuss?\n\nHaving said that, this isn't a high impact security flaw, so some delay is not a problem."
							},
							{
								"isprivate": "0",
								"commentid": "4280956",
								"comment_count": "23",
								"who": {
									"text": "anssi.hannula",
									"name": "Anssi Hannula"
								},
								"bug_when": "2012-01-01 01:32:17 +0000",
								"thetext": "The CVE-2011-1777.patch attached to this report (attachment #523601) is broken and breaks ISO support (found out by Mageia QA, https://bugs.mageia.org/show_bug.cgi?id=3941 ).\n\nThe upstream commit added braces to several 'if' statements, but in two places those are missing from this patch, causing the execution to enter the parent 'else' code blocks which are now wrongly associated with the added 'if' statements.\n\nAdditionally, the patch adds a return value to the heap_add_entry() function. However, there is an additional return statement in the function which should also now be changed to return ARCHIVE_OK, but this was missed.\n\nFor the record, here are the changes I made to the patch:\nhttp://svnweb.mageia.org/packages/updates/1/libarchive/current/SOURCES/libarchive-CVE-2011-1777.diff?r1=188950&r2=189404"
							},
							{
								"isprivate": "0",
								"commentid": "4292352",
								"comment_count": "24",
								"who": {
									"text": "ndevos",
									"name": "Niels de Vos"
								},
								"bug_when": "2012-01-06 20:45:52 +0000",
								"thetext": "EPEL5 contains libarchive-2.8.4-3.el5, this package does not contain any patches against the CVE's, can someone confirm it is vulnerable? If it needs fixing, please clone the bug and assign it to me."
							},
							{
								"isprivate": "0",
								"commentid": "4303381",
								"comment_count": "25",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2012-01-12 02:16:51 +0000",
								"thetext": "Thanks, Anssi!  I think we should use the patch Mageia is using for our Fedora/EPEL updates:\n\nhttp://svnweb.mageia.org/packages/updates/1/libarchive/current/SOURCES/libarchive-CVE-2011-1777.diff?revision=189404&view=co\n\nNeils, I will file a tracker for you.  2.8.4 should be affected as well."
							},
							{
								"isprivate": "0",
								"commentid": "4303384",
								"comment_count": "26",
								"who": {
									"text": "vdanen",
									"name": "Vincent Danen"
								},
								"bug_when": "2012-01-12 02:17:33 +0000",
								"thetext": "Created libarchive tracking bugs for this issue\n\nAffects: epel-5 [bug 773505]"
							},
							{
								"isprivate": "0",
								"commentid": "4365959",
								"comment_count": "28",
								"who": {
									"text": "rcvalle",
									"name": "Ramon de C Valle"
								},
								"bug_when": "2012-01-16 10:56:20 +0000",
								"thetext": "This regression affects the latest version of libarchive package released via RHSA-2011:1507. I've cloned this to Bug 782008."
							},
							{
								"isprivate": "0",
								"commentid": "4546731",
								"comment_count": "29",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2012-03-24 19:08:32 +0000",
								"thetext": "libarchive-2.8.4-5.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report."
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "4303382",
						"comment_count": "0",
						"who": {
							"text": "vdanen",
							"name": "Vincent Danen"
						},
						"bug_when": "2012-01-12 02:17:27 +0000",
						"thetext": "\nThis is an automatically created tracking bug!  It was created to ensure\nthat one or more security vulnerabilities are fixed in affected Fedora\nversions.\n\nFor comments that are specific to the vulnerability please use bugs filed\nagainst \"Security Response\" product referenced in the \"Blocks\" field.\n\nFor more information see:\nhttp://fedoraproject.org/wiki/Security/TrackingBugs\n\nWhen creating a Bodhi update request, please include this bug ID and the\nbug IDs of this bug's parent bugs filed against the \"Security Response\"\nproduct (the top-level CVE bugs).  Please mention the CVE IDs being fixed\nin the RPM changelog when available.\n\nBodhi update submission link:\nhttps://admin.fedoraproject.org/updates/new/?type_=security&bugs=705849\n\nepel-5 tracking bug for libarchive: see blocks bug list for full details of the security issue(s).\n\n[bug automatically created by: add-tracking-bugs]"
					},
					{
						"isprivate": "0",
						"commentid": "4364143",
						"comment_count": "1",
						"who": {
							"text": "ndevos",
							"name": "Niels de Vos"
						},
						"bug_when": "2012-01-14 10:01:54 +0000",
						"thetext": "Created attachment 555212\nPatch from Bug 705849 for CVE-2011-1777"
					},
					{
						"isprivate": "0",
						"commentid": "4364144",
						"comment_count": "2",
						"who": {
							"text": "ndevos",
							"name": "Niels de Vos"
						},
						"bug_when": "2012-01-14 10:03:23 +0000",
						"thetext": "Created attachment 555213\nPatch from Bug 705849 for CVE-2011-1778 (2nd version)"
					},
					{
						"isprivate": "0",
						"commentid": "4364145",
						"comment_count": "3",
						"who": {
							"text": "ndevos",
							"name": "Niels de Vos"
						},
						"bug_when": "2012-01-14 10:09:23 +0000",
						"thetext": "Both attached patches apply cleanly against libarchive-2.8.4-3.el5.\n\nDouble checked the details in Bug 705849#c4, which look correct imho:\n- CVE-2010-4666 is not relevant as libarchive-2.8.4 does not have .cab support.\n- CVE-2011-1779 the changes between the upstream version and .el5 are huge, there\n  is little/no similarity of code changed by commit\n  http://code.google.com/p/libarchive/source/detail?r=3038."
					},
					{
						"isprivate": "0",
						"commentid": "4364159",
						"comment_count": "4",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2012-01-14 10:48:48 +0000",
						"thetext": "libarchive-2.8.4-4.el5 has been submitted as an update for Fedora EPEL 5.\nhttps://admin.fedoraproject.org/updates/libarchive-2.8.4-4.el5"
					},
					{
						"isprivate": "0",
						"commentid": "4496352",
						"comment_count": "5",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2012-03-06 13:07:13 +0000",
						"thetext": "libarchive-2.8.4-5.el5 has been submitted as an update for Fedora EPEL 5.\nhttps://admin.fedoraproject.org/updates/libarchive-2.8.4-5.el5"
					},
					{
						"isprivate": "0",
						"commentid": "4497900",
						"comment_count": "6",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2012-03-06 19:33:40 +0000",
						"thetext": "Package libarchive-2.8.4-5.el5:\n* should fix your issue,\n* was pushed to the Fedora EPEL 5 testing repository,\n* should be available at your local mirror within two days.\nUpdate it with:\n# su -c 'yum update --enablerepo=epel-testing libarchive-2.8.4-5.el5'\nas soon as you are able to.\nPlease go to the following url:\nhttps://admin.fedoraproject.org/updates/FEDORA-EPEL-2012-0697/libarchive-2.8.4-5.el5\nthen log in and leave karma (feedback)."
					},
					{
						"isprivate": "0",
						"commentid": "4546729",
						"comment_count": "7",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2012-03-24 19:08:21 +0000",
						"thetext": "libarchive-2.8.4-5.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report."
					}
				]
			}
		}
	],
	"builds": [
		{
			"nvr": "libarchive-2.8.4-5.el5",
			"signed": true,
			"type": "rpm",
			"package": {
				"i386": [
					{
						"name": "libarchive",
						"version": "2.8.4",
						"release": "5.el5",
						"arch": "i386"
					},
					{
						"name": "libarchive-devel",
						"version": "2.8.4",
						"release": "5.el5",
						"arch": "i386"
					},
					{
						"name": "libarchive-debuginfo",
						"version": "2.8.4",
						"release": "5.el5",
						"arch": "i386"
					}
				],
				"ppc": [
					{
						"name": "libarchive-devel",
						"version": "2.8.4",
						"release": "5.el5",
						"arch": "ppc"
					},
					{
						"name": "libarchive",
						"version": "2.8.4",
						"release": "5.el5",
						"arch": "ppc"
					},
					{
						"name": "libarchive-debuginfo",
						"version": "2.8.4",
						"release": "5.el5",
						"arch": "ppc"
					}
				],
				"src": [
					{
						"name": "libarchive",
						"version": "2.8.4",
						"release": "5.el5",
						"arch": "src"
					}
				],
				"x86_64": [
					{
						"name": "libarchive-debuginfo",
						"version": "2.8.4",
						"release": "5.el5",
						"arch": "x86_64"
					},
					{
						"name": "libarchive",
						"version": "2.8.4",
						"release": "5.el5",
						"arch": "x86_64"
					},
					{
						"name": "libarchive-devel",
						"version": "2.8.4",
						"release": "5.el5",
						"arch": "x86_64"
					}
				]
			}
		}
	],
	"close_bugs": true,
	"comments": [
		{
			"id": 14620,
			"text": "This update has been submitted for testing by devos. ",
			"timestamp": "2012-03-06 13:07:21",
			"update_id": 2037,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 14621,
			"text": "This update is currently being pushed to the Fedora EPEL 5 testing updates repository.",
			"timestamp": "2012-03-06 18:01:32",
			"update_id": 2037,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 14622,
			"text": "This update has been pushed to testing",
			"timestamp": "2012-03-06 19:33:45",
			"update_id": 2037,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 14623,
			"text": "This update has reached 14 days in testing and can be pushed to stable now if the maintainer wishes",
			"timestamp": "2012-03-20 22:06:35",
			"update_id": 2037,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 14624,
			"text": "This update has been submitted for stable by devos. ",
			"timestamp": "2012-03-22 11:01:12",
			"update_id": 2037,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 14625,
			"text": "This update is currently being pushed to the Fedora EPEL 5 stable updates repository.",
			"timestamp": "2012-03-24 16:29:01",
			"update_id": 2037,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 14626,
			"text": "This update has been pushed to stable",
			"timestamp": "2012-03-24 19:08:38",
			"update_id": 2037,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		}
	],
	"content_type": "rpm",
	"date_pushed": "2012-03-24 19:08:38",
	"date_stable": "2012-03-24 19:08:38",
	"date_submitted": "2012-03-06 13:07:09",
	"date_testing": "2012-03-06 19:33:45",
	"meets_testing_requirements": true,
	"notes": "Fix ISO support, regression introduced with fix for CVE-2011-1777\nSecurity fixes for CVE-2011-1777 and CVE-2011-1778.",
	"pushed": true,
	"release": {
		"branch": "el5",
		"candidate_tag": "dist-5E-epel-testing-candidate",
		"composed_by_bodhi": true,
		"dist_tag": "dist-5E-epel",
		"id_prefix": "FEDORA-EPEL",
		"long_name": "Fedora EPEL 5",
		"mail_template": "fedora_epel_legacy_errata_template",
		"name": "EL-5",
		"override_tag": "dist-5E-epel-override",
		"package_manager": "unspecified",
		"stable_tag": "dist-5E-epel",
		"state": "archived",
		"testing_tag": "dist-5E-epel-testing",
		"version": "5"
	},
	"severity": "unspecified",
	"stable_karma": 3,
	"status": "stable",
	"suggest": "unspecified",
	"title": "libarchive-2.8.4-5.el5",
	"type": "security",
	"url": "https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2012-0697",
	"unstable_karma": -3,
	"updateid": "FEDORA-EPEL-2012-0697",
	"user": {
		"avatar": "https://seccdn.libravatar.org/avatar/74ec42e43b8b0e25f4d02109f9be36c126642688d2376b0b27ba11b2dfdfbb39?s=24&d=retro",
		"email": "niels@nixpanic.net",
		"groups": [
			{
				"name": "packager"
			},
			{
				"name": "ipausers"
			},
			{
				"name": "fedora-contributor"
			},
			{
				"name": "signed_fpca"
			},
			{
				"name": "fedorabugs"
			},
			{
				"name": "centosproject-email-aliases"
			},
			{
				"name": "cla_redhat"
			},
			{
				"name": "sig-extras"
			},
			{
				"name": "sig-storage"
			}
		],
		"id": 477,
		"name": "devos",
		"openid": "devos.id.fedoraproject.org"
	},
	"version_hash": "d34da97109982de2fb54672adaabcf2b9a65d0b9"
}
