{
	"alias": "FEDORA-EPEL-2019-4dfb020a65",
	"autokarma": true,
	"autotime": true,
	"bugs": [
		{
			"bug_id": 1748397,
			"feedback": [
				{
					"bug_id": 1748397,
					"comment": {
						"id": 1029828,
						"karma": 1,
						"text": "tested on Fc29 .. works in principle. As no exploit is available yet, mitigations can't be verified.",
						"timestamp": "2019-09-06 16:22:34",
						"update_id": 152190,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/c5faa2724c82a7cef6cc1adc123c0575a5b0632348eff258aea0c2007ed08698?s=24&d=retro",
							"email": "customercare@resellerdesktop.de",
							"groups": [
								{
									"name": "ipausers"
								}
							],
							"id": 1579,
							"name": "rdtcustomercare",
							"openid": "rdtcustomercare.id.fedoraproject.org"
						},
						"user_id": 1579
					},
					"comment_id": 1029828
				},
				{
					"bug_id": 1748397,
					"comment": {
						"id": 1029840,
						"karma": 1,
						"timestamp": "2019-09-06 16:35:17",
						"update_id": 152192,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/ff320e47345c66937afccc4b03a053ebdcf58d0fcc21d8eeb12ef845d55d1d62?s=24&d=retro",
							"email": "marko.bevc@gmail.com",
							"groups": [
								{
									"name": "ipausers"
								},
								{
									"name": "signed_fpca"
								}
							],
							"id": 3703,
							"name": "markec",
							"openid": "markec.id.fedoraproject.org"
						},
						"user_id": 3703
					},
					"comment_id": 1029840
				},
				{
					"bug_id": 1748397,
					"comment": {
						"id": 1029858,
						"karma": 1,
						"timestamp": "2019-09-06 16:41:57",
						"update_id": 152191,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/ff320e47345c66937afccc4b03a053ebdcf58d0fcc21d8eeb12ef845d55d1d62?s=24&d=retro",
							"email": "marko.bevc@gmail.com",
							"groups": [
								{
									"name": "ipausers"
								},
								{
									"name": "signed_fpca"
								}
							],
							"id": 3703,
							"name": "markec",
							"openid": "markec.id.fedoraproject.org"
						},
						"user_id": 3703
					},
					"comment_id": 1029858
				},
				{
					"bug_id": 1748397,
					"comment": {
						"id": 1029860,
						"karma": 1,
						"timestamp": "2019-09-06 16:43:01",
						"update_id": 152186,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/ff320e47345c66937afccc4b03a053ebdcf58d0fcc21d8eeb12ef845d55d1d62?s=24&d=retro",
							"email": "marko.bevc@gmail.com",
							"groups": [
								{
									"name": "ipausers"
								},
								{
									"name": "signed_fpca"
								}
							],
							"id": 3703,
							"name": "markec",
							"openid": "markec.id.fedoraproject.org"
						},
						"user_id": 3703
					},
					"comment_id": 1029860
				},
				{
					"bug_id": 1748397,
					"comment": {
						"id": 1029862,
						"karma": 1,
						"timestamp": "2019-09-06 16:43:19",
						"update_id": 152188,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/ff320e47345c66937afccc4b03a053ebdcf58d0fcc21d8eeb12ef845d55d1d62?s=24&d=retro",
							"email": "marko.bevc@gmail.com",
							"groups": [
								{
									"name": "ipausers"
								},
								{
									"name": "signed_fpca"
								}
							],
							"id": 3703,
							"name": "markec",
							"openid": "markec.id.fedoraproject.org"
						},
						"user_id": 3703
					},
					"comment_id": 1029862
				},
				{
					"bug_id": 1748397,
					"comment": {
						"id": 1030222,
						"karma": 1,
						"timestamp": "2019-09-06 20:36:33",
						"update_id": 152188,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/07e2e13924673bb2473d7986739a296680e40e9090510e7a1922af20b11db0dc?s=24&d=retro",
							"email": "frantisek@sumsal.cz",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "wikiedit"
								},
								{
									"name": "ocp-cico-systemd"
								}
							],
							"id": 5107,
							"name": "mrc0mmand",
							"openid": "mrc0mmand.id.fedoraproject.org"
						},
						"user_id": 5107
					},
					"comment_id": 1030222
				},
				{
					"bug_id": 1748397,
					"comment": {
						"id": 1030679,
						"karma": 1,
						"timestamp": "2019-09-07 16:23:54",
						"update_id": 152192,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/950bcb0dea3f773bfa11f39b32f113b428ed43c92b78672dfa2fb7347d727e84?s=24&d=retro",
							"email": "ps@pos-ecommerce.net",
							"groups": [
								{
									"name": "ipausers"
								}
							],
							"id": 5143,
							"name": "peteroverethernet",
							"openid": "peteroverethernet.id.fedoraproject.org"
						},
						"user_id": 5143
					},
					"comment_id": 1030679
				},
				{
					"bug_id": 1748397,
					"comment": {
						"id": 1030680,
						"karma": 1,
						"timestamp": "2019-09-07 16:24:52",
						"update_id": 152191,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/950bcb0dea3f773bfa11f39b32f113b428ed43c92b78672dfa2fb7347d727e84?s=24&d=retro",
							"email": "ps@pos-ecommerce.net",
							"groups": [
								{
									"name": "ipausers"
								}
							],
							"id": 5143,
							"name": "peteroverethernet",
							"openid": "peteroverethernet.id.fedoraproject.org"
						},
						"user_id": 5143
					},
					"comment_id": 1030680
				},
				{
					"bug_id": 1748397,
					"comment": {
						"id": 1030884,
						"karma": 1,
						"text": "Works as expected. Security vulnerability fix could not be verified because of missing exploit sample.9",
						"timestamp": "2019-09-08 00:49:14",
						"update_id": 152192,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/f695da8d415e5717a743cff35aece09ce0370fa858f715944bdbdcd9b021a969?s=24&d=retro",
							"email": "mmuellerpos@t-online.de",
							"id": 5144,
							"name": "mglobal",
							"openid": "mglobal.id.fedoraproject.org"
						},
						"user_id": 5144
					},
					"comment_id": 1030884
				},
				{
					"bug_id": 1748397,
					"comment": {
						"id": 1030885,
						"karma": 1,
						"text": "Works as expected. Security vulnerability fix could not be verified because of missing exploit sample.9\n\n",
						"timestamp": "2019-09-08 00:50:45",
						"update_id": 152191,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/f695da8d415e5717a743cff35aece09ce0370fa858f715944bdbdcd9b021a969?s=24&d=retro",
							"email": "mmuellerpos@t-online.de",
							"id": 5144,
							"name": "mglobal",
							"openid": "mglobal.id.fedoraproject.org"
						},
						"user_id": 5144
					},
					"comment_id": 1030885
				}
			],
			"parent": true,
			"security": true,
			"title": "CVE-2019-15846 exim: out-of-bounds access in string_interpret_escape() leading to buffer overflow in the SMTP delivery process",
			"bugzilla": {
				"bug_id": "1748397",
				"alias": "CVE-2019-15846",
				"creation_ts": "2019-09-03 14:02:13 +0000",
				"short_desc": "CVE-2019-15846 exim: out-of-bounds access in string_interpret_escape() leading to buffer overflow in the SMTP delivery process",
				"delta_ts": "2021-02-16 21:25:33 +0000",
				"bug_status": "CLOSED",
				"resolution": "WONTFIX",
				"keywords": "Security",
				"priority": "urgent",
				"bug_severity": "urgent",
				"depends_on": [
					"1749761",
					"1749838"
				],
				"blocked": [
					{
						"bug_id": "1748403",
						"error": "NotPermitted"
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "13132880",
						"comment_count": "0",
						"who": {
							"text": "msiddiqu"
						},
						"bug_when": "2019-09-03 14:02:13 +0000",
						"thetext": "Quoting form the pre-release of the Exim project security advisory:\n\nThe SMTP Delivery process in all versions up to and including Exim 4.92.1 has a Buffer Overflow.  In the default runtime configuration, this is exploitable with crafted Server Name Indication (SNI) data during a TLS negotiation. In other configurations, it is exploitable with a crafted client TLS certificate."
					},
					{
						"isprivate": "0",
						"commentid": "13132901",
						"comment_count": "1",
						"who": {
							"text": "msiddiqu"
						},
						"bug_when": "2019-09-03 14:03:58 +0000",
						"thetext": "Acknowledgments:\n\nName: the Exim project\nUpstream: Zerons, Qualys"
					},
					{
						"isprivate": "0",
						"commentid": "13140536",
						"comment_count": "5",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2019-09-05 09:15:09 +0000",
						"thetext": "This issue is getting fixed in the upstream version 4.92.2."
					},
					{
						"isprivate": "0",
						"commentid": "13143191",
						"comment_count": "6",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2019-09-05 20:37:19 +0000",
						"thetext": "The issue here is in the Exim's internal function string_interpret_escape():\n\nhttps://git.exim.org/exim.git/blob/cf84d126bc:/src/src/string.c#l217\n\nThis function processes a single backslash escaped sequence and returns the character that is represented by the escape sequence.  The function fails to correctly handle situation when backslash is the last character of the input string, and incorrectly sets the pointer that is supposed to point to the last character of the escape sequence upon function exit.  A function caller than subsequently advances the pointer past the buffer boundary.  That leads to out-of-bounds read when the caller attempts to process the input string following the escape sequence.  Additionally, this may lead to out-of-bounds write when unescaped string is written (to the same or different buffer).\n\nThe analysis of this issue was performed by the Qualys Security Advisory team.  Quoting their findings:\n\n\"\"\"\n- From an attacker's point of view, most calls to\n  string_interpret_escape() are uninteresting. For example, nextitem()\n  in src/filter.c checks for buffer overflows, and string_dequote()\n  seems to process trusted strings only (strings from configuration\n  files).\n\n- On the other hand, string_unprinting() is very interesting:\n\n  - It is used in tls_import_cert() (for peercert, for example); but\n    certificates are in PEM format (i.e., base64) and hence unlikely to\n    contain the problematic backslash-null-byte sequence.\n\n  - It is used for peerdn and sni in src/spool_in.c; but peerdn is used\n    only if client certificates are processed by Exim, and this is not\n    the default (and although some sites use client-certificate\n    authentication, this is not very common, and hence not very\n    interesting for an attacker).\n\n  - In any case, as long as Exim supports and accepts tls connections,\n    an attacker can send an sni, and hence reach the problematic\n    string_unprinting() and string_interpret_escape() functions.\n\"\"\"\n\nThey further confirmed that the buffer overflow (out-of-bounds write) that is triggered via sni or peerdn processing is exploitable and can lead to code execution within a process that runs with root privileges, and it can be triggered by an unauthenticated remote attacker.\n\nThe only currently supported Red Hat product which includes Exim is Red Hat Enterprise Linux 5, with older Exim 4.63.  This version includes the buggy string_interpret_escape() function.  However, unlike recent Exim versions, it does not include string_unprinting() function and hence does not do peerdn and sni processing as described above.  The string_unprinting() function and its use for unquoting of peerdn and sni info from spool files was introduced in Exim 4.80 via the following commits:\n\nhttps://git.exim.org/exim.git/commitdiff/c7396ac5dedeca5d791113782ae72b4bb67692e3\nhttps://git.exim.org/exim.git/commitdiff/7be682ca5ebd9571a01b762195b11c34cd231830\n\nAs noted in the Qualys Security Advisory team's analysis, other uses of the string_interpret_escape() only process trusted inputs (typically inputs from various configuration files) and/or avoid buffer overflow via additional bounds checking or extension of output buffer as more data is being written.\n\nTherefore, even though the version of Exim as shipped with Red Hat Enterprise Linux 5 includes the buggy string_interpret_escape() function, it does not expose the problem and is not affected by the remote code execution flaw."
					},
					{
						"isprivate": "0",
						"commentid": "13143237",
						"comment_count": "7",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2019-09-05 21:08:12 +0000",
						"thetext": "Statement:\n\nThe flaw in the string_interpret_escape() function exists in the versions of Exim as shipped with Red Hat Enterprise Linux 5. However, it is not exposed to untrusted inputs and therefore it can not be exploited to achieve remote code execution. Refer to Red Hat Bugzilla bug 1748397 for further technical details: https://bugzilla.redhat.com/show_bug.cgi?id=1748397#c6\n\nExim mail server is not shipped with Red Hat Enterprise Linux 6, 7, and 8."
					},
					{
						"isprivate": "0",
						"commentid": "13145134",
						"comment_count": "8",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2019-09-06 12:32:30 +0000",
						"thetext": "Upstream commit:\n\nhttps://git.exim.org/exim.git/commitdiff/2600301ba6dbac5c9d640c87007a07ee6dcea1f4\n\nThe same change for the exim_dbmbuild tool, which includes a copy of the string_interpret_escape() function.  Note that this tool is not expected to be used on untrusted inputs, and hence the problem in it is not considered to have security impact.\n\nhttps://git.exim.org/exim.git/commitdiff/66935633816a88460f5222f40dc29d1a4e877978\nhttps://git.exim.org/exim.git/commitdiff/cdc7f9a9667ecf31d803fc8d1a31b466284360bd"
					},
					{
						"isprivate": "0",
						"commentid": "13145185",
						"comment_count": "9",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2019-09-06 12:34:26 +0000",
						"thetext": "In reply to comment #6:\n> The analysis of this issue was performed by the Qualys Security Advisory\n> team.  Quoting their findings:\n\nFull write-up from the Qualys Security Advisory team can be found in:\n\nhttps://git.exim.org/exim.git/blob/2600301ba6:/doc/doc-txt/cve-2019-15846/qualys.mbx"
					},
					{
						"isprivate": "0",
						"commentid": "13145735",
						"comment_count": "10",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2019-09-06 14:34:48 +0000",
						"thetext": "Public now via upstream commits (linked above) and the upstream advisory:\n\nhttp://exim.org/static/doc/security/CVE-2019-15846.txt"
					},
					{
						"isprivate": "0",
						"commentid": "13145737",
						"comment_count": "11",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2019-09-06 14:37:24 +0000",
						"thetext": "Upstream advisory provides the following mitigation instructions that can be used to block exploitation using sni or peerdn as described in comment 6 above.\n\nQuoting the Mitigation section of the upstream advisory:\n\n\"\"\"\nMitigation\n==========\n\nDo not offer TLS. (This mitigation is not recommended.)\n\nFor a attacking SNI the following ACL snippet should work:\n\n    # to be prepended to your mail acl (the ACL referenced\n    # by the acl_smtp_mail main config option)\n    deny    condition = ${if eq{\\\\}{${substr{-1}{1}{$tls_in_sni}}}}\n    deny    condition = ${if eq{\\\\}{${substr{-1}{1}{$tls_in_peerdn}}}}\n\"\"\"\n\nNote that this mitigation is not needed for the version of Exim as shipped with Red Hat Enterprise Linux 5."
					},
					{
						"isprivate": "0",
						"commentid": "13145744",
						"comment_count": "12",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2019-09-06 14:38:54 +0000",
						"thetext": "Created exim tracking bugs for this issue:\n\nAffects: epel-all [bug 1749838]"
					},
					{
						"isprivate": "0",
						"commentid": "13145759",
						"comment_count": "13",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2019-09-06 14:43:56 +0000",
						"thetext": "External References:\n\nhttps://exim.org/static/doc/security/CVE-2019-15846.txt"
					},
					{
						"isprivate": "0",
						"commentid": "13147342",
						"comment_count": "14",
						"who": {
							"text": "prodsec-dev",
							"name": "Product Security DevOps Team"
						},
						"bug_when": "2019-09-06 21:42:27 +0000",
						"thetext": "This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):\n\nhttps://access.redhat.com/security/cve/cve-2019-15846"
					}
				]
			}
		},
		{
			"bug_id": 1749838,
			"feedback": [
				{
					"bug_id": 1749838,
					"comment": {
						"id": 1029840,
						"karma": 1,
						"timestamp": "2019-09-06 16:35:17",
						"update_id": 152192,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/ff320e47345c66937afccc4b03a053ebdcf58d0fcc21d8eeb12ef845d55d1d62?s=24&d=retro",
							"email": "marko.bevc@gmail.com",
							"groups": [
								{
									"name": "ipausers"
								},
								{
									"name": "signed_fpca"
								}
							],
							"id": 3703,
							"name": "markec",
							"openid": "markec.id.fedoraproject.org"
						},
						"user_id": 3703
					},
					"comment_id": 1029840
				},
				{
					"bug_id": 1749838,
					"comment": {
						"id": 1029858,
						"karma": 1,
						"timestamp": "2019-09-06 16:41:57",
						"update_id": 152191,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/ff320e47345c66937afccc4b03a053ebdcf58d0fcc21d8eeb12ef845d55d1d62?s=24&d=retro",
							"email": "marko.bevc@gmail.com",
							"groups": [
								{
									"name": "ipausers"
								},
								{
									"name": "signed_fpca"
								}
							],
							"id": 3703,
							"name": "markec",
							"openid": "markec.id.fedoraproject.org"
						},
						"user_id": 3703
					},
					"comment_id": 1029858
				},
				{
					"bug_id": 1749838,
					"comment": {
						"id": 1030679,
						"karma": 1,
						"timestamp": "2019-09-07 16:23:54",
						"update_id": 152192,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/950bcb0dea3f773bfa11f39b32f113b428ed43c92b78672dfa2fb7347d727e84?s=24&d=retro",
							"email": "ps@pos-ecommerce.net",
							"groups": [
								{
									"name": "ipausers"
								}
							],
							"id": 5143,
							"name": "peteroverethernet",
							"openid": "peteroverethernet.id.fedoraproject.org"
						},
						"user_id": 5143
					},
					"comment_id": 1030679
				},
				{
					"bug_id": 1749838,
					"comment": {
						"id": 1030680,
						"karma": 1,
						"timestamp": "2019-09-07 16:24:52",
						"update_id": 152191,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/950bcb0dea3f773bfa11f39b32f113b428ed43c92b78672dfa2fb7347d727e84?s=24&d=retro",
							"email": "ps@pos-ecommerce.net",
							"groups": [
								{
									"name": "ipausers"
								}
							],
							"id": 5143,
							"name": "peteroverethernet",
							"openid": "peteroverethernet.id.fedoraproject.org"
						},
						"user_id": 5143
					},
					"comment_id": 1030680
				},
				{
					"bug_id": 1749838,
					"comment": {
						"id": 1030884,
						"karma": 1,
						"text": "Works as expected. Security vulnerability fix could not be verified because of missing exploit sample.9",
						"timestamp": "2019-09-08 00:49:14",
						"update_id": 152192,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/f695da8d415e5717a743cff35aece09ce0370fa858f715944bdbdcd9b021a969?s=24&d=retro",
							"email": "mmuellerpos@t-online.de",
							"id": 5144,
							"name": "mglobal",
							"openid": "mglobal.id.fedoraproject.org"
						},
						"user_id": 5144
					},
					"comment_id": 1030884
				},
				{
					"bug_id": 1749838,
					"comment": {
						"id": 1030885,
						"karma": 1,
						"text": "Works as expected. Security vulnerability fix could not be verified because of missing exploit sample.9\n\n",
						"timestamp": "2019-09-08 00:50:45",
						"update_id": 152191,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/f695da8d415e5717a743cff35aece09ce0370fa858f715944bdbdcd9b021a969?s=24&d=retro",
							"email": "mmuellerpos@t-online.de",
							"id": 5144,
							"name": "mglobal",
							"openid": "mglobal.id.fedoraproject.org"
						},
						"user_id": 5144
					},
					"comment_id": 1030885
				}
			],
			"security": true,
			"title": "CVE-2019-15846 exim: out-of-bounds access in string_interpret_escape() leading to buffer overflow in the SMTP delivery process [epel-all]",
			"bugzilla": {
				"bug_id": "1749838",
				"creation_ts": "2019-09-06 14:38:48 +0000",
				"short_desc": "CVE-2019-15846 exim: out-of-bounds access in string_interpret_escape() leading to buffer overflow in the SMTP delivery process [epel-all]",
				"delta_ts": "2019-09-08 03:20:12 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Security, SecurityTracking",
				"priority": "urgent",
				"bug_severity": "urgent",
				"blocked": [
					{
						"bug_id": "1748397",
						"alias": "CVE-2019-15846",
						"creation_ts": "2019-09-03 14:02:13 +0000",
						"short_desc": "CVE-2019-15846 exim: out-of-bounds access in string_interpret_escape() leading to buffer overflow in the SMTP delivery process",
						"delta_ts": "2021-02-16 21:25:33 +0000",
						"bug_status": "CLOSED",
						"resolution": "WONTFIX",
						"keywords": "Security",
						"priority": "urgent",
						"bug_severity": "urgent",
						"depends_on": [
							"1749761",
							"1749838"
						],
						"blocked": [
							{
								"bug_id": "1748403",
								"error": "NotPermitted"
							}
						],
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "13132880",
								"comment_count": "0",
								"who": {
									"text": "msiddiqu"
								},
								"bug_when": "2019-09-03 14:02:13 +0000",
								"thetext": "Quoting form the pre-release of the Exim project security advisory:\n\nThe SMTP Delivery process in all versions up to and including Exim 4.92.1 has a Buffer Overflow.  In the default runtime configuration, this is exploitable with crafted Server Name Indication (SNI) data during a TLS negotiation. In other configurations, it is exploitable with a crafted client TLS certificate."
							},
							{
								"isprivate": "0",
								"commentid": "13132901",
								"comment_count": "1",
								"who": {
									"text": "msiddiqu"
								},
								"bug_when": "2019-09-03 14:03:58 +0000",
								"thetext": "Acknowledgments:\n\nName: the Exim project\nUpstream: Zerons, Qualys"
							},
							{
								"isprivate": "0",
								"commentid": "13140536",
								"comment_count": "5",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2019-09-05 09:15:09 +0000",
								"thetext": "This issue is getting fixed in the upstream version 4.92.2."
							},
							{
								"isprivate": "0",
								"commentid": "13143191",
								"comment_count": "6",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2019-09-05 20:37:19 +0000",
								"thetext": "The issue here is in the Exim's internal function string_interpret_escape():\n\nhttps://git.exim.org/exim.git/blob/cf84d126bc:/src/src/string.c#l217\n\nThis function processes a single backslash escaped sequence and returns the character that is represented by the escape sequence.  The function fails to correctly handle situation when backslash is the last character of the input string, and incorrectly sets the pointer that is supposed to point to the last character of the escape sequence upon function exit.  A function caller than subsequently advances the pointer past the buffer boundary.  That leads to out-of-bounds read when the caller attempts to process the input string following the escape sequence.  Additionally, this may lead to out-of-bounds write when unescaped string is written (to the same or different buffer).\n\nThe analysis of this issue was performed by the Qualys Security Advisory team.  Quoting their findings:\n\n\"\"\"\n- From an attacker's point of view, most calls to\n  string_interpret_escape() are uninteresting. For example, nextitem()\n  in src/filter.c checks for buffer overflows, and string_dequote()\n  seems to process trusted strings only (strings from configuration\n  files).\n\n- On the other hand, string_unprinting() is very interesting:\n\n  - It is used in tls_import_cert() (for peercert, for example); but\n    certificates are in PEM format (i.e., base64) and hence unlikely to\n    contain the problematic backslash-null-byte sequence.\n\n  - It is used for peerdn and sni in src/spool_in.c; but peerdn is used\n    only if client certificates are processed by Exim, and this is not\n    the default (and although some sites use client-certificate\n    authentication, this is not very common, and hence not very\n    interesting for an attacker).\n\n  - In any case, as long as Exim supports and accepts tls connections,\n    an attacker can send an sni, and hence reach the problematic\n    string_unprinting() and string_interpret_escape() functions.\n\"\"\"\n\nThey further confirmed that the buffer overflow (out-of-bounds write) that is triggered via sni or peerdn processing is exploitable and can lead to code execution within a process that runs with root privileges, and it can be triggered by an unauthenticated remote attacker.\n\nThe only currently supported Red Hat product which includes Exim is Red Hat Enterprise Linux 5, with older Exim 4.63.  This version includes the buggy string_interpret_escape() function.  However, unlike recent Exim versions, it does not include string_unprinting() function and hence does not do peerdn and sni processing as described above.  The string_unprinting() function and its use for unquoting of peerdn and sni info from spool files was introduced in Exim 4.80 via the following commits:\n\nhttps://git.exim.org/exim.git/commitdiff/c7396ac5dedeca5d791113782ae72b4bb67692e3\nhttps://git.exim.org/exim.git/commitdiff/7be682ca5ebd9571a01b762195b11c34cd231830\n\nAs noted in the Qualys Security Advisory team's analysis, other uses of the string_interpret_escape() only process trusted inputs (typically inputs from various configuration files) and/or avoid buffer overflow via additional bounds checking or extension of output buffer as more data is being written.\n\nTherefore, even though the version of Exim as shipped with Red Hat Enterprise Linux 5 includes the buggy string_interpret_escape() function, it does not expose the problem and is not affected by the remote code execution flaw."
							},
							{
								"isprivate": "0",
								"commentid": "13143237",
								"comment_count": "7",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2019-09-05 21:08:12 +0000",
								"thetext": "Statement:\n\nThe flaw in the string_interpret_escape() function exists in the versions of Exim as shipped with Red Hat Enterprise Linux 5. However, it is not exposed to untrusted inputs and therefore it can not be exploited to achieve remote code execution. Refer to Red Hat Bugzilla bug 1748397 for further technical details: https://bugzilla.redhat.com/show_bug.cgi?id=1748397#c6\n\nExim mail server is not shipped with Red Hat Enterprise Linux 6, 7, and 8."
							},
							{
								"isprivate": "0",
								"commentid": "13145134",
								"comment_count": "8",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2019-09-06 12:32:30 +0000",
								"thetext": "Upstream commit:\n\nhttps://git.exim.org/exim.git/commitdiff/2600301ba6dbac5c9d640c87007a07ee6dcea1f4\n\nThe same change for the exim_dbmbuild tool, which includes a copy of the string_interpret_escape() function.  Note that this tool is not expected to be used on untrusted inputs, and hence the problem in it is not considered to have security impact.\n\nhttps://git.exim.org/exim.git/commitdiff/66935633816a88460f5222f40dc29d1a4e877978\nhttps://git.exim.org/exim.git/commitdiff/cdc7f9a9667ecf31d803fc8d1a31b466284360bd"
							},
							{
								"isprivate": "0",
								"commentid": "13145185",
								"comment_count": "9",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2019-09-06 12:34:26 +0000",
								"thetext": "In reply to comment #6:\n> The analysis of this issue was performed by the Qualys Security Advisory\n> team.  Quoting their findings:\n\nFull write-up from the Qualys Security Advisory team can be found in:\n\nhttps://git.exim.org/exim.git/blob/2600301ba6:/doc/doc-txt/cve-2019-15846/qualys.mbx"
							},
							{
								"isprivate": "0",
								"commentid": "13145735",
								"comment_count": "10",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2019-09-06 14:34:48 +0000",
								"thetext": "Public now via upstream commits (linked above) and the upstream advisory:\n\nhttp://exim.org/static/doc/security/CVE-2019-15846.txt"
							},
							{
								"isprivate": "0",
								"commentid": "13145737",
								"comment_count": "11",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2019-09-06 14:37:24 +0000",
								"thetext": "Upstream advisory provides the following mitigation instructions that can be used to block exploitation using sni or peerdn as described in comment 6 above.\n\nQuoting the Mitigation section of the upstream advisory:\n\n\"\"\"\nMitigation\n==========\n\nDo not offer TLS. (This mitigation is not recommended.)\n\nFor a attacking SNI the following ACL snippet should work:\n\n    # to be prepended to your mail acl (the ACL referenced\n    # by the acl_smtp_mail main config option)\n    deny    condition = ${if eq{\\\\}{${substr{-1}{1}{$tls_in_sni}}}}\n    deny    condition = ${if eq{\\\\}{${substr{-1}{1}{$tls_in_peerdn}}}}\n\"\"\"\n\nNote that this mitigation is not needed for the version of Exim as shipped with Red Hat Enterprise Linux 5."
							},
							{
								"isprivate": "0",
								"commentid": "13145744",
								"comment_count": "12",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2019-09-06 14:38:54 +0000",
								"thetext": "Created exim tracking bugs for this issue:\n\nAffects: epel-all [bug 1749838]"
							},
							{
								"isprivate": "0",
								"commentid": "13145759",
								"comment_count": "13",
								"who": {
									"text": "thoger",
									"name": "Tomas Hoger"
								},
								"bug_when": "2019-09-06 14:43:56 +0000",
								"thetext": "External References:\n\nhttps://exim.org/static/doc/security/CVE-2019-15846.txt"
							},
							{
								"isprivate": "0",
								"commentid": "13147342",
								"comment_count": "14",
								"who": {
									"text": "prodsec-dev",
									"name": "Product Security DevOps Team"
								},
								"bug_when": "2019-09-06 21:42:27 +0000",
								"thetext": "This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):\n\nhttps://access.redhat.com/security/cve/cve-2019-15846"
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "13145742",
						"comment_count": "0",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2019-09-06 14:38:48 +0000",
						"thetext": "\nThis is an automatically created tracking bug!  It was created to ensure\nthat one or more security vulnerabilities are fixed in affected versions\nof epel-all.\n\nFor comments that are specific to the vulnerability please use bugs filed\nagainst the \"Security Response\" product referenced in the \"Blocks\" field.\n\nFor more information see:\nhttp://fedoraproject.org/wiki/Security/TrackingBugs\n\nWhen submitting as an update, use the fedpkg template provided in the next\ncomment(s).  This will include the bug IDs of this tracking bug as well as\nthe relevant top-level CVE bugs.\n\nPlease also mention the CVE IDs being fixed in the RPM changelog and the\nfedpkg commit message.\n\nNOTE: this issue affects multiple supported versions of Fedora EPEL. While\nonly one tracking bug has been filed, please correct all affected versions\nat the same time.  If you need to fix the versions independent of each\nother, you may clone this bug as appropriate."
					},
					{
						"isprivate": "0",
						"commentid": "13145743",
						"comment_count": "1",
						"who": {
							"text": "thoger",
							"name": "Tomas Hoger"
						},
						"bug_when": "2019-09-06 14:38:50 +0000",
						"thetext": "Use the following template to for the 'fedpkg update' request to submit an\nupdate for this issue as it contains the top-level parent bug(s) as well as\nthis tracking bug.  This will ensure that all associated bugs get updated\nwhen new packages are pushed to stable.\n\n=====\n\n# bugfix, security, enhancement, newpackage (required)\ntype=security\n\n# low, medium, high, urgent (required)\nseverity=urgent\n\n# testing, stable\nrequest=testing\n\n# Bug numbers: 1234,9876\nbugs=1748397,1749838\n\n# Description of your update\nnotes=Security fix for [PUT CVEs HERE]\n\n# Enable request automation based on the stable/unstable karma thresholds\nautokarma=True\nstable_karma=3\nunstable_karma=-3\n\n# Automatically close bugs when this marked as stable\nclose_bugs=True\n\n# Suggest that users restart after update\nsuggest_reboot=False\n\n======\n\nAdditionally, you may opt to use the bodhi web interface to submit updates:\n\nhttps://bodhi.fedoraproject.org/updates/new"
					},
					{
						"isprivate": "0",
						"commentid": "13146100",
						"comment_count": "2",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2019-09-06 16:00:41 +0000",
						"thetext": "FEDORA-EPEL-2019-4dfb020a65 has been submitted as an update to Fedora EPEL 6. https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2019-4dfb020a65"
					},
					{
						"isprivate": "0",
						"commentid": "13146113",
						"comment_count": "3",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2019-09-06 16:03:43 +0000",
						"thetext": "FEDORA-EPEL-2019-fb4fca003a has been submitted as an update to Fedora EPEL 7. https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2019-fb4fca003a"
					},
					{
						"isprivate": "0",
						"commentid": "13148105",
						"comment_count": "4",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2019-09-08 02:28:50 +0000",
						"thetext": "exim-4.92.2-1.el7 has been pushed to the Fedora EPEL 7 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "13148151",
						"comment_count": "5",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2019-09-08 03:20:12 +0000",
						"thetext": "exim-4.92.2-1.el6 has been pushed to the Fedora EPEL 6 stable repository. If problems still persist, please make note of it in this bug report."
					}
				]
			}
		}
	],
	"builds": [
		{
			"epoch": 0,
			"nvr": "exim-4.92.2-1.el6",
			"release_id": 10,
			"signed": true,
			"type": "rpm",
			"package": {
				"i686": [
					{
						"name": "exim-greylist",
						"version": "4.92.2",
						"release": "1.el6",
						"arch": "i686"
					},
					{
						"name": "exim-mysql",
						"version": "4.92.2",
						"release": "1.el6",
						"arch": "i686"
					},
					{
						"name": "exim-debuginfo",
						"version": "4.92.2",
						"release": "1.el6",
						"arch": "i686"
					},
					{
						"name": "exim-pgsql",
						"version": "4.92.2",
						"release": "1.el6",
						"arch": "i686"
					},
					{
						"name": "exim-mon",
						"version": "4.92.2",
						"release": "1.el6",
						"arch": "i686"
					},
					{
						"name": "exim",
						"version": "4.92.2",
						"release": "1.el6",
						"arch": "i686"
					}
				],
				"src": [
					{
						"name": "exim",
						"version": "4.92.2",
						"release": "1.el6",
						"arch": "src"
					}
				],
				"x86_64": [
					{
						"name": "exim-greylist",
						"version": "4.92.2",
						"release": "1.el6",
						"arch": "x86_64"
					},
					{
						"name": "exim-pgsql",
						"version": "4.92.2",
						"release": "1.el6",
						"arch": "x86_64"
					},
					{
						"name": "exim-mysql",
						"version": "4.92.2",
						"release": "1.el6",
						"arch": "x86_64"
					},
					{
						"name": "exim",
						"version": "4.92.2",
						"release": "1.el6",
						"arch": "x86_64"
					},
					{
						"name": "exim-debuginfo",
						"version": "4.92.2",
						"release": "1.el6",
						"arch": "x86_64"
					},
					{
						"name": "exim-mon",
						"version": "4.92.2",
						"release": "1.el6",
						"arch": "x86_64"
					}
				]
			}
		}
	],
	"close_bugs": true,
	"comments": [
		{
			"id": 1029781,
			"text": "This update has been submitted for testing by jskarvad. ",
			"timestamp": "2019-09-06 16:00:38",
			"update_id": 152191,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 1029782,
			"text": "This update's test gating status has been changed to 'waiting'.",
			"timestamp": "2019-09-06 16:00:38",
			"update_id": 152191,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 1029783,
			"text": "This update's test gating status has been changed to 'ignored'.",
			"timestamp": "2019-09-06 16:00:42",
			"update_id": 152191,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"bug_feedback": [
				{
					"bug": {
						"bug_id": 1748397,
						"parent": true,
						"security": true,
						"title": "CVE-2019-15846 exim: out-of-bounds access in string_interpret_escape() leading to buffer overflow in the SMTP delivery process"
					},
					"bug_id": 1748397,
					"comment_id": 1029858
				},
				{
					"bug": {
						"bug_id": 1749838,
						"security": true,
						"title": "CVE-2019-15846 exim: out-of-bounds access in string_interpret_escape() leading to buffer overflow in the SMTP delivery process [epel-all]"
					},
					"bug_id": 1749838,
					"comment_id": 1029858
				}
			],
			"id": 1029858,
			"karma": 1,
			"timestamp": "2019-09-06 16:41:57",
			"update_id": 152191,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/ff320e47345c66937afccc4b03a053ebdcf58d0fcc21d8eeb12ef845d55d1d62?s=24&d=retro",
				"email": "marko.bevc@gmail.com",
				"groups": [
					{
						"name": "ipausers"
					},
					{
						"name": "signed_fpca"
					}
				],
				"id": 3703,
				"name": "markec",
				"openid": "markec.id.fedoraproject.org"
			},
			"user_id": 3703
		},
		{
			"id": 1029859,
			"text": "This update has been submitted for stable by bodhi. ",
			"timestamp": "2019-09-06 16:41:57",
			"update_id": 152191,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"bug_feedback": [
				{
					"bug": {
						"bug_id": 1748397,
						"parent": true,
						"security": true,
						"title": "CVE-2019-15846 exim: out-of-bounds access in string_interpret_escape() leading to buffer overflow in the SMTP delivery process"
					},
					"bug_id": 1748397,
					"comment_id": 1030680
				},
				{
					"bug": {
						"bug_id": 1749838,
						"security": true,
						"title": "CVE-2019-15846 exim: out-of-bounds access in string_interpret_escape() leading to buffer overflow in the SMTP delivery process [epel-all]"
					},
					"bug_id": 1749838,
					"comment_id": 1030680
				}
			],
			"id": 1030680,
			"karma": 1,
			"timestamp": "2019-09-07 16:24:52",
			"update_id": 152191,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/950bcb0dea3f773bfa11f39b32f113b428ed43c92b78672dfa2fb7347d727e84?s=24&d=retro",
				"email": "ps@pos-ecommerce.net",
				"groups": [
					{
						"name": "ipausers"
					}
				],
				"id": 5143,
				"name": "peteroverethernet",
				"openid": "peteroverethernet.id.fedoraproject.org"
			},
			"user_id": 5143
		},
		{
			"bug_feedback": [
				{
					"bug": {
						"bug_id": 1748397,
						"parent": true,
						"security": true,
						"title": "CVE-2019-15846 exim: out-of-bounds access in string_interpret_escape() leading to buffer overflow in the SMTP delivery process"
					},
					"bug_id": 1748397,
					"comment_id": 1030885
				},
				{
					"bug": {
						"bug_id": 1749838,
						"security": true,
						"title": "CVE-2019-15846 exim: out-of-bounds access in string_interpret_escape() leading to buffer overflow in the SMTP delivery process [epel-all]"
					},
					"bug_id": 1749838,
					"comment_id": 1030885
				}
			],
			"id": 1030885,
			"karma": 1,
			"text": "Works as expected. Security vulnerability fix could not be verified because of missing exploit sample.9\n\n",
			"timestamp": "2019-09-08 00:50:45",
			"update_id": 152191,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/f695da8d415e5717a743cff35aece09ce0370fa858f715944bdbdcd9b021a969?s=24&d=retro",
				"email": "mmuellerpos@t-online.de",
				"id": 5144,
				"name": "mglobal",
				"openid": "mglobal.id.fedoraproject.org"
			},
			"user_id": 5144
		},
		{
			"id": 1030946,
			"text": "This update has been pushed to stable.",
			"timestamp": "2019-09-08 03:20:14",
			"update_id": 152191,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		}
	],
	"content_type": "rpm",
	"date_pushed": "2019-09-08 03:20:09",
	"date_stable": "2019-09-08 03:20:09",
	"date_submitted": "2019-09-06 16:00:38",
	"karma": 3,
	"meets_testing_requirements": true,
	"notes": "This is an update fixing CVE-2019-15846.",
	"pushed": true,
	"release": {
		"branch": "el6",
		"candidate_tag": "dist-6E-epel-testing-candidate",
		"composed_by_bodhi": true,
		"create_automatic_updates": false,
		"dist_tag": "dist-6E-epel",
		"id_prefix": "FEDORA-EPEL",
		"long_name": "Fedora EPEL 6",
		"mail_template": "fedora_epel_legacy_errata_template",
		"name": "EL-6",
		"override_tag": "dist-6E-epel-override",
		"package_manager": "unspecified",
		"stable_tag": "dist-6E-epel",
		"state": "archived",
		"testing_tag": "dist-6E-epel-testing",
		"version": "6"
	},
	"require_bugs": true,
	"require_testcases": true,
	"severity": "urgent",
	"stable_days": 14,
	"stable_karma": 1,
	"status": "stable",
	"suggest": "unspecified",
	"test_gating_status": "ignored",
	"title": "exim-4.92.2-1.el6",
	"type": "security",
	"url": "https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2019-4dfb020a65",
	"unstable_karma": -3,
	"updateid": "FEDORA-EPEL-2019-4dfb020a65",
	"user": {
		"avatar": "https://seccdn.libravatar.org/avatar/ccc672094c5197c6a07761eca84a5f20d750e98f19a5f9132e7e92494cf3a5ab?s=24&d=retro",
		"email": "jskarvad@redhat.com",
		"groups": [
			{
				"name": "packager"
			},
			{
				"name": "provenpackager"
			},
			{
				"name": "ipausers"
			},
			{
				"name": "fedora-contributor"
			},
			{
				"name": "signed_fpca"
			},
			{
				"name": "fedorabugs"
			},
			{
				"name": "cla_redhat"
			},
			{
				"name": "3d-printing-sig"
			},
			{
				"name": "gittuned"
			}
		],
		"id": 591,
		"name": "jskarvad",
		"openid": "jskarvad.id.fedoraproject.org"
	},
	"version_hash": "ac4d3129c22986d1b251d1a1aa479f38fb950aa2"
}
