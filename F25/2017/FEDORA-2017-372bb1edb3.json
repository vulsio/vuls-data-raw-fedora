{
	"alias": "FEDORA-2017-372bb1edb3",
	"bugs": [
		{
			"bug_id": 1394862,
			"feedback": [
				{
					"bug_id": 1394862,
					"comment": {
						"id": 612611,
						"text": "@pkubat noticed one potential bug in the original patch and sent an updated build to avoid it; if you can re-test with the new build and confirm the bug's still fixed it'd be great. thanks!",
						"timestamp": "2017-05-24 18:05:39",
						"update_id": 88479,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/0e6c01c694d74afb0cbb65bc1be91950111503818caf492c0938dc2b97c48c41?s=24&d=retro",
							"email": "awilliam@redhat.com",
							"groups": [
								{
									"name": "proventesters"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "packager"
								},
								{
									"name": "qa-tools-sig"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "news"
								},
								{
									"name": "gittriage"
								},
								{
									"name": "sysadmin"
								},
								{
									"name": "gitspin-kickstarts"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "gitgeneric-release"
								},
								{
									"name": "yak_farmers"
								},
								{
									"name": "triagers"
								},
								{
									"name": "qa"
								},
								{
									"name": "sysadmin-qa"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "gitmkinitrd"
								},
								{
									"name": "qa-admin"
								},
								{
									"name": "sysadmin-main"
								},
								{
									"name": "common-issues-triage"
								},
								{
									"name": "aws-qa"
								},
								{
									"name": "gitfedora-project-schedule"
								},
								{
									"name": "change-wranglers"
								},
								{
									"name": "fedora-ci-admins"
								},
								{
									"name": "program-management"
								},
								{
									"name": "trust admins"
								}
							],
							"id": 302,
							"name": "adamwill",
							"openid": "adamwill.id.fedoraproject.org"
						},
						"user_id": 302
					},
					"comment_id": 612611
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 613299,
						"karma": -1,
						"karma_critpath": -1,
						"text": "https://bugzilla.redhat.com/show_bug.cgi?id=1394862#c43",
						"timestamp": "2017-05-26 07:41:56",
						"update_id": 88479,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/d69b9b24da4213d1e018fe681e71da6502aaffc989b60b2c5c4d1082dca77ab1?s=24&d=retro",
							"email": "lslebodn@redhat.com",
							"groups": [
								{
									"name": "packager"
								}
							],
							"id": 809,
							"name": "lslebodn",
							"openid": "lslebodn.id.fedoraproject.org"
						},
						"user_id": 809
					},
					"comment_id": 613299,
					"karma": -1
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 613338,
						"karma": -1,
						"karma_critpath": -1,
						"text": "This update hosed by RPM database, which I could only rebuild by manually copying the old library back onto my system.",
						"timestamp": "2017-05-26 10:01:58",
						"update_id": 88479,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/e5045d506aa85d296de0918e4dd52b74cc33dec956be122a03bfdbe4be24e97f?s=24&d=retro",
							"email": "decathorpe@gmail.com",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "rust-sig"
								},
								{
									"name": "packaging-committee"
								},
								{
									"name": "libreoffice-sig"
								},
								{
									"name": "multimedia-sig"
								},
								{
									"name": "diversity-pride"
								},
								{
									"name": "pantheon-sig"
								}
							],
							"id": 388,
							"name": "decathorpe",
							"openid": "decathorpe.id.fedoraproject.org"
						},
						"user_id": 388
					},
					"comment_id": 613338
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 616155,
						"karma": 1,
						"karma_critpath": 1,
						"text": "using libdb-5.3.28-21.fc26 armhfp and aarch64 successfully upgraded with dnf-plugin-system-upgrade+local repo",
						"timestamp": "2017-06-02 02:12:18",
						"update_id": 88479,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/f10909406582318e3ebdf96e827351c846709a4f1aba17f5dc241c7efb6aa8d0?s=24&d=retro",
							"email": "pwhalen@redhat.com",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "sysadmin-releng"
								},
								{
									"name": "sysadmin-secondary"
								},
								{
									"name": "iot"
								},
								{
									"name": "arm-qa"
								},
								{
									"name": "fedora-arm"
								},
								{
									"name": "gitarm"
								},
								{
									"name": "gitfedora-arm-installer"
								}
							],
							"id": 1201,
							"name": "pwhalen",
							"openid": "pwhalen.id.fedoraproject.org"
						},
						"user_id": 1201
					},
					"comment_id": 616155
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 616280,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Upgrade (with dnf) from F25 to F26 with libdb-5.3.28-21.fc26 works fine.",
						"timestamp": "2017-06-02 10:44:12",
						"update_id": 88479,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/fed051a3f0d823ee275e455903acbd549ffc28d888a26c8f4de2ae831bb8d36e?s=24&d=retro",
							"email": "pschindl@redhat.com",
							"groups": [
								{
									"name": "packager"
								}
							],
							"id": 923,
							"name": "pschindl",
							"openid": "pschindl.id.fedoraproject.org"
						},
						"user_id": 923
					},
					"comment_id": 616280
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 616349,
						"karma": 1,
						"karma_critpath": 1,
						"text": "LGTM!  Works great!  =)",
						"timestamp": "2017-06-02 12:58:47",
						"update_id": 88479,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/307632fc7188138f052f244345e779451863879298f2e6d73023011a05b1f1f6?s=24&d=retro",
							"email": "besser82.fpo@gmail.com",
							"groups": [
								{
									"name": "proventesters"
								},
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "designteam"
								},
								{
									"name": "shogun-ca"
								},
								{
									"name": "alt-gtk-de-sig"
								}
							],
							"id": 206,
							"name": "besser82",
							"openid": "besser82.id.fedoraproject.org"
						},
						"user_id": 206
					},
					"comment_id": 616349,
					"karma": 1
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 616382,
						"karma": -1,
						"karma_critpath": -1,
						"text": "ppc64le is still broken, see https://bugzilla.redhat.com/show_bug.cgi?id=1443415#c60 for details",
						"timestamp": "2017-06-02 14:42:28",
						"update_id": 88479,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/0d6309f7bbfbf2bca3fc0fea5151b48895a2735481e4a38fce599fd5f24c546a?s=24&d=retro",
							"email": "dan@danny.cz",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "sysadmin"
								},
								{
									"name": "sysadmin-releng"
								},
								{
									"name": "sysadmin-secondary"
								},
								{
									"name": "signers"
								},
								{
									"name": "fedora-s390"
								},
								{
									"name": "libreoffice-sig"
								}
							],
							"id": 254,
							"name": "sharkcz",
							"openid": "sharkcz.id.fedoraproject.org"
						},
						"user_id": 254
					},
					"comment_id": 616382
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 616405,
						"karma": 1,
						"karma_critpath": 1,
						"timestamp": "2017-06-02 17:19:17",
						"update_id": 88479,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/c0c88fc149461069b0140f5f9adde9fd5d97bc085bcaa17ae921c03458cf3943?s=24&d=retro",
							"email": "striker@terranforge.com",
							"id": 2262,
							"name": "strikerttd",
							"openid": "strikerttd.id.fedoraproject.org"
						},
						"user_id": 2262
					},
					"comment_id": 616405
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 617210,
						"karma": 1,
						"karma_critpath": 1,
						"text": "I upgraded from F25 with libdb-5.3.28-21.fc25 and the upgrade went fine. I can also install packages using dnf and gnome-software.",
						"timestamp": "2017-06-05 10:35:39",
						"update_id": 88479,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/dcc9b804c7f4931d90ad5f9b8b2518e79df4743a418f53589057dc035bddcd0d?s=24&d=retro",
							"email": "kparal@redhat.com",
							"groups": [
								{
									"name": "qa-tools-sig"
								},
								{
									"name": "proventesters"
								},
								{
									"name": "qa"
								},
								{
									"name": "packager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "qa-admin"
								},
								{
									"name": "common-issues-triage"
								},
								{
									"name": "trust admins"
								}
							],
							"id": 411,
							"name": "kparal",
							"openid": "kparal.id.fedoraproject.org"
						},
						"user_id": 411
					},
					"comment_id": 617210
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 617310,
						"karma": 1,
						"karma_critpath": 1,
						"text": "installed without issue on preexisting f26",
						"timestamp": "2017-06-05 14:25:31",
						"update_id": 88479,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/f38a49ac09be92e45a73ab655eeba4960eb3642ea35bdfcd0671521e938137dd?s=24&d=retro",
							"email": "edoubrayrie@gmail.com",
							"id": 1903,
							"name": "edwardo",
							"openid": "edwardo.id.fedoraproject.org"
						},
						"user_id": 1903
					},
					"comment_id": 617310
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 618381,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works great!  LGTM!  =)",
						"timestamp": "2017-06-08 07:11:31",
						"update_id": 88478,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/307632fc7188138f052f244345e779451863879298f2e6d73023011a05b1f1f6?s=24&d=retro",
							"email": "besser82.fpo@gmail.com",
							"groups": [
								{
									"name": "proventesters"
								},
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "designteam"
								},
								{
									"name": "shogun-ca"
								},
								{
									"name": "alt-gtk-de-sig"
								}
							],
							"id": 206,
							"name": "besser82",
							"openid": "besser82.id.fedoraproject.org"
						},
						"user_id": 206
					},
					"comment_id": 618381,
					"karma": 1
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 618382,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works great!  LGTM!  =)",
						"timestamp": "2017-06-08 07:12:19",
						"update_id": 88477,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/307632fc7188138f052f244345e779451863879298f2e6d73023011a05b1f1f6?s=24&d=retro",
							"email": "besser82.fpo@gmail.com",
							"groups": [
								{
									"name": "proventesters"
								},
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "designteam"
								},
								{
									"name": "shogun-ca"
								},
								{
									"name": "alt-gtk-de-sig"
								}
							],
							"id": 206,
							"name": "besser82",
							"openid": "besser82.id.fedoraproject.org"
						},
						"user_id": 206
					},
					"comment_id": 618382,
					"karma": 1
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 618437,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works for me. No regressions noted compared to previous version.",
						"timestamp": "2017-06-08 08:59:11",
						"update_id": 88477,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/d2961abadbc61ac02ca743308c188aa38757b1751e713948c0e71ea034847140?s=24&d=retro",
							"email": "chr77@protonmail.com",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								}
							],
							"id": 308,
							"name": "chr77",
							"openid": "chr77.id.fedoraproject.org"
						},
						"user_id": 308
					},
					"comment_id": 618437
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 618438,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works for me. No regressions noted compared to previous version.",
						"timestamp": "2017-06-08 08:59:44",
						"update_id": 88478,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/d2961abadbc61ac02ca743308c188aa38757b1751e713948c0e71ea034847140?s=24&d=retro",
							"email": "chr77@protonmail.com",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								}
							],
							"id": 308,
							"name": "chr77",
							"openid": "chr77.id.fedoraproject.org"
						},
						"user_id": 308
					},
					"comment_id": 618438
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 618452,
						"karma": 1,
						"karma_critpath": 1,
						"text": "success with upgrade from f25 to f26.\n\nI did update  libdb-5.3.28-21.fc25 from koji before running:\nsudo dnf --enablerepo=updates-testing system-upgrade download --refresh --releasever=26\nsudo dnf system-upgrade reboot\n",
						"timestamp": "2017-06-08 09:41:10",
						"update_id": 88478,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/44ba15b2f9ad3453f0b8a9c99f822dd2bf0cbf0e5ebecfe1953b6107185c118c?s=24&d=retro",
							"email": "juloml@gmail.com",
							"groups": [
								{
									"name": "ipausers"
								}
							],
							"id": 1536,
							"name": "juml",
							"openid": "juml.id.fedoraproject.org"
						},
						"user_id": 1536
					},
					"comment_id": 618452
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 618558,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works for me",
						"timestamp": "2017-06-08 15:43:16",
						"update_id": 88477,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/478550355b43b3333002ff195ceef90449dfb005cb31d13012d132c707eb2db7?s=24&d=retro",
							"email": "johnsoncizuza@gmail.com",
							"id": 3646,
							"name": "johnsoncizuza",
							"openid": "johnsoncizuza.id.fedoraproject.org"
						},
						"user_id": 3646
					},
					"comment_id": 618558
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 618693,
						"text": "Just an FYI, got a whole bunch of these, on multiple systems:\n\nerror: db5 error(-30969) from dbenv->open: BDB0091 DB_VERSION_MISMATCH: Database environment version mismatch\nerror: cannot open Packages index using db5 -  (-30969)\nerror: cannot open Packages database in /var/lib/rpm\n\nThe dnf run did finish successfully though.",
						"timestamp": "2017-06-08 23:17:09",
						"update_id": 88478,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/1a8afd83231ef5ba905344806ba95b39f2abd77b399b0ee217ec3e6fa30a4825?s=24&d=retro",
							"email": "bojan@rexursive.com",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								}
							],
							"id": 198,
							"name": "bojan",
							"openid": "bojan.id.fedoraproject.org"
						},
						"user_id": 198
					},
					"comment_id": 618693
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 618816,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Installed fresh F25 Workstation from Live, updated libdb, fully updated using gnome-software, used dnf system-upgrade to upgrade to F26, tested dnf and gnome-software. Seems to work.",
						"timestamp": "2017-06-09 10:34:23",
						"update_id": 88477,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/dcc9b804c7f4931d90ad5f9b8b2518e79df4743a418f53589057dc035bddcd0d?s=24&d=retro",
							"email": "kparal@redhat.com",
							"groups": [
								{
									"name": "qa-tools-sig"
								},
								{
									"name": "proventesters"
								},
								{
									"name": "qa"
								},
								{
									"name": "packager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "qa-admin"
								},
								{
									"name": "common-issues-triage"
								},
								{
									"name": "trust admins"
								}
							],
							"id": 411,
							"name": "kparal",
							"openid": "kparal.id.fedoraproject.org"
						},
						"user_id": 411
					},
					"comment_id": 618816
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 618823,
						"text": "I had tried to upgrade from F25 to F26 a RPi3 following QA:Testcase_upgrade_dnf_current_server and without installing this update: the upgrade process got stuck on cleaning up some package.\n\nI did a fresh install of F25 on such device. Before performing the system upgrade I installed this package update: the system upgrade was successful.",
						"timestamp": "2017-06-09 10:54:58",
						"update_id": 88478,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/4dfa31e963873203ebe47d817c7fb5e6d082728f5a8d7e17396fd419d58fb0fe?s=24&d=retro",
							"email": "alciregi@posteo.net",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "ask-fedora"
								},
								{
									"name": "cvsl10n"
								},
								{
									"name": "respins-sig"
								},
								{
									"name": "wikiedit"
								},
								{
									"name": "l10n"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "advocates"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "fedora-join"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "neuro-sig"
								},
								{
									"name": "qa"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "common-issues-triage"
								}
							],
							"id": 3508,
							"name": "alciregi",
							"openid": "alciregi.id.fedoraproject.org"
						},
						"user_id": 3508
					},
					"comment_id": 618823
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 618864,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Installed fresh F25 Workstation from Live, updated libdb, fully updated using gnome-software, used dnf system-upgrade to upgrade to F26, tested dnf and gnome-software. Seems to work.",
						"timestamp": "2017-06-09 11:49:03",
						"update_id": 88478,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/dcc9b804c7f4931d90ad5f9b8b2518e79df4743a418f53589057dc035bddcd0d?s=24&d=retro",
							"email": "kparal@redhat.com",
							"groups": [
								{
									"name": "qa-tools-sig"
								},
								{
									"name": "proventesters"
								},
								{
									"name": "qa"
								},
								{
									"name": "packager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "qa-admin"
								},
								{
									"name": "common-issues-triage"
								},
								{
									"name": "trust admins"
								}
							],
							"id": 411,
							"name": "kparal",
							"openid": "kparal.id.fedoraproject.org"
						},
						"user_id": 411
					},
					"comment_id": 618864
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 618892,
						"text": "Hmm, I updated libdb on my production F25 together with some other packages, and there's still something fishy:\n\n      Upgrading   : java-1.8.0-openjdk-headless-1:1.8.0.131-3.b12.fc25.x86_64                                       17/44 \n    warning: /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.131-3.b12.fc25.x86_64/jre/lib/security/java.security created as /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.131-3.b12.fc25.x86_64/jre/lib/security/java.security.rpmnew\n    error: db5 error(-30969) from dbenv->open: BDB0091 DB_VERSION_MISMATCH: Database environment version mismatch\n    error: cannot open Packages index using db5 -  (-30969)\n    error: cannot open Packages database in /var/lib/rpm\n    error: db5 error(-30969) from dbenv->open: BDB0091 DB_VERSION_MISMATCH: Database environment version mismatch\n    error: cannot open Packages index using db5 -  (-30969)\n    error: cannot open Packages database in /var/lib/rpm\n    error: db5 error(-30969) from dbenv->open: BDB0091 DB_VERSION_MISMATCH: Database environment version mismatch\n    error: cannot open Packages index using db5 -  (-30969)\n    error: cannot open Packages database in /var/lib/rpm\n    error: db5 error(-30969) from dbenv->open: BDB0091 DB_VERSION_MISMATCH: Database environment version mismatch\n    error: cannot open Packages index using db5 -  (-30969)\n    error: cannot open Packages database in /var/lib/rpm\n    restored /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.131-3.b12.fc25.x86_64/jre/lib/security/java.security.rpmnew to /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.131-3.b12.fc25.x86_64/jre/lib/security/java.security\n\n\nBut the update finished fine.",
						"timestamp": "2017-06-09 13:14:10",
						"update_id": 88478,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/dcc9b804c7f4931d90ad5f9b8b2518e79df4743a418f53589057dc035bddcd0d?s=24&d=retro",
							"email": "kparal@redhat.com",
							"groups": [
								{
									"name": "qa-tools-sig"
								},
								{
									"name": "proventesters"
								},
								{
									"name": "qa"
								},
								{
									"name": "packager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "qa-admin"
								},
								{
									"name": "common-issues-triage"
								},
								{
									"name": "trust admins"
								}
							],
							"id": 411,
							"name": "kparal",
							"openid": "kparal.id.fedoraproject.org"
						},
						"user_id": 411
					},
					"comment_id": 618892
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 618893,
						"text": "DB_VERSION_MISMATCH errors are expected as libdb refuses to access its environment when there differences between the old and new environment (due to libdb upgrade) and it cannot safely rebuild it (as is the case with accessing rpmdb from scriplets)",
						"timestamp": "2017-06-09 13:21:31",
						"update_id": 88478,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/e456c9b9b2e75cd60657ae9f6d54c94a5e16a63e2747675184ad44b0a7230287?s=24&d=retro",
							"email": "pkubat@redhat.com",
							"groups": [
								{
									"name": "packager"
								}
							],
							"id": 2917,
							"name": "pkubat",
							"openid": "pkubat.id.fedoraproject.org"
						},
						"user_id": 2917
					},
					"comment_id": 618893
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 619017,
						"karma": -1,
						"karma_critpath": -1,
						"text": "Causes dnf to segfault twice during \"dnf upgrade\". Unfortunately abrt is able to open a bug report only for one of them (first backtrace is unusable). I had to run rpm --rebuilddb to fix this. Filed https://bugzilla.redhat.com/show_bug.cgi?id=1460303 .\n\nAlso, @besser82 , giving karma to your own submissions (you edited and added packages, then upvoted them) is gaming the karma system.",
						"timestamp": "2017-06-09 15:53:38",
						"update_id": 88478,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/bfa8ba84bf4284629b20a5b559a25a086e61a0cdaeeb1aa1a2f70fb077b17795?s=24&d=retro",
							"email": "dominik@greysector.net",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "scitech_sig"
								},
								{
									"name": "scitech"
								},
								{
									"name": "websites-apps-cms"
								},
								{
									"name": "multimedia-sig"
								}
							],
							"id": 237,
							"name": "rathann",
							"openid": "rathann.id.fedoraproject.org"
						},
						"user_id": 237
					},
					"comment_id": 619017
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 619018,
						"text": "Clarification: dnf segfaults each time until rpm --rebuilddb is invoked after this update.",
						"timestamp": "2017-06-09 15:54:51",
						"update_id": 88478,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/bfa8ba84bf4284629b20a5b559a25a086e61a0cdaeeb1aa1a2f70fb077b17795?s=24&d=retro",
							"email": "dominik@greysector.net",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "scitech_sig"
								},
								{
									"name": "scitech"
								},
								{
									"name": "websites-apps-cms"
								},
								{
									"name": "multimedia-sig"
								}
							],
							"id": 237,
							"name": "rathann",
							"openid": "rathann.id.fedoraproject.org"
						},
						"user_id": 237
					},
					"comment_id": 619018
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 619924,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Work for me,\nHave to rebuild the package database.",
						"timestamp": "2017-06-10 03:46:26",
						"update_id": 88477,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/2011903e34aa8e6afb771438876ffbd459194f6eb0c79df733e19091f56af4c6?s=24&d=retro",
							"email": "tenk42@gmail.com",
							"id": 3144,
							"name": "tenk",
							"openid": "tenk.id.fedoraproject.org"
						},
						"user_id": 3144
					},
					"comment_id": 619924
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 619927,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Work for me!\nHave to do rebuild the rpm database",
						"timestamp": "2017-06-10 03:50:42",
						"update_id": 88478,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/2011903e34aa8e6afb771438876ffbd459194f6eb0c79df733e19091f56af4c6?s=24&d=retro",
							"email": "tenk42@gmail.com",
							"id": 3144,
							"name": "tenk",
							"openid": "tenk.id.fedoraproject.org"
						},
						"user_id": 3144
					},
					"comment_id": 619927
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 620291,
						"karma": -1,
						"karma_critpath": -1,
						"text": "I also stumbled over the segfault issue after updating F25:\n- neither \"dnf\" nor \"rpm\" were able to use the rpm database\n- error messages as described in: https://bugzilla.redhat.com/show_bug.cgi?id=1394862#c43\n- recovery via \"rpm --rebuilddb\" worked",
						"timestamp": "2017-06-11 08:53:35",
						"update_id": 88478,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/c44464f6a9ecd1e1b1a613dcfa5e822fdd74a6d5fd85d39085878e35f4a4b54b?s=24&d=retro",
							"email": "chkr@plauener.de",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "fi-apprentice"
								}
							],
							"id": 1157,
							"name": "chkr",
							"openid": "chkr.id.fedoraproject.org"
						},
						"user_id": 1157
					},
					"comment_id": 620291
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 628789,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works great!  LGTM!  =)",
						"timestamp": "2017-06-29 03:31:56",
						"update_id": 91024,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/307632fc7188138f052f244345e779451863879298f2e6d73023011a05b1f1f6?s=24&d=retro",
							"email": "besser82.fpo@gmail.com",
							"groups": [
								{
									"name": "proventesters"
								},
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "designteam"
								},
								{
									"name": "shogun-ca"
								},
								{
									"name": "alt-gtk-de-sig"
								}
							],
							"id": 206,
							"name": "besser82",
							"openid": "besser82.id.fedoraproject.org"
						},
						"user_id": 206
					},
					"comment_id": 628789,
					"karma": 1
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 628790,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works great!  LGTM!  =)",
						"timestamp": "2017-06-29 03:32:04",
						"update_id": 91025,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/307632fc7188138f052f244345e779451863879298f2e6d73023011a05b1f1f6?s=24&d=retro",
							"email": "besser82.fpo@gmail.com",
							"groups": [
								{
									"name": "proventesters"
								},
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "designteam"
								},
								{
									"name": "shogun-ca"
								},
								{
									"name": "alt-gtk-de-sig"
								}
							],
							"id": 206,
							"name": "besser82",
							"openid": "besser82.id.fedoraproject.org"
						},
						"user_id": 206
					},
					"comment_id": 628790,
					"karma": 1
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 629500,
						"karma": 1,
						"karma_critpath": 1,
						"text": "upgraded completed on armhfp.",
						"timestamp": "2017-06-30 20:26:25",
						"update_id": 91023,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/f10909406582318e3ebdf96e827351c846709a4f1aba17f5dc241c7efb6aa8d0?s=24&d=retro",
							"email": "pwhalen@redhat.com",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "sysadmin-releng"
								},
								{
									"name": "sysadmin-secondary"
								},
								{
									"name": "iot"
								},
								{
									"name": "arm-qa"
								},
								{
									"name": "fedora-arm"
								},
								{
									"name": "gitarm"
								},
								{
									"name": "gitfedora-arm-installer"
								}
							],
							"id": 1201,
							"name": "pwhalen",
							"openid": "pwhalen.id.fedoraproject.org"
						},
						"user_id": 1201
					},
					"comment_id": 629500
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 629566,
						"karma": 1,
						"karma_critpath": 1,
						"text": "No regressions noted.",
						"timestamp": "2017-06-30 20:56:40",
						"update_id": 91024,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/e62cb974458dc33fcf2225462b8765e0aadcbbd698560c8f8dad6c3e23d5e47e?s=24&d=retro",
							"email": "dhgutteridge@hotmail.com",
							"groups": [
								{
									"name": "ipausers"
								}
							],
							"id": 194,
							"name": "dhgutteridge",
							"openid": "dhgutteridge.id.fedoraproject.org"
						},
						"user_id": 194
					},
					"comment_id": 629566
				},
				{
					"bug_id": 1394862,
					"comment": {
						"id": 632718,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works for me.",
						"timestamp": "2017-07-08 21:43:49",
						"update_id": 91025,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/0fa05851f1f2f54b981d3c0ab58e0a15cc1384567409b91e76ec2e2078d47e5e?s=24&d=retro",
							"email": "jonathanecalloway@gmail.com",
							"id": 1359,
							"name": "jonathancalloway",
							"openid": "jonathancalloway.id.fedoraproject.org"
						},
						"user_id": 1359
					},
					"comment_id": 632718,
					"karma": 1
				}
			],
			"title": "libdb: Assumes that internal condition variable layout never changes",
			"bugzilla": {
				"bug_id": "1394862",
				"creation_ts": "2016-11-14 15:35:21 +0000",
				"short_desc": "libdb: Assumes that internal condition variable layout never changes",
				"delta_ts": "2017-09-13 14:39:46 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "CommonBugs",
				"priority": "unspecified",
				"bug_severity": "unspecified",
				"blocked": [
					{
						"bug_id": "1346768",
						"error": "NotPermitted"
					},
					{
						"bug_id": "1397087",
						"creation_ts": "2016-11-21 15:11:10 +0000",
						"short_desc": "Rpm hangs after updating to glibc >= 2.25",
						"delta_ts": "2017-09-13 14:44:04 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"priority": "high",
						"bug_severity": "high",
						"depends_on": [
							"1394862"
						],
						"blocked": [
							{
								"bug_id": "1349186",
								"alias": "F26BetaBlocker",
								"creation_ts": "2016-06-22 22:07:50 +0000",
								"short_desc": "Fedora 26 Beta blocker bug tracker",
								"delta_ts": "2017-11-25 01:17:51 +0000",
								"bug_status": "CLOSED",
								"resolution": "CURRENTRELEASE",
								"bug_file_loc": "https://fedoraproject.org/wiki/QA:SOP_blocker_bug_process",
								"keywords": "Tracking",
								"priority": "unspecified",
								"bug_severity": "unspecified",
								"depends_on": [
									"1348688",
									"1376638",
									"1377401",
									"1388648",
									"1397087",
									"1414391",
									"1415360",
									"1419946",
									"1430920",
									"1435583",
									"1438046",
									"1439051",
									"1439388",
									"1440502",
									"1443206",
									"1444651",
									"1445017",
									"1445302",
									"1445776",
									"1446432",
									"1446879",
									"1447777",
									"1447886",
									"1448923",
									"1454897",
									"1457336",
									"1457626"
								],
								"long_desc": [
									{
										"isprivate": "0",
										"commentid": "9442971",
										"comment_count": "0",
										"who": {
											"text": "awilliam",
											"name": "Adam Williamson"
										},
										"bug_when": "2016-06-22 22:07:50 +0000",
										"thetext": "Fedora 26 Beta blocker tracker bug: http://fedoraproject.org/wiki/BugZappers/HouseKeeping/Trackers\n\nTo propose a bug as blocking the Fedora 26 Beta release, mark it as blocking this bug, or use the webapp: https://qa.fedoraproject.org/blockerbugs/propose_bug . It will be reviewed according to https://fedoraproject.org/wiki/QA:SOP_blocker_bug_process . If you can, please specify the release criterion that the bug violates. See https://fedoraproject.org/wiki/Fedora_Release_Criteria for details on the release criteria.\n\nIf the bug is not serious enough to block release but you believe it merits being fixed during a milestone freeze (see https://fedoraproject.org/wiki/Milestone_freezes ), you can propose it as a 'freeze exception' instead. To do this, mark it as blocking the bug F26BetaFreezeException . See https://fedoraproject.org/wiki/QA:SOP_freeze_exception_bug_process for the freeze exception process."
									},
									{
										"isprivate": "0",
										"commentid": "10579772",
										"comment_count": "1",
										"who": {
											"text": "awilliam",
											"name": "Adam Williamson"
										},
										"bug_when": "2017-07-10 16:13:29 +0000",
										"thetext": "Fedora 26 was released. Bug closed per https://fedoraproject.org/wiki/BugZappers/HouseKeeping/Trackers"
									},
									{
										"isprivate": "0",
										"commentid": "10579797",
										"comment_count": "2",
										"who": {
											"text": "awilliam",
											"name": "Adam Williamson"
										},
										"bug_when": "2017-07-10 16:19:48 +0000",
										"thetext": "Fedora 26 was released. Bug closed per https://fedoraproject.org/wiki/BugZappers/HouseKeeping/Trackers"
									}
								]
							},
							{
								"bug_id": "1443415",
								"creation_ts": "2017-04-19 08:31:04 +0000",
								"short_desc": "[TRACKING] Upgrade f25 to f26 get stuck in Cleanup",
								"delta_ts": "2018-05-29 12:12:31 +0000",
								"bug_status": "CLOSED",
								"resolution": "EOL",
								"keywords": "Triaged",
								"priority": "unspecified",
								"bug_severity": "unspecified",
								"depends_on": [
									"1397087",
									"1460003"
								],
								"blocked": [
									{
										"bug_id": "1071880",
										"alias": "PPCTracker",
										"creation_ts": "2014-03-03 11:41:52 +0000",
										"short_desc": "(PPCTracker) Fedora for PowerPC architectures (ppc64,ppc64le): Bug Tracker",
										"delta_ts": "2024-07-04 11:18:17 +0000",
										"bug_status": "ASSIGNED",
										"keywords": "Tracking",
										"priority": "medium",
										"bug_severity": "medium",
										"depends_on": [
											"238953",
											"1266508",
											"1562071",
											"1817976",
											"1909065",
											"1960848",
											"2209760",
											"2212765",
											"2240371",
											"2273668",
											"2293597",
											"2293909",
											"2294180",
											"179260",
											"468831",
											"810582",
											"834619",
											"864392",
											"968359",
											"990749",
											"999069",
											"1015497",
											"1035541",
											"1049976",
											"1058258",
											"1058289",
											"1058686",
											"1059234",
											"1059816",
											"1067470",
											"1070183",
											"1070206",
											"1070380",
											"1070892",
											"1071278",
											"1071284",
											"1071527",
											"1071845",
											"1079673",
											"1085127",
											"1085704",
											"1088339",
											"1090452",
											"1091538",
											"1093163",
											"1094513",
											"1094975",
											"1097109",
											"1097111",
											"1098151",
											"1100762",
											"1101996",
											"1104215",
											"1104279",
											"1104603",
											"1105552",
											"1108103",
											"1110892",
											"1111453",
											"1114240",
											"1122406",
											"1125883",
											"1128663",
											"1130079",
											"1132488",
											"1134566",
											"1136388",
											"1136532",
											"1136535",
											"1136544",
											"1140057",
											"1140189",
											"1143912",
											"1149159",
											"1149702",
											"1149704",
											"1151853",
											"1155291",
											"1155660",
											"1156300",
											"1158522",
											"1160429",
											"1160916",
											"1161098",
											"1161119",
											"1161152",
											"1161585",
											"1162245",
											"1162904",
											"1162914",
											"1164209",
											"1164221",
											"1165638",
											"1166474",
											"1166489",
											"1168634",
											"1172791",
											"1174607",
											"1175526",
											"1182677",
											"1185298",
											"1194704",
											"1195065",
											"1195663",
											"1196994",
											"1197007",
											"1197165",
											"1197721",
											"1197772",
											"1199041",
											"1201219",
											"1202876",
											"1204876",
											"1205359",
											"1206060",
											"1206161",
											"1208412",
											"1210003",
											"1211616",
											"1211638",
											"1212328",
											"1212472",
											"1214950",
											"1220294",
											"1220866",
											"1221689",
											"1223869",
											"1225035",
											"1225487",
											"1226316",
											"1228102",
											"1230233",
											"1232158",
											"1232650",
											"1232739",
											"1234277",
											"1234284",
											"1235709",
											"1235999",
											"1237089",
											"1238168",
											"1241214",
											"1247047",
											"1247567",
											"1247925",
											"1251120",
											"1251422",
											"1251520",
											"1251972",
											"1252074",
											"1252899",
											"1252905",
											"1252975",
											"1253763",
											"1254606",
											"1255074",
											"1255135",
											"1255682",
											"1256839",
											"1257201",
											"1257966",
											"1260297",
											"1261541",
											"1262402",
											"1262441",
											"1262444",
											"1264504",
											"1264912",
											"1265546",
											"1265674",
											"1267269",
											"1268789",
											"1269811",
											"1271230",
											"1273103",
											"1274974",
											"1275229",
											"1275619",
											"1276061",
											"1276959",
											"1277142",
											"1278066",
											"1278135",
											"1278428",
											"1281446",
											"1281764",
											"1284527",
											"1285786",
											"1286149",
											"1286249",
											"1286625",
											"1287015",
											"1287105",
											"1288561",
											"1289106",
											"1289940",
											"1290958",
											"1291565",
											"1292461",
											"1292462",
											"1292467",
											"1292969",
											"1294016",
											"1295350",
											"1296842",
											"1297387",
											"1297855",
											"1297894",
											"1299151",
											"1299193",
											"1299226",
											"1299599",
											"1300900",
											"1302224",
											"1303219",
											"1303223",
											"1304402",
											"1305512",
											"1305725",
											"1306214",
											"1308252",
											"1308424",
											"1309225",
											"1310495",
											"1311685",
											"1312018",
											"1312339",
											"1315225",
											"1315903",
											"1316840",
											"1319063",
											"1321113",
											"1322696",
											"1323193",
											"1324085",
											"1325114",
											"1325126",
											"1325858",
											"1326250",
											"1326366",
											"1328455",
											"1330098",
											"1330102",
											"1330108",
											"1330161",
											"1330174",
											"1331726",
											"1332146",
											"1332150",
											"1332449",
											"1332978",
											"1333344",
											"1333695",
											"1334125",
											"1334212",
											"1334315",
											"1334320",
											"1335162",
											"1335823",
											"1336466",
											"1340736",
											"1340829",
											"1341090",
											"1342146",
											"1342561",
											"1344636",
											"1345826",
											"1349945",
											"1350486",
											"1351737",
											"1351971",
											"1356152",
											"1356189",
											"1359680",
											"1361037",
											"1365739",
											"1365851",
											"1365862",
											"1365940",
											"1366328",
											"1368495",
											"1368932",
											"1369162",
											"1369169",
											"1371894",
											"1373576",
											"1374380",
											"1374382",
											"1374749",
											"1375942",
											"1377201",
											"1377395",
											"1378359",
											"1379123",
											"1380643",
											"1381206",
											"1383912",
											"1386180",
											"1387107",
											"1387601",
											"1388453",
											"1388561",
											"1389957",
											"1391932",
											"1392264",
											"1392340",
											"1392465",
											"1392478",
											"1392479",
											"1392848",
											"1392854",
											"1392887",
											"1392922",
											"1393834",
											"1396814",
											"1398322",
											"1398575",
											"1400476",
											"1401220",
											"1401707",
											"1402256",
											"1403216",
											"1403760",
											"1404305",
											"1409636",
											"1410774",
											"1410784",
											"1412274",
											"1412926",
											"1414489",
											"1417244",
											"1419355",
											"1420350",
											"1420753",
											"1426796",
											"1428310",
											"1429575",
											"1430827",
											"1430829",
											"1430830",
											"1433859",
											"1434007",
											"1434276",
											"1435154",
											"1435585",
											"1435953",
											"1437793",
											"1439051",
											"1439141",
											"1440047",
											"1440843",
											"1443415",
											"1447276",
											"1447777",
											"1447924",
											"1449582",
											"1450755",
											"1451115",
											"1451143",
											"1452813",
											"1455299",
											"1460003",
											"1461708",
											"1461775",
											"1463749",
											"1464115",
											"1465159",
											"1465171",
											"1465174",
											"1465176",
											"1465657",
											"1467647",
											"1470692",
											"1471785",
											"1472375",
											"1474744",
											"1475636",
											"1476380",
											"1481163",
											"1481611",
											"1482382",
											"1482447",
											"1484149",
											"1484151",
											"1484320",
											"1484474",
											"1484579",
											"1485690",
											"1486737",
											"1487787",
											"1491093",
											"1491751",
											"1494542",
											"1497720",
											"1498561",
											"1498922",
											"1501936",
											"1502009",
											"1512229",
											"1515934",
											"1516213",
											"1518707",
											"1524376",
											"1527692",
											"1528378",
											"1538300",
											"1538817",
											"1540995",
											"1541319",
											"1541613",
											"1544349",
											"1544833",
											"1546693",
											"1546743",
											"1547049",
											"1547467",
											"1548001",
											"1548425",
											"1548671",
											"1552648",
											"1552650",
											"1552653",
											"1552724",
											"1553626",
											"1553794",
											"1554345",
											"1556989",
											"1561011",
											"1562059",
											"1562061",
											"1562073",
											"1563466",
											"1565693",
											"1566066",
											"1566151",
											"1566225",
											"1569045",
											"1570256",
											"1571205",
											"1571860",
											"1572540",
											"1573538",
											"1574604",
											"1577587",
											"1578429",
											"1579708",
											"1585991",
											"1588130",
											"1588734",
											"1588774",
											"1591701",
											"1601259",
											"1605125",
											"1609208",
											"1609513",
											"1612490",
											"1612601",
											"1614948",
											"1619601",
											"1619690",
											"1624915",
											"1626057",
											"1628394",
											"1628540",
											"1631093",
											"1631759",
											"1633565",
											"1643729",
											"1647947",
											"1659239",
											"1660807",
											"1666298",
											"1668751",
											"1669055",
											"1669235",
											"1669256",
											"1675014",
											"1675573",
											"1676411",
											"1676475",
											"1679074",
											"1680040",
											"1687369",
											"1687882",
											"1689037",
											"1689819",
											"1691016",
											"1691487",
											"1691832",
											"1693676",
											"1713090",
											"1714489",
											"1719378",
											"1722181",
											"1723425",
											"1724800",
											"1725924",
											"1726444",
											"1730843",
											"1732612",
											"1733118",
											"1733673",
											"1733926",
											"1736762",
											"1737581",
											"1737587",
											"1738752",
											"1741266",
											"1745841",
											"1746405",
											"1746852",
											"1749729",
											"1756650",
											"1756838",
											"1757249",
											"1757250",
											"1757548",
											"1758225",
											"1762709",
											"1764666",
											"1766519",
											"1768551",
											"1769324",
											"1769445",
											"1769600",
											"1771031",
											"1772935",
											"1774507",
											"1777345",
											"1779589",
											"1782919",
											"1784961",
											"1789199",
											"1789854",
											"1790436",
											"1795575",
											"1798908",
											"1803351",
											"1816527",
											"1817004",
											"1817773",
											"1817959",
											"1820619",
											"1824208",
											"1825287",
											"1827397",
											"1838565",
											"1853217",
											"1856283",
											"1860811",
											"1860932",
											"1863685",
											"1864181",
											"1869980",
											"1870213",
											"1886303",
											"1894654",
											"1897661",
											"1899841",
											"1913493",
											"1915266",
											"1921479",
											"1921485",
											"1923654",
											"1933742",
											"1933794",
											"1934063",
											"1934065",
											"1937684",
											"1939775",
											"1941652",
											"1943729",
											"1948576",
											"1959353",
											"1965610",
											"1966347",
											"1987280",
											"1987972",
											"1989412",
											"1994599",
											"1996330",
											"1999118",
											"2022035",
											"2027889",
											"2030308",
											"2040887",
											"2041573",
											"2043517",
											"2044054",
											"2045152",
											"2045160",
											"2045186",
											"2045189",
											"2045310",
											"2045367",
											"2045456",
											"2045714",
											"2045780",
											"2045797",
											"2046802",
											"2046865",
											"2046907",
											"2048910",
											"2049371",
											"2056459",
											"2061022",
											"2064025",
											"2081451",
											"2095750",
											"2096956",
											"2100546",
											"2102907",
											"2109095",
											"2109120",
											"2112825",
											"2113609",
											"2115752",
											"2124845",
											"2131287",
											"2140618",
											"2142739",
											"2143393",
											"2154939",
											"2160760",
											"2162999",
											"2164029",
											"2173015",
											"2177410",
											"2177691",
											"2209435",
											"2212748",
											"2218314",
											"2221314",
											"2264712",
											"2275090"
										],
										"blocked": [
											{
												"bug_id": "2171964",
												"creation_ts": "2023-02-21 02:32:53 +0000",
												"short_desc": "ICE / segfault in process_function_and_variable_attributes() when building tokodon on ppc64le",
												"delta_ts": "2023-08-16 07:10:03 +0000",
												"bug_status": "NEW",
												"priority": "unspecified",
												"bug_severity": "unspecified",
												"depends_on": [
													"1071880"
												],
												"external_bugs": {
													"text": "108887",
													"name": "GNU Compiler Collection"
												},
												"long_desc": [
													{
														"isprivate": "0",
														"commentid": "17062382",
														"comment_count": "0",
														"who": {
															"text": "justin.zobel",
															"name": "Justin Zobel"
														},
														"bug_when": "2023-02-21 02:32:53 +0000",
														"thetext": "Build has failed only on ppc64le 4 times now, one build example https://koji.fedoraproject.org/koji/taskinfo?taskID=97784827\n\nUpstream has stated they will not support ppc64le.\n\nAdding ExcludeArch until this can be fixed."
													},
													{
														"isprivate": "0",
														"commentid": "17062632",
														"comment_count": "1",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2023-02-21 07:07:45 +0000",
														"thetext": "This is a gcc internal error, probably gcc13 related, I will try to get the details and switch the bug to gcc."
													},
													{
														"isprivate": "0",
														"commentid": "17062697",
														"comment_count": "2",
														"who": {
															"text": "justin.zobel",
															"name": "Justin Zobel"
														},
														"bug_when": "2023-02-21 07:29:45 +0000",
														"thetext": "Thanks Dan much appreciated!"
													},
													{
														"isprivate": "0",
														"commentid": "17062752",
														"comment_count": "3",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2023-02-21 08:04:58 +0000",
														"thetext": "(gdb) run\nStarting program: /usr/bin/g++ -DHAVE_KIO -DKCOREADDONS_LIB -DQT_CONCURRENT_LIB -DQT_CORE_LIB -DQT_DBUS_LIB -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_NO_DEBUG -DQT_NO_FOREACH -DQT_NO_KEYWORDS -DQT_QMLMODELS_LIB -DQT_QML_LIB -DQT_QUICKCONTROLS2_LIB -DQT_QUICK_LIB -DQT_WEBSOCKETS_LIB -DQT_WIDGETS_LIB -DQT_XML_LIB -D_GNU_SOURCE -D_LARGEFILE64_SOURCE -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src -I/home/sharkcz/tokodon/tokodon-23.02.0/src -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src/tokodon_static_autogen/include -isystem /usr/include/qt5 -isystem /usr/include/qt5/QtQuick -isystem /usr/include/qt5/QtQmlModels -isystem /usr/include/qt5/QtQml -isystem /usr/include/qt5/QtNetwork -isystem /usr/include/qt5/QtCore -isystem /usr/lib64/qt5/mkspecs/linux-g++ -isystem /usr/include/qt5/QtGui -isystem /usr/include/qt5/QtWebSockets -isystem /usr/include/qt5/QtQuickControls2 -isystem /usr/include/KF5/KI18n -isystem /usr/include/KF5 -isystem /usr/include/KF5/Kirigami2 -isystem /usr/include/KF5/KNotifications -isystem /usr/include/qt5/QtWidgets -isystem /usr/include/qt5/QtDBus -isystem /usr/include/KF5/KConfig -isystem /usr/include/KF5/KConfigCore -isystem /usr/include/KF5/KConfigGui -isystem /usr/include/qt5/QtXml -isystem /usr/include/KF5/KCoreAddons -isystem /usr/include/KF5/KIOWidgets -isystem /usr/include/KF5/KIOGui -isystem /usr/include/KF5/KIOCore -isystem /usr/include/KF5/KIO -isystem /usr/include/KF5/KService -isystem /usr/include/qt5/QtConcurrent -isystem /usr/include/KF5/KWindowSystem -isystem /usr/include/KF5/KJobWidgets -isystem /usr/include/KF5/Solid -isystem /usr/include/KF5/KCompletion -isystem /usr/include/KF5/KWidgetsAddons -isystem /usr/include/KF5/KConfigWidgets -isystem /usr/include/KF5/KCodecs -isystem /usr/include/KF5/KAuthWidgets -isystem /usr/include/KF5/KAuthCore -isystem /usr/include/KF5/KAuth -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-U_FORTIFY_SOURCE,-D_FORTIFY_SOURCE=3 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -fstack-protector-strong -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mcpu=power8 -mtune=power8 -fasynchronous-unwind-tables -fstack-clash-protection -fno-operator-names -fno-exceptions -Wall -Wextra -Wcast-align -Wchar-subscripts -Wformat-security -Wno-long-long -Wpointer-arith -Wundef -Wnon-virtual-dtor -Woverloaded-virtual -Werror=return-type -Werror=init-self -Wvla -Wdate-time -Wsuggest-override -Wlogical-op -DNDEBUG -std=gnu++17 -fvisibility=hidden -fvisibility-inlines-hidden -fPIC -MD -MT src/CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -MF CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o.d -o CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -c /home/sharkcz/tokodon/tokodon-23.02.0/src/linkpaginatedtimelinemodel.cpp\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n[Attaching after Thread 0x7ffff7ff34e0 (LWP 18708) vfork to child process 18710]\n[New inferior 2 (process 18710)]\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n[Detaching vfork parent process 18708 after child exec]\n[Inferior 1 (process 18708) detached]\nprocess 18710 is executing new program: /usr/libexec/gcc/ppc64le-redhat-linux/13/cc1plus\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n\nThread 2.1 \"cc1plus\" received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7ffff7ff53c0 (LWP 18710)]\nprocess_function_and_variable_attributes (first_var=0x7fffdc638a00, first=0x7fffdc539900) at ../../gcc/cgraphunit.cc:861\nDownloading 0.02 MB source file /usr/src/debug/gcc-13.0.1-0.4.fc39.ppc64le/obj-ppc64le-redhat-linux/gcc/../../gcc/cgraphunit.cc\n861\t      tree decl = node->decl;\n(gdb) cont\nContinuing.\n\nThread 2.1 \"cc1plus\" hit Breakpoint 1, 0x0000000010747e9c in internal_error (gmsgid=0x11927bf8 \"%s\") at ../../gcc/diagnostic.cc:2138\n2138\t{\n(gdb) bt\n#0  0x0000000010747e9c in internal_error (gmsgid=0x11927bf8 \"%s\") at ../../gcc/diagnostic.cc:2138\n#1  0x00000000103f7a5c in crash_signal (signo=11) at ../../gcc/toplev.cc:317\n#2  <signal handler called>\n#3  process_function_and_variable_attributes (first_var=0x7fffdc638a00, first=0x7fffdc539900) at ../../gcc/cgraphunit.cc:861\n#4  analyze_functions (first_time=first_time@entry=true) at ../../gcc/cgraphunit.cc:1181\n#5  0x00000000112bf628 in symbol_table::finalize_compilation_unit (this=0x7fffe8080000) at ../../gcc/cgraphunit.cc:2545\n#6  0x000000001125c410 in compile_file () at ../../gcc/toplev.cc:474\n#7  0x00000000111dd510 in do_compile (no_backend=<optimized out>) at ../../gcc/toplev.cc:2128\n#8  toplev::main (this=this@entry=0x7fffffffca00, argc=<optimized out>, argv=<optimized out>) at ../../gcc/toplev.cc:2282\n#9  0x00000000111dc5d0 in main (argc=<optimized out>, argv=<optimized out>) at ../../gcc/main.cc:39"
													},
													{
														"isprivate": "0",
														"commentid": "17062753",
														"comment_count": "4",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2023-02-21 08:05:48 +0000",
														"thetext": "Created attachment 1945415\npreprocessed sources"
													},
													{
														"isprivate": "0",
														"commentid": "17062834",
														"comment_count": "5",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2023-02-21 08:22:23 +0000",
														"thetext": "reduced g++ command line with only defines or include paths still reproducing the issue is\n\n/usr/bin/g++ -DHAVE_KIO -DKCOREADDONS_LIB -DQT_CONCURRENT_LIB -DQT_CORE_LIB -DQT_DBUS_LIB -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_NO_DEBUG -DQT_NO_FOREACH -DQT_NO_KEYWORDS -DQT_QMLMODELS_LIB -DQT_QML_LIB -DQT_QUICKCONTROLS2_LIB -DQT_QUICK_LIB -DQT_WEBSOCKETS_LIB -DQT_WIDGETS_LIB -DQT_XML_LIB -D_GNU_SOURCE -D_LARGEFILE64_SOURCE -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src -I/home/sharkcz/tokodon/tokodon-23.02.0/src -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src/tokodon_static_autogen/include -isystem /usr/include/qt5 -isystem /usr/include/qt5/QtQuick -isystem /usr/include/qt5/QtQmlModels -isystem /usr/include/qt5/QtQml -isystem /usr/include/qt5/QtNetwork -isystem /usr/include/qt5/QtCore -isystem /usr/lib64/qt5/mkspecs/linux-g++ -isystem /usr/include/qt5/QtGui -isystem /usr/include/qt5/QtWebSockets -isystem /usr/include/qt5/QtQuickControls2 -isystem /usr/include/KF5/KI18n -isystem /usr/include/KF5 -isystem /usr/include/KF5/Kirigami2 -isystem /usr/include/KF5/KNotifications -isystem /usr/include/qt5/QtWidgets -isystem /usr/include/qt5/QtDBus -isystem /usr/include/KF5/KConfig -isystem /usr/include/KF5/KConfigCore -isystem /usr/include/KF5/KConfigGui -isystem /usr/include/qt5/QtXml -isystem /usr/include/KF5/KCoreAddons -isystem /usr/include/KF5/KIOWidgets -isystem /usr/include/KF5/KIOGui -isystem /usr/include/KF5/KIOCore -isystem /usr/include/KF5/KIO -isystem /usr/include/KF5/KService -isystem /usr/include/qt5/QtConcurrent -isystem /usr/include/KF5/KWindowSystem -isystem /usr/include/KF5/KJobWidgets -isystem /usr/include/KF5/Solid -isystem /usr/include/KF5/KCompletion -isystem /usr/include/KF5/KWidgetsAddons -isystem /usr/include/KF5/KConfigWidgets -isystem /usr/include/KF5/KCodecs -isystem /usr/include/KF5/KAuthWidgets -isystem /usr/include/KF5/KAuthCore -isystem /usr/include/KF5/KAuth -O2 -pipe -m64 -mcpu=power8 -mtune=power8 -fPIC -o CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -c /home/sharkcz/tokodon/tokodon-23.02.0/src/linkpaginatedtimelinemodel.cpp"
													},
													{
														"isprivate": "0",
														"commentid": "17065288",
														"comment_count": "6",
														"who": {
															"text": "jakub",
															"name": "Jakub Jelinek"
														},
														"bug_when": "2023-02-21 21:14:20 +0000",
														"thetext": "cvise reduced to -std=gnu++17 -O2 -mcpu=power8:\n\ntemplate <int __v> struct integral_constant {\n  static constexpr int value = __v;\n};\nusing false_type = integral_constant<false>;\ntemplate <bool, bool, typename...> struct __result_of_impl;\ntemplate <typename _Functor, typename... _ArgTypes>\nstruct __result_of_impl<false, false, _Functor, _ArgTypes...> {\n  typedef decltype(0) type;\n};\ntemplate <typename... _ArgTypes>\nstruct __invoke_result\n    : __result_of_impl<false_type::value, false_type::value, _ArgTypes...> {};\ntemplate <typename, typename _Fn, typename... _Args>\nvoid __invoke_impl(_Fn __f, _Args... __args) {\n  __f(__args...);\n}\ntemplate <typename, typename _Callable, typename... _Args>\nvoid __invoke_r(_Callable __fn, _Args... __args) {\n  using __result = __invoke_result<_Args...>;\n  using __type = typename __result::type;\n  __invoke_impl<__type>(__fn, __args...);\n}\nstruct QString {\n  QString(const char *);\n};\ntemplate <typename> class function;\ntemplate <typename _Functor> struct _Base_manager {\n  static _Functor _M_get_pointer(int) { __builtin_abort (); }\n};\ntemplate <typename, typename> class _Function_handler;\ntemplate <typename _Res, typename _Functor, typename... _ArgTypes>\nstruct _Function_handler<_Res(_ArgTypes...), _Functor> {\n  using _Base = _Base_manager<_Functor>;\n  static _Res _M_invoke(const int &__functor, _ArgTypes &&...__args) {\n    auto __trans_tmp_1 = _Base::_M_get_pointer(__functor);\n    __invoke_r<_Res>(__trans_tmp_1, __args...);\n  }\n};\ntemplate <typename _Res, typename... _ArgTypes>\nstruct function<_Res(_ArgTypes...)> {\n  template <typename _Functor>\n  using _Handler = _Function_handler<_Res(_ArgTypes...), _Functor>;\n  template <typename _Functor> function(_Functor) {\n    using _My_handler = _Handler<_Functor>;\n    _M_invoker = _My_handler::_M_invoke;\n  }\n  using _Invoker_type = _Res (*)(const int &, _ArgTypes &&...);\n  _Invoker_type _M_invoker;\n};\nstruct QRegularExpression {\n  QRegularExpression(QString);\n};\nstruct AbstractAccount {\n  void get(function<void(AbstractAccount *)>,\n           function<void(AbstractAccount *)>);\n};\nstruct AbstractTimelineModel {\n  AbstractAccount m_account;\n};\nstruct LinkPaginationTimelineModel : AbstractTimelineModel {\n  void fillTimeline();\n};\nvoid LinkPaginationTimelineModel::fillTimeline() {\n  [] {};\n  m_account.get([](AbstractAccount *) { static QRegularExpression re(\"\"); },\n                [](AbstractAccount *) {});\n}\n\nBut, strangely can't reproduce with a cross-compiler from x86_64 to powerpc64le."
													},
													{
														"isprivate": "0",
														"commentid": "17540990",
														"comment_count": "7",
														"who": {
															"text": "releng",
															"name": "Fedora Release Engineering"
														},
														"bug_when": "2023-08-16 07:10:03 +0000",
														"thetext": "This bug appears to have been reported against 'rawhide' during the Fedora Linux 39 development cycle.\nChanging version to 39."
													}
												]
											},
											{
												"bug_id": "1929836",
												"creation_ts": "2021-02-17 18:32:37 +0000",
												"short_desc": "ppc64le: severe ptrace, tracing, and audit regression",
												"delta_ts": "2022-09-05 08:10:08 +0000",
												"bug_status": "CLOSED",
												"resolution": "CURRENTRELEASE",
												"bug_file_loc": "https://git.kernel.org/torvalds/c/d72500f992849d31ebae8f821a023660ddd0dcc2",
												"keywords": "BetaBlocker",
												"priority": "urgent",
												"bug_severity": "urgent",
												"depends_on": [
													"1071880"
												],
												"blocked": [
													{
														"bug_id": "1930252",
														"error": "NotPermitted"
													}
												],
												"long_desc": [
													{
														"isprivate": "0",
														"commentid": "14794276",
														"comment_count": "0",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-02-17 18:32:37 +0000",
														"thetext": "Hello, strace upstream is speaking. :)\n\nThere seems to be a severe ppc64le kernel regression detected by strace %check (625 of 972 tests failed).  This ruins strace and blocks any strace update.\n\nFor me it looks as if the kernel function syscall_get_error started to return 0 instead of the error code.\n\nThe logs are in the latest strace build task that failed:\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=62171493\n\nThe kernel used for build there was\nLinux buildvm-ppc64le-14.iad2.fedoraproject.org 5.10.15-200.fc33.ppc64le #1 SMP Wed Feb 10 17:31:04 UTC 2021 ppc64le ppc64le ppc64le GNU/Linux\n\nFor comparison, the same version of strace passes all tests on all other rawhide architectures, as well as on Debian ppc64le (kernel 5.10.13-1).\n\nThe latest successfull strace build to rawhide was about 2 months ago:\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1658216\n\nThe kernel used for build there was\nLinux buildvm-ppc64le-38.iad2.fedoraproject.org 5.9.11-200.fc33.ppc64le #1 SMP Tue Nov 24 18:02:53 UTC 2020 ppc64le ppc64le ppc64le GNU/Linux"
													},
													{
														"isprivate": "0",
														"commentid": "14797189",
														"comment_count": "1",
														"who": {
															"text": "esyr",
															"name": "Eugene Syromiatnikov"
														},
														"bug_when": "2021-02-18 13:45:03 +0000",
														"thetext": "Fedora's 5.10.7-200.fc33.ppc64le (on buildvm-ppc64le-19.iad2.fedoraproject.org) was broken as well, for the record."
													},
													{
														"isprivate": "0",
														"commentid": "14868304",
														"comment_count": "2",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-03-14 00:26:35 +0000",
														"thetext": "I'd like to reiterate: this kernel bug breaks strace badly, making it almost unusable."
													},
													{
														"isprivate": "0",
														"commentid": "14942947",
														"comment_count": "3",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-04-07 16:25:50 +0000",
														"thetext": "This is the reason why the latest strace release didn't get into Fedora, see\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1711422\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1711415\n\nUntil this bug is fixed, no strace updates in Fedora are possible."
													},
													{
														"isprivate": "0",
														"commentid": "15061049",
														"comment_count": "4",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-14 10:20:36 +0000",
														"thetext": "Using the latest strace that can decode the structure returned by PTRACE_GETREGSET,\none can see that's wrong in the data returned by the kernel.\n\nLinux buildvm-ppc64le-22.iad2.fedoraproject.org 5.11.10-200.fc33.ppc64le\non exiting chdir(\"\") syscall did the following:\n\nptrace(PTRACE_GETREGSET, 702867, NT_PRSTATUS, {iov_base={gpr=[0xc, 0x7fffd8c3f250, 0x7fffa60b7000, 0xfffffffffffffffe, 0x7fffd8c3f158, 0, 0x8, 0x20, 0xfffffffe7fffffff, 0, 0, 0, 0, 0x7fffa615a390, 0, 0, 0, 0x7fffd8c3fa58, 0x7fffd8c3f308, 0x7fffd8c3f304, 0x1228f4f68, 0x1228f4fb0, 0xab98c, 0xab991, 0x7fffa61533a0, 0x1228f5180, 0x1228f51b8, 0x122910010, 0, 0xab98c, 0x7fffa5c6fff0, 0x100000], nip=0x7fffa5fb4ad4, msr=0x800000000000d033, orig_gpr3=0x1228f52e8, ctr=0, link=0, xer=0, ccr=0x44000278, softe=0x1, trap=0x3000, dar=0x7fffa5fb4aa8, dsisr=0x40000000, result=0xfffffffffffffffe, ...}, iov_len=384}) = 0\n\nAs you can see, unlike any normal ppc64le kernel, here ccr does not have 0x10000000 bit set, and gpr[3] equals to 0xfffffffffffffffe (== -2L) instead of expected 0x2 (== ENOENT).\nSo yes, this kernel has an obviously broken ptrace ABI.\n\nYou can find this and much more in the scratch build log at https://koji.fedoraproject.org/koji/taskinfo?taskID=67867999"
													},
													{
														"isprivate": "0",
														"commentid": "15061494",
														"comment_count": "5",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-05-14 13:38:41 +0000",
														"thetext": "for the record, from my F-32 system (bare-metal Power9, not a VM) with kernel-5.11.19-100.fc32.ppc64le, strace built from master branch\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  905\n# SKIP:  97\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0"
													},
													{
														"isprivate": "0",
														"commentid": "15062263",
														"comment_count": "6",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-05-14 18:02:11 +0000",
														"thetext": "and I get these from a rawhide VM with kernel-5.13.0-0.rc1.20210512git88b06399c9c7.15.fc35.ppc64le\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  232\n# SKIP:  102\n# XFAIL: 0\n# FAIL:  668\n# XPASS: 0\n# ERROR: 0\n\n\nbut in F-32 VM with kernel kernel-5.11.19-100.fc32.ppc64le everything looks good\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  905\n# SKIP:  97\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0\n============================================================================\nand I get the same good result in the F-32 VM with kernel-5.12.3-300.fc34.ppc64le\n\nF-32 VM with kernel-5.13.0-0.rc1.20210512git88b06399c9c7.15.fc35.ppc64le then gives\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  901\n# SKIP:  101\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0\n============================================================================\n\n\nIt makes me think that the failures are not related to the kernel version, but to something else in the rawhide buildroot, perhaps glibc?"
													},
													{
														"isprivate": "0",
														"commentid": "15062268",
														"comment_count": "7",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-05-14 18:05:25 +0000",
														"thetext": "but kernel-headers-5.11.19-100.fc32.ppc64le was always used for the F-32 tests (if this should make the difference, will check ...)"
													},
													{
														"isprivate": "0",
														"commentid": "15062989",
														"comment_count": "8",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-15 01:03:06 +0000",
														"thetext": "(In reply to Dan Hork from comment #6)\n> It makes me think that the failures are not related to the kernel version,\n> but to something else in the rawhide buildroot, perhaps glibc?\n\nIf it's not the kernel but something else, then this something else is also capable of meddling both with struct ptrace_syscall_info returned by ptrace(PTRACE_GET_SYSCALL_INFO, pid, size, info) as described in the first comment, and with struct pt_regs returned by syscall(__NR_ptrace, PTRACE_GETREGSET, pid, NT_PRSTATUS, iov) in a very specific way described in #c4; in other words, this something is changing both ccr and gpr[3] in the kernel for all ptraced processes."
													},
													{
														"isprivate": "0",
														"commentid": "15074749",
														"comment_count": "9",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-05-18 14:05:24 +0000",
														"thetext": "after updating to glibc-2.33.9000-6.fc35 in my F-32 VM, where the tests were passing, I get now the failures\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  232\n# SKIP:  102\n# XFAIL: 0\n# FAIL:  668\n# XPASS: 0\n# ERROR: 0\n============================================================================"
													},
													{
														"isprivate": "0",
														"commentid": "15076721",
														"comment_count": "10",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-05-18 15:15:01 +0000",
														"thetext": "let's switch to glibc for their feedback ..."
													},
													{
														"isprivate": "0",
														"commentid": "15079009",
														"comment_count": "11",
														"who": {
															"text": "fweimer",
															"name": "Florian Weimer"
														},
														"bug_when": "2021-05-18 20:14:57 +0000",
														"thetext": "Is it possible to reproduce this issue with an already-built strace binary?\n\nWe added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to <sys/ptrace.h>, maybe that causes different execution paths in strace to be taken?"
													},
													{
														"isprivate": "0",
														"commentid": "15079018",
														"comment_count": "12",
														"who": {
															"text": "codonell",
															"name": "Carlos O'Donell"
														},
														"bug_when": "2021-05-18 20:19:39 +0000",
														"thetext": "(In reply to Florian Weimer from comment #11)\n> Is it possible to reproduce this issue with an already-built strace binary?\n> \n> We added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to\n> <sys/ptrace.h>, maybe that causes different execution paths in strace to be\n> taken?\n\nWe also have the 'sc' vs. 'svc' instruction selection in the same timeframe for power?"
													},
													{
														"isprivate": "0",
														"commentid": "15079022",
														"comment_count": "13",
														"who": {
															"text": "codonell",
															"name": "Carlos O'Donell"
														},
														"bug_when": "2021-05-18 20:20:48 +0000",
														"thetext": "(In reply to Carlos O'Donell from comment #12)\n> (In reply to Florian Weimer from comment #11)\n> > Is it possible to reproduce this issue with an already-built strace binary?\n> > \n> > We added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to\n> > <sys/ptrace.h>, maybe that causes different execution paths in strace to be\n> > taken?\n> \n> We also have the 'sc' vs. 'svc' instruction selection in the same timeframe\n> for power?\n\nSorry, 'scv'."
													},
													{
														"isprivate": "0",
														"commentid": "15079274",
														"comment_count": "14",
														"who": {
															"text": "codonell",
															"name": "Carlos O'Donell"
														},
														"bug_when": "2021-05-18 21:16:04 +0000",
														"thetext": "A recent scratch build failed on a POWER9 box, which would be the hardware under which glibc would switch to 'scv' for syscalls.\n\nJust two quick snippets:\n\n--- exp 2021-05-18 20:26:11.715277248 +0000\n+++ log 2021-05-18 20:26:11.715277248 +0000\n-chdir(0x7fffb053ffe0) = -1 EFAULT (Bad address)\n-chdir(0x7fffb053ffe1) = -1 EFAULT (Bad address)\n+chdir(0x7fffb053ffe0) = 18446744073709551602\n+chdir(0x7fffb053ffe1) = 18446744073709551602\nFAIL printpath-umovestr-legacy.test (exit status: 1)\nFAIL: printstrn-umoven-legacy\n\n--- exp 2021-05-18 20:26:44.524009554 +0000\n+++ log 2021-05-18 20:26:44.524009554 +0000\n@@ -1,2 +1,2 @@\n-writev(-1, [{iov_base=\"\", iov_len=0}, {iov_base=\"f\", iov_len=1}, {iov_base=\"ef\", iov_len=2}, {iov_base=\"def\", iov_len=3}, {iov_base=\"cdef\", iov_len=4}, {iov_base=\"bcdef\", iov_len=5}, {iov_base=\"abcdef\", iov_len=6}, {iov_base=\"zabcdef\", iov_len=7}, {iov_base=\"yzabcdef\", iov_len=8}, {iov_base=\"xyzabcdef\", iov_len=9}, {iov_base=\"wxyzabcdef\", iov_len=10}, {iov_base=\"vwxyzabcdef\", iov_len=11}, {iov_base=\"uvwxyzabcdef\", iov_len=12}, {iov_base=\"tuvwxyzabcdef\", iov_len=13}, {iov_base=\"stuvwxyzabcdef\", iov_len=14}, {iov_base=\"rstuvwxyzabcdef\", iov_len=15}, {iov_base=\"qrstuvwxyzabcdef\", iov_len=16}, {iov_base=\"pqrstuvwxyzabcdef\", iov_len=17}, {iov_base=\"opqrstuvwxyzabcdef\", iov_len=18}, {iov_base=\"nopqrstuvwxyzabcdef\", iov_len=19}, {iov_base=\"mnopqrstuvwxyzabcdef\", iov_len=20}, {iov_base=\"lmnopqrstuvwxyzabcdef\", iov_len=21}, {iov_base=\"klmnopqrstuvwxyzabcdef\", iov_len=22}, {iov_base=\"jklmnopqrstuvwxyzabcdef\", iov_len=23}, {iov_base=\"ijklmnopqrstuvwxyzabcdef\", iov_len=24}, {iov_base=\"hijklmnopqrstuvwxyzabcdef\", iov_len=25}, {iov_base=\"ghijklmnopqrstuvwxyzabcdef\", iov_len=26}, {iov_base=\"fghijklmnopqrstuvwxyzabcdef\", iov_len=27}, {iov_base=\"efghijklmnopqrstuvwxyzabcdef\", iov_len=28}, {iov_base=\"defghijklmnopqrstuvwxyzabcdef\", iov_len=29}, {iov_base=\"cdefghijklmnopqrstuvwxyzabcdef\", iov_len=30}, {iov_base=\"bcdefghijklmnopqrstuvwxyzabcdef\", iov_len=31}], 32) = -1 EBADF (Bad file descriptor)\n+writev(-1, [{iov_base=\"\", iov_len=0}, {iov_base=\"f\", iov_len=1}, {iov_base=\"ef\", iov_len=2}, {iov_base=\"def\", iov_len=3}, {iov_base=\"cdef\", iov_len=4}, {iov_base=\"bcdef\", iov_len=5}, {iov_base=\"abcdef\", iov_len=6}, {iov_base=\"zabcdef\", iov_len=7}, {iov_base=\"yzabcdef\", iov_len=8}, {iov_base=\"xyzabcdef\", iov_len=9}, {iov_base=\"wxyzabcdef\", iov_len=10}, {iov_base=\"vwxyzabcdef\", iov_len=11}, {iov_base=\"uvwxyzabcdef\", iov_len=12}, {iov_base=\"tuvwxyzabcdef\", iov_len=13}, {iov_base=\"stuvwxyzabcdef\", iov_len=14}, {iov_base=\"rstuvwxyzabcdef\", iov_len=15}, {iov_base=\"qrstuvwxyzabcdef\", iov_len=16}, {iov_base=\"pqrstuvwxyzabcdef\", iov_len=17}, {iov_base=\"opqrstuvwxyzabcdef\", iov_len=18}, {iov_base=\"nopqrstuvwxyzabcdef\", iov_len=19}, {iov_base=\"mnopqrstuvwxyzabcdef\", iov_len=20}, {iov_base=\"lmnopqrstuvwxyzabcdef\", iov_len=21}, {iov_base=\"klmnopqrstuvwxyzabcdef\", iov_len=22}, {iov_base=\"jklmnopqrstuvwxyzabcdef\", iov_len=23}, {iov_base=\"ijklmnopqrstuvwxyzabcdef\", iov_len=24}, {iov_base=\"hijklmnopqrstuvwxyzabcdef\", iov_len=25}, {iov_base=\"ghijklmnopqrstuvwxyzabcdef\", iov_len=26}, {iov_base=\"fghijklmnopqrstuvwxyzabcdef\", iov_len=27}, {iov_base=\"efghijklmnopqrstuvwxyzabcdef\", iov_len=28}, {iov_base=\"defghijklmnopqrstuvwxyzabcdef\", iov_len=29}, {iov_base=\"cdefghijklmnopqrstuvwxyzabcdef\", iov_len=30}, {iov_base=\"bcdefghijklmnopqrstuvwxyzabcdef\", iov_len=31}], 32) = 18446744073709551607\nFAIL umovestr_cached.test (exit status: 1)\n\nThe last successful strace build is with glibc-2.32.9000-20.fc34.ppc64le, which is ~4 builds before 'scv' is introduced.\n\nAll builds after 'scv' is introduced in glibc-2.32.9000-24 (2021-01-08) appear to fail.\n\nI don't see any 'scv' enablement in strace for ppc64le."
													},
													{
														"isprivate": "0",
														"commentid": "15079276",
														"comment_count": "15",
														"who": {
															"text": "tulioqm",
															"name": "Tulio Magno Quites Machado Filho"
														},
														"bug_when": "2021-05-18 21:18:21 +0000",
														"thetext": "(In reply to Carlos O'Donell from comment #14)\n> I don't see any 'scv' enablement in strace for ppc64le.\n\nI agree with you. strace upstream is missing support for scv.\ne.g. in this function https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\nWe can't trust on the value of CR0 anymore.  An error is returned when r3 is negative."
													},
													{
														"isprivate": "0",
														"commentid": "15079396",
														"comment_count": "16",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-18 22:40:03 +0000",
														"thetext": "(In reply to Tulio Magno Quites Machado Filho from comment #15)\n> (In reply to Carlos O'Donell from comment #14)\n> > I don't see any 'scv' enablement in strace for ppc64le.\n> \n> I agree with you. strace upstream is missing support for scv.\n> e.g. in this function\n> https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n> We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> negative.\n\nDoes this mean that the kernel function syscall_get_error and all its users including PTRACE_GET_SYSCALL_INFO API is broken when scv is used?"
													},
													{
														"isprivate": "0",
														"commentid": "15079417",
														"comment_count": "17",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-18 22:56:59 +0000",
														"thetext": "(In reply to Dmitry V. Levin from comment #16)\n> (In reply to Tulio Magno Quites Machado Filho from comment #15)\n> > (In reply to Carlos O'Donell from comment #14)\n> > > I don't see any 'scv' enablement in strace for ppc64le.\n> > \n> > I agree with you. strace upstream is missing support for scv.\n> > e.g. in this function\n> > https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n> > We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> > negative.\n> \n> Does this mean that the kernel function syscall_get_error and all its users\n> including PTRACE_GET_SYSCALL_INFO API are broken when scv is used?\n\nLooks like the answer is yes, the kernel commit v5.9-rc1~100^2~164 that introduced scv support was incomplete, all users of ccr in arch/powerpc/include/asm/ptrace.h and arch/powerpc/include/asm/syscall.h are broken when scv is used.\n\nSo while the idea of changing the error handling convention is questionable,\nthe bug is on the kernel side that failed to implement the new error handling convention."
													},
													{
														"isprivate": "0",
														"commentid": "15079459",
														"comment_count": "18",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-18 23:32:22 +0000",
														"thetext": "(In reply to Tulio Magno Quites Machado Filho from comment #15)\n> (In reply to Carlos O'Donell from comment #14)\n> > I don't see any 'scv' enablement in strace for ppc64le.\n> \n> I agree with you. strace upstream is missing support for scv.\n> e.g. in this function\n> https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n\nPlease note that this file is not used when PTRACE_GET_SYSCALL_INFO is working properly,\nthere is a runtime test for this, see\n\n$ strace -d -enone / 2>&1 |grep PTRACE_GET_SYSCALL_INFO\n\nHowever, there is going to be an issue with src/linux/powerpc/set_error.c and its users, e.g. syscall tampering.\n\n> We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> negative.\n\nI hope somebody who knows scv semantics would contribute missing parts of scv support to strace and the kernel before strace is kicked out from Fedora due to ftbfs."
													},
													{
														"isprivate": "0",
														"commentid": "15084949",
														"comment_count": "19",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-20 03:47:43 +0000",
														"thetext": "There was a short discussion in linux-api mailing list that identified two bugs:\n1. incomplete scv abi support in the kernel that breaks users of asm/syscall.h and asm/ptrace.h, these users include ptrace, tracing, and audit subsystems; detected by hundereds of tests from the strace test suite, proposed patch can be found at https://lore.kernel.org/linux-api/1621385544.nttlk5qugb.astroid@bobo.none/ ;\n2. a glibc bug detected by signal test from the strace test suite, proposed patch can be found at https://lore.kernel.org/linux-api/1621400263.gf0mbqhkrf.astroid@bobo.none/ .\n\nFeel free to split this bug report into two if necessary."
													},
													{
														"isprivate": "0",
														"commentid": "15088583",
														"comment_count": "20",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-20 23:06:30 +0000",
														"thetext": "Since the glibc bug is now tracked by #1962971, switching this bug back to the kernel component.\n\nMeanwhile, Nicholas Piggin submitted a patch that's likely to be the final, see\nhttps://lore.kernel.org/linuxppc-dev/20210520111931.2597127-2-npiggin@gmail.com/\n\nI'd like to remind that this bug was found by strace test suite and it blocks strace updates in Fedora.\n\nI hope the fix will be applied before strace is kicked out from Fedora due to ftbfs which is 19 weeks already."
													},
													{
														"isprivate": "0",
														"commentid": "15093123",
														"comment_count": "21",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-23 17:43:31 +0000",
														"thetext": "(In reply to Dmitry V. Levin from comment #20)\n> Meanwhile, Nicholas Piggin submitted a patch that's likely to be the final,\n> see\n> https://lore.kernel.org/linuxppc-dev/20210520111931.2597127-2-npiggin@gmail.\n> com/\n\nThis patch has been merged upstream, see\nhttps://git.kernel.org/torvalds/c/d72500f992849d31ebae8f821a023660ddd0dcc2"
													},
													{
														"isprivate": "0",
														"commentid": "15095587",
														"comment_count": "22",
														"who": {
															"text": "jforbes",
															"name": "Justin M. Forbes"
														},
														"bug_when": "2021-05-24 14:19:12 +0000",
														"thetext": "That should be in the 5.13-rc3 build today for rawhide. I have also cherry picked it for 5.12, so it should land in stable fedora with 5.12.7 and newer."
													},
													{
														"isprivate": "0",
														"commentid": "15185392",
														"comment_count": "23",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-06-14 15:35:34 +0000",
														"thetext": "Dmitry, is there still something blocking you from updating strace? I believe we already have all the kernel/glibc bits included for F-34+."
													},
													{
														"isprivate": "0",
														"commentid": "15195017",
														"comment_count": "24",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-06-16 12:06:57 +0000",
														"thetext": "Everything should have been fixed now, but I cannot tell for sure because something else is broken: a scratch build of strace HEAD failed with the following diagnostics: BuildrootError: could not init mock buildroot, mock exited with status 30; see root.log for more information\n\nThe corresponding root.log contains the following diagnostics:\nDEBUG util.py:444:  Error: \nDEBUG util.py:444:   Problem: package util-linux-2.37-2.fc35.x86_64 requires util-linux-core = 2.37-2.fc35, but none of the providers can be installed\nDEBUG util.py:444:    - conflicting requests\nDEBUG util.py:444:    - nothing provides libpcre2-posix.so.2()(64bit) needed by util-linux-core-2.37-2.fc35.x86_64\nDEBUG util.py:446:  (try to add '--skip-broken' to skip uninstallable packages)\nDEBUG util.py:598:  Child return code was: 1\n\nThis looks as if all builds to fc35 are currently broken.\nFor more details see the scratch build task: https://koji.fedoraproject.org/koji/taskinfo?taskID=70224999"
													},
													{
														"isprivate": "0",
														"commentid": "15195062",
														"comment_count": "25",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-06-16 12:17:33 +0000",
														"thetext": "The buildroot should be OK again, there was a pcre2 update with unexpected consequences, but it has been untagged."
													},
													{
														"isprivate": "0",
														"commentid": "15195850",
														"comment_count": "26",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-06-16 14:59:25 +0000",
														"thetext": "for the record, my local F-34 rebuild of strace HEAD with kernel-5.12.10-300.fc34.ppc64le and glibc-2.33-16.fc34.ppc64le was successful"
													},
													{
														"isprivate": "0",
														"commentid": "15197009",
														"comment_count": "27",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-06-16 23:19:42 +0000",
														"thetext": "(In reply to Dan Hork from comment #26)\n> for the record, my local F-34 rebuild of strace HEAD with\n> kernel-5.12.10-300.fc34.ppc64le and glibc-2.33-16.fc34.ppc64le was successful\n\nMy scratch build to fc34 was successful, too:\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=70227524"
													},
													{
														"isprivate": "0",
														"commentid": "16610110",
														"comment_count": "28",
														"who": {
															"text": "mcermak",
															"name": "Martin Cermak"
														},
														"bug_when": "2022-09-05 08:05:57 +0000",
														"thetext": "Maybe this one could be flipped to MODIFIED or further?  Thanks!"
													},
													{
														"isprivate": "0",
														"commentid": "16610124",
														"comment_count": "29",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2022-09-05 08:10:08 +0000",
														"thetext": "It was fixed long time ago, closing."
													}
												]
											},
											{
												"bug_id": "1962971",
												"creation_ts": "2021-05-20 22:54:06 +0000",
												"short_desc": "glibc: ppc64le: scv ABI error handling fails to check IS_ERR_VALUE",
												"delta_ts": "2021-07-06 13:32:49 +0000",
												"bug_status": "CLOSED",
												"resolution": "ERRATA",
												"keywords": "BetaBlocker",
												"priority": "unspecified",
												"bug_severity": "urgent",
												"depends_on": [
													"1071880"
												],
												"blocked": [
													{
														"bug_id": "1930252",
														"error": "NotPermitted"
													},
													{
														"bug_id": "1963901",
														"creation_ts": "2021-05-24 11:10:27 +0000",
														"short_desc": "RHEL9 - ppc64le: glibc fails to check IS_ERR_VALUE when using scv",
														"delta_ts": "2023-07-18 14:29:19 +0000",
														"bug_status": "CLOSED",
														"resolution": "CURRENTRELEASE",
														"keywords": "Bugfix, Patch, Triaged",
														"priority": "unspecified",
														"bug_severity": "high",
														"depends_on": [
															"1962971"
														],
														"blocked": [
															{
																"bug_id": "1875375",
																"error": "NotPermitted"
															}
														],
														"external_bugs": {
															"text": "27892",
															"name": "Sourceware"
														},
														"long_desc": [
															{
																"isprivate": "0",
																"commentid": "15094789",
																"comment_count": "0",
																"who": {
																	"text": "bugproxy",
																	"name": "IBM Bug Proxy"
																},
																"bug_when": "2021-05-24 11:10:27 +0000"
															},
															{
																"isprivate": "0",
																"commentid": "15094790",
																"comment_count": "1",
																"who": {
																	"text": "bugproxy",
																	"name": "IBM Bug Proxy"
																},
																"bug_when": "2021-05-24 11:10:35 +0000",
																"thetext": "== Comment: #0 - Tulio Magno Quites Machado Filho <tulioqm@br.ibm.com> - 2021-05-21 16:11:35 ==\n---Problem Description---\nglibc fails to check IS_ERR_VALUE when using scv.\n\nThis bug has been reported upstream as: https://sourceware.org/bugzilla/show_bug.cgi?id=27892\n\nIt has also been reported for Fedora 35: https://bugzilla.redhat.com/show_bug.cgi?id=1962971\n \nContact Information = Tulio Magno Quites Machado Filho/tulioqm@br.ibm.com \n \n---Additional Hardware Info---\nA POWER9 or POWER10 server with support for scv is required to reproduce the error.\n\n\n---Steps to Reproduce---\n 1. Build strace and its tests.\n 2. Run test tests/signal\n \nUserspace rpm: glibc \n \nThe userspace tool has the following bit modes: 64-bit"
															},
															{
																"isprivate": "0",
																"commentid": "15103462",
																"comment_count": "6",
																"who": {
																	"text": "fweimer",
																	"name": "Florian Weimer"
																},
																"bug_when": "2021-05-25 17:37:12 +0000",
																"thetext": "Merge request: https://gitlab.com/redhat/centos-stream/rpms/glibc/-/merge_requests/11"
															},
															{
																"isprivate": "0",
																"commentid": "15103633",
																"comment_count": "7",
																"who": {
																	"text": "bugproxy",
																	"name": "IBM Bug Proxy"
																},
																"bug_when": "2021-05-25 17:47:07 +0000",
																"thetext": "------- Comment From tulioqm@br.ibm.com 2021-05-24 10:12 EDT-------\n> May we make this bug report public? Thanks.\n\nYes, but I don't know how to do this.\nCould you help me, please?"
															}
														]
													}
												],
												"external_bugs": {
													"text": "27892",
													"name": "Sourceware"
												},
												"long_desc": [
													{
														"isprivate": "0",
														"commentid": "15088572",
														"comment_count": "0",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-20 22:54:06 +0000",
														"thetext": "+++ This bug was initially created as a clone of Bug #1929836 +++\n\nThe scv ABI introduced by glibc-2.32.9000-24 at 2021-01-08 has the following bug: RET_SCV macro (added by upstream commit glibc-2.33~117) treats any negative value returned by syscall via scv ABI as an error, but this is not correct.\n\nProposed fix was posted by Nicholas Piggin at\nhttps://sourceware.org/pipermail/libc-alpha/2021-May/126534.html\n\nThis bug was found by strace test suite and it blocks strace updates in Fedora.\n\nI hope the fix will be applied before strace is kicked out from Fedora due to ftbfs which is 19 weeks already."
													},
													{
														"isprivate": "0",
														"commentid": "15138481",
														"comment_count": "1",
														"who": {
															"text": "updates",
															"name": "Fedora Update System"
														},
														"bug_when": "2021-06-01 13:46:20 +0000",
														"thetext": "FEDORA-2021-abbb0d8a88 has been submitted as an update to Fedora 34. https://bodhi.fedoraproject.org/updates/FEDORA-2021-abbb0d8a88"
													},
													{
														"isprivate": "0",
														"commentid": "15138487",
														"comment_count": "2",
														"who": {
															"text": "codonell",
															"name": "Carlos O'Donell"
														},
														"bug_when": "2021-06-01 13:47:36 +0000",
														"thetext": "This fix is currently pending the Fedora Rawhide sync with the upstream development branch.\n\nThe fix is going into Fedora 34 with the next errata going through bodhi."
													},
													{
														"isprivate": "0",
														"commentid": "15140578",
														"comment_count": "3",
														"who": {
															"text": "updates",
															"name": "Fedora Update System"
														},
														"bug_when": "2021-06-02 01:41:09 +0000",
														"thetext": "FEDORA-2021-abbb0d8a88 has been pushed to the Fedora 34 testing repository.\nSoon you'll be able to install the update with the following command:\n`sudo dnf upgrade --enablerepo=updates-testing --advisory=FEDORA-2021-abbb0d8a88`\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2021-abbb0d8a88\n\nSee also https://fedoraproject.org/wiki/QA:Updates_Testing for more information on how to test updates."
													},
													{
														"isprivate": "0",
														"commentid": "15144856",
														"comment_count": "4",
														"who": {
															"text": "updates",
															"name": "Fedora Update System"
														},
														"bug_when": "2021-06-03 01:01:07 +0000",
														"thetext": "FEDORA-2021-abbb0d8a88 has been pushed to the Fedora 34 stable repository.\nIf problem still persists, please make note of it in this bug report."
													},
													{
														"isprivate": "0",
														"commentid": "15194139",
														"comment_count": "5",
														"who": {
															"text": "updates",
															"name": "Fedora Update System"
														},
														"bug_when": "2021-06-16 08:27:59 +0000",
														"thetext": "FEDORA-2021-9ce0f65a09 has been pushed to the Fedora 35 stable repository.\nIf problem still persists, please make note of it in this bug report."
													}
												]
											}
										],
										"long_desc": [
											{
												"isprivate": "0",
												"commentid": "6873212",
												"comment_count": "0",
												"who": {
													"text": "karsten",
													"name": "Karsten Hopp"
												},
												"bug_when": "2014-03-03 11:41:52 +0000",
												"thetext": "Description of problem:\nThis is a tracker for bugzillas and patches related to the PowerPC (ppc, ppc64) architectures.\n\nppc64le has its own tracker: bug 1051573"
											},
											{
												"isprivate": "0",
												"commentid": "10293511",
												"comment_count": "1",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2017-03-31 08:51:19 +0000",
												"thetext": "*** Bug 1051573 has been marked as a duplicate of this bug. ***"
											},
											{
												"isprivate": "0",
												"commentid": "10293516",
												"comment_count": "2",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2017-03-31 08:52:39 +0000",
												"thetext": "add open bugs from the ppc64le tracker"
											},
											{
												"isprivate": "0",
												"commentid": "13402189",
												"comment_count": "3",
												"who": {
													"text": "bcotton",
													"name": "Ben Cotton"
												},
												"bug_when": "2019-11-27 14:16:33 +0000",
												"thetext": "Fedora 29 changed to end-of-life (EOL) status on 2019-11-26. Fedora 29 is\nno longer maintained, which means that it will not receive any further\nsecurity or bug fix updates. As a result we are closing this bug.\n\nIf you can reproduce this bug against a currently maintained version of\nFedora please feel free to reopen this bug against that version. If you\nare unable to reopen this bug, please file a new report against the\ncurrent release. If you experience problems, please add a comment to this\nbug.\n\nThank you for reporting this bug and we are sorry it could not be fixed."
											},
											{
												"isprivate": "0",
												"commentid": "13403192",
												"comment_count": "4",
												"who": {
													"text": "bcotton",
													"name": "Ben Cotton"
												},
												"bug_when": "2019-11-27 16:41:04 +0000",
												"thetext": "This bug was accidentally closed due to a query error. Reopening."
											}
										]
									},
									{
										"bug_id": "1430829",
										"alias": "F26PPCBeta",
										"creation_ts": "2017-03-09 16:33:28 +0000",
										"short_desc": "F26 PPC Beta Blocker Tracker",
										"delta_ts": "2017-12-04 11:21:20 +0000",
										"bug_status": "CLOSED",
										"resolution": "CURRENTRELEASE",
										"keywords": "Tracking",
										"priority": "unspecified",
										"bug_severity": "unspecified",
										"depends_on": [
											"1439051",
											"1443415",
											"1447276",
											"1447777",
											"1447924",
											"1450755"
										],
										"blocked": [
											{
												"bug_id": "1071880",
												"alias": "PPCTracker",
												"creation_ts": "2014-03-03 11:41:52 +0000",
												"short_desc": "(PPCTracker) Fedora for PowerPC architectures (ppc64,ppc64le): Bug Tracker",
												"delta_ts": "2024-07-04 11:18:17 +0000",
												"bug_status": "ASSIGNED",
												"keywords": "Tracking",
												"priority": "medium",
												"bug_severity": "medium",
												"depends_on": [
													"238953",
													"1266508",
													"1562071",
													"1817976",
													"1909065",
													"1960848",
													"2209760",
													"2212765",
													"2240371",
													"2273668",
													"2293597",
													"2293909",
													"2294180",
													"179260",
													"468831",
													"810582",
													"834619",
													"864392",
													"968359",
													"990749",
													"999069",
													"1015497",
													"1035541",
													"1049976",
													"1058258",
													"1058289",
													"1058686",
													"1059234",
													"1059816",
													"1067470",
													"1070183",
													"1070206",
													"1070380",
													"1070892",
													"1071278",
													"1071284",
													"1071527",
													"1071845",
													"1079673",
													"1085127",
													"1085704",
													"1088339",
													"1090452",
													"1091538",
													"1093163",
													"1094513",
													"1094975",
													"1097109",
													"1097111",
													"1098151",
													"1100762",
													"1101996",
													"1104215",
													"1104279",
													"1104603",
													"1105552",
													"1108103",
													"1110892",
													"1111453",
													"1114240",
													"1122406",
													"1125883",
													"1128663",
													"1130079",
													"1132488",
													"1134566",
													"1136388",
													"1136532",
													"1136535",
													"1136544",
													"1140057",
													"1140189",
													"1143912",
													"1149159",
													"1149702",
													"1149704",
													"1151853",
													"1155291",
													"1155660",
													"1156300",
													"1158522",
													"1160429",
													"1160916",
													"1161098",
													"1161119",
													"1161152",
													"1161585",
													"1162245",
													"1162904",
													"1162914",
													"1164209",
													"1164221",
													"1165638",
													"1166474",
													"1166489",
													"1168634",
													"1172791",
													"1174607",
													"1175526",
													"1182677",
													"1185298",
													"1194704",
													"1195065",
													"1195663",
													"1196994",
													"1197007",
													"1197165",
													"1197721",
													"1197772",
													"1199041",
													"1201219",
													"1202876",
													"1204876",
													"1205359",
													"1206060",
													"1206161",
													"1208412",
													"1210003",
													"1211616",
													"1211638",
													"1212328",
													"1212472",
													"1214950",
													"1220294",
													"1220866",
													"1221689",
													"1223869",
													"1225035",
													"1225487",
													"1226316",
													"1228102",
													"1230233",
													"1232158",
													"1232650",
													"1232739",
													"1234277",
													"1234284",
													"1235709",
													"1235999",
													"1237089",
													"1238168",
													"1241214",
													"1247047",
													"1247567",
													"1247925",
													"1251120",
													"1251422",
													"1251520",
													"1251972",
													"1252074",
													"1252899",
													"1252905",
													"1252975",
													"1253763",
													"1254606",
													"1255074",
													"1255135",
													"1255682",
													"1256839",
													"1257201",
													"1257966",
													"1260297",
													"1261541",
													"1262402",
													"1262441",
													"1262444",
													"1264504",
													"1264912",
													"1265546",
													"1265674",
													"1267269",
													"1268789",
													"1269811",
													"1271230",
													"1273103",
													"1274974",
													"1275229",
													"1275619",
													"1276061",
													"1276959",
													"1277142",
													"1278066",
													"1278135",
													"1278428",
													"1281446",
													"1281764",
													"1284527",
													"1285786",
													"1286149",
													"1286249",
													"1286625",
													"1287015",
													"1287105",
													"1288561",
													"1289106",
													"1289940",
													"1290958",
													"1291565",
													"1292461",
													"1292462",
													"1292467",
													"1292969",
													"1294016",
													"1295350",
													"1296842",
													"1297387",
													"1297855",
													"1297894",
													"1299151",
													"1299193",
													"1299226",
													"1299599",
													"1300900",
													"1302224",
													"1303219",
													"1303223",
													"1304402",
													"1305512",
													"1305725",
													"1306214",
													"1308252",
													"1308424",
													"1309225",
													"1310495",
													"1311685",
													"1312018",
													"1312339",
													"1315225",
													"1315903",
													"1316840",
													"1319063",
													"1321113",
													"1322696",
													"1323193",
													"1324085",
													"1325114",
													"1325126",
													"1325858",
													"1326250",
													"1326366",
													"1328455",
													"1330098",
													"1330102",
													"1330108",
													"1330161",
													"1330174",
													"1331726",
													"1332146",
													"1332150",
													"1332449",
													"1332978",
													"1333344",
													"1333695",
													"1334125",
													"1334212",
													"1334315",
													"1334320",
													"1335162",
													"1335823",
													"1336466",
													"1340736",
													"1340829",
													"1341090",
													"1342146",
													"1342561",
													"1344636",
													"1345826",
													"1349945",
													"1350486",
													"1351737",
													"1351971",
													"1356152",
													"1356189",
													"1359680",
													"1361037",
													"1365739",
													"1365851",
													"1365862",
													"1365940",
													"1366328",
													"1368495",
													"1368932",
													"1369162",
													"1369169",
													"1371894",
													"1373576",
													"1374380",
													"1374382",
													"1374749",
													"1375942",
													"1377201",
													"1377395",
													"1378359",
													"1379123",
													"1380643",
													"1381206",
													"1383912",
													"1386180",
													"1387107",
													"1387601",
													"1388453",
													"1388561",
													"1389957",
													"1391932",
													"1392264",
													"1392340",
													"1392465",
													"1392478",
													"1392479",
													"1392848",
													"1392854",
													"1392887",
													"1392922",
													"1393834",
													"1396814",
													"1398322",
													"1398575",
													"1400476",
													"1401220",
													"1401707",
													"1402256",
													"1403216",
													"1403760",
													"1404305",
													"1409636",
													"1410774",
													"1410784",
													"1412274",
													"1412926",
													"1414489",
													"1417244",
													"1419355",
													"1420350",
													"1420753",
													"1426796",
													"1428310",
													"1429575",
													"1430827",
													"1430829",
													"1430830",
													"1433859",
													"1434007",
													"1434276",
													"1435154",
													"1435585",
													"1435953",
													"1437793",
													"1439051",
													"1439141",
													"1440047",
													"1440843",
													"1443415",
													"1447276",
													"1447777",
													"1447924",
													"1449582",
													"1450755",
													"1451115",
													"1451143",
													"1452813",
													"1455299",
													"1460003",
													"1461708",
													"1461775",
													"1463749",
													"1464115",
													"1465159",
													"1465171",
													"1465174",
													"1465176",
													"1465657",
													"1467647",
													"1470692",
													"1471785",
													"1472375",
													"1474744",
													"1475636",
													"1476380",
													"1481163",
													"1481611",
													"1482382",
													"1482447",
													"1484149",
													"1484151",
													"1484320",
													"1484474",
													"1484579",
													"1485690",
													"1486737",
													"1487787",
													"1491093",
													"1491751",
													"1494542",
													"1497720",
													"1498561",
													"1498922",
													"1501936",
													"1502009",
													"1512229",
													"1515934",
													"1516213",
													"1518707",
													"1524376",
													"1527692",
													"1528378",
													"1538300",
													"1538817",
													"1540995",
													"1541319",
													"1541613",
													"1544349",
													"1544833",
													"1546693",
													"1546743",
													"1547049",
													"1547467",
													"1548001",
													"1548425",
													"1548671",
													"1552648",
													"1552650",
													"1552653",
													"1552724",
													"1553626",
													"1553794",
													"1554345",
													"1556989",
													"1561011",
													"1562059",
													"1562061",
													"1562073",
													"1563466",
													"1565693",
													"1566066",
													"1566151",
													"1566225",
													"1569045",
													"1570256",
													"1571205",
													"1571860",
													"1572540",
													"1573538",
													"1574604",
													"1577587",
													"1578429",
													"1579708",
													"1585991",
													"1588130",
													"1588734",
													"1588774",
													"1591701",
													"1601259",
													"1605125",
													"1609208",
													"1609513",
													"1612490",
													"1612601",
													"1614948",
													"1619601",
													"1619690",
													"1624915",
													"1626057",
													"1628394",
													"1628540",
													"1631093",
													"1631759",
													"1633565",
													"1643729",
													"1647947",
													"1659239",
													"1660807",
													"1666298",
													"1668751",
													"1669055",
													"1669235",
													"1669256",
													"1675014",
													"1675573",
													"1676411",
													"1676475",
													"1679074",
													"1680040",
													"1687369",
													"1687882",
													"1689037",
													"1689819",
													"1691016",
													"1691487",
													"1691832",
													"1693676",
													"1713090",
													"1714489",
													"1719378",
													"1722181",
													"1723425",
													"1724800",
													"1725924",
													"1726444",
													"1730843",
													"1732612",
													"1733118",
													"1733673",
													"1733926",
													"1736762",
													"1737581",
													"1737587",
													"1738752",
													"1741266",
													"1745841",
													"1746405",
													"1746852",
													"1749729",
													"1756650",
													"1756838",
													"1757249",
													"1757250",
													"1757548",
													"1758225",
													"1762709",
													"1764666",
													"1766519",
													"1768551",
													"1769324",
													"1769445",
													"1769600",
													"1771031",
													"1772935",
													"1774507",
													"1777345",
													"1779589",
													"1782919",
													"1784961",
													"1789199",
													"1789854",
													"1790436",
													"1795575",
													"1798908",
													"1803351",
													"1816527",
													"1817004",
													"1817773",
													"1817959",
													"1820619",
													"1824208",
													"1825287",
													"1827397",
													"1838565",
													"1853217",
													"1856283",
													"1860811",
													"1860932",
													"1863685",
													"1864181",
													"1869980",
													"1870213",
													"1886303",
													"1894654",
													"1897661",
													"1899841",
													"1913493",
													"1915266",
													"1921479",
													"1921485",
													"1923654",
													"1933742",
													"1933794",
													"1934063",
													"1934065",
													"1937684",
													"1939775",
													"1941652",
													"1943729",
													"1948576",
													"1959353",
													"1965610",
													"1966347",
													"1987280",
													"1987972",
													"1989412",
													"1994599",
													"1996330",
													"1999118",
													"2022035",
													"2027889",
													"2030308",
													"2040887",
													"2041573",
													"2043517",
													"2044054",
													"2045152",
													"2045160",
													"2045186",
													"2045189",
													"2045310",
													"2045367",
													"2045456",
													"2045714",
													"2045780",
													"2045797",
													"2046802",
													"2046865",
													"2046907",
													"2048910",
													"2049371",
													"2056459",
													"2061022",
													"2064025",
													"2081451",
													"2095750",
													"2096956",
													"2100546",
													"2102907",
													"2109095",
													"2109120",
													"2112825",
													"2113609",
													"2115752",
													"2124845",
													"2131287",
													"2140618",
													"2142739",
													"2143393",
													"2154939",
													"2160760",
													"2162999",
													"2164029",
													"2173015",
													"2177410",
													"2177691",
													"2209435",
													"2212748",
													"2218314",
													"2221314",
													"2264712",
													"2275090"
												],
												"blocked": [
													{
														"bug_id": "2171964",
														"creation_ts": "2023-02-21 02:32:53 +0000",
														"short_desc": "ICE / segfault in process_function_and_variable_attributes() when building tokodon on ppc64le",
														"delta_ts": "2023-08-16 07:10:03 +0000",
														"bug_status": "NEW",
														"priority": "unspecified",
														"bug_severity": "unspecified",
														"depends_on": [
															"1071880"
														],
														"external_bugs": {
															"text": "108887",
															"name": "GNU Compiler Collection"
														},
														"long_desc": [
															{
																"isprivate": "0",
																"commentid": "17062382",
																"comment_count": "0",
																"who": {
																	"text": "justin.zobel",
																	"name": "Justin Zobel"
																},
																"bug_when": "2023-02-21 02:32:53 +0000",
																"thetext": "Build has failed only on ppc64le 4 times now, one build example https://koji.fedoraproject.org/koji/taskinfo?taskID=97784827\n\nUpstream has stated they will not support ppc64le.\n\nAdding ExcludeArch until this can be fixed."
															},
															{
																"isprivate": "0",
																"commentid": "17062632",
																"comment_count": "1",
																"who": {
																	"text": "dan",
																	"name": "Dan Hork"
																},
																"bug_when": "2023-02-21 07:07:45 +0000",
																"thetext": "This is a gcc internal error, probably gcc13 related, I will try to get the details and switch the bug to gcc."
															},
															{
																"isprivate": "0",
																"commentid": "17062697",
																"comment_count": "2",
																"who": {
																	"text": "justin.zobel",
																	"name": "Justin Zobel"
																},
																"bug_when": "2023-02-21 07:29:45 +0000",
																"thetext": "Thanks Dan much appreciated!"
															},
															{
																"isprivate": "0",
																"commentid": "17062752",
																"comment_count": "3",
																"who": {
																	"text": "dan",
																	"name": "Dan Hork"
																},
																"bug_when": "2023-02-21 08:04:58 +0000",
																"thetext": "(gdb) run\nStarting program: /usr/bin/g++ -DHAVE_KIO -DKCOREADDONS_LIB -DQT_CONCURRENT_LIB -DQT_CORE_LIB -DQT_DBUS_LIB -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_NO_DEBUG -DQT_NO_FOREACH -DQT_NO_KEYWORDS -DQT_QMLMODELS_LIB -DQT_QML_LIB -DQT_QUICKCONTROLS2_LIB -DQT_QUICK_LIB -DQT_WEBSOCKETS_LIB -DQT_WIDGETS_LIB -DQT_XML_LIB -D_GNU_SOURCE -D_LARGEFILE64_SOURCE -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src -I/home/sharkcz/tokodon/tokodon-23.02.0/src -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src/tokodon_static_autogen/include -isystem /usr/include/qt5 -isystem /usr/include/qt5/QtQuick -isystem /usr/include/qt5/QtQmlModels -isystem /usr/include/qt5/QtQml -isystem /usr/include/qt5/QtNetwork -isystem /usr/include/qt5/QtCore -isystem /usr/lib64/qt5/mkspecs/linux-g++ -isystem /usr/include/qt5/QtGui -isystem /usr/include/qt5/QtWebSockets -isystem /usr/include/qt5/QtQuickControls2 -isystem /usr/include/KF5/KI18n -isystem /usr/include/KF5 -isystem /usr/include/KF5/Kirigami2 -isystem /usr/include/KF5/KNotifications -isystem /usr/include/qt5/QtWidgets -isystem /usr/include/qt5/QtDBus -isystem /usr/include/KF5/KConfig -isystem /usr/include/KF5/KConfigCore -isystem /usr/include/KF5/KConfigGui -isystem /usr/include/qt5/QtXml -isystem /usr/include/KF5/KCoreAddons -isystem /usr/include/KF5/KIOWidgets -isystem /usr/include/KF5/KIOGui -isystem /usr/include/KF5/KIOCore -isystem /usr/include/KF5/KIO -isystem /usr/include/KF5/KService -isystem /usr/include/qt5/QtConcurrent -isystem /usr/include/KF5/KWindowSystem -isystem /usr/include/KF5/KJobWidgets -isystem /usr/include/KF5/Solid -isystem /usr/include/KF5/KCompletion -isystem /usr/include/KF5/KWidgetsAddons -isystem /usr/include/KF5/KConfigWidgets -isystem /usr/include/KF5/KCodecs -isystem /usr/include/KF5/KAuthWidgets -isystem /usr/include/KF5/KAuthCore -isystem /usr/include/KF5/KAuth -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-U_FORTIFY_SOURCE,-D_FORTIFY_SOURCE=3 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -fstack-protector-strong -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mcpu=power8 -mtune=power8 -fasynchronous-unwind-tables -fstack-clash-protection -fno-operator-names -fno-exceptions -Wall -Wextra -Wcast-align -Wchar-subscripts -Wformat-security -Wno-long-long -Wpointer-arith -Wundef -Wnon-virtual-dtor -Woverloaded-virtual -Werror=return-type -Werror=init-self -Wvla -Wdate-time -Wsuggest-override -Wlogical-op -DNDEBUG -std=gnu++17 -fvisibility=hidden -fvisibility-inlines-hidden -fPIC -MD -MT src/CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -MF CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o.d -o CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -c /home/sharkcz/tokodon/tokodon-23.02.0/src/linkpaginatedtimelinemodel.cpp\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n[Attaching after Thread 0x7ffff7ff34e0 (LWP 18708) vfork to child process 18710]\n[New inferior 2 (process 18710)]\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n[Detaching vfork parent process 18708 after child exec]\n[Inferior 1 (process 18708) detached]\nprocess 18710 is executing new program: /usr/libexec/gcc/ppc64le-redhat-linux/13/cc1plus\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n\nThread 2.1 \"cc1plus\" received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7ffff7ff53c0 (LWP 18710)]\nprocess_function_and_variable_attributes (first_var=0x7fffdc638a00, first=0x7fffdc539900) at ../../gcc/cgraphunit.cc:861\nDownloading 0.02 MB source file /usr/src/debug/gcc-13.0.1-0.4.fc39.ppc64le/obj-ppc64le-redhat-linux/gcc/../../gcc/cgraphunit.cc\n861\t      tree decl = node->decl;\n(gdb) cont\nContinuing.\n\nThread 2.1 \"cc1plus\" hit Breakpoint 1, 0x0000000010747e9c in internal_error (gmsgid=0x11927bf8 \"%s\") at ../../gcc/diagnostic.cc:2138\n2138\t{\n(gdb) bt\n#0  0x0000000010747e9c in internal_error (gmsgid=0x11927bf8 \"%s\") at ../../gcc/diagnostic.cc:2138\n#1  0x00000000103f7a5c in crash_signal (signo=11) at ../../gcc/toplev.cc:317\n#2  <signal handler called>\n#3  process_function_and_variable_attributes (first_var=0x7fffdc638a00, first=0x7fffdc539900) at ../../gcc/cgraphunit.cc:861\n#4  analyze_functions (first_time=first_time@entry=true) at ../../gcc/cgraphunit.cc:1181\n#5  0x00000000112bf628 in symbol_table::finalize_compilation_unit (this=0x7fffe8080000) at ../../gcc/cgraphunit.cc:2545\n#6  0x000000001125c410 in compile_file () at ../../gcc/toplev.cc:474\n#7  0x00000000111dd510 in do_compile (no_backend=<optimized out>) at ../../gcc/toplev.cc:2128\n#8  toplev::main (this=this@entry=0x7fffffffca00, argc=<optimized out>, argv=<optimized out>) at ../../gcc/toplev.cc:2282\n#9  0x00000000111dc5d0 in main (argc=<optimized out>, argv=<optimized out>) at ../../gcc/main.cc:39"
															},
															{
																"isprivate": "0",
																"commentid": "17062753",
																"comment_count": "4",
																"who": {
																	"text": "dan",
																	"name": "Dan Hork"
																},
																"bug_when": "2023-02-21 08:05:48 +0000",
																"thetext": "Created attachment 1945415\npreprocessed sources"
															},
															{
																"isprivate": "0",
																"commentid": "17062834",
																"comment_count": "5",
																"who": {
																	"text": "dan",
																	"name": "Dan Hork"
																},
																"bug_when": "2023-02-21 08:22:23 +0000",
																"thetext": "reduced g++ command line with only defines or include paths still reproducing the issue is\n\n/usr/bin/g++ -DHAVE_KIO -DKCOREADDONS_LIB -DQT_CONCURRENT_LIB -DQT_CORE_LIB -DQT_DBUS_LIB -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_NO_DEBUG -DQT_NO_FOREACH -DQT_NO_KEYWORDS -DQT_QMLMODELS_LIB -DQT_QML_LIB -DQT_QUICKCONTROLS2_LIB -DQT_QUICK_LIB -DQT_WEBSOCKETS_LIB -DQT_WIDGETS_LIB -DQT_XML_LIB -D_GNU_SOURCE -D_LARGEFILE64_SOURCE -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src -I/home/sharkcz/tokodon/tokodon-23.02.0/src -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src/tokodon_static_autogen/include -isystem /usr/include/qt5 -isystem /usr/include/qt5/QtQuick -isystem /usr/include/qt5/QtQmlModels -isystem /usr/include/qt5/QtQml -isystem /usr/include/qt5/QtNetwork -isystem /usr/include/qt5/QtCore -isystem /usr/lib64/qt5/mkspecs/linux-g++ -isystem /usr/include/qt5/QtGui -isystem /usr/include/qt5/QtWebSockets -isystem /usr/include/qt5/QtQuickControls2 -isystem /usr/include/KF5/KI18n -isystem /usr/include/KF5 -isystem /usr/include/KF5/Kirigami2 -isystem /usr/include/KF5/KNotifications -isystem /usr/include/qt5/QtWidgets -isystem /usr/include/qt5/QtDBus -isystem /usr/include/KF5/KConfig -isystem /usr/include/KF5/KConfigCore -isystem /usr/include/KF5/KConfigGui -isystem /usr/include/qt5/QtXml -isystem /usr/include/KF5/KCoreAddons -isystem /usr/include/KF5/KIOWidgets -isystem /usr/include/KF5/KIOGui -isystem /usr/include/KF5/KIOCore -isystem /usr/include/KF5/KIO -isystem /usr/include/KF5/KService -isystem /usr/include/qt5/QtConcurrent -isystem /usr/include/KF5/KWindowSystem -isystem /usr/include/KF5/KJobWidgets -isystem /usr/include/KF5/Solid -isystem /usr/include/KF5/KCompletion -isystem /usr/include/KF5/KWidgetsAddons -isystem /usr/include/KF5/KConfigWidgets -isystem /usr/include/KF5/KCodecs -isystem /usr/include/KF5/KAuthWidgets -isystem /usr/include/KF5/KAuthCore -isystem /usr/include/KF5/KAuth -O2 -pipe -m64 -mcpu=power8 -mtune=power8 -fPIC -o CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -c /home/sharkcz/tokodon/tokodon-23.02.0/src/linkpaginatedtimelinemodel.cpp"
															},
															{
																"isprivate": "0",
																"commentid": "17065288",
																"comment_count": "6",
																"who": {
																	"text": "jakub",
																	"name": "Jakub Jelinek"
																},
																"bug_when": "2023-02-21 21:14:20 +0000",
																"thetext": "cvise reduced to -std=gnu++17 -O2 -mcpu=power8:\n\ntemplate <int __v> struct integral_constant {\n  static constexpr int value = __v;\n};\nusing false_type = integral_constant<false>;\ntemplate <bool, bool, typename...> struct __result_of_impl;\ntemplate <typename _Functor, typename... _ArgTypes>\nstruct __result_of_impl<false, false, _Functor, _ArgTypes...> {\n  typedef decltype(0) type;\n};\ntemplate <typename... _ArgTypes>\nstruct __invoke_result\n    : __result_of_impl<false_type::value, false_type::value, _ArgTypes...> {};\ntemplate <typename, typename _Fn, typename... _Args>\nvoid __invoke_impl(_Fn __f, _Args... __args) {\n  __f(__args...);\n}\ntemplate <typename, typename _Callable, typename... _Args>\nvoid __invoke_r(_Callable __fn, _Args... __args) {\n  using __result = __invoke_result<_Args...>;\n  using __type = typename __result::type;\n  __invoke_impl<__type>(__fn, __args...);\n}\nstruct QString {\n  QString(const char *);\n};\ntemplate <typename> class function;\ntemplate <typename _Functor> struct _Base_manager {\n  static _Functor _M_get_pointer(int) { __builtin_abort (); }\n};\ntemplate <typename, typename> class _Function_handler;\ntemplate <typename _Res, typename _Functor, typename... _ArgTypes>\nstruct _Function_handler<_Res(_ArgTypes...), _Functor> {\n  using _Base = _Base_manager<_Functor>;\n  static _Res _M_invoke(const int &__functor, _ArgTypes &&...__args) {\n    auto __trans_tmp_1 = _Base::_M_get_pointer(__functor);\n    __invoke_r<_Res>(__trans_tmp_1, __args...);\n  }\n};\ntemplate <typename _Res, typename... _ArgTypes>\nstruct function<_Res(_ArgTypes...)> {\n  template <typename _Functor>\n  using _Handler = _Function_handler<_Res(_ArgTypes...), _Functor>;\n  template <typename _Functor> function(_Functor) {\n    using _My_handler = _Handler<_Functor>;\n    _M_invoker = _My_handler::_M_invoke;\n  }\n  using _Invoker_type = _Res (*)(const int &, _ArgTypes &&...);\n  _Invoker_type _M_invoker;\n};\nstruct QRegularExpression {\n  QRegularExpression(QString);\n};\nstruct AbstractAccount {\n  void get(function<void(AbstractAccount *)>,\n           function<void(AbstractAccount *)>);\n};\nstruct AbstractTimelineModel {\n  AbstractAccount m_account;\n};\nstruct LinkPaginationTimelineModel : AbstractTimelineModel {\n  void fillTimeline();\n};\nvoid LinkPaginationTimelineModel::fillTimeline() {\n  [] {};\n  m_account.get([](AbstractAccount *) { static QRegularExpression re(\"\"); },\n                [](AbstractAccount *) {});\n}\n\nBut, strangely can't reproduce with a cross-compiler from x86_64 to powerpc64le."
															},
															{
																"isprivate": "0",
																"commentid": "17540990",
																"comment_count": "7",
																"who": {
																	"text": "releng",
																	"name": "Fedora Release Engineering"
																},
																"bug_when": "2023-08-16 07:10:03 +0000",
																"thetext": "This bug appears to have been reported against 'rawhide' during the Fedora Linux 39 development cycle.\nChanging version to 39."
															}
														]
													},
													{
														"bug_id": "1929836",
														"creation_ts": "2021-02-17 18:32:37 +0000",
														"short_desc": "ppc64le: severe ptrace, tracing, and audit regression",
														"delta_ts": "2022-09-05 08:10:08 +0000",
														"bug_status": "CLOSED",
														"resolution": "CURRENTRELEASE",
														"bug_file_loc": "https://git.kernel.org/torvalds/c/d72500f992849d31ebae8f821a023660ddd0dcc2",
														"keywords": "BetaBlocker",
														"priority": "urgent",
														"bug_severity": "urgent",
														"depends_on": [
															"1071880"
														],
														"blocked": [
															{
																"bug_id": "1930252",
																"error": "NotPermitted"
															}
														],
														"long_desc": [
															{
																"isprivate": "0",
																"commentid": "14794276",
																"comment_count": "0",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-02-17 18:32:37 +0000",
																"thetext": "Hello, strace upstream is speaking. :)\n\nThere seems to be a severe ppc64le kernel regression detected by strace %check (625 of 972 tests failed).  This ruins strace and blocks any strace update.\n\nFor me it looks as if the kernel function syscall_get_error started to return 0 instead of the error code.\n\nThe logs are in the latest strace build task that failed:\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=62171493\n\nThe kernel used for build there was\nLinux buildvm-ppc64le-14.iad2.fedoraproject.org 5.10.15-200.fc33.ppc64le #1 SMP Wed Feb 10 17:31:04 UTC 2021 ppc64le ppc64le ppc64le GNU/Linux\n\nFor comparison, the same version of strace passes all tests on all other rawhide architectures, as well as on Debian ppc64le (kernel 5.10.13-1).\n\nThe latest successfull strace build to rawhide was about 2 months ago:\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1658216\n\nThe kernel used for build there was\nLinux buildvm-ppc64le-38.iad2.fedoraproject.org 5.9.11-200.fc33.ppc64le #1 SMP Tue Nov 24 18:02:53 UTC 2020 ppc64le ppc64le ppc64le GNU/Linux"
															},
															{
																"isprivate": "0",
																"commentid": "14797189",
																"comment_count": "1",
																"who": {
																	"text": "esyr",
																	"name": "Eugene Syromiatnikov"
																},
																"bug_when": "2021-02-18 13:45:03 +0000",
																"thetext": "Fedora's 5.10.7-200.fc33.ppc64le (on buildvm-ppc64le-19.iad2.fedoraproject.org) was broken as well, for the record."
															},
															{
																"isprivate": "0",
																"commentid": "14868304",
																"comment_count": "2",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-03-14 00:26:35 +0000",
																"thetext": "I'd like to reiterate: this kernel bug breaks strace badly, making it almost unusable."
															},
															{
																"isprivate": "0",
																"commentid": "14942947",
																"comment_count": "3",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-04-07 16:25:50 +0000",
																"thetext": "This is the reason why the latest strace release didn't get into Fedora, see\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1711422\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1711415\n\nUntil this bug is fixed, no strace updates in Fedora are possible."
															},
															{
																"isprivate": "0",
																"commentid": "15061049",
																"comment_count": "4",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-05-14 10:20:36 +0000",
																"thetext": "Using the latest strace that can decode the structure returned by PTRACE_GETREGSET,\none can see that's wrong in the data returned by the kernel.\n\nLinux buildvm-ppc64le-22.iad2.fedoraproject.org 5.11.10-200.fc33.ppc64le\non exiting chdir(\"\") syscall did the following:\n\nptrace(PTRACE_GETREGSET, 702867, NT_PRSTATUS, {iov_base={gpr=[0xc, 0x7fffd8c3f250, 0x7fffa60b7000, 0xfffffffffffffffe, 0x7fffd8c3f158, 0, 0x8, 0x20, 0xfffffffe7fffffff, 0, 0, 0, 0, 0x7fffa615a390, 0, 0, 0, 0x7fffd8c3fa58, 0x7fffd8c3f308, 0x7fffd8c3f304, 0x1228f4f68, 0x1228f4fb0, 0xab98c, 0xab991, 0x7fffa61533a0, 0x1228f5180, 0x1228f51b8, 0x122910010, 0, 0xab98c, 0x7fffa5c6fff0, 0x100000], nip=0x7fffa5fb4ad4, msr=0x800000000000d033, orig_gpr3=0x1228f52e8, ctr=0, link=0, xer=0, ccr=0x44000278, softe=0x1, trap=0x3000, dar=0x7fffa5fb4aa8, dsisr=0x40000000, result=0xfffffffffffffffe, ...}, iov_len=384}) = 0\n\nAs you can see, unlike any normal ppc64le kernel, here ccr does not have 0x10000000 bit set, and gpr[3] equals to 0xfffffffffffffffe (== -2L) instead of expected 0x2 (== ENOENT).\nSo yes, this kernel has an obviously broken ptrace ABI.\n\nYou can find this and much more in the scratch build log at https://koji.fedoraproject.org/koji/taskinfo?taskID=67867999"
															},
															{
																"isprivate": "0",
																"commentid": "15061494",
																"comment_count": "5",
																"who": {
																	"text": "dan",
																	"name": "Dan Hork"
																},
																"bug_when": "2021-05-14 13:38:41 +0000",
																"thetext": "for the record, from my F-32 system (bare-metal Power9, not a VM) with kernel-5.11.19-100.fc32.ppc64le, strace built from master branch\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  905\n# SKIP:  97\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0"
															},
															{
																"isprivate": "0",
																"commentid": "15062263",
																"comment_count": "6",
																"who": {
																	"text": "dan",
																	"name": "Dan Hork"
																},
																"bug_when": "2021-05-14 18:02:11 +0000",
																"thetext": "and I get these from a rawhide VM with kernel-5.13.0-0.rc1.20210512git88b06399c9c7.15.fc35.ppc64le\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  232\n# SKIP:  102\n# XFAIL: 0\n# FAIL:  668\n# XPASS: 0\n# ERROR: 0\n\n\nbut in F-32 VM with kernel kernel-5.11.19-100.fc32.ppc64le everything looks good\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  905\n# SKIP:  97\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0\n============================================================================\nand I get the same good result in the F-32 VM with kernel-5.12.3-300.fc34.ppc64le\n\nF-32 VM with kernel-5.13.0-0.rc1.20210512git88b06399c9c7.15.fc35.ppc64le then gives\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  901\n# SKIP:  101\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0\n============================================================================\n\n\nIt makes me think that the failures are not related to the kernel version, but to something else in the rawhide buildroot, perhaps glibc?"
															},
															{
																"isprivate": "0",
																"commentid": "15062268",
																"comment_count": "7",
																"who": {
																	"text": "dan",
																	"name": "Dan Hork"
																},
																"bug_when": "2021-05-14 18:05:25 +0000",
																"thetext": "but kernel-headers-5.11.19-100.fc32.ppc64le was always used for the F-32 tests (if this should make the difference, will check ...)"
															},
															{
																"isprivate": "0",
																"commentid": "15062989",
																"comment_count": "8",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-05-15 01:03:06 +0000",
																"thetext": "(In reply to Dan Hork from comment #6)\n> It makes me think that the failures are not related to the kernel version,\n> but to something else in the rawhide buildroot, perhaps glibc?\n\nIf it's not the kernel but something else, then this something else is also capable of meddling both with struct ptrace_syscall_info returned by ptrace(PTRACE_GET_SYSCALL_INFO, pid, size, info) as described in the first comment, and with struct pt_regs returned by syscall(__NR_ptrace, PTRACE_GETREGSET, pid, NT_PRSTATUS, iov) in a very specific way described in #c4; in other words, this something is changing both ccr and gpr[3] in the kernel for all ptraced processes."
															},
															{
																"isprivate": "0",
																"commentid": "15074749",
																"comment_count": "9",
																"who": {
																	"text": "dan",
																	"name": "Dan Hork"
																},
																"bug_when": "2021-05-18 14:05:24 +0000",
																"thetext": "after updating to glibc-2.33.9000-6.fc35 in my F-32 VM, where the tests were passing, I get now the failures\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  232\n# SKIP:  102\n# XFAIL: 0\n# FAIL:  668\n# XPASS: 0\n# ERROR: 0\n============================================================================"
															},
															{
																"isprivate": "0",
																"commentid": "15076721",
																"comment_count": "10",
																"who": {
																	"text": "dan",
																	"name": "Dan Hork"
																},
																"bug_when": "2021-05-18 15:15:01 +0000",
																"thetext": "let's switch to glibc for their feedback ..."
															},
															{
																"isprivate": "0",
																"commentid": "15079009",
																"comment_count": "11",
																"who": {
																	"text": "fweimer",
																	"name": "Florian Weimer"
																},
																"bug_when": "2021-05-18 20:14:57 +0000",
																"thetext": "Is it possible to reproduce this issue with an already-built strace binary?\n\nWe added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to <sys/ptrace.h>, maybe that causes different execution paths in strace to be taken?"
															},
															{
																"isprivate": "0",
																"commentid": "15079018",
																"comment_count": "12",
																"who": {
																	"text": "codonell",
																	"name": "Carlos O'Donell"
																},
																"bug_when": "2021-05-18 20:19:39 +0000",
																"thetext": "(In reply to Florian Weimer from comment #11)\n> Is it possible to reproduce this issue with an already-built strace binary?\n> \n> We added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to\n> <sys/ptrace.h>, maybe that causes different execution paths in strace to be\n> taken?\n\nWe also have the 'sc' vs. 'svc' instruction selection in the same timeframe for power?"
															},
															{
																"isprivate": "0",
																"commentid": "15079022",
																"comment_count": "13",
																"who": {
																	"text": "codonell",
																	"name": "Carlos O'Donell"
																},
																"bug_when": "2021-05-18 20:20:48 +0000",
																"thetext": "(In reply to Carlos O'Donell from comment #12)\n> (In reply to Florian Weimer from comment #11)\n> > Is it possible to reproduce this issue with an already-built strace binary?\n> > \n> > We added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to\n> > <sys/ptrace.h>, maybe that causes different execution paths in strace to be\n> > taken?\n> \n> We also have the 'sc' vs. 'svc' instruction selection in the same timeframe\n> for power?\n\nSorry, 'scv'."
															},
															{
																"isprivate": "0",
																"commentid": "15079274",
																"comment_count": "14",
																"who": {
																	"text": "codonell",
																	"name": "Carlos O'Donell"
																},
																"bug_when": "2021-05-18 21:16:04 +0000",
																"thetext": "A recent scratch build failed on a POWER9 box, which would be the hardware under which glibc would switch to 'scv' for syscalls.\n\nJust two quick snippets:\n\n--- exp 2021-05-18 20:26:11.715277248 +0000\n+++ log 2021-05-18 20:26:11.715277248 +0000\n-chdir(0x7fffb053ffe0) = -1 EFAULT (Bad address)\n-chdir(0x7fffb053ffe1) = -1 EFAULT (Bad address)\n+chdir(0x7fffb053ffe0) = 18446744073709551602\n+chdir(0x7fffb053ffe1) = 18446744073709551602\nFAIL printpath-umovestr-legacy.test (exit status: 1)\nFAIL: printstrn-umoven-legacy\n\n--- exp 2021-05-18 20:26:44.524009554 +0000\n+++ log 2021-05-18 20:26:44.524009554 +0000\n@@ -1,2 +1,2 @@\n-writev(-1, [{iov_base=\"\", iov_len=0}, {iov_base=\"f\", iov_len=1}, {iov_base=\"ef\", iov_len=2}, {iov_base=\"def\", iov_len=3}, {iov_base=\"cdef\", iov_len=4}, {iov_base=\"bcdef\", iov_len=5}, {iov_base=\"abcdef\", iov_len=6}, {iov_base=\"zabcdef\", iov_len=7}, {iov_base=\"yzabcdef\", iov_len=8}, {iov_base=\"xyzabcdef\", iov_len=9}, {iov_base=\"wxyzabcdef\", iov_len=10}, {iov_base=\"vwxyzabcdef\", iov_len=11}, {iov_base=\"uvwxyzabcdef\", iov_len=12}, {iov_base=\"tuvwxyzabcdef\", iov_len=13}, {iov_base=\"stuvwxyzabcdef\", iov_len=14}, {iov_base=\"rstuvwxyzabcdef\", iov_len=15}, {iov_base=\"qrstuvwxyzabcdef\", iov_len=16}, {iov_base=\"pqrstuvwxyzabcdef\", iov_len=17}, {iov_base=\"opqrstuvwxyzabcdef\", iov_len=18}, {iov_base=\"nopqrstuvwxyzabcdef\", iov_len=19}, {iov_base=\"mnopqrstuvwxyzabcdef\", iov_len=20}, {iov_base=\"lmnopqrstuvwxyzabcdef\", iov_len=21}, {iov_base=\"klmnopqrstuvwxyzabcdef\", iov_len=22}, {iov_base=\"jklmnopqrstuvwxyzabcdef\", iov_len=23}, {iov_base=\"ijklmnopqrstuvwxyzabcdef\", iov_len=24}, {iov_base=\"hijklmnopqrstuvwxyzabcdef\", iov_len=25}, {iov_base=\"ghijklmnopqrstuvwxyzabcdef\", iov_len=26}, {iov_base=\"fghijklmnopqrstuvwxyzabcdef\", iov_len=27}, {iov_base=\"efghijklmnopqrstuvwxyzabcdef\", iov_len=28}, {iov_base=\"defghijklmnopqrstuvwxyzabcdef\", iov_len=29}, {iov_base=\"cdefghijklmnopqrstuvwxyzabcdef\", iov_len=30}, {iov_base=\"bcdefghijklmnopqrstuvwxyzabcdef\", iov_len=31}], 32) = -1 EBADF (Bad file descriptor)\n+writev(-1, [{iov_base=\"\", iov_len=0}, {iov_base=\"f\", iov_len=1}, {iov_base=\"ef\", iov_len=2}, {iov_base=\"def\", iov_len=3}, {iov_base=\"cdef\", iov_len=4}, {iov_base=\"bcdef\", iov_len=5}, {iov_base=\"abcdef\", iov_len=6}, {iov_base=\"zabcdef\", iov_len=7}, {iov_base=\"yzabcdef\", iov_len=8}, {iov_base=\"xyzabcdef\", iov_len=9}, {iov_base=\"wxyzabcdef\", iov_len=10}, {iov_base=\"vwxyzabcdef\", iov_len=11}, {iov_base=\"uvwxyzabcdef\", iov_len=12}, {iov_base=\"tuvwxyzabcdef\", iov_len=13}, {iov_base=\"stuvwxyzabcdef\", iov_len=14}, {iov_base=\"rstuvwxyzabcdef\", iov_len=15}, {iov_base=\"qrstuvwxyzabcdef\", iov_len=16}, {iov_base=\"pqrstuvwxyzabcdef\", iov_len=17}, {iov_base=\"opqrstuvwxyzabcdef\", iov_len=18}, {iov_base=\"nopqrstuvwxyzabcdef\", iov_len=19}, {iov_base=\"mnopqrstuvwxyzabcdef\", iov_len=20}, {iov_base=\"lmnopqrstuvwxyzabcdef\", iov_len=21}, {iov_base=\"klmnopqrstuvwxyzabcdef\", iov_len=22}, {iov_base=\"jklmnopqrstuvwxyzabcdef\", iov_len=23}, {iov_base=\"ijklmnopqrstuvwxyzabcdef\", iov_len=24}, {iov_base=\"hijklmnopqrstuvwxyzabcdef\", iov_len=25}, {iov_base=\"ghijklmnopqrstuvwxyzabcdef\", iov_len=26}, {iov_base=\"fghijklmnopqrstuvwxyzabcdef\", iov_len=27}, {iov_base=\"efghijklmnopqrstuvwxyzabcdef\", iov_len=28}, {iov_base=\"defghijklmnopqrstuvwxyzabcdef\", iov_len=29}, {iov_base=\"cdefghijklmnopqrstuvwxyzabcdef\", iov_len=30}, {iov_base=\"bcdefghijklmnopqrstuvwxyzabcdef\", iov_len=31}], 32) = 18446744073709551607\nFAIL umovestr_cached.test (exit status: 1)\n\nThe last successful strace build is with glibc-2.32.9000-20.fc34.ppc64le, which is ~4 builds before 'scv' is introduced.\n\nAll builds after 'scv' is introduced in glibc-2.32.9000-24 (2021-01-08) appear to fail.\n\nI don't see any 'scv' enablement in strace for ppc64le."
															},
															{
																"isprivate": "0",
																"commentid": "15079276",
																"comment_count": "15",
																"who": {
																	"text": "tulioqm",
																	"name": "Tulio Magno Quites Machado Filho"
																},
																"bug_when": "2021-05-18 21:18:21 +0000",
																"thetext": "(In reply to Carlos O'Donell from comment #14)\n> I don't see any 'scv' enablement in strace for ppc64le.\n\nI agree with you. strace upstream is missing support for scv.\ne.g. in this function https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\nWe can't trust on the value of CR0 anymore.  An error is returned when r3 is negative."
															},
															{
																"isprivate": "0",
																"commentid": "15079396",
																"comment_count": "16",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-05-18 22:40:03 +0000",
																"thetext": "(In reply to Tulio Magno Quites Machado Filho from comment #15)\n> (In reply to Carlos O'Donell from comment #14)\n> > I don't see any 'scv' enablement in strace for ppc64le.\n> \n> I agree with you. strace upstream is missing support for scv.\n> e.g. in this function\n> https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n> We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> negative.\n\nDoes this mean that the kernel function syscall_get_error and all its users including PTRACE_GET_SYSCALL_INFO API is broken when scv is used?"
															},
															{
																"isprivate": "0",
																"commentid": "15079417",
																"comment_count": "17",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-05-18 22:56:59 +0000",
																"thetext": "(In reply to Dmitry V. Levin from comment #16)\n> (In reply to Tulio Magno Quites Machado Filho from comment #15)\n> > (In reply to Carlos O'Donell from comment #14)\n> > > I don't see any 'scv' enablement in strace for ppc64le.\n> > \n> > I agree with you. strace upstream is missing support for scv.\n> > e.g. in this function\n> > https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n> > We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> > negative.\n> \n> Does this mean that the kernel function syscall_get_error and all its users\n> including PTRACE_GET_SYSCALL_INFO API are broken when scv is used?\n\nLooks like the answer is yes, the kernel commit v5.9-rc1~100^2~164 that introduced scv support was incomplete, all users of ccr in arch/powerpc/include/asm/ptrace.h and arch/powerpc/include/asm/syscall.h are broken when scv is used.\n\nSo while the idea of changing the error handling convention is questionable,\nthe bug is on the kernel side that failed to implement the new error handling convention."
															},
															{
																"isprivate": "0",
																"commentid": "15079459",
																"comment_count": "18",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-05-18 23:32:22 +0000",
																"thetext": "(In reply to Tulio Magno Quites Machado Filho from comment #15)\n> (In reply to Carlos O'Donell from comment #14)\n> > I don't see any 'scv' enablement in strace for ppc64le.\n> \n> I agree with you. strace upstream is missing support for scv.\n> e.g. in this function\n> https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n\nPlease note that this file is not used when PTRACE_GET_SYSCALL_INFO is working properly,\nthere is a runtime test for this, see\n\n$ strace -d -enone / 2>&1 |grep PTRACE_GET_SYSCALL_INFO\n\nHowever, there is going to be an issue with src/linux/powerpc/set_error.c and its users, e.g. syscall tampering.\n\n> We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> negative.\n\nI hope somebody who knows scv semantics would contribute missing parts of scv support to strace and the kernel before strace is kicked out from Fedora due to ftbfs."
															},
															{
																"isprivate": "0",
																"commentid": "15084949",
																"comment_count": "19",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-05-20 03:47:43 +0000",
																"thetext": "There was a short discussion in linux-api mailing list that identified two bugs:\n1. incomplete scv abi support in the kernel that breaks users of asm/syscall.h and asm/ptrace.h, these users include ptrace, tracing, and audit subsystems; detected by hundereds of tests from the strace test suite, proposed patch can be found at https://lore.kernel.org/linux-api/1621385544.nttlk5qugb.astroid@bobo.none/ ;\n2. a glibc bug detected by signal test from the strace test suite, proposed patch can be found at https://lore.kernel.org/linux-api/1621400263.gf0mbqhkrf.astroid@bobo.none/ .\n\nFeel free to split this bug report into two if necessary."
															},
															{
																"isprivate": "0",
																"commentid": "15088583",
																"comment_count": "20",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-05-20 23:06:30 +0000",
																"thetext": "Since the glibc bug is now tracked by #1962971, switching this bug back to the kernel component.\n\nMeanwhile, Nicholas Piggin submitted a patch that's likely to be the final, see\nhttps://lore.kernel.org/linuxppc-dev/20210520111931.2597127-2-npiggin@gmail.com/\n\nI'd like to remind that this bug was found by strace test suite and it blocks strace updates in Fedora.\n\nI hope the fix will be applied before strace is kicked out from Fedora due to ftbfs which is 19 weeks already."
															},
															{
																"isprivate": "0",
																"commentid": "15093123",
																"comment_count": "21",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-05-23 17:43:31 +0000",
																"thetext": "(In reply to Dmitry V. Levin from comment #20)\n> Meanwhile, Nicholas Piggin submitted a patch that's likely to be the final,\n> see\n> https://lore.kernel.org/linuxppc-dev/20210520111931.2597127-2-npiggin@gmail.\n> com/\n\nThis patch has been merged upstream, see\nhttps://git.kernel.org/torvalds/c/d72500f992849d31ebae8f821a023660ddd0dcc2"
															},
															{
																"isprivate": "0",
																"commentid": "15095587",
																"comment_count": "22",
																"who": {
																	"text": "jforbes",
																	"name": "Justin M. Forbes"
																},
																"bug_when": "2021-05-24 14:19:12 +0000",
																"thetext": "That should be in the 5.13-rc3 build today for rawhide. I have also cherry picked it for 5.12, so it should land in stable fedora with 5.12.7 and newer."
															},
															{
																"isprivate": "0",
																"commentid": "15185392",
																"comment_count": "23",
																"who": {
																	"text": "dan",
																	"name": "Dan Hork"
																},
																"bug_when": "2021-06-14 15:35:34 +0000",
																"thetext": "Dmitry, is there still something blocking you from updating strace? I believe we already have all the kernel/glibc bits included for F-34+."
															},
															{
																"isprivate": "0",
																"commentid": "15195017",
																"comment_count": "24",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-06-16 12:06:57 +0000",
																"thetext": "Everything should have been fixed now, but I cannot tell for sure because something else is broken: a scratch build of strace HEAD failed with the following diagnostics: BuildrootError: could not init mock buildroot, mock exited with status 30; see root.log for more information\n\nThe corresponding root.log contains the following diagnostics:\nDEBUG util.py:444:  Error: \nDEBUG util.py:444:   Problem: package util-linux-2.37-2.fc35.x86_64 requires util-linux-core = 2.37-2.fc35, but none of the providers can be installed\nDEBUG util.py:444:    - conflicting requests\nDEBUG util.py:444:    - nothing provides libpcre2-posix.so.2()(64bit) needed by util-linux-core-2.37-2.fc35.x86_64\nDEBUG util.py:446:  (try to add '--skip-broken' to skip uninstallable packages)\nDEBUG util.py:598:  Child return code was: 1\n\nThis looks as if all builds to fc35 are currently broken.\nFor more details see the scratch build task: https://koji.fedoraproject.org/koji/taskinfo?taskID=70224999"
															},
															{
																"isprivate": "0",
																"commentid": "15195062",
																"comment_count": "25",
																"who": {
																	"text": "dan",
																	"name": "Dan Hork"
																},
																"bug_when": "2021-06-16 12:17:33 +0000",
																"thetext": "The buildroot should be OK again, there was a pcre2 update with unexpected consequences, but it has been untagged."
															},
															{
																"isprivate": "0",
																"commentid": "15195850",
																"comment_count": "26",
																"who": {
																	"text": "dan",
																	"name": "Dan Hork"
																},
																"bug_when": "2021-06-16 14:59:25 +0000",
																"thetext": "for the record, my local F-34 rebuild of strace HEAD with kernel-5.12.10-300.fc34.ppc64le and glibc-2.33-16.fc34.ppc64le was successful"
															},
															{
																"isprivate": "0",
																"commentid": "15197009",
																"comment_count": "27",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-06-16 23:19:42 +0000",
																"thetext": "(In reply to Dan Hork from comment #26)\n> for the record, my local F-34 rebuild of strace HEAD with\n> kernel-5.12.10-300.fc34.ppc64le and glibc-2.33-16.fc34.ppc64le was successful\n\nMy scratch build to fc34 was successful, too:\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=70227524"
															},
															{
																"isprivate": "0",
																"commentid": "16610110",
																"comment_count": "28",
																"who": {
																	"text": "mcermak",
																	"name": "Martin Cermak"
																},
																"bug_when": "2022-09-05 08:05:57 +0000",
																"thetext": "Maybe this one could be flipped to MODIFIED or further?  Thanks!"
															},
															{
																"isprivate": "0",
																"commentid": "16610124",
																"comment_count": "29",
																"who": {
																	"text": "dan",
																	"name": "Dan Hork"
																},
																"bug_when": "2022-09-05 08:10:08 +0000",
																"thetext": "It was fixed long time ago, closing."
															}
														]
													},
													{
														"bug_id": "1962971",
														"creation_ts": "2021-05-20 22:54:06 +0000",
														"short_desc": "glibc: ppc64le: scv ABI error handling fails to check IS_ERR_VALUE",
														"delta_ts": "2021-07-06 13:32:49 +0000",
														"bug_status": "CLOSED",
														"resolution": "ERRATA",
														"keywords": "BetaBlocker",
														"priority": "unspecified",
														"bug_severity": "urgent",
														"depends_on": [
															"1071880"
														],
														"blocked": [
															{
																"bug_id": "1930252",
																"error": "NotPermitted"
															},
															{
																"bug_id": "1963901",
																"creation_ts": "2021-05-24 11:10:27 +0000",
																"short_desc": "RHEL9 - ppc64le: glibc fails to check IS_ERR_VALUE when using scv",
																"delta_ts": "2023-07-18 14:29:19 +0000",
																"bug_status": "CLOSED",
																"resolution": "CURRENTRELEASE",
																"keywords": "Bugfix, Patch, Triaged",
																"priority": "unspecified",
																"bug_severity": "high",
																"depends_on": [
																	"1962971"
																],
																"blocked": [
																	{
																		"bug_id": "1875375",
																		"error": "NotPermitted"
																	}
																],
																"external_bugs": {
																	"text": "27892",
																	"name": "Sourceware"
																},
																"long_desc": [
																	{
																		"isprivate": "0",
																		"commentid": "15094789",
																		"comment_count": "0",
																		"who": {
																			"text": "bugproxy",
																			"name": "IBM Bug Proxy"
																		},
																		"bug_when": "2021-05-24 11:10:27 +0000"
																	},
																	{
																		"isprivate": "0",
																		"commentid": "15094790",
																		"comment_count": "1",
																		"who": {
																			"text": "bugproxy",
																			"name": "IBM Bug Proxy"
																		},
																		"bug_when": "2021-05-24 11:10:35 +0000",
																		"thetext": "== Comment: #0 - Tulio Magno Quites Machado Filho <tulioqm@br.ibm.com> - 2021-05-21 16:11:35 ==\n---Problem Description---\nglibc fails to check IS_ERR_VALUE when using scv.\n\nThis bug has been reported upstream as: https://sourceware.org/bugzilla/show_bug.cgi?id=27892\n\nIt has also been reported for Fedora 35: https://bugzilla.redhat.com/show_bug.cgi?id=1962971\n \nContact Information = Tulio Magno Quites Machado Filho/tulioqm@br.ibm.com \n \n---Additional Hardware Info---\nA POWER9 or POWER10 server with support for scv is required to reproduce the error.\n\n\n---Steps to Reproduce---\n 1. Build strace and its tests.\n 2. Run test tests/signal\n \nUserspace rpm: glibc \n \nThe userspace tool has the following bit modes: 64-bit"
																	},
																	{
																		"isprivate": "0",
																		"commentid": "15103462",
																		"comment_count": "6",
																		"who": {
																			"text": "fweimer",
																			"name": "Florian Weimer"
																		},
																		"bug_when": "2021-05-25 17:37:12 +0000",
																		"thetext": "Merge request: https://gitlab.com/redhat/centos-stream/rpms/glibc/-/merge_requests/11"
																	},
																	{
																		"isprivate": "0",
																		"commentid": "15103633",
																		"comment_count": "7",
																		"who": {
																			"text": "bugproxy",
																			"name": "IBM Bug Proxy"
																		},
																		"bug_when": "2021-05-25 17:47:07 +0000",
																		"thetext": "------- Comment From tulioqm@br.ibm.com 2021-05-24 10:12 EDT-------\n> May we make this bug report public? Thanks.\n\nYes, but I don't know how to do this.\nCould you help me, please?"
																	}
																]
															}
														],
														"external_bugs": {
															"text": "27892",
															"name": "Sourceware"
														},
														"long_desc": [
															{
																"isprivate": "0",
																"commentid": "15088572",
																"comment_count": "0",
																"who": {
																	"text": "ldv",
																	"name": "Dmitry V. Levin"
																},
																"bug_when": "2021-05-20 22:54:06 +0000",
																"thetext": "+++ This bug was initially created as a clone of Bug #1929836 +++\n\nThe scv ABI introduced by glibc-2.32.9000-24 at 2021-01-08 has the following bug: RET_SCV macro (added by upstream commit glibc-2.33~117) treats any negative value returned by syscall via scv ABI as an error, but this is not correct.\n\nProposed fix was posted by Nicholas Piggin at\nhttps://sourceware.org/pipermail/libc-alpha/2021-May/126534.html\n\nThis bug was found by strace test suite and it blocks strace updates in Fedora.\n\nI hope the fix will be applied before strace is kicked out from Fedora due to ftbfs which is 19 weeks already."
															},
															{
																"isprivate": "0",
																"commentid": "15138481",
																"comment_count": "1",
																"who": {
																	"text": "updates",
																	"name": "Fedora Update System"
																},
																"bug_when": "2021-06-01 13:46:20 +0000",
																"thetext": "FEDORA-2021-abbb0d8a88 has been submitted as an update to Fedora 34. https://bodhi.fedoraproject.org/updates/FEDORA-2021-abbb0d8a88"
															},
															{
																"isprivate": "0",
																"commentid": "15138487",
																"comment_count": "2",
																"who": {
																	"text": "codonell",
																	"name": "Carlos O'Donell"
																},
																"bug_when": "2021-06-01 13:47:36 +0000",
																"thetext": "This fix is currently pending the Fedora Rawhide sync with the upstream development branch.\n\nThe fix is going into Fedora 34 with the next errata going through bodhi."
															},
															{
																"isprivate": "0",
																"commentid": "15140578",
																"comment_count": "3",
																"who": {
																	"text": "updates",
																	"name": "Fedora Update System"
																},
																"bug_when": "2021-06-02 01:41:09 +0000",
																"thetext": "FEDORA-2021-abbb0d8a88 has been pushed to the Fedora 34 testing repository.\nSoon you'll be able to install the update with the following command:\n`sudo dnf upgrade --enablerepo=updates-testing --advisory=FEDORA-2021-abbb0d8a88`\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2021-abbb0d8a88\n\nSee also https://fedoraproject.org/wiki/QA:Updates_Testing for more information on how to test updates."
															},
															{
																"isprivate": "0",
																"commentid": "15144856",
																"comment_count": "4",
																"who": {
																	"text": "updates",
																	"name": "Fedora Update System"
																},
																"bug_when": "2021-06-03 01:01:07 +0000",
																"thetext": "FEDORA-2021-abbb0d8a88 has been pushed to the Fedora 34 stable repository.\nIf problem still persists, please make note of it in this bug report."
															},
															{
																"isprivate": "0",
																"commentid": "15194139",
																"comment_count": "5",
																"who": {
																	"text": "updates",
																	"name": "Fedora Update System"
																},
																"bug_when": "2021-06-16 08:27:59 +0000",
																"thetext": "FEDORA-2021-9ce0f65a09 has been pushed to the Fedora 35 stable repository.\nIf problem still persists, please make note of it in this bug report."
															}
														]
													}
												],
												"long_desc": [
													{
														"isprivate": "0",
														"commentid": "6873212",
														"comment_count": "0",
														"who": {
															"text": "karsten",
															"name": "Karsten Hopp"
														},
														"bug_when": "2014-03-03 11:41:52 +0000",
														"thetext": "Description of problem:\nThis is a tracker for bugzillas and patches related to the PowerPC (ppc, ppc64) architectures.\n\nppc64le has its own tracker: bug 1051573"
													},
													{
														"isprivate": "0",
														"commentid": "10293511",
														"comment_count": "1",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2017-03-31 08:51:19 +0000",
														"thetext": "*** Bug 1051573 has been marked as a duplicate of this bug. ***"
													},
													{
														"isprivate": "0",
														"commentid": "10293516",
														"comment_count": "2",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2017-03-31 08:52:39 +0000",
														"thetext": "add open bugs from the ppc64le tracker"
													},
													{
														"isprivate": "0",
														"commentid": "13402189",
														"comment_count": "3",
														"who": {
															"text": "bcotton",
															"name": "Ben Cotton"
														},
														"bug_when": "2019-11-27 14:16:33 +0000",
														"thetext": "Fedora 29 changed to end-of-life (EOL) status on 2019-11-26. Fedora 29 is\nno longer maintained, which means that it will not receive any further\nsecurity or bug fix updates. As a result we are closing this bug.\n\nIf you can reproduce this bug against a currently maintained version of\nFedora please feel free to reopen this bug against that version. If you\nare unable to reopen this bug, please file a new report against the\ncurrent release. If you experience problems, please add a comment to this\nbug.\n\nThank you for reporting this bug and we are sorry it could not be fixed."
													},
													{
														"isprivate": "0",
														"commentid": "13403192",
														"comment_count": "4",
														"who": {
															"text": "bcotton",
															"name": "Ben Cotton"
														},
														"bug_when": "2019-11-27 16:41:04 +0000",
														"thetext": "This bug was accidentally closed due to a query error. Reopening."
													}
												]
											}
										],
										"long_desc": [
											{
												"isprivate": "0",
												"commentid": "10225644",
												"comment_count": "0",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2017-03-09 16:33:28 +0000"
											}
										]
									}
								],
								"long_desc": [
									{
										"isprivate": "0",
										"commentid": "10344739",
										"comment_count": "0",
										"who": {
											"text": "menantea",
											"name": "Menanteau Guy"
										},
										"bug_when": "2017-04-19 08:31:04 +0000",
										"thetext": "openQA \"upgrade\" tests failed on ppc64 and ppc64le architectures with f26 nigthly compose since 20170417.\nhttps://kojipkgs.fedoraproject.org/compose/branched/Fedora-26-20170417.n.0/...\n-> with new krb5-libs-1.15.1-6\n\nThere was no problem on compose of 20170416 and before (with krb5-libs-1.15.1-3)\n\nFailing tests:\nhttps://fedoraproject.org/wiki/QA:Testcase_upgrade_dnf_current_server\nhttps://fedoraproject.org/wiki/QA:Testcase_upgrade_dnf_current_minimal\nhttps://fedoraproject.org/wiki/QA:Testcase_upgrade_dnf_previous_server\nhttps://fedoraproject.org/wiki/QA:Testcase_upgrade_dnf_previous_minimal\n\nI analysed specifically the QA:Testcase_upgrade_dnf_current_server (upgrade from f25 to f26) and I got a guest stuck (unable to pass any command at console) during the command:\n\"dnf system-upgrade reboot\"\n\nI can see in the log that the last trace of dnf.rpm.log is:\nINFO Cleanup: crypto-policies-20160921-4.gitf3018dd.fc25.noarch\nthen everything get stuck and I am not able to access anymore to the guest.\n\nOn normal behaviour, I have seen that the Cleanup just after the crypto-policies is the krb5-libs so I guessed the problems occurs during the krb5-libs Cleanup phase.\n\nI tried to execute the test without the upgrade of krb5-libs by adding the option:\nexclude=krb5-libs\nin the fedora.repo used by dnf. The upgrade process went to the end without any problem (and without updating krb5-libs). This make me feel the new krb5-libs is the one responsible of the freeze. \nNote that I was able to install then the krb5-libs-1.15.1-6 successfully after the upgrade."
									},
									{
										"isprivate": "0",
										"commentid": "10345353",
										"comment_count": "1",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-04-19 11:24:17 +0000",
										"thetext": "We saw a similar case (arch agnostic) with texlive, where a scriptlet was wrong and entered an endless loop. Guy, can't you check from console if there is something running when the dnf update process is stuck?"
									},
									{
										"isprivate": "0",
										"commentid": "10345909",
										"comment_count": "2",
										"who": {
											"text": "menantea",
											"name": "Menanteau Guy"
										},
										"bug_when": "2017-04-19 13:41:43 +0000",
										"thetext": "Dan, unfortunately I didn't find a way to do that. After the \"dnf system-upgrade reboot\", the upgrade process takes the focus of the console on the boot screen and I am not able to use this console or to connect to the guest."
									},
									{
										"isprivate": "0",
										"commentid": "10346937",
										"comment_count": "3",
										"who": {
											"text": "rharwood",
											"name": "Robbie Harwood"
										},
										"bug_when": "2017-04-19 18:29:24 +0000",
										"thetext": "Well, that's odd.  I don't know why it would hang here; there isn't anything that can loop.  The only change from -4 to -6 is the addition of this trigger https://github.com/frozencemetery/krb5_fedora/blob/master/krb5.spec#L515-L529 so I assume it's hanging there.\n\nYou mention it's failing on ppc64{,le}; if it's not failing on any other architectures, I don't think this is a krb5 problem (maybe dnf?)."
									},
									{
										"isprivate": "0",
										"commentid": "10349640",
										"comment_count": "4",
										"who": {
											"text": "menantea",
											"name": "Menanteau Guy"
										},
										"bug_when": "2017-04-20 12:54:07 +0000",
										"thetext": "ok I will try to add code to get a trace of what is running by krb5 at reboot during the \"system-upgrade\" to see if krb5 is involved."
									},
									{
										"isprivate": "0",
										"commentid": "10350137",
										"comment_count": "5",
										"who": {
											"text": "pwhalen",
											"name": "Paul Whalen"
										},
										"bug_when": "2017-04-20 14:33:12 +0000",
										"thetext": "I'm hitting this on aarch64 and armhfp during server upgrade. Seemingly hanging during cleanup of 'crypto-policies-20160921-4.gitf3018dd.fc25.noarch'\n\narmhfp:\n[968/1030] Cleanup gzip-1.8-1.fc25.armv7hl...\n[969/1030] Cleanup crypto-policies-20160921-4.gitf3018dd.fc25.noarch...\n[970/1030] Cleanup krb5-libs-1.14.4-7.fc25.armv7hl...\n\naarch64:\n[979/1118] Cleanup python3-libs-3.5.3-4.fc25.aarch64...\n[980/1118] Cleanup system-python-libs-3.5.3-4.fc25.aarch64...\n[981/1118] Cleanup crypto-policies-20160921-4.gitf3018dd.fc25.noarch..."
									},
									{
										"isprivate": "0",
										"commentid": "10350499",
										"comment_count": "6",
										"who": {
											"text": "rharwood",
											"name": "Robbie Harwood"
										},
										"bug_when": "2017-04-20 15:46:56 +0000",
										"thetext": "That's interesting: you're both on an older version of Fedora, and seeing this on different packages.  Let's ask the dnf folks."
									},
									{
										"isprivate": "0",
										"commentid": "10364045",
										"comment_count": "7",
										"who": {
											"text": "ignatenko",
											"name": "Igor Gnatenko"
										},
										"bug_when": "2017-04-26 10:54:13 +0000",
										"thetext": "you could run --rpmverbosity=debug and see what's going on there.."
									},
									{
										"isprivate": "0",
										"commentid": "10365579",
										"comment_count": "8",
										"who": {
											"text": "pwhalen",
											"name": "Paul Whalen"
										},
										"bug_when": "2017-04-26 17:02:56 +0000",
										"thetext": "Created attachment 1274331\ndnf rpm log\n\nUpgrade attempted with:\n\ndnf system-upgrade download --releasever=26 --debuglevel 9 --rpmverbosity=debug\ndnf system-upgrade --debuglevel 9 --rpmverbosity=debug reboot\n\nLogs attached."
									},
									{
										"isprivate": "0",
										"commentid": "10365583",
										"comment_count": "9",
										"who": {
											"text": "pwhalen",
											"name": "Paul Whalen"
										},
										"bug_when": "2017-04-26 17:03:37 +0000",
										"thetext": "Created attachment 1274333\ndnf.log"
									},
									{
										"isprivate": "0",
										"commentid": "10372931",
										"comment_count": "10",
										"who": {
											"text": "pwhalen",
											"name": "Paul Whalen"
										},
										"bug_when": "2017-04-28 16:30:40 +0000",
										"thetext": "Created attachment 1274977\ntruncated strace log with maxcpus=1\n\nThis hang is also reproducible with 'dnf distro-sync --releasever=26' and allows for network access for troubleshooting. \n\nIt does not always happen with the same package during Cleanup, and can also occur during the 'Upgrade' phase. When it does hang, it ends with 'FUTEX_WAIT' even when limiting maxcpus=1."
									},
									{
										"isprivate": "0",
										"commentid": "10372982",
										"comment_count": "11",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-04-28 16:42:13 +0000",
										"thetext": "Hanging in the futex(FUTEX_WAIT) syscall often means a deadlock situation in a multi-threaded application ... The kernel bug with the same symptom should be fixed for a long time."
									},
									{
										"isprivate": "0",
										"commentid": "10373666",
										"comment_count": "12",
										"who": {
											"text": "pwhalen",
											"name": "Paul Whalen"
										},
										"bug_when": "2017-04-28 20:00:06 +0000",
										"thetext": "Also reproducible by attempting to upgrade dnf and deps to f26\n\ndnf --releasever=26 update dnf -y\n...\n Installing  : libXft-2.3.2-5.fc26.aarch64                              60/127 \n Installing  : tk-1:8.6.6-1.fc26.aarch64                                61/127 \n Installing  : python35-3.5.2-9.fc26.aarch64                            62/127 \n\n\n\n[root@mustang ~]# strace -f -p 1030\nstrace: Process 1030 attached\nfutex(0xffff8fc717d0, FUTEX_WAIT, 2, NULL\n\n\nUpgrading dnf was successful 5/6 attempts. After dnf is upgraded, distro-sync completed 5/5."
									},
									{
										"isprivate": "0",
										"commentid": "10376681",
										"comment_count": "13",
										"who": {
											"text": "pwhalen",
											"name": "Paul Whalen"
										},
										"bug_when": "2017-05-01 17:09:44 +0000",
										"thetext": "Proposing as a blocker for Beta, criteria:\n\n\"... it must be possible to successfully complete a direct upgrade from fully updated installations of the last two stable Fedora releases with that package set installed.\""
									},
									{
										"isprivate": "0",
										"commentid": "10376903",
										"comment_count": "14",
										"who": {
											"text": "gmarr",
											"name": "Geoffrey Marr"
										},
										"bug_when": "2017-05-01 18:38:49 +0000",
										"thetext": "Discussed during the 2017-05-01 blocker review meeting: [1]\n\nThe decision to classify this bug as an AcceptedBlocker was made as it violates the following blocker criteria:\n\n\"... it must be possible to successfully complete a direct upgrade from fully updated installations of the last two stable Fedora releases with that package set installed.\"\n\n[1] https://meetbot.fedoraproject.org/fedora-blocker-review/2017-05-01/f26-blocker-review.2017-05-01-16.02.txt"
									},
									{
										"isprivate": "0",
										"commentid": "10381943",
										"comment_count": "15",
										"who": {
											"text": "ignatenko",
											"name": "Igor Gnatenko"
										},
										"bug_when": "2017-05-03 11:44:13 +0000",
										"thetext": "*** Bug 1443610 has been marked as a duplicate of this bug. ***"
									},
									{
										"isprivate": "0",
										"commentid": "10418991",
										"comment_count": "16",
										"who": {
											"text": "code",
											"name": "Daniel"
										},
										"bug_when": "2017-05-17 02:19:21 +0000",
										"thetext": "Also a problem when upgrading on armhfp."
									},
									{
										"isprivate": "0",
										"commentid": "10420719",
										"comment_count": "17",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-05-17 11:54:52 +0000",
										"thetext": "s390x is affected as well"
									},
									{
										"isprivate": "0",
										"commentid": "10440948",
										"comment_count": "18",
										"who": {
											"text": "awilliam",
											"name": "Adam Williamson"
										},
										"bug_when": "2017-05-23 17:03:19 +0000",
										"thetext": "So Igor says this is basically https://bugzilla.redhat.com/show_bug.cgi?id=1394862 , which upstream has a possible fix for. He has done F25 and F26 scratch builds with the fix:\n\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=19706601\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=19706649\n\ncan affected folks on armhfp please test in the following way?\n\n1) Install the patched F25 scratch build\n2) Do your upgrade in such a way that the patched F26 scratch build will be included\n\nIn other words, the fix needs to be applied 'at both ends'.\n\nDue to Koji's F25 config, there are no builds for aarch64 or ppc64 - if you want to test on those arches you'll have to grab the SRPM and rebuild it. To test on s390 you'll have to rebuild both F25 and F26 from SRPM."
									},
									{
										"isprivate": "0",
										"commentid": "10441464",
										"comment_count": "19",
										"who": {
											"text": "pwhalen",
											"name": "Paul Whalen"
										},
										"bug_when": "2017-05-23 20:37:11 +0000",
										"thetext": "using those scratch builds, f25 minimal successfully upgraded to f26 on armhfp."
									},
									{
										"isprivate": "0",
										"commentid": "10441649",
										"comment_count": "20",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2017-05-23 22:43:13 +0000",
										"thetext": "libdb-5.3.28-18.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
									},
									{
										"isprivate": "0",
										"commentid": "10441652",
										"comment_count": "21",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2017-05-23 22:43:59 +0000",
										"thetext": "libdb-5.3.28-18.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf"
									},
									{
										"isprivate": "0",
										"commentid": "10441654",
										"comment_count": "22",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2017-05-23 22:44:22 +0000",
										"thetext": "libdb-5.3.28-18.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
									},
									{
										"isprivate": "0",
										"commentid": "10441656",
										"comment_count": "23",
										"who": {
											"text": "awilliam",
											"name": "Adam Williamson"
										},
										"bug_when": "2017-05-23 22:44:50 +0000",
										"thetext": "Thanks. I've now submitted official updates for 24, 25 and 26 with the patch applied. If more folks could test and confirm the fix (and provide karma on the updates), that'd be great. We should ensure all three updates are pushed stable before closing this bug."
									},
									{
										"isprivate": "0",
										"commentid": "10448425",
										"comment_count": "24",
										"who": {
											"text": "awilliam",
											"name": "Adam Williamson"
										},
										"bug_when": "2017-05-25 17:10:01 +0000",
										"thetext": "So it seems like this libdb update is causing problems in the compose process; I'm going to unpush all the updates for safety:\n\n<adamw> there seem to be some issues in the compose process; both the RC compose attempts got stuck in STARTED state\n<jkurik> afaik some builders went down and needed to be restarted, that slowed down the compose\n<dgilmore> adamw: from looking there may be issues witha  libdb update\n<nirik> right... they are hanging in lorax... and several failed in lorax -> libdb\n<adamw> ooh.\n<adamw> there's a libdb blocker fix which is supposed to *prevent* update hangs...\n<dgilmore> it may be causeing compose hangs\n<nirik> yep.\n<adamw> maybe the fix has problems\n<adamw> can you tell what libdb nevr is involved?\n<adamw> well, maybe we should do this in #fedora-releng...\n<dgilmore> DEBUG util.py:439:  (68/714) libdb-5.3.28-19.fc26.aarch64\n<adamw> mmf, that's the latest one :/\n\nCCing dgilmore and nirik for further details."
									},
									{
										"isprivate": "0",
										"commentid": "10448491",
										"comment_count": "25",
										"who": {
											"text": "kevin",
											"name": "Kevin Fenzi"
										},
										"bug_when": "2017-05-25 17:39:45 +0000",
										"thetext": "Here's a failed koji task from the attempted rc compose: \n\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=19719675\n\nLooking at root.log there: \n\nDEBUG util.py:439:  creating the runtime image\nDEBUG util.py:439:  /bin/sh: line 1: 12545 Floating point exception(core dumped) lorax --product=Fedora --version=26 --release=26 --source=file:///mnt/koji/compose/26/Fedora-26-20170524.1/work/x86_64/repo --variant=Everything --noupgrade --buildarch=x86_64 --volid=Fedora-E-dvd-x86_64-26 --logfile=/mnt/koji/compose/26/Fedora-26-20170524.1/logs/x86_64/buildinstall-Everything-logs/lorax.log /mnt/koji/compose/26/Fedora-26-20170524.1/work/x86_64/buildinstall/Everything\nDEBUG util.py:577:  Child return code was: 136\n\nLooking on that builder ( buildhw-01.phx2.fedoraproject.org ):\n\n[Wed May 24 04:34:45 2017] traps: lorax[37508] trap divide error ip:7f5d7af41b04 sp:7ffe7afae730 error:0\n[Wed May 24 04:34:45 2017]  in libdb-5.3.so[7f5d7ae64000+1b5000]\n[Wed May 24 04:37:17 2017] traps: lorax[37259] trap divide error ip:f56eff8c sp:ffd6f1c0 error:0\n[Wed May 24 04:37:17 2017]  in libdb-5.3.so[f5604000+1d1000]\n[Wed May 24 04:41:25 2017] traps: lorax[36579] trap divide error ip:7fb5ecf68b04 sp:7ffe0644ed70 error:0\n[Wed May 24 04:41:25 2017]  in libdb-5.3.so[7fb5ece8b000+1b5000]\n[Wed May 24 23:30:05 2017] traps: lorax[12545] trap divide error ip:7f0cbd3cfb04 sp:7ffed72fd010 error:0\n[Wed May 24 23:30:05 2017]  in libdb-5.3.so[7f0cbd2f2000+1b5000]\n[Wed May 24 23:32:07 2017] traps: lorax[12320] trap divide error ip:f569cf8c sp:ff8e5610 error:0\n[Wed May 24 23:32:07 2017]  in libdb-5.3.so[f55b1000+1d1000]\n[Wed May 24 23:32:23 2017] traps: lorax[12313] trap divide error ip:f56b5f8c sp:ffc11490 error:0\n[Wed May 24 23:32:23 2017]  in libdb-5.3.so[f55ca000+1d1000]\n[Wed May 24 23:38:25 2017] traps: lorax[12491] trap divide error ip:7fed6c14bb04 sp:7ffd94c8aef0 error:0\n[Wed May 24 23:38:25 2017]  in libdb-5.3.so[7fed6c06e000+1b5000]"
									},
									{
										"isprivate": "0",
										"commentid": "10448498",
										"comment_count": "26",
										"who": {
											"text": "awilliam",
											"name": "Adam Williamson"
										},
										"bug_when": "2017-05-25 17:42:54 +0000",
										"thetext": "It's worth noting that all compose tasks run in mock chroots, so the issue here could be something missing from the mock environment that the code assumes will be available."
									},
									{
										"isprivate": "0",
										"commentid": "10448507",
										"comment_count": "27",
										"who": {
											"text": "fweimer",
											"name": "Florian Weimer"
										},
										"bug_when": "2017-05-25 17:46:51 +0000",
										"thetext": "(In reply to Adam Williamson from comment #26)\n> It's worth noting that all compose tasks run in mock chroots, so the issue\n> here could be something missing from the mock environment that the code\n> assumes will be available.\n\nOr the RPM database was created from outside of the chroot in the old libdb format, and the first attempt to touch it triggers an upgrade attempt, which fails."
									},
									{
										"isprivate": "0",
										"commentid": "10448826",
										"comment_count": "28",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2017-05-25 19:19:57 +0000",
										"thetext": "libdb-5.3.28-19.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
									},
									{
										"isprivate": "0",
										"commentid": "10449806",
										"comment_count": "29",
										"who": {
											"text": "bitlord0xff",
											"name": "Branko Grubi"
										},
										"bug_when": "2017-05-26 04:39:19 +0000",
										"thetext": "Created attachment 1282477\nupgrade_fail\n\nThis could be relate to this bug. During upgrade my dnf crashed with:\n\n...\n  Running scriptlet: qpdf-libs-6.0.0-4.fc26.x86_64                                                                                                                                                      107/112 \n  Cleanup          : microcode_ctl-2:2.1-14.1.fc26.x86_64                                                                                                                                               108/112 \n  Cleanup          : libv4l-1.12.5-1.fc26.x86_64                                                                                                                                                        109/112 \n  Running scriptlet: libv4l-1.12.5-1.fc26.x86_64                                                                                                                                                        109/112 \n  Running scriptlet: gssproxy-0.7.0-7.fc26.x86_64                                                                                                                                                       110/112 \nFloating point exception (core dumped)\n\nNow even 'rpm' doesn't work it crashes."
									},
									{
										"isprivate": "0",
										"commentid": "10449837",
										"comment_count": "30",
										"who": {
											"text": "robatino",
											"name": "Andre Robatino"
										},
										"bug_when": "2017-05-26 05:12:31 +0000",
										"thetext": "> Now even 'rpm' doesn't work it crashes.\n\nThat happened to me yesterday during a yum update of a F26 guest. It looks like the rpm database format changed. You have to rebuild the rpm database. I followed the instructions at https://ma.ttias.be/yum-update-db_runrecovery-fatal-error-run-database-recovery/ (you'd use the corresponding instructions for dnf) and then ran yum-complete-transaction (don't know the dnf command) and then everything was fine again."
									},
									{
										"isprivate": "0",
										"commentid": "10449863",
										"comment_count": "31",
										"who": {
											"text": "robatino",
											"name": "Andre Robatino"
										},
										"bug_when": "2017-05-26 05:33:29 +0000",
										"thetext": "I take it back - AFAIK the rpm database format didn't change, but as I said, rebuilding the rpm database did fix my problem."
									},
									{
										"isprivate": "0",
										"commentid": "10450039",
										"comment_count": "32",
										"who": {
											"text": "awilliam",
											"name": "Adam Williamson"
										},
										"bug_when": "2017-05-26 06:05:47 +0000",
										"thetext": "It certainly seems plausible that you ran into basically the same problem the composes are hitting, whatever it is, and a database rebuild would shift it. I've now unpushed the update for F26 as well, so hopefully no-one else will run into it."
									},
									{
										"isprivate": "0",
										"commentid": "10450147",
										"comment_count": "33",
										"who": {
											"text": "pkubat",
											"name": "Petr Kubat"
										},
										"bug_when": "2017-05-26 07:09:23 +0000",
										"thetext": "I think there is some scriptlet magic involved in this.\nJust tested to a newer libdb+glibc version with having openldap-servers package installed (which I know for a fact has a triggerin on libdb and touches the rpmdb) and failed the same way. Most likely due to the fact that the trigger rebuilds the db with newer version of libdb and rpm then tries to open it with the older version... But will have to look into this further."
									},
									{
										"isprivate": "0",
										"commentid": "10450169",
										"comment_count": "34",
										"who": {
											"text": "pmatilai",
											"name": "Panu Matilainen"
										},
										"bug_when": "2017-05-26 07:19:07 +0000",
										"thetext": "The database *environment* changes with the new libdb version, and once the database has been accessed with the newer version the older version can no longer access it and will barf in one way or the other. At least that's what I saw on Wednesday in my brief testing of the new libdb.\n\nAnyway, you don't need a full --rebuilddb in this situation, \"rm -f /var/lib/rpm/__*.db\" to nuke the environment is enough."
									},
									{
										"isprivate": "0",
										"commentid": "10450307",
										"comment_count": "35",
										"who": {
											"text": "lslebodn",
											"name": "Lukas Slebodnik"
										},
										"bug_when": "2017-05-26 07:50:38 +0000",
										"thetext": "Moving to assigned because upgrade to libdb-5.3.28-19.fc26\nstill does not work as expected and rpmdb is broken"
									},
									{
										"isprivate": "0",
										"commentid": "10450543",
										"comment_count": "36",
										"who": {
											"text": "hdegoede",
											"name": "Hans de Goede"
										},
										"bug_when": "2017-05-26 09:15:50 +0000",
										"thetext": "Hi,\n\nI'm seeing this too, not sure if it is related to the libdb update, I've updated to F26 a while ago and I already have manually run rpm --rebuilddb, yet after sucking in just 2 days of F26 updates today my dnf update is stuck at:\n\n  Running scriptlet: gssproxy-0.7.0-7.fc26.x86_64                     1029/1040 \n\n(yes lots of updates in the last 2 days, texlive is in the set)\n\nSo it seems that the gssproxy scriptlet is doing something which triggers this.\n\nNote no fp exception for me just dnf stuck using 100% CPU.\n\nRegards,\n\nHans"
									},
									{
										"isprivate": "0",
										"commentid": "10450557",
										"comment_count": "37",
										"who": {
											"text": "hdegoede",
											"name": "Hans de Goede"
										},
										"bug_when": "2017-05-26 09:22:41 +0000",
										"thetext": "A bit more input, I had to kill -9 dnf, after that dnf repoquery --duplicates showed a few duplicates so I did\ndnf remove --duplicates, this time the gssproxy scriptlet did run successfully.\n\nI did do a rpm --rebuild after they kill -9 as I was not sure the rpmdb would still be in a sane state after that.\n\nNot sure if this is helpful, feel free to ignore."
									},
									{
										"isprivate": "0",
										"commentid": "10450850",
										"comment_count": "38",
										"who": {
											"text": "lslebodn",
											"name": "Lukas Slebodnik"
										},
										"bug_when": "2017-05-26 10:51:19 +0000",
										"thetext": "Hans,\nIt is not related to gssproxy. It crashed even with updating just a libdb\n\nsh# dnf update libdb*\nLast metadata expiration check: 0:13:01 ago on Fri May 26 12:36:04 2017 CEST.\nDependencies resolved.\n================================================================================\n Package          Arch        Version                Repository            Size\n================================================================================\nUpgrading:\n libdb            x86_64      5.3.28-19.fc26         updates-testing      749 k\n libdb-utils      x86_64      5.3.28-19.fc26         updates-testing      137 k\n\nTransaction Summary\n================================================================================\nUpgrade  2 Packages\n\nTotal download size: 886 k\nIs this ok [y/N]: y\nDownloading Packages:\n(1/2): libdb-utils-5.3.28-19.fc26.x86_64.rpm    4.8 MB/s | 137 kB     00:00    \n(2/2): libdb-5.3.28-17.fc26_5.3.28-19.fc26.x86_ 7.8 MB/s | 236 kB     00:00    \n[DRPM] libdb-5.3.28-17.fc26_5.3.28-19.fc26.x86_64.drpm: done                   \n--------------------------------------------------------------------------------\nTotal                                           337 kB/s | 373 kB     00:01     \nDelta RPMs reduced 0.9 MB of updates to 0.4 MB (57.1% saved)\nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Preparing        :                                                        1/1 \n  Upgrading        : libdb-5.3.28-19.fc26.x86_64                            1/4 \n  Running scriptlet: libdb-5.3.28-19.fc26.x86_64                            1/4 \nSegmentation fault (core dumped)\n\nsh# rpm -q libdb\nSegmentation fault (core dumped)"
									},
									{
										"isprivate": "0",
										"commentid": "10450873",
										"comment_count": "39",
										"who": {
											"text": "ignatenko",
											"name": "Igor Gnatenko"
										},
										"bug_when": "2017-05-26 10:57:06 +0000",
										"thetext": "*** Bug 1455823 has been marked as a duplicate of this bug. ***"
									},
									{
										"isprivate": "0",
										"commentid": "10450876",
										"comment_count": "40",
										"who": {
											"text": "ignatenko",
											"name": "Igor Gnatenko"
										},
										"bug_when": "2017-05-26 10:57:39 +0000",
										"thetext": "*** Bug 1455864 has been marked as a duplicate of this bug. ***"
									},
									{
										"isprivate": "0",
										"commentid": "10450892",
										"comment_count": "41",
										"who": {
											"text": "lslebodn",
											"name": "Lukas Slebodnik"
										},
										"bug_when": "2017-05-26 11:05:35 +0000",
										"thetext": "I hit submit too fast.\n\nsh# rpm -q libdb\nSegmentation fault (core dumped)\n\nsh# rpm --rebuilddb \n\nsh# rpm -q libdb\nlibdb-5.3.28-19.fc26.x86_64\nlibdb-5.3.28-17.fc26.x86_64\n\nsh# rpm -q --scripts libdb\npostinstall program: /sbin/ldconfig\npostuninstall program: /sbin/ldconfig\npostinstall program: /sbin/ldconfig\npostuninstall program: /sbin/ldconfig\n\nI doubt anyone tested package before pushing to updates-testing.\n\nBTW it is not bug in dnf because similar problems are with yum-deprecated or microdnf. It is bug in libdb"
									},
									{
										"isprivate": "0",
										"commentid": "10451916",
										"comment_count": "42",
										"who": {
											"text": "pmatilai",
											"name": "Panu Matilainen"
										},
										"bug_when": "2017-05-26 15:33:17 +0000",
										"thetext": "Lukas, try to understand that not everybody's experience equals yours. \n\nFor example I did test the thing and saw ZERO crashes, only when downgrading back to previous libdb version did I see problems (which doesn't always happen but is not unexpected). \n\nThe actual bug is that librpm doesn't sufficiently isolate libdb from the rest of the world, and s*** like this hits the fan once every few years in that one transaction where some deep magic like glibc futex internals change. Truly fixing that would likely require drastic architectural change in rpm to force all database access through a single daemon so there can never be two different versions trying to access the same db."
									},
									{
										"isprivate": "0",
										"commentid": "10452142",
										"comment_count": "43",
										"who": {
											"text": "lslebodn",
											"name": "Lukas Slebodnik"
										},
										"bug_when": "2017-05-26 16:33:13 +0000",
										"thetext": "(In reply to Panu Matilainen from comment #42)\n> Lukas, try to understand that not everybody's experience equals yours. \n> \n> For example I did test the thing and saw ZERO crashes, only when downgrading\n> back to previous libdb version did I see problems (which doesn't always\n> happen but is not unexpected). \n> \n> The actual bug is that librpm doesn't sufficiently isolate libdb from the\n> rest of the world, and s*** like this hits the fan once every few years in\n> that one transaction where some deep magic like glibc futex internals\n> change. Truly fixing that would likely require drastic architectural change\n> in rpm to force all database access through a single daemon so there can\n> never be two different versions trying to access the same db.\n\nPannu, what did you test and where/which machine?\n\nBecause upgrade on fedora 26 does not work for me with rpm, yum-deprecated (upgrade does not finish) snd -> crash. And I tested with 3 different fedora 26 machines. It crashed even in f26 docker containers(x86_64, i686) which I use for integration testing of unrelated project. It does not look like a corner-case to me. Or only very low change that only I hit bug everywhere.\n\nBTW If you really cannot reproduce yourself and need more logs/info/valgrind output ... then I will be glad to provide them."
									},
									{
										"isprivate": "0",
										"commentid": "10452201",
										"comment_count": "44",
										"who": {
											"text": "plroskin",
											"name": "Pavel Roskin"
										},
										"bug_when": "2017-05-26 16:59:44 +0000",
										"thetext": "I don't know if that's the original issue, but I also experienced dnf crash on update of Fedora 26 that required \"rpm --rebuilddb\". I experienced the same issue on two different systems in the recent hours. Both track Fedora 26. One was upgraded two months ago (when alpha was released), another was installed as Fedora 26 around the same time. Both systems have fedora-updates-testing enabled. The symptoms are:\n\n\"dnf upgrade\" tries to upgrade a large number of packages and crashes:\n\n  Running scriptlet: qpdf-libs-6.0.0-4.fc26.x86_64\n  Cleanup          : microcode_ctl-2:2.1-14.1.fc26.x86_64\n  Cleanup          : libv4l-1.12.5-1.fc26.x86_64\n  Running scriptlet: libv4l-1.12.5-1.fc26.x86_64\n  Running scriptlet: gssproxy-0.7.0-7.fc26.x86_64\nFloating point exception\n\nKernel log shows divide error in deleted (!!!) libdb-5.3.so\n\n[  340.774423] traps: dnf[2177] trap divide error ip:7fdd2eaa9f32 sp:7ffc3f07cb00 error:0 in libdb-5.3.so (deleted)[7fdd2e9d2000+1b5000]\n\n\"package-cleanup --cleandupes\" segfaults\n\n[  413.885836] traps: package-cleanup[4076] general protection ip:7f86c15d6683 sp:7ffcc0cf2190 error:0 in libdb-5.3.so[7f86c14b1000+1b6000]\n\n\"rpm --rebuilddb\" works\n\n\"package-cleanup --cleandupes\" works\n\n  Erasing    : 1:dmidecode-3.0-8.fc26.x86_64\n  Erasing    : gssproxy-0.7.0-7.fc26.x86_64\n  Erasing    : gperftools-libs-2.5.91-1.fc26.x86_64\n\n\"dnf check\" passes"
									},
									{
										"isprivate": "0",
										"commentid": "10452217",
										"comment_count": "45",
										"who": {
											"text": "pkubat",
											"name": "Petr Kubat"
										},
										"bug_when": "2017-05-26 17:12:46 +0000",
										"thetext": "Lukas, Pavel and anyone other hitting this issue:\nPlease provide us with result of either \"dnf --rpmverbosity debug update\", or \"rpm -Uvv\" when upgrading through rpm. This will tell us much more about where in the update process the failure takes place.\n\nThank you!"
									},
									{
										"isprivate": "0",
										"commentid": "10452373",
										"comment_count": "46",
										"who": {
											"text": "plroskin",
											"name": "Pavel Roskin"
										},
										"bug_when": "2017-05-26 18:37:07 +0000",
										"thetext": "I cannot reproduce the issue by downgrading the packages that were upgraded today and redoing the upgrade. But I noticed that if I downgrade libdb, I need to run \"rpm --rebuilddb\". I don't know if it's normal."
									},
									{
										"isprivate": "0",
										"commentid": "10452422",
										"comment_count": "47",
										"who": {
											"text": "fedora",
											"name": "Christian Stadelmann"
										},
										"bug_when": "2017-05-26 19:03:25 +0000",
										"thetext": "(In reply to Pavel Roskin from comment #46)\n> I cannot reproduce the issue by downgrading the packages that were upgraded\n> today and redoing the upgrade. But I noticed that if I downgrade libdb, I\n> need to run \"rpm --rebuilddb\". I don't know if it's normal.\n\nIt looks like you have reproduced the issue, if your RPM database broke. Sometimes the crash happens after dnf finishes or in a separate process using RPM, e.g. dnf makecache."
									},
									{
										"isprivate": "0",
										"commentid": "10452529",
										"comment_count": "48",
										"who": {
											"text": "lslebodn",
											"name": "Lukas Slebodnik"
										},
										"bug_when": "2017-05-26 20:09:32 +0000",
										"thetext": "[root@host rpms]# rpm -qa \"libdb*\"\nlibdb-utils-5.3.28-17.fc26.x86_64\nlibdb-5.3.28-17.fc26.x86_64\n\n[root@host rpms]# rpm -Uvvv libdb-5.3.28-19.fc26.x86_64.rpm  libdb-utils-5.3.28-19.fc26.x86_64.rpm\nufdio:       1 reads,    16960 total bytes in 0.000016 secs\nufdio:       1 reads,     4874 total bytes in 0.000001 secs\nufdio:       1 reads,    16960 total bytes in 0.000006 secs\nD: ============== libdb-5.3.28-19.fc26.x86_64.rpm\nD: loading keyring from pubkeys in /var/lib/rpm/pubkeys/*.key\nD: couldn't find any keys in /var/lib/rpm/pubkeys/*.key\nD: loading keyring from rpmdb\nD: opening  db environment /var/lib/rpm cdb:0x401\nD: opening  db index       /var/lib/rpm/Packages 0x400 mode=0x0\nD: locked   db index       /var/lib/rpm/Packages\nD: opening  db index       /var/lib/rpm/Name 0x400 mode=0x0\nD:  read h#      50 Header SHA1 digest: OK (3faba9ffbffc3a2d283452d115959d3d0c6fe2fa)\nD: added key gpg-pubkey-fdb19c98-56fd6333 to keyring\nD:  read h#     983 Header SHA1 digest: OK (44dfac3a3ed2ad52f6139c5313da593614f56803)\nD: added key gpg-pubkey-34ec9cba-54e38751 to keyring\nD:  read h#    1020 Header SHA1 digest: OK (cfe21d873624cf8171e50d34136dbc005df076ed)\nD: added key gpg-pubkey-81b46521-55b3ca9a to keyring\nD:  read h#    1894 Header SHA1 digest: OK (5e75131638942274458bbc47adc744c3f502a8e8)\nD: added key gpg-pubkey-64dab85d-57d33e22 to keyring\nD:  read h#    1923 Header SHA1 digest: OK (10c972a7cd84e939380e135e42e6566833a140f6)\nD: added key gpg-pubkey-f5282ee4-58ac92a3 to keyring\nD:  read h#    2062 Header SHA1 digest: OK (6ece1dbaaa4150376442430d5a07f4d54c135dec)\nD: added key gpg-pubkey-98ab5139-4bf2d0b0 to keyring\nD: Using legacy gpg-pubkey(s) from rpmdb\nD: Expected size:       767222 = lead(96)+sigs(4324)+pad(4)+data(762798)\nD:   Actual size:       767222\nD: libdb-5.3.28-19.fc26.x86_64.rpm: Header SHA1 digest: OK (cc6f9b160a1c8a2f128b48d77a88bd8c1009d710)\nufdio:       6 reads,    14370 total bytes in 0.000009 secs\nD: Plugin: calling hook init in systemd_inhibit plugin\nD:  read h#     750 Header SHA1 digest: OK (fd008120d31275ac46e0759e0e41ef7d9d4f9fbc)\nD:      added binary package [0]\nD: ============== libdb-utils-5.3.28-19.fc26.x86_64.rpm\nD: Expected size:       140406 = lead(96)+sigs(4324)+pad(4)+data(135982)\nD:   Actual size:       140406\nD: libdb-utils-5.3.28-19.fc26.x86_64.rpm: Header SHA1 digest: OK (863b47cdec17d7cda4df885dd1438a8629c31f04)\nufdio:       6 reads,    20738 total bytes in 0.000014 secs\nD:  read h#    1547 Header SHA1 digest: OK (137fb7a99f7ae0f5a59fd12b724a29c348be1e60)\nD:      added binary package [1]\nD: found 0 source and 2 binary packages\nD: opening  db index       /var/lib/rpm/Conflictname 0x400 mode=0x0\nD: opening  db index       /var/lib/rpm/Requirename 0x400 mode=0x0\nD: ========== +++ libdb-5.3.28-19.fc26 x86_64/linux 0x2\nD: opening  db index       /var/lib/rpm/Basenames 0x400 mode=0x0\nD:  read h#    1413 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: /sbin/ldconfig                                YES (db files)\nD:  Requires: /sbin/ldconfig                                YES (cached)\nD: opening  db index       /var/lib/rpm/Providename 0x400 mode=0x0\nD:  Requires: libc.so.6()(64bit)                            YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.14)(64bit)                  YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.15)(64bit)                  YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.17)(64bit)                  YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.2.5)(64bit)                 YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.3)(64bit)                   YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.3.4)(64bit)                 YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.4)(64bit)                   YES (db provides)\nD:  Requires: libpthread.so.0()(64bit)                      YES (db provides)\nD:  Requires: libpthread.so.0(GLIBC_2.2.5)(64bit)           YES (db provides)\nD:  Requires: libpthread.so.0(GLIBC_2.3.2)(64bit)           YES (db provides)\nD:  Requires: rpmlib(CompressedFileNames) <= 3.0.4-1        YES (rpmlib provides)\nD:  Requires: rpmlib(FileDigests) <= 4.6.0-1                YES (rpmlib provides)\nD:  Requires: rpmlib(PayloadFilesHavePrefix) <= 4.0-1       YES (rpmlib provides)\nD:  Requires: rpmlib(PayloadIsXz) <= 5.2-1                  YES (rpmlib provides)\nD:  Requires: rtld(GNU_HASH)                                YES (db provides)\nD:  read h#     851 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD: Conflicts: filesystem < 3                                NO  \nD: opening  db index       /var/lib/rpm/Obsoletename 0x400 mode=0x0\nD: ========== +++ libdb-utils-5.3.28-19.fc26 x86_64/linux 0x2\nD:  Requires: libc.so.6()(64bit)                            YES (cached)\nD:  Requires: libc.so.6(GLIBC_2.14)(64bit)                  YES (cached)\nD:  Requires: libc.so.6(GLIBC_2.2.5)(64bit)                 YES (cached)\nD:  Requires: libc.so.6(GLIBC_2.3)(64bit)                   YES (cached)\nD:  Requires: libc.so.6(GLIBC_2.3.4)(64bit)                 YES (cached)\nD:  Requires: libc.so.6(GLIBC_2.4)(64bit)                   YES (cached)\nD:  Requires: libdb(x86-64) = 5.3.28-19.fc26                YES (added provide)\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  Requires: libpthread.so.0()(64bit)                      YES (cached)\nD:  Requires: libpthread.so.0(GLIBC_2.2.5)(64bit)           YES (cached)\nD:  Requires: rpmlib(CompressedFileNames) <= 3.0.4-1        YES (rpmlib provides)\nD:  Requires: rpmlib(FileDigests) <= 4.6.0-1                YES (rpmlib provides)\nD:  Requires: rpmlib(PayloadFilesHavePrefix) <= 4.0-1       YES (rpmlib provides)\nD:  Requires: rpmlib(PayloadIsXz) <= 5.2-1                  YES (rpmlib provides)\nD:  Requires: rtld(GNU_HASH)                                YES (cached)\nD: ========== --- libdb-5.3.28-17.fc26 x86_64/linux 0x2\nD:  read h#      70 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     228 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     376 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     417 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     446 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     453 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     501 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     550 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     683 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     763 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     801 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     827 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1063 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1360 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1575 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1639 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1658 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1814 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1860 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    2108 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD: ========== --- libdb-utils-5.3.28-17.fc26 x86_64/linux 0x2\nD:  read h#    1021 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-utils                                   YES (added provide)\nD:  Requires: libdb-utils                                   YES (added provide)\nD:  Requires: /usr/bin/db_stat                              YES (added files)\nD: ========== recording tsort relations\nD:  Requires: libdb(x86-64) = 5.3.28-19.fc26                YES (added provide)\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  Requires: libdb(x86-64) = 5.3.28-17.fc26                YES (added provide)\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD: ========== tsorting packages (order, #predecessors, #succesors, depth)\nD:     0    0    1    1   +libdb-5.3.28-19.fc26.x86_64\nD:     1    0    0    2     +libdb-utils-5.3.28-19.fc26.x86_64\nD:     2    0    1    1   -libdb-utils-5.3.28-17.fc26.x86_64\nD:     3    0    0    2     -libdb-5.3.28-17.fc26.x86_64\nD: installing binary packages\nD: closed   db index       /var/lib/rpm/Packages\nD: closed   db index       /var/lib/rpm/Obsoletename\nD: closed   db index       /var/lib/rpm/Conflictname\nD: closed   db index       /var/lib/rpm/Providename\nD: closed   db index       /var/lib/rpm/Requirename\nD: closed   db index       /var/lib/rpm/Basenames\nD: closed   db index       /var/lib/rpm/Name\nD: closed   db environment /var/lib/rpm\nD: opening  db environment /var/lib/rpm cdb:0x401\nD: opening  db index       /var/lib/rpm/Packages (none) mode=0x42\nD: sanity checking 4 elements\nD: opening  db index       /var/lib/rpm/Name (none) mode=0x42\nD:  read h#     750 Header SHA1 digest: OK (fd008120d31275ac46e0759e0e41ef7d9d4f9fbc)\nD:  read h#    1547 Header SHA1 digest: OK (137fb7a99f7ae0f5a59fd12b724a29c348be1e60)\nD: Plugin: calling hook tsm_pre in selinux plugin\nD: Plugin: calling hook tsm_pre in systemd_inhibit plugin\nD: System shutdown blocked (fd 12)\nD: opening  db index       /var/lib/rpm/Transfiletriggername (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Dirnames (none) mode=0x42\nD: unknown: libdb-utils-5.3.28-17.fc26.x86_64 has 30 files\nD: Plugin: calling hook psm_pre in selinux plugin\nD: unknown: libdb-5.3.28-17.fc26.x86_64 has 7 files\nD: Plugin: calling hook psm_pre in selinux plugin\nD: running pre-transaction scripts\nD: computing 74 file fingerprints\nD: opening  db index       /var/lib/rpm/Basenames (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Group (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Requirename (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Providename (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Conflictname (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Obsoletename (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Triggername (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Installtid (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Sigmd5 (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Sha1header (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Filetriggername (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Recommendname (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Suggestname (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Supplementname (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Enhancename (none) mode=0x42\nPreparing packages...\nD: computing file dispositions\nD: 0x00000028     4096      2542694           -1 /\nD: ========== +++ libdb-5.3.28-19.fc26 x86_64-linux 0x2\nD: Expected size:       767222 = lead(96)+sigs(4324)+pad(4)+data(762798)\nD:   Actual size:       767222\nD: libdb-5.3.28-19.fc26.x86_64: Header SHA1 digest: OK (cc6f9b160a1c8a2f128b48d77a88bd8c1009d710)\nD:   install: libdb-5.3.28-19.fc26.x86_64 has 7 files\nD: Plugin: calling hook psm_pre in selinux plugin\nD:  read h#    1814 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nlibdb-5.3.28-19.fc26.x86_64\nD: ========== Directories not explicitly included in package:\nD:          0 /usr/lib64/\nD:          1 /usr/share/doc/\nD:          3 /usr/share/licenses/\nD: ==========\nD: create     100755  1 (   0,   0)1853896 /usr/lib64/libdb-5.3.so;59288a17\nufdio:      57 writes,  1853896 total bytes in 0.000611 secs\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/lib64/libdb-5.3.so;59288a17, system_u:object_r:lib_t:s0) \nD: create     120777  1 (   0,   0)    12 /usr/lib64/libdb-5.so;59288a17\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/lib64/libdb-5.so;59288a17, system_u:object_r:lib_t:s0) \nD: create     040755  1 (   0,   0)     0 /usr/share/doc/libdb\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/share/doc/libdb, system_u:object_r:usr_t:s0) \nD: create     100644  1 (   0,   0)   240 /usr/share/doc/libdb/README;59288a17\nufdio:       1 writes,      240 total bytes in 0.000014 secs\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/share/doc/libdb/README;59288a17, system_u:object_r:usr_t:s0) \nD: create     040755  1 (   0,   0)     0 /usr/share/licenses/libdb\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/share/licenses/libdb, system_u:object_r:usr_t:s0) \nD: create     100644  1 (   0,   0)  7310 /usr/share/licenses/libdb/LICENSE;59288a17\nufdio:       1 writes,     7310 total bytes in 0.000011 secs\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/share/licenses/libdb/LICENSE;59288a17, system_u:object_r:usr_t:s0) \nD: create     100644  1 (   0,   0) 26530 /usr/share/licenses/libdb/lgpl-2.1.txt;59288a17\nufdio:       1 writes,    26530 total bytes in 0.000018 secs\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/share/licenses/libdb/lgpl-2.1.txt;59288a17, system_u:object_r:usr_t:s0) \nfdio:      94 reads,  1889100 total bytes in 0.053953 secs\nD: adding \"libdb\" to Name index.\nD: adding 7 entries to Basenames index.\nD: adding \"System Environment/Libraries\" to Group index.\nD: adding 18 entries to Requirename index.\nD: adding 3 entries to Providename index.\nD: adding 1 entries to Conflictname index.\nD: adding 5 entries to Dirnames index.\nD: adding 1 entries to Installtid index.\nD: adding 1 entries to Sigmd5 index.\nD: adding \"cc6f9b160a1c8a2f128b48d77a88bd8c1009d710\" to Sha1header index.\nD: %post(libdb-5.3.28-19.fc26.x86_64): scriptlet start\nD: %post(libdb-5.3.28-19.fc26.x86_64): execv(/sbin/ldconfig) pid 32495\nD: Plugin: calling hook scriptlet_fork_post in selinux plugin\nD: setexecfilecon: (/sbin/ldconfig) \nD: %post(libdb-5.3.28-19.fc26.x86_64): waitpid(32495) rc 32495 status 0\nD: %triggerin(openldap-servers-2.4.44-10.fc26.x86_64): scriptlet start\nfdio:       2 writes,      368 total bytes in 0.000032 secs\nD: %triggerin(openldap-servers-2.4.44-10.fc26.x86_64): execv(/bin/sh) pid 32496\nD: Plugin: calling hook scriptlet_fork_post in selinux plugin\nD: setexecfilecon: (/bin/sh) \n+ '[' 2 -eq 2 ']'\n++ rpm -q '--qf=%{version}\\n' libdb\n++ wc -l\n++ sort -u\n++ sed 's/\\.[0-9]*$//'\n+ '[' 1 '!=' 1 ']'\n+ rm -f /var/lib/ldap/rpm_upgrade_libdb\n+ exit 0\nD: %triggerin(openldap-servers-2.4.44-10.fc26.x86_64): waitpid(32496) rc 32496 status 0\nerror: rpmdb: DB_LOCK->lock_put: Lock is no longer valid\nerror: db5 error(22) from dbcursor->c_close: Invalid argument\n\n\nAnd upgrade has not finished yet"
									},
									{
										"isprivate": "0",
										"commentid": "10452608",
										"comment_count": "49",
										"who": {
											"text": "lslebodn",
											"name": "Lukas Slebodnik"
										},
										"bug_when": "2017-05-26 21:21:13 +0000",
										"thetext": "rpm is busy (100%CPU) even after 60 minutes; so I killed it.\n\nSo it looks like I was really lucky that openldap-servers was installed in all my cases even though it was not running anywhere. I am so sorry that I was so pessimistic and a little bit frustrated."
									},
									{
										"isprivate": "0",
										"commentid": "10454712",
										"comment_count": "50",
										"who": {
											"text": "pmatilai",
											"name": "Panu Matilainen"
										},
										"bug_when": "2017-05-29 06:33:10 +0000",
										"thetext": "(In reply to Lukas Slebodnik from comment #43)\n> Pannu, what did you test and where/which machine?\n\nIt's Panu, with a single n, BTW.\n\nI'm sure I tested something different than you did. Which is the whole point: people HAVE tested the fix in good faith without seeing the crashes you're seeing. Not everybody has openldap-servers installed, and (thank goodness) not many packages are naughty enough to call rpm from scriptlets. \n\nRunning rpm queries manually during the upgrade would have the same effect so it's not all just about naughty packages either.\n\nIn any case, good thing is it did get caught before going further, updates-testing served its purpose."
									},
									{
										"isprivate": "0",
										"commentid": "10454813",
										"comment_count": "51",
										"who": {
											"text": "ignatenko",
											"name": "Igor Gnatenko"
										},
										"bug_when": "2017-05-29 07:27:21 +0000",
										"thetext": "*** Bug 1455750 has been marked as a duplicate of this bug. ***"
									},
									{
										"isprivate": "0",
										"commentid": "10460136",
										"comment_count": "52",
										"who": {
											"text": "awilliam",
											"name": "Adam Williamson"
										},
										"bug_when": "2017-05-30 19:40:13 +0000",
										"thetext": "For the record, we're transferring the blocker status from this bug to https://bugzilla.redhat.com/show_bug.cgi?id=1397087 , which is the specific bug we really voted on as a blocker issue. It's not really appropriate to grant blocker status to tracker bugs, as their 'meaning' could change over time - say in this case, we could resolve the current issue but then some much smaller bug which caused an issue only very rarely (and maybe only on a secondary arch) could be set as blocking this tracker, and then that would instantly 'become' a release blocker. Which we don't want."
									},
									{
										"isprivate": "0",
										"commentid": "10463048",
										"comment_count": "53",
										"who": {
											"text": "ignatenko",
											"name": "Igor Gnatenko"
										},
										"bug_when": "2017-05-31 11:52:30 +0000",
										"thetext": "*** Bug 1456788 has been marked as a duplicate of this bug. ***"
									},
									{
										"isprivate": "0",
										"commentid": "10463050",
										"comment_count": "54",
										"who": {
											"text": "ignatenko",
											"name": "Igor Gnatenko"
										},
										"bug_when": "2017-05-31 11:52:35 +0000",
										"thetext": "*** Bug 1456002 has been marked as a duplicate of this bug. ***"
									},
									{
										"isprivate": "0",
										"commentid": "10468553",
										"comment_count": "55",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2017-06-01 12:44:41 +0000",
										"thetext": "libdb-5.3.28-21.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
									},
									{
										"isprivate": "0",
										"commentid": "10470757",
										"comment_count": "56",
										"who": {
											"text": "pwhalen",
											"name": "Paul Whalen"
										},
										"bug_when": "2017-06-02 02:10:19 +0000",
										"thetext": "using libdb-5.3.28-21.fc26 armhfp and aarch64 successfully upgraded with dnf-plugin-system-upgrade+local repo"
									},
									{
										"isprivate": "0",
										"commentid": "10471093",
										"comment_count": "57",
										"who": {
											"text": "awilliam",
											"name": "Adam Williamson"
										},
										"bug_when": "2017-06-02 05:30:40 +0000",
										"thetext": "It'd be really great if people could help test the new update hard: test that it fixes the actual bug, test it in the scenarios that caused trouble with -18 and -19, etc. We want to get this fix out for Beta, but we don't want to send it unless we're sure it's good. Thanks a lot!"
									},
									{
										"isprivate": "0",
										"commentid": "10472354",
										"comment_count": "58",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2017-06-02 13:00:16 +0000",
										"thetext": "libdb-5.3.28-21.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf"
									},
									{
										"isprivate": "0",
										"commentid": "10472359",
										"comment_count": "59",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2017-06-02 13:00:54 +0000",
										"thetext": "libdb-5.3.28-21.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
									},
									{
										"isprivate": "0",
										"commentid": "10472661",
										"comment_count": "60",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-06-02 14:35:20 +0000",
										"thetext": "I did a check with ppc64le and the issue is still here. This is what I did\n- installed F-25 \"minimal\"\n- updated libdb to libdb-5.3.28-21.fc25.ppc64le (downloaded from ppc koji)\n- created a side repo for F-26 libdb containing libdb-5.3.28-21.fc26.ppc64le (downloaded from primary koji)\n- run \"dnf distro-sync --releasever 26\" with the side repo enabled\n- and got a hung after\n...\n  Cleanup     : crypto-policies-20160921-4.gitf3018dd.fc25.noarch  614/708 \n  Cleanup     : krb5-libs-1.14.4-7.fc25.ppc64le                    615/708"
									},
									{
										"isprivate": "0",
										"commentid": "10472783",
										"comment_count": "61",
										"who": {
											"text": "mattdm",
											"name": "Matthew Miller"
										},
										"bug_when": "2017-06-02 15:09:49 +0000",
										"thetext": "(In reply to Dan Hork from comment #60)\n> I did a check with ppc64le and the issue is still here. This is what I did\n> - installed F-25 \"minimal\"\n> - updated libdb to libdb-5.3.28-21.fc25.ppc64le (downloaded from ppc koji)\n> - created a side repo for F-26 libdb containing libdb-5.3.28-21.fc26.ppc64le\n> (downloaded from primary koji)\n> - run \"dnf distro-sync --releasever 26\" with the side repo enabled\n> - and got a hung after\n> ...\n>   Cleanup     : crypto-policies-20160921-4.gitf3018dd.fc25.noarch  614/708 \n>   Cleanup     : krb5-libs-1.14.4-7.fc25.ppc64le                    615/708\n\nDan, do you get hangs with dnf system-upgrade? It's just doing an online update that is problematic?"
									},
									{
										"isprivate": "0",
										"commentid": "10472796",
										"comment_count": "62",
										"who": {
											"text": "mtasaka",
											"name": "Mamoru TASAKA"
										},
										"bug_when": "2017-06-02 15:19:23 +0000",
										"thetext": "Well, my recognition is that \n* -18 and -19 applied a patch which are supposed to fix hang issue in -17, but it caused segv\n* -21 removed the patch applied on -18 and -19, so -21 is effencially same as -17, and while segv is gone, hang issue in -17 \"should\" reappear.\n\nAm I right?"
									},
									{
										"isprivate": "0",
										"commentid": "10472809",
										"comment_count": "63",
										"who": {
											"text": "mtasaka",
											"name": "Mamoru TASAKA"
										},
										"bug_when": "2017-06-02 15:20:59 +0000",
										"thetext": "(In reply to Mamoru TASAKA from comment #62)\n> Well, my recognition is that \n> * -18 and -19 applied a patch which are supposed to fix hang issue in -17,\n> but it caused segv\n> * -21 removed the patch applied on -18 and -19, so -21 is effencially same\n> as -17, and while segv is gone, hang issue in -17 \"should\" reappear.\n> \n> Am I right?\n\nOops, removing patch was done in -20, -21 introduced other patch, sorry."
									},
									{
										"isprivate": "0",
										"commentid": "10472904",
										"comment_count": "64",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-06-02 15:38:35 +0000",
										"thetext": "(In reply to Matthew Miller from comment #61)\n> (In reply to Dan Hork from comment #60)\n> > I did a check with ppc64le and the issue is still here. This is what I did\n> > - installed F-25 \"minimal\"\n> > - updated libdb to libdb-5.3.28-21.fc25.ppc64le (downloaded from ppc koji)\n> > - created a side repo for F-26 libdb containing libdb-5.3.28-21.fc26.ppc64le\n> > (downloaded from primary koji)\n> > - run \"dnf distro-sync --releasever 26\" with the side repo enabled\n> > - and got a hung after\n> > ...\n> >   Cleanup     : crypto-policies-20160921-4.gitf3018dd.fc25.noarch  614/708 \n> >   Cleanup     : krb5-libs-1.14.4-7.fc25.ppc64le                    615/708\n> \n> Dan, do you get hangs with dnf system-upgrade? It's just doing an online\n> update that is problematic?\n\n- installed F-25 \"minimal\"\n- created a side repo for F-26 libdb containing libdb-5.3.28-21.fc26.ppc64le (downloaded from primary koji)\n- run \"dnf system-upgrade download --releasever 26\" with the side repo enabled\n- run \"dnf system-upgrade reboot\"\n- and got a hung at\n [620/714]  Cleanup : crypto-policies-20160921-4.gitf3018dd.fc25.noarch\non the console"
									},
									{
										"isprivate": "0",
										"commentid": "10472915",
										"comment_count": "65",
										"who": {
											"text": "mattdm",
											"name": "Matthew Miller"
										},
										"bug_when": "2017-06-02 15:39:47 +0000",
										"thetext": "Well, that answers that. :( Thanks Dan."
									},
									{
										"isprivate": "0",
										"commentid": "10472928",
										"comment_count": "66",
										"who": {
											"text": "awilliam",
											"name": "Adam Williamson"
										},
										"bug_when": "2017-06-02 15:42:59 +0000",
										"thetext": "Dan: did you check the correct libdb version was actually included in the distro-sync / upgrade transactions?"
									},
									{
										"isprivate": "0",
										"commentid": "10472963",
										"comment_count": "67",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-06-02 15:46:16 +0000",
										"thetext": "(In reply to Adam Williamson from comment #66)\n> Dan: did you check the correct libdb version was actually included in the\n> distro-sync / upgrade transactions?\n\nit's listed in the \"download\" phase, so it should be then also installed/updated\n\n...\n libcroco                                                  ppc64le                         0.6.12-1.fc26                                                 fedora                         121 k\n libcrypt-nss                                              ppc64le                         2.25-4.fc26                                                   fedora                          53 k\n libcurl                                                   ppc64le                         7.53.1-7.fc26                                                 fedora                         294 k\n libdb                                                     ppc64le                         5.3.28-21.fc26                                                libdb                          798 k\n libdb-utils                                               ppc64le                         5.3.28-21.fc26                                                libdb                          150 k\n libedit                                                   ppc64le                         3.1-17.20160618cvs.fc26                                       fedora                         107 k\n libfdisk                                                  ppc64le                         2.29.1-2.fc26                                                 fedora                         248 k\n libffi                                                    ppc64le                         3.1-10.fc26                                                   fedora                          35 k\n libgcc                                                    ppc64le                         7.1.1-1.fc26                                                  fedora                          76 k\n..."
									},
									{
										"isprivate": "0",
										"commentid": "10474622",
										"comment_count": "68",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2017-06-04 05:10:25 +0000",
										"thetext": "libdb-5.3.28-21.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
									},
									{
										"isprivate": "0",
										"commentid": "10475802",
										"comment_count": "69",
										"who": {
											"text": "pkubat",
											"name": "Petr Kubat"
										},
										"bug_when": "2017-06-05 06:15:51 +0000",
										"thetext": "Hi Dan,\ncan you reproduce this issue using debugging output so that we can see where dnf freezes? Running with \"--rpmverbosity debug\" should do the trick.\n\nAlso are you able to reproduce this even after updating libdb to the latest version for F25 (https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf) before running the upgrade to F26?"
									},
									{
										"isprivate": "0",
										"commentid": "10476162",
										"comment_count": "70",
										"who": {
											"text": "besser82",
											"name": "Bjrn 'besser82' Esser"
										},
										"bug_when": "2017-06-05 08:02:30 +0000",
										"thetext": "Looking at https://bugzilla.redhat.com/show_bug.cgi?id=1443415#c60 and https://bugzilla.redhat.com/show_bug.cgi?id=1443415#c64, Dan tried both options: with updating to -21 libdb on F25 and without."
									},
									{
										"isprivate": "0",
										"commentid": "10476263",
										"comment_count": "71",
										"who": {
											"text": "pkubat",
											"name": "Petr Kubat"
										},
										"bug_when": "2017-06-05 08:21:45 +0000",
										"thetext": ">Dan tried both options: with updating to -21 libdb on F25 and without.\n\nMissed that, thanks!\n\nIn any case the debug output would still be immensely helpful as I am currently unable to reproduce the hang on a ppc64le box."
									},
									{
										"isprivate": "0",
										"commentid": "10476284",
										"comment_count": "72",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-06-05 08:26:43 +0000",
										"thetext": "(In reply to Petr Kubat from comment #69)\n> Hi Dan,\n> can you reproduce this issue using debugging output so that we can see where\n> dnf freezes? Running with \"--rpmverbosity debug\" should do the trick.\n> \n> Also are you able to reproduce this even after updating libdb to the latest\n> version for F25\n> (https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf) before\n> running the upgrade to F26?\n\nPetr, I'll check with you off-line and give you login info for the machine I use for reproducing the problem.\n\nFor debugging purposes I think we should stick to the online update using \"dnf distro-sync\", I couldn't access the console when running the off-line upgrade."
									},
									{
										"isprivate": "0",
										"commentid": "10476729",
										"comment_count": "73",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-06-05 10:21:56 +0000",
										"thetext": "Seems I can't reproduce the issue any more with an up-to-date F-25 system, maybe something in the updates pushed over the weekend made the change."
									},
									{
										"isprivate": "0",
										"commentid": "10476737",
										"comment_count": "74",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-06-05 10:25:15 +0000",
										"thetext": "For the record - the first in my procedure in comment #60 should read as \"install and update F-25 minimal\"."
									},
									{
										"isprivate": "0",
										"commentid": "10477022",
										"comment_count": "75",
										"who": {
											"text": "besser82",
											"name": "Bjrn 'besser82' Esser"
										},
										"bug_when": "2017-06-05 12:04:14 +0000",
										"thetext": "I cannot reproduce any hangs during the dist-upgrade when updating from an up-2-date fc24 or fc25, when having -21 libdb installed *before* upgrading to fc26."
									},
									{
										"isprivate": "0",
										"commentid": "10477029",
										"comment_count": "76",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2017-06-05 12:07:11 +0000",
										"thetext": "libdb-5.3.28-21.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
									},
									{
										"isprivate": "0",
										"commentid": "10477241",
										"comment_count": "77",
										"who": {
											"text": "pmatilai",
											"name": "Panu Matilainen"
										},
										"bug_when": "2017-06-05 13:01:19 +0000",
										"thetext": "(In reply to Bjrn \"besser82\" Esser from comment #75)\n> I cannot reproduce any hangs during the dist-upgrade when updating from an\n> up-2-date fc24 or fc25, when having -21 libdb installed *before* upgrading\n> to fc26.\n\nRight, and that's exactly the procedure that MUST be used, testing anything else is useless because it WILL fail unless libdb is updated to -21 first in a separate transaction.\n\nBased on the messages this seems to be working except with ppc64le from which we're seeing a bit mixed results. Which makes me suspect maybe ppc64le has a different issue on top of the one being fixed here."
									},
									{
										"isprivate": "0",
										"commentid": "10480074",
										"comment_count": "78",
										"who": {
											"text": "pkubat",
											"name": "Petr Kubat"
										},
										"bug_when": "2017-06-06 08:06:47 +0000",
										"thetext": "To extend upon Panu's comment:\n\nThe difference between upgrading from F24/25 with libdb updated to -21 and upgrading without the -21 libdb update already installed is that in the latter case (newly installed) libdb relies only on rpm's transaction lock to see whether it should rebuild rpmdb's environment due to VERSION_MISMATCH (change of libdb regions' internal structures) fixing the original glibc issue of bug 1394862. However since this is a feature of the -21 build there is a window in the update process after the new glibc is already installed and before the libdb -21 build gets installed during which an external process might freeze when accessing rpmdb's environment due to not being able to work with new glibc internals.\n\nIn the former case, having the libdb -21 build already installed on the system before running the upgrade to F26 makes libdb able to use its own internal flock-style lock of the environment (that is part of the fix for bug 1394862) during the upgrade instead of relying on the rpm's transaction lock (though the hack is still there to be able to install libdb -21 f24/25 build in the first place) so it would definitely be more safer running the upgrade this way.\n\nIn either of those cases I have yet to see a hang/crash get reproduced (if you can, let me know!)."
									},
									{
										"isprivate": "0",
										"commentid": "10481938",
										"comment_count": "79",
										"who": {
											"text": "menantea",
											"name": "Menanteau Guy"
										},
										"bug_when": "2017-06-06 15:17:43 +0000",
										"thetext": "I still have the problem in my side,\n1 - installed F-25 ppc64le \"minimal\"\n2 - created a side repo for F-25 libdb containing libdb-5.3.28-21.fc25.ppc64le \nand libdb-utils-5.3.28-21.fc25.ppc64le (downloaded from secondary koji)\n3 - do a \"dnf update\" and check new libdbxx -21 fc25 are installed\n4 - created a side repo for F-26 libdb containing libdb-5.3.28-21.fc26.ppc64le and libdb-utils-5.3.28-21.fc26.ppc64le (downloaded from primary koji)\n5 - run \"dnf system-upgrade download --releasever 26\" with the side repo F-26 enabled and check libdbxx -21 fc25 will be upgraded by libdbxx -21 fc26\n6 - run \"dnf system-upgrade reboot\"\n- and got a hung at \n[643/739] Cleanup crypto-policies-20160921-4.gitf3018dd.fc25.noarch...\n\nNote that I hung the same way without creation of F-26 repo of step 4 (only f25 updated with libdb -21 fc25 and no libdb repo F-26 before the system-upgrade)."
									},
									{
										"isprivate": "0",
										"commentid": "10481969",
										"comment_count": "80",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-06-06 15:24:11 +0000",
										"thetext": "I tried today again and can't reproduce it on ppoc64le. Guy, could you store the list of installed rpms from the F-25 system before starting the update? I suspect something changed between Friday and Monday in the F-25 updates, so I would compare my list with yours."
									},
									{
										"isprivate": "0",
										"commentid": "10482200",
										"comment_count": "81",
										"who": {
											"text": "menantea",
											"name": "Menanteau Guy"
										},
										"bug_when": "2017-06-06 16:23:30 +0000",
										"thetext": "Created attachment 1285467\ndnf list installed after \"dnf update\"\n\ndnf_list_installed.after_update is the list done just after the fc25 ppc64le installation update"
									},
									{
										"isprivate": "0",
										"commentid": "10482205",
										"comment_count": "82",
										"who": {
											"text": "menantea",
											"name": "Menanteau Guy"
										},
										"bug_when": "2017-06-06 16:24:21 +0000",
										"thetext": "Created attachment 1285468\nbefore update\n\ndnf_list_installed.before_upgrade is the list done after the fc25 ppc64le installation update + install of packages \"createrepo, wget, libdb -21 and libdb-utils -21\" (and dependencies)."
									},
									{
										"isprivate": "0",
										"commentid": "10486556",
										"comment_count": "83",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2017-06-07 17:40:51 +0000",
										"thetext": "libdb-5.3.28-21.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
									},
									{
										"isprivate": "0",
										"commentid": "10487164",
										"comment_count": "84",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2017-06-07 20:15:42 +0000",
										"thetext": "libdb-5.3.28-21.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf"
									},
									{
										"isprivate": "0",
										"commentid": "10488132",
										"comment_count": "85",
										"who": {
											"text": "skumari",
											"name": "Sinny Kumari"
										},
										"bug_when": "2017-06-08 06:41:10 +0000",
										"thetext": "(In reply to Dan Hork from comment #17)\n> s390x is affected as well\n\nUpgrade issue seems to be fixed for s390x as well. Did following:\n- Installed F25 and \"dnf update\"\n- created side repo for F-26 with latest libdb and libdb-utils package from s390-koji  (libdb-utils-5.3.28-21.fc26.s390x and libdb-5.3.28-21.fc26.s390x)\n- Ran \"dnf distro-sync --releasever 26\" with the side repo enabled\n- distro-sync finished successfully\n- Rebooted system successfully"
									},
									{
										"isprivate": "0",
										"commentid": "10488805",
										"comment_count": "86",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-06-08 09:57:00 +0000",
										"thetext": "Seems I can reproduce Guy's hang, with libdb-5.3.28-21.fc25.ppc64le updated before the upgrade starts."
									},
									{
										"isprivate": "0",
										"commentid": "10488846",
										"comment_count": "87",
										"who": {
											"text": "menantea",
											"name": "Menanteau Guy"
										},
										"bug_when": "2017-06-08 10:10:42 +0000",
										"thetext": "Upgrade of f25 ppc64le to f26 succeed when I use \"dnf distro-sync\" process described by Sinny (comment #85) instead of \"dnf system-upgrade\" process used by openqa test (comment #1) and described by Paul (comment #8)"
									},
									{
										"isprivate": "0",
										"commentid": "10490097",
										"comment_count": "88",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-06-08 15:53:19 +0000",
										"thetext": "this is log from my stuck upgrade on ppc64le with libdb-5.3.28-21.fc25.ppc64le installed\n\n...\nD: ========== +++ crypto-policies-20160921-4.gitf3018dd.fc25 noarch-linux 0x0\nD:     erase: crypto-policies-20160921-4.gitf3018dd.fc25.noarch has 46 files\nD: Plugin: calling hook psm_pre in selinux plugin\nD: skip       100644  1 (   0,   0)  2856 /usr/share/man/man8/update-crypto-policies.8.gz\nD: skip       100644  1 (   0,   0) 26432 /usr/share/licenses/crypto-policies/COPYING.LESSER\nD: skip       040755  2 (   0,   0)  4096 /usr/share/licenses/crypto-policies\nD: skip       100644  1 (   0,   0)    70 /usr/share/crypto-policies/reload-cmds.sh\nD: skip       100644  1 (   0,   0)   606 /usr/share/crypto-policies/default-config\nD: skip       100644  1 (   0,   0)    87 /usr/share/crypto-policies/LEGACY/openssl.txt\nD: skip       100644  1 (   0,   0)   431 /usr/share/crypto-policies/LEGACY/nss.txt\nD: skip       100644  1 (   0,   0)   142 /usr/share/crypto-policies/LEGACY/krb5.txt\nD: skip       100644  1 (   0,   0)   312 /usr/share/crypto-policies/LEGACY/java.txt\nD: skip       100644  1 (   0,   0)   438 /usr/share/crypto-policies/LEGACY/gnutls28.txt\nD: skip       100644  1 (   0,   0)   496 /usr/share/crypto-policies/LEGACY/gnutls.txt\nD: skip       100644  1 (   0,   0)    64 /usr/share/crypto-policies/LEGACY/bind.txt\nD: skip       100644  1 (   0,   0)   103 /usr/share/crypto-policies/FUTURE/openssl.txt\nD: skip       100644  1 (   0,   0)   400 /usr/share/crypto-policies/FUTURE/nss.txt\nD: skip       100644  1 (   0,   0)   111 /usr/share/crypto-policies/FUTURE/krb5.txt\nD: skip       100644  1 (   0,   0)   386 /usr/share/crypto-policies/FUTURE/java.txt\nD: skip       100644  1 (   0,   0)   420 /usr/share/crypto-policies/FUTURE/gnutls28.txt\nD: skip       100644  1 (   0,   0)   465 /usr/share/crypto-policies/FUTURE/gnutls.txt\nD: skip       100644  1 (   0,   0)   105 /usr/share/crypto-policies/FUTURE/bind.txt\nD: skip       100644  1 (   0,   0)   160 /usr/share/crypto-policies/EMPTY/openssl.txt\nD: skip       100644  1 (   0,   0)   145 /usr/share/crypto-policies/EMPTY/nss.txt\nD: skip       100644  1 (   0,   0)    22 /usr/share/crypto-policies/EMPTY/krb5.txt\nD: skip       100644  1 (   0,   0)   594 /usr/share/crypto-policies/EMPTY/java.txt\nD: skip       100644  1 (   0,   0)    36 /usr/share/crypto-policies/EMPTY/gnutls28.txt\nD: skip       100644  1 (   0,   0)    36 /usr/share/crypto-policies/EMPTY/gnutls.txt\nD: skip       100644  1 (   0,   0)   123 /usr/share/crypto-policies/EMPTY/bind.txt\nD: skip       100644  1 (   0,   0)    97 /usr/share/crypto-policies/DEFAULT/openssl.txt\nD: skip       100644  1 (   0,   0)   418 /usr/share/crypto-policies/DEFAULT/nss.txt\nD: skip       100644  1 (   0,   0)   125 /usr/share/crypto-policies/DEFAULT/krb5.txt\nD: skip       100644  1 (   0,   0)   345 /usr/share/crypto-policies/DEFAULT/java.txt\nD: skip       100644  1 (   0,   0)   420 /usr/share/crypto-policies/DEFAULT/gnutls28.txt\nD: skip       100644  1 (   0,   0)   465 /usr/share/crypto-policies/DEFAULT/gnutls.txt\nD: skip       100644  1 (   0,   0)    70 /usr/share/crypto-policies/DEFAULT/bind.txt\nD: skip       040755  6 (   0,   0)  4096 /usr/share/crypto-policies\nD: skip       100755  1 (   0,   0)  2362 /usr/bin/update-crypto-policies\nD: skip       040755  2 (   0,   0)  4096 /etc/crypto-policies/local.d\nD: skip       100644  1 (   0,   0)   606 /etc/crypto-policies/config\nD: skip       120777  1 (   0,   0)    46 /etc/crypto-policies/back-ends/openssl.config\nD: skip       120777  1 (   0,   0)    42 /etc/crypto-policies/back-ends/nss.config\nD: skip       120777  1 (   0,   0)    43 /etc/crypto-policies/back-ends/krb5.config\nD: skip       120777  1 (   0,   0)    43 /etc/crypto-policies/back-ends/java.config\nD: skip       120777  1 (   0,   0)    47 /etc/crypto-policies/back-ends/gnutls28.config\nD: skip       120777  1 (   0,   0)    45 /etc/crypto-policies/back-ends/gnutls.config\nD: skip       120777  1 (   0,   0)    43 /etc/crypto-policies/back-ends/bind.config\nD: skip       040755  2 (   0,   0)  4096 /etc/crypto-policies/back-ends\nD: skip       040755  5 (   0,   0)  4096 /etc/crypto-policies\nfdio:       2 writes,      759 total bytes in 0.000020 secs\nD:   --- h#     186 crypto-policies-20160921-4.gitf3018dd.fc25.noarch\nD: adding \"crypto-policies\" to Name index.\nD: adding 46 entries to Basenames index.\nD: adding \"Unspecified\" to Group index.\nD: adding 8 entries to Requirename index.\nD: adding 2 entries to Providename index.\nD: adding 14 entries to Dirnames index.\nD: adding 1 entries to Installtid index.\nD: adding 1 entries to Sigmd5 index.\nD: adding \"9f33e91a20fa838c5e85706350d2b9c7e5d4ac2c\" to Sha1header index.\nD: ========== +++ krb5-libs-1.14.4-7.fc25 ppc64le-linux 0x2\nD:     erase: krb5-libs-1.14.4-7.fc25.ppc64le has 41 files\nD: Plugin: calling hook psm_pre in selinux plugin\nD: %triggerun(krb5-libs-1.15.1-8.fc26.ppc64le): scriptlet start\nD: %triggerun(krb5-libs-1.15.1-8.fc26.ppc64le): execv(/bin/sh) pid 3867\nD: Plugin: calling hook scriptlet_fork_post in selinux plugin\nD: setexecfilecon: (/bin/sh) \n++ rpm -q --qf '%{VERSION}\\n' krb5-libs\n++ sort -V\n++ tr -d '\\n'\n++ head -n 1\n+ old_ver=1.14.4\n++ rpm -q --qf '%{RELEASE}\\n' krb5-libs\n++ sort -V\n++ head -n 1\n++ tr -d '\\n'\n+ old_rel=7.fc25\n+ old_rel=7\n+ [[ 1.14.4 < 1.15.1 ]]\n+ grep -q 'includedir /etc/krb5.conf.d' /etc/krb5.conf\n+ exit 0\nD: %triggerun(krb5-libs-1.15.1-8.fc26.ppc64le): waitpid(3867) rc 3867 status 0\n  Cleanup     : krb5-libs-1.14.4-7.fc25.ppc64le                                                                                                                                       613/706 \nD: skip       040755  2 (   0,   0)  4096 /var/kerberos/krb5/user\nD: skip       040755  3 (   0,   0)  4096 /var/kerberos/krb5\nD: skip       040755  3 (   0,   0)  4096 /var/kerberos\nD: skip       100644  1 (   0,   0) 13970 /usr/share/man/man5/krb5.conf.5.gz\nD: skip       100644  1 (   0,   0)  1176 /usr/share/man/man5/k5login.5.gz\nD: skip       100644  1 (   0,   0)  1207 /usr/share/man/man5/k5identity.5.gz\nD: skip       100644  1 (   0,   0)    39 /usr/share/man/man5/.k5login.5.gz\nD: skip       100644  1 (   0,   0)    42 /usr/share/man/man5/.k5identity.5.gz\nD: skip       100644  1 (   0,   0)   410 /usr/share/locale/en_US/LC_MESSAGES/mit-krb5.mo\nD: skip       100644  1 (   0,   0) 61301 /usr/share/licenses/krb5-libs/LICENSE\nD: skip       040755  2 (   0,   0)  4096 /usr/share/licenses/krb5-libs\nD: skip       100644  1 (   0,   0) 15120 /usr/share/doc/krb5-libs/README\nD: skip       100644  1 (   0,   0) 61301 /usr/share/doc/krb5-libs/NOTICE\nD: skip       040755  2 (   0,   0)  4096 /usr/share/doc/krb5-libs\nD: skip       100755  1 (   0,   0)135408 /usr/lib64/libkrb5support.so.0.1\nD: skip       120777  1 (   0,   0)    21 /usr/lib64/libkrb5support.so.0\nD: skip       100755  1 (   0,   0)1199384 /usr/lib64/libkrb5.so.3.3\nD: skip       120777  1 (   0,   0)    14 /usr/lib64/libkrb5.so.3\nD: skip       100755  1 (   0,   0) 68576 /usr/lib64/libkrad.so.0.0\nD: skip       120777  1 (   0,   0)    14 /usr/lib64/libkrad.so.0\nD: skip       100755  1 (   0,   0)135224 /usr/lib64/libkdb5.so.8.0\nD: skip       120777  1 (   0,   0)    14 /usr/lib64/libkdb5.so.8\nD: skip       100755  1 (   0,   0)267296 /usr/lib64/libk5crypto.so.3.1\nD: skip       120777  1 (   0,   0)    18 /usr/lib64/libk5crypto.so.3\nD: skip       100755  1 (   0,   0)202424 /usr/lib64/libgssrpc.so.4.2\nD: skip       120777  1 (   0,   0)    16 /usr/lib64/libgssrpc.so.4\nD: skip       100755  1 (   0,   0)402960 /usr/lib64/libgssapi_krb5.so.2.2\nD: skip       120777  1 (   0,   0)    21 /usr/lib64/libgssapi_krb5.so.2\nD: skip       100755  1 (   0,   0) 68584 /usr/lib64/krb5/plugins/tls/k5tls.so\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/tls\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/preauth\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/libkrb5\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/kdb\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/authdata\nD: skip       040755  7 (   0,   0)  4096 /usr/lib64/krb5/plugins\nD: skip       040755  3 (   0,   0)  4096 /usr/lib64/krb5\nD: skip       120777  1 (   0,   0)    42 /etc/krb5.conf.d/crypto-policies\nD: skip       040755  2 (   0,   0)  4096 /etc/krb5.conf.d\nD: skip       100644  1 (   0,   0)   677 /etc/krb5.conf\nD: skip       040755  2 (   0,   0)  4096 /etc/gss/mech.d\nD: skip       040755  3 (   0,   0)  4096 /etc/gss\nD: %postun(krb5-libs-1.14.4-7.fc25.ppc64le): scriptlet start\nD: %postun(krb5-libs-1.14.4-7.fc25.ppc64le): execv(/sbin/ldconfig) pid 3879\nD: Plugin: calling hook scriptlet_fork_post in selinux plugin\nD: setexecfilecon: (/sbin/ldconfig) \nD: %postun(krb5-libs-1.14.4-7.fc25.ppc64le): waitpid(3879) rc 3879 status 0"
									},
									{
										"isprivate": "0",
										"commentid": "10490141",
										"comment_count": "89",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2017-06-08 16:04:29 +0000",
										"thetext": "libdb-5.3.28-21.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
									},
									{
										"isprivate": "0",
										"commentid": "10490167",
										"comment_count": "90",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2017-06-08 16:10:32 +0000",
										"thetext": "libdb-5.3.28-21.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf"
									},
									{
										"isprivate": "0",
										"commentid": "10490652",
										"comment_count": "91",
										"who": {
											"text": "awilliam",
											"name": "Adam Williamson"
										},
										"bug_when": "2017-06-08 19:23:37 +0000",
										"thetext": "As this is supposed to be a *tracking* bug, can someone file a new bug for the outstanding ppc64le issue and mark it as fixing this bug? I'll edit the updates to *not* close this bug."
									},
									{
										"isprivate": "0",
										"commentid": "10490658",
										"comment_count": "92",
										"who": {
											"text": "awilliam",
											"name": "Adam Williamson"
										},
										"bug_when": "2017-06-08 19:26:32 +0000",
										"thetext": "sorry, of course I meant \"mark it as blocking this bug\" not \"mark it as fixing this bug\"."
									},
									{
										"isprivate": "0",
										"commentid": "10499102",
										"comment_count": "93",
										"who": {
											"text": "labbott",
											"name": "Laura Abbott"
										},
										"bug_when": "2017-06-12 20:33:15 +0000",
										"thetext": "*** Bug 1460147 has been marked as a duplicate of this bug. ***"
									},
									{
										"isprivate": "0",
										"commentid": "10665030",
										"comment_count": "94",
										"who": {
											"text": "ignatenko",
											"name": "Igor Gnatenko"
										},
										"bug_when": "2017-08-02 11:06:43 +0000",
										"thetext": "*** Bug 1476493 has been marked as a duplicate of this bug. ***"
									},
									{
										"isprivate": "0",
										"commentid": "11555099",
										"comment_count": "95",
										"who": {
											"text": "bcotton",
											"name": "Fedora End Of Life"
										},
										"bug_when": "2018-05-03 08:29:45 +0000",
										"thetext": "This message is a reminder that Fedora 26 is nearing its end of life.\nApproximately 4 (four) weeks from now Fedora will stop maintaining\nand issuing updates for Fedora 26. It is Fedora's policy to close all\nbug reports from releases that are no longer maintained. At that time\nthis bug will be closed as EOL if it remains open with a Fedora  'version'\nof '26'.\n\nPackage Maintainer: If you wish for this bug to remain open because you\nplan to fix it in a currently maintained version, simply change the 'version'\nto a later Fedora version.\n\nThank you for reporting this issue and we are sorry that we were not\nable to fix it before Fedora 26 is end of life. If you would still like\nto see this bug fixed and are able to reproduce it against a later version\nof Fedora, you are encouraged  change the 'version' to a later Fedora\nversion prior this bug is closed as described in the policy above.\n\nAlthough we aim to fix as many bugs as possible during every release's\nlifetime, sometimes those efforts are overtaken by events. Often a\nmore recent Fedora release includes newer upstream software that fixes\nbugs or makes them obsolete."
									},
									{
										"isprivate": "0",
										"commentid": "11648581",
										"comment_count": "96",
										"who": {
											"text": "bcotton",
											"name": "Fedora End Of Life"
										},
										"bug_when": "2018-05-29 12:12:31 +0000",
										"thetext": "Fedora 26 changed to end-of-life (EOL) status on 2018-05-29. Fedora 26\nis no longer maintained, which means that it will not receive any\nfurther security or bug fix updates. As a result we are closing this bug.\n\nIf you can reproduce this bug against a currently maintained version of\nFedora please feel free to reopen this bug against that version. If you\nare unable to reopen this bug, please file a new report against the\ncurrent release. If you experience problems, please add a comment to this\nbug.\n\nThank you for reporting this bug and we are sorry it could not be fixed."
									}
								]
							}
						],
						"external_bugs": {
							"text": "1460303",
							"name": "Red Hat Bugzilla"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "9908788",
								"comment_count": "0",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2016-11-21 15:11:10 +0000",
								"thetext": "Description of problem:\nI do not have a deterministic reproducer. But I happen for me when building\ndocker images based on rawhide. The bug is reproducible with dnf and yum-deprecated therefore I assume bug is in rpm. But I noticed there are valgrind errors with uninitialized memory which might explain difficult reproducer.\n\nVersion-Release number of selected component (if applicable):\nrpm-4.13.0-4.fc26.x86_64\n\nHow reproducible:\nDeterministic in my environment when building docker image\nIt happened to me that installation was stuck even for installation of simple pacakge (lftp)\n\nSteps to Reproduce:\n# docker run -ti --rm fedora:rawhide bash\nRun docker images for fedora rawhide and run following commands inside container\n1. dnf update -y 'rpm*'\n2. dnf install -y 'dnf-command(builddep)' valgrind\n3. dnf debuginfo-install -y rpm libdb\n# try to install package with minimal dependencies (e.g. lftp)\n4. valgrind --track-origins=yes dnf install -y lftp\n\nActual results:\nTotal                                                                                                                                                      215 kB/s | 822 kB     00:03     \nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Installing  : lftp-4.7.3-1.fc25.x86_64                                                                                                                                               1/1 \n==83== Syscall param pwrite64(buf) points to uninitialised byte(s)\n==83==    at 0x5317DE3: ??? (in /usr/lib64/libpthread-2.24.90.so)\n==83==    by 0x12720C30: __os_io (in /usr/lib64/libdb-5.3.so)\n==83==    by 0x1270C731: ??? (in /usr/lib64/libdb-5.3.so)\n==83==    by 0x1270CBA2: __memp_bhwrite (in /usr/lib64/libdb-5.3.so)\n==83==    by 0x1271CE14: __memp_sync_int (in /usr/lib64/libdb-5.3.so)\n==83==    by 0x126B2D16: __db_sync (in /usr/lib64/libdb-5.3.so)\n==83==    by 0x126C53CF: __db_sync_pp (in /usr/lib64/libdb-5.3.so)\n==83==    by 0x11F53FF5: dbiSync (db3.c:547)\n==83==    by 0x11F53FF5: db3_dbiCursorFree (db3.c:606)\n==83==    by 0x11F5ECD9: rpmdbAdd (rpmdb.c:2411)\n==83==    by 0x11F72A0C: dbAdd (psm.c:551)\n==83==    by 0x11F72A0C: rpmPackageInstall (psm.c:682)\n==83==    by 0x11F72A0C: rpmpsmRun (psm.c:844)\n==83==    by 0x11F862A4: rpmteProcess (rpmte.c:756)\n==83==    by 0x11F8CBBD: rpmtsProcess (transaction.c:1361)\n==83==    by 0x11F8CBBD: rpmtsRun (transaction.c:1541)\n==83==  Address 0x8e59248 is 2,312 bytes inside a block of size 4,096 alloc'd\n==83==    at 0x4C2DB8D: malloc (vg_replace_malloc.c:299)\n==83==    by 0x1271E1F4: __os_malloc (in /usr/lib64/libdb-5.3.so)\n==83==    by 0x1270C897: ??? (in /usr/lib64/libdb-5.3.so)\n==83==    by 0x1270CBA2: __memp_bhwrite (in /usr/lib64/libdb-5.3.so)\n==83==    by 0x1271CE14: __memp_sync_int (in /usr/lib64/libdb-5.3.so)\n==83==    by 0x126B2D16: __db_sync (in /usr/lib64/libdb-5.3.so)\n==83==    by 0x126C53CF: __db_sync_pp (in /usr/lib64/libdb-5.3.so)\n==83==    by 0x11F53FF5: dbiSync (db3.c:547)\n==83==    by 0x11F53FF5: db3_dbiCursorFree (db3.c:606)\n==83==    by 0x11F5ECD9: rpmdbAdd (rpmdb.c:2411)\n==83==    by 0x11F72A0C: dbAdd (psm.c:551)\n==83==    by 0x11F72A0C: rpmPackageInstall (psm.c:682)\n==83==    by 0x11F72A0C: rpmpsmRun (psm.c:844)\n==83==    by 0x11F862A4: rpmteProcess (rpmte.c:756)\n==83==    by 0x11F8CBBD: rpmtsProcess (transaction.c:1361)\n==83==    by 0x11F8CBBD: rpmtsRun (transaction.c:1541)\n==83==  Uninitialised value was created by a stack allocation\n==83==    at 0x125EB590: ??? (in /usr/lib64/libdb-5.3.so)\n==83== \n  Verifying   : lftp-4.7.3-1.fc25.x86_64                                                                                                                                               1/1 \n\nInstalled:\n  lftp.x86_64 4.7.3-1.fc25                                                                                                                                                                 \n\nComplete!\n==83== \n==83== HEAP SUMMARY:\n==83==     in use at exit: 58,246,804 bytes in 53,257 blocks\n==83==   total heap usage: 447,873 allocs, 394,616 frees, 3,993,424,200 bytes allocated\n==83== \n==83== LEAK SUMMARY:\n==83==    definitely lost: 345 bytes in 20 blocks\n==83==    indirectly lost: 0 bytes in 0 blocks\n==83==      possibly lost: 3,164,151 bytes in 18,487 blocks\n==83==    still reachable: 55,081,988 bytes in 34,747 blocks\n==83==                       of which reachable via heuristic:\n==83==                         length64           : 426,096 bytes in 504 blocks\n==83==                         newarray           : 1,536 bytes in 16 blocks\n==83==         suppressed: 0 bytes in 0 blocks\n==83== Rerun with --leak-check=full to see details of leaked memory\n==83== \n==83== For counts of detected and suppressed errors, rerun with: -v\n==83== ERROR SUMMARY: 5 errors from 1 contexts (suppressed: 0 from 0)\n\nExpected results:\nERROR SUMMARY has 0 errors\n\nAdditional info:\nI can see a little bit different valgrind error with direct usage of rpm bianry\n\nsh# rpm -e lftp\nsh# valgrind --track-origins=yes rpm -ivh https://kojipkgs.fedoraproject.org//packages/lftp/4.7.3/1.fc25/x86_64/lftp-4.7.3-1.fc25.x86_64.rpm\n==91== Memcheck, a memory error detector\n==91== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==91== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==91== Command: rpm -ivh https://kojipkgs.fedoraproject.org//packages/lftp/4.7.3/1.fc25/x86_64/lftp-4.7.3-1.fc25.x86_64.rpm\n==91== \nRetrieving https://kojipkgs.fedoraproject.org//packages/lftp/4.7.3/1.fc25/x86_64/lftp-4.7.3-1.fc25.x86_64.rpm\nPreparing...                          ################################# [100%]\nUpdating / installing...\n   1:lftp-4.7.3-1.fc25                ################################# [100%]\n==91== Syscall param pwrite64(buf) points to uninitialised byte(s)\n==91==    at 0x6FA0DC3: __pwrite64_nocancel (in /usr/lib64/libpthread-2.24.90.so)\n==91==    by 0x584AC30: __os_io (in /usr/lib64/libdb-5.3.so)\n==91==    by 0x5836731: ??? (in /usr/lib64/libdb-5.3.so)\n==91==    by 0x5836BA2: __memp_bhwrite (in /usr/lib64/libdb-5.3.so)\n==91==    by 0x5846E14: __memp_sync_int (in /usr/lib64/libdb-5.3.so)\n==91==    by 0x57DCD16: __db_sync (in /usr/lib64/libdb-5.3.so)\n==91==    by 0x57EF3CF: __db_sync_pp (in /usr/lib64/libdb-5.3.so)\n==91==    by 0x4E4EFF5: dbiSync (db3.c:547)\n==91==    by 0x4E4EFF5: db3_dbiCursorFree (db3.c:606)\n==91==    by 0x4E5626E: tag2index (rpmdb.c:2368)\n==91==    by 0x4E59D4A: indexPut (rpmdb.c:2377)\n==91==    by 0x4E59D4A: rpmdbAdd (rpmdb.c:2421)\n==91==    by 0x4E6DA0C: dbAdd (psm.c:551)\n==91==    by 0x4E6DA0C: rpmPackageInstall (psm.c:682)\n==91==    by 0x4E6DA0C: rpmpsmRun (psm.c:844)\n==91==    by 0x4E812A4: rpmteProcess (rpmte.c:756)\n==91==  Address 0x9036f30 is in a rw- mapped file /var/lib/rpm/__db.003 segment\n==91==  Uninitialised value was created by a stack allocation\n==91==    at 0x572A740: ??? (in /usr/lib64/libdb-5.3.so)\n==91== \n==91== \n==91== HEAP SUMMARY:\n==91==     in use at exit: 13,716 bytes in 78 blocks\n==91==   total heap usage: 12,555 allocs, 12,477 frees, 15,969,502 bytes allocated\n==91== \n==91== LEAK SUMMARY:\n==91==    definitely lost: 0 bytes in 0 blocks\n==91==    indirectly lost: 0 bytes in 0 blocks\n==91==      possibly lost: 0 bytes in 0 blocks\n==91==    still reachable: 13,716 bytes in 78 blocks\n==91==         suppressed: 0 bytes in 0 blocks\n==91== Rerun with --leak-check=full to see details of leaked memory\n==91== \n==91== For counts of detected and suppressed errors, rerun with: -v\n==91== ERROR SUMMARY: 4 errors from 1 contexts (suppressed: 0 from 0)"
							},
							{
								"isprivate": "0",
								"commentid": "9908811",
								"comment_count": "1",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2016-11-21 15:18:43 +0000",
								"thetext": "The valgrind complaint is an ages old false positive caused by BDB internal optimization, its even documented somewhere in BDB doco.\n\nTry looking at what it's actually doing when it appears stuck - is it burning cpu/io cycles or just hanging there etc."
							},
							{
								"isprivate": "0",
								"commentid": "9908828",
								"comment_count": "2",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2016-11-21 15:23:23 +0000",
								"thetext": "(In reply to Panu Matilainen from comment #1)\n> The valgrind complaint is an ages old false positive caused by BDB internal\n> optimization, its even documented somewhere in BDB doco.\n> \n> Try looking at what it's actually doing when it appears stuck - is it\n> burning cpu/io cycles or just hanging there etc.\n\nThere is not any activity, but I can see also different valgrind error\nwhich does not contain 'dbiSync'\n\nSteps to Reproduce:\n# docker run -ti --rm fedora:rawhide bash\nRun docker images for fedora rawhide and run following commands inside container\n    1  dnf update -y 'rpm*'\n    2  dnf install -y 'dnf-command(builddep)' valgrind\n    3  dnf debuginfo-install -y rpm libdb\n    4  valgrind --track-origins=yes dnf update -y glibc\n\n[root@d609e6427820 /]# valgrind --track-origins=yes dnf update -y glibc        \n==80== Memcheck, a memory error detector\n==80== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==80== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==80== Command: /usr/bin/dnf update -y glibc\n==80== \nLast metadata expiration check: 0:02:12 ago on Mon Nov 21 15:15:36 2016 UTC.\nDependencies resolved.\n================================================================================\n Package                  Arch        Version                Repository    Size\n================================================================================\nUpgrading:\n glibc                    x86_64      2.24.90-17.fc26        rawhide      3.3 M\n glibc-all-langpacks      x86_64      2.24.90-17.fc26        rawhide      7.0 M\n glibc-common             x86_64      2.24.90-17.fc26        rawhide      881 k\n libcrypt-nss             x86_64      2.24.90-17.fc26        rawhide       46 k\n\nTransaction Summary\n================================================================================\nUpgrade  4 Packages\n\nTotal download size: 11 M\nDownloading Packages:\n(1/4): glibc-common-2.24.90-17.fc26.x86_64.rpm  1.8 MB/s | 881 kB     00:00    \n(2/4): libcrypt-nss-2.24.90-17.fc26.x86_64.rpm  1.6 MB/s |  46 kB     00:00    \n(3/4): glibc-2.24.90-17.fc26.x86_64.rpm         2.2 MB/s | 3.3 MB     00:01    \n(4/4): glibc-all-langpacks-2.24.90-17.fc26.x86_ 2.4 MB/s | 7.0 MB     00:02    \n--------------------------------------------------------------------------------\nTotal                                           1.7 MB/s |  11 MB     00:06     \nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Upgrading   : glibc-common-2.24.90-17.fc26.x86_64                         1/8 \n==80== Syscall param pwrite64(buf) points to uninitialised byte(s)\n==80==    at 0x5317DE3: ??? (in /usr/lib64/libpthread-2.24.90.so)\n==80==    by 0x12720C30: __os_io (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x1270C731: ??? (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x1270CBA2: __memp_bhwrite (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x1271CE14: __memp_sync_int (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x126B2D16: __db_sync (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x126C53CF: __db_sync_pp (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x11F53FF5: dbiSync (db3.c:547)\n==80==    by 0x11F53FF5: db3_dbiCursorFree (db3.c:606)\n==80==    by 0x11F5ECD9: rpmdbAdd (rpmdb.c:2411)\n==80==    by 0x11F72A0C: dbAdd (psm.c:551)\n==80==    by 0x11F72A0C: rpmPackageInstall (psm.c:682)\n==80==    by 0x11F72A0C: rpmpsmRun (psm.c:844)\n==80==    by 0x11F862A4: rpmteProcess (rpmte.c:756)\n==80==    by 0x11F8CBBD: rpmtsProcess (transaction.c:1361)\n==80==    by 0x11F8CBBD: rpmtsRun (transaction.c:1541)\n==80==  Address 0x7017596 is 2,278 bytes inside a block of size 4,096 alloc'd\n==80==    at 0x4C2DB8D: malloc (vg_replace_malloc.c:299)\n==80==    by 0x1271E1F4: __os_malloc (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x1270C897: ??? (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x1270CBA2: __memp_bhwrite (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x1271CE14: __memp_sync_int (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x126B2D16: __db_sync (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x126C53CF: __db_sync_pp (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x11F53FF5: dbiSync (db3.c:547)\n==80==    by 0x11F53FF5: db3_dbiCursorFree (db3.c:606)\n==80==    by 0x11F5ECD9: rpmdbAdd (rpmdb.c:2411)\n==80==    by 0x11F72A0C: dbAdd (psm.c:551)\n==80==    by 0x11F72A0C: rpmPackageInstall (psm.c:682)\n==80==    by 0x11F72A0C: rpmpsmRun (psm.c:844)\n==80==    by 0x11F862A4: rpmteProcess (rpmte.c:756)\n==80==    by 0x11F8CBBD: rpmtsProcess (transaction.c:1361)\n==80==    by 0x11F8CBBD: rpmtsRun (transaction.c:1541)\n==80==  Uninitialised value was created by a stack allocation\n==80==    at 0x125EB590: ??? (in /usr/lib64/libdb-5.3.so)\n==80== \n  Upgrading   : glibc-all-langpacks-2.24.90-17.fc26.x86_64                  2/8 \n==80== Conditional jump or move depends on uninitialised value(s)\n==80==    at 0x1260C694: __bam_stkrel (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x125FD257: ??? (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x126B71DB: __dbc_iput (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x126C69C0: __dbc_put_pp (in /usr/lib64/libdb-5.3.so)\n==80==    by 0x11F53234: dbiCursorPut.isra.5 (db3.c:626)\n==80==    by 0x11F551C0: updateIndex.part.8 (db3.c:1097)\n==80==    by 0x11F55590: updateIndex (db3.c:1144)\n==80==    by 0x11F55590: db3_idxdbPut (db3.c:1140)\n==80==    by 0x11F5B0B2: tag2index (rpmdb.c:2348)\n==80==    by 0x11F5ED4A: indexPut (rpmdb.c:2377)\n==80==    by 0x11F5ED4A: rpmdbAdd (rpmdb.c:2421)\n==80==    by 0x11F72A0C: dbAdd (psm.c:551)\n==80==    by 0x11F72A0C: rpmPackageInstall (psm.c:682)\n==80==    by 0x11F72A0C: rpmpsmRun (psm.c:844)\n==80==    by 0x11F862A4: rpmteProcess (rpmte.c:756)\n==80==    by 0x11F8CBBD: rpmtsProcess (transaction.c:1361)\n==80==    by 0x11F8CBBD: rpmtsRun (transaction.c:1541)\n==80==  Uninitialised value was created by a stack allocation\n==80==    at 0x125E9C50: ??? (in /usr/lib64/libdb-5.3.so)\n==80== \n  Upgrading   : glibc-2.24.90-17.fc26.x86_64                                3/8 \n  Upgrading   : libcrypt-nss-2.24.90-17.fc26.x86_64                         4/8 \n  Cleanup     : libcrypt-nss-2.24.90-2.fc26.x86_64                          5/8 \n  Cleanup     : glibc-common-2.24.90-2.fc26.x86_64                          6/8 \n  Cleanup     : glibc-all-langpacks-2.24.90-2.fc26.x86_64                   7/8 \n  Cleanup     : glibc-2.24.90-2.fc26.x86_64                                 8/8 \n  Verifying   : glibc-2.24.90-17.fc26.x86_64                                1/8 \n  Verifying   : glibc-common-2.24.90-17.fc26.x86_64                         2/8 \n  Verifying   : glibc-all-langpacks-2.24.90-17.fc26.x86_64                  3/8 \n  Verifying   : libcrypt-nss-2.24.90-17.fc26.x86_64                         4/8 \n  Verifying   : glibc-2.24.90-2.fc26.x86_64                                 5/8 \n  Verifying   : glibc-all-langpacks-2.24.90-2.fc26.x86_64                   6/8 \n  Verifying   : glibc-common-2.24.90-2.fc26.x86_64                          7/8 \n  Verifying   : libcrypt-nss-2.24.90-2.fc26.x86_64                          8/8 \n\nUpgraded:\n  glibc.x86_64 2.24.90-17.fc26                                                  \n  glibc-all-langpacks.x86_64 2.24.90-17.fc26                                    \n  glibc-common.x86_64 2.24.90-17.fc26                                           \n  libcrypt-nss.x86_64 2.24.90-17.fc26                                           \n\nComplete!\n==80== \n==80== HEAP SUMMARY:\n==80==     in use at exit: 58,807,031 bytes in 56,957 blocks\n==80==   total heap usage: 1,264,661 allocs, 1,207,704 frees, 4,144,098,835 bytes allocated\n==80== \n==80== LEAK SUMMARY:\n==80==    definitely lost: 1,521 bytes in 23 blocks\n==80==    indirectly lost: 125,140 bytes in 66 blocks\n==80==      possibly lost: 3,288,601 bytes in 19,571 blocks\n==80==    still reachable: 55,391,001 bytes in 37,287 blocks\n==80==                       of which reachable via heuristic:\n==80==                         length64           : 426,096 bytes in 504 blocks\n==80==                         newarray           : 1,536 bytes in 16 blocks\n==80==         suppressed: 0 bytes in 0 blocks\n==80== Rerun with --leak-check=full to see details of leaked memory\n==80== \n==80== For counts of detected and suppressed errors, rerun with: -v\n==80== ERROR SUMMARY: 34 errors from 2 contexts (suppressed: 0 from 0)"
							},
							{
								"isprivate": "0",
								"commentid": "9908899",
								"comment_count": "3",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2016-11-21 15:36:09 +0000",
								"thetext": "Created attachment 1222428\nDockerfile which reveal the bug very often\n\nCopy attached file to empty directory and build and image\nsh# docker build -t temp_rm_me .\n\nThe installation of build dependencies stuck for me with following output\nDependencies resolved.\n================================================================================\n Package                          Arch   Version                  Repository\n                                                                           Size\n================================================================================\nInstalling:\n 389-ds-base-devel                x86_64 1.3.6.1-1.fc26           rawhide 222 k\n autoconf                         noarch 2.69-23.fc26             rawhide 710 k\n automake                         noarch 1.15-8.fc26              rawhide 694 k\n cyrus-sasl-devel                 x86_64 2.1.26-27.fc26           rawhide 313 k\n dbus-python                      x86_64 1.2.4-2.fc25             rawhide 129 k\n\n//snip\n\nTransaction Summary\n================================================================================\nInstall  209 Packages\nUpgrade   28 Packages\nSkip      14 Packages\n\nTotal download size: 99 M\nDownloading Packages:\n--------------------------------------------------------------------------------\nTotal                                            28 MB/s |  99 MB     00:03     \nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Upgrading   : libcom_err-1.43.3-1.fc26.x86_64                           1/265 \n  Installing  : libtalloc-2.1.8-1.fc26.x86_64                             2/265 \n  Upgrading   : nspr-4.13.1-1.fc26.x86_64                                 3/265 \n  Installing  : libtevent-0.9.31-1.fc26.x86_64                            4/265 \n  Installing  : libtdb-1.3.11-1.fc26.x86_64                               5/265 \n  Upgrading   : nss-util-3.27.0-2.fc26.x86_64                             6/265 \n  Installing  : python2-six-1.10.0-4.fc26.noarch                          7/265 \n  Upgrading   : libuuid-2.29-1.fc26.x86_64                                8/265 \n  Installing  : libldb-1.1.27-1.fc26.x86_64                               9/265 \n  Upgrading   : pcre-8.39-6.fc26.x86_64                                  10/265 \n  Installing  : nspr-devel-4.13.1-1.fc26.x86_64                          11/265 \n  Upgrading   : libblkid-2.29-1.fc26.x86_64                              12/265 \n  Installing  : xmlrpc-c-1.32.5-1909.svn2451.fc24.x86_64                 13/265\n\n\nand there are just 2 processes inside container shell and python with dnf\n\n   CGroup: /system.slice/docker-04f608509c75dc43bb7a1c5e86fae071397b4969ba03d179cc0b3466229bfd37.scope\n           24379 /bin/sh -c dnf --setopt=deltarpm=0 --setopt=fastestmirror=1         --setopt=install_weak_deps=false --setopt=tsflags=nodocs         install -y             sudo             git             'dnf-command(builddep)'             @buildsys-build     && curl https://git.fedorahosted.org/cgit/freeipa.git/plain/freeipa.spec.in             -o freeipa.spec.in     && dnf --setopt=deltarpm=0 --setopt=fastestmirror=1            --setopt=install_weak_deps=false --setopt=tsflags=nodocs            builddep -y --spec freeipa.spec.in     && rm -f freeipa.spec.in     && dnf clean all\n           24589 /usr/libexec/system-python /usr/bin/dnf --setopt=deltarpm=0 --setopt=fastestmirror=1 --setopt=install_weak_deps=false --setopt=tsflags=nodocs builddep -y --spec freeipa.spec.in\n\n\nThe strace for python is:\nsh# strace -p 24589\nstrace: Process 24589 attached\nfutex(0x7ff6f2a11064, FUTEX_WAIT, 4294967295, NULL"
							},
							{
								"isprivate": "0",
								"commentid": "9908908",
								"comment_count": "4",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2016-11-21 15:37:49 +0000",
								"thetext": "As I mention in the description The same problem is with yum-deprecated.\nAnd if I try to install some packages manually the installation is stuck on different package."
							},
							{
								"isprivate": "0",
								"commentid": "9908916",
								"comment_count": "5",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2016-11-21 15:39:28 +0000",
								"thetext": "BTW my workaround is to remove && rebuild rpm-db before calling builddep\n\n--- a/Dockerfile        2016-11-21 16:24:25.994623950 +0100\n+++ b/Dockerfile        2016-11-21 14:53:04.466568545 +0100\n@@ -11,6 +11,8 @@\n             @buildsys-build \\\n     && curl https://git.fedorahosted.org/cgit/freeipa.git/plain/freeipa.spec.in \\\n             -o freeipa.spec.in \\\n+    && rm -f /var/lib/rpm/__db* \\\n+    && rpm --rebuilddb \\\n     && dnf --setopt=deltarpm=0 --setopt=fastestmirror=1 \\\n            --setopt=install_weak_deps=false --setopt=tsflags=nodocs \\\n            builddep -y --spec freeipa.spec.in \\"
							},
							{
								"isprivate": "0",
								"commentid": "9909228",
								"comment_count": "6",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2016-11-21 17:05:43 +0000",
								"thetext": "(In reply to Lukas Slebodnik from comment #5)\n> BTW my workaround is to remove && rebuild rpm-db before calling builddep\n> \n> --- a/Dockerfile        2016-11-21 16:24:25.994623950 +0100\n> +++ b/Dockerfile        2016-11-21 14:53:04.466568545 +0100\n> @@ -11,6 +11,8 @@\n>              @buildsys-build \\\n>      && curl\n> https://git.fedorahosted.org/cgit/freeipa.git/plain/freeipa.spec.in \\\n>              -o freeipa.spec.in \\\n> +    && rm -f /var/lib/rpm/__db* \\\n> +    && rpm --rebuilddb \\\n>      && dnf --setopt=deltarpm=0 --setopt=fastestmirror=1 \\\n>             --setopt=install_weak_deps=false --setopt=tsflags=nodocs \\\n>             builddep -y --spec freeipa.spec.in \\\n\nFlorian F. mentioned on IRC, that simpler workaround is just to remove var/lib/rpm/__db* files. Calling \"rpm --rebuilddb\" is not necessary."
							},
							{
								"isprivate": "0",
								"commentid": "9910703",
								"comment_count": "7",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2016-11-22 04:18:11 +0000",
								"thetext": "That sounds like there's a db cursor not getting freed somewhere."
							},
							{
								"isprivate": "0",
								"commentid": "9910772",
								"comment_count": "8",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2016-11-22 05:31:44 +0000",
								"thetext": "(too early in the morning...)\n\nOutput of 'db_stat -CA -h /var/lib/rpm' as root when it hangs would be interesting."
							},
							{
								"isprivate": "0",
								"commentid": "9911220",
								"comment_count": "9",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2016-11-22 09:09:25 +0000",
								"thetext": "Created attachment 1222632\nOutput of db_stat -CA -h /var/lib/rpm\n\nHere you are"
							},
							{
								"isprivate": "0",
								"commentid": "9911235",
								"comment_count": "10",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2016-11-22 09:11:06 +0000",
								"thetext": "FYI I also noticed that fedora rawhide has never version of libdb 5.3.28-15\nwhich should fix mutexes not being released properly (#1272680).\n\nI downgraded libdb to older version without this patch but it did not fix hangs."
							},
							{
								"isprivate": "0",
								"commentid": "9916191",
								"comment_count": "11",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2016-11-23 13:12:26 +0000",
								"thetext": "I hit this bug yesterday on my laptop when I was upgrading f25 -> rawhide.\nI had to cancel/kill dnf and as a side effect I had installed more version of packages because upgrade transaction has not been finished."
							},
							{
								"isprivate": "0",
								"commentid": "9917035",
								"comment_count": "12",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2016-11-23 16:26:34 +0000",
								"thetext": "Okay I can reproduce something remotely resembling that now. I'm on F24'ish system so details will differ but there are hints at least.\n\n# yum-deprecated --releasever=25 --installroot /srv/test --setopt=keepcache=true install bash\n[...]\n# db_stat -CA -h /srv/test/var/lib/rpm\ndb_stat: DB_ENV->open: /srv/test/var/lib/rpm: No such file or directory\n\nThat is how it should be, rpm removes the BDB environment after chroot operations. That's what happens with rpm itself (obviously). However doing the same with dnf:\n\n# dnf --releasever=25 --installroot /srv/test --setopt=keepcache=true install bash\n[...]\n# db_stat -CA -h /srv/test/var/lib/rpm|wc -l\n162\n\nIn this case they're all READ locks which rpm will mope up on the next run but it'll complain loudly. I know I've seen fleeting glimpses of those complaints where they shouldn't have existed, just haven't had a chance to investigate. But the screwy thing here is that the environment should not even exist after dnf exits! So it seems dnf is (re)opening the rpmdb from inside the chroot which is ... not a good idea. This is with dnf 1.1.10 on F24, IIRC F25 has 2.0 and newer hawkey/whatever so there's plenty of room for different behavior. \n\nYou said you can reproduce it with yum-deprecated, but can you actually reproduce the hang if you *only* use yum-deprecated all the way? (ie after using \"rm -f /var/lib/rpm/__db*\" to clear any cruft from earlier runs)"
							},
							{
								"isprivate": "0",
								"commentid": "9917095",
								"comment_count": "13",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2016-11-23 16:38:44 +0000",
								"thetext": "Another datapoint: for my testcase the problem is related to importing pubkeys. If I run dnf with --nogpgcheck or pre-import the keys to the test root, there are no leftover locks. Please test whether that makes a difference for you - its possible I'm seeing a different issue entirely, but its also quite possible it's the same issue but only worse with newer dnf."
							},
							{
								"isprivate": "0",
								"commentid": "9919154",
								"comment_count": "14",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2016-11-24 09:35:35 +0000",
								"thetext": "Right, never mind about the pubkey case, that appears to be relatively harmless.\n\nWhat kills it is any outside access to rpmdb during the transaction where glibc is updated to the rawhide version. For example 'db_stat -CA -h /var/lib/rpm' is fine until glibc has gotten updated, after that trying to run it causes both rpm and the db_stat process  tohang. Ditto for running 'rpm -qa' or such (as root) durin the update. That does not happen during eg F24 -> F25 glibc update.\n\nfweimer (cc'd): has there been some major futex-related change in rawhide glibc?"
							},
							{
								"isprivate": "0",
								"commentid": "9919237",
								"comment_count": "15",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2016-11-24 09:49:56 +0000",
								"thetext": "Oh, actually it's simpler than that: after updating to rawhide glibc, new rpm is dead until you nuke the BDB environment: 'rm -f /var/lib/rpm/__db*'"
							},
							{
								"isprivate": "0",
								"commentid": "9919244",
								"comment_count": "16",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2016-11-24 09:50:47 +0000",
								"thetext": "Oops, not \"new rpm\". Just \"rpm is dead\" until..."
							},
							{
								"isprivate": "0",
								"commentid": "9919351",
								"comment_count": "17",
								"who": {
									"text": "fweimer",
									"name": "Florian Weimer"
								},
								"bug_when": "2016-11-24 10:10:52 +0000",
								"thetext": "(In reply to Panu Matilainen from comment #14)\n> Right, never mind about the pubkey case, that appears to be relatively\n> harmless.\n> \n> What kills it is any outside access to rpmdb during the transaction where\n> glibc is updated to the rawhide version. For example 'db_stat -CA -h\n> /var/lib/rpm' is fine until glibc has gotten updated, after that trying to\n> run it causes both rpm and the db_stat process  tohang. Ditto for running\n> 'rpm -qa' or such (as root) durin the update. That does not happen during eg\n> F24 -> F25 glibc update.\n> \n> fweimer (cc'd): has there been some major futex-related change in rawhide\n> glibc?\n\nThis looks like bug 1394862.  Berkeley DB assumes that it's safe to use process-shared mutexes and condition variables after all processes have detached from a mapping, something which POSIX does not guarantee."
							},
							{
								"isprivate": "0",
								"commentid": "9919621",
								"comment_count": "18",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2016-11-24 10:35:18 +0000",
								"thetext": "(In reply to Florian Weimer from comment #17)\n> This looks like bug 1394862. \n\nOh, indeed. Thanks for the pointer.\n\n> Berkeley DB assumes that it's safe to use\n> process-shared mutexes and condition variables after all processes have\n> detached from a mapping, something which POSIX does not guarantee.\n\nRight. It's not the first time such glibc changes cause trouble for rpmdb, just been a while since the last one and BDB locks are still just as ill-suited for rpm as they ever were...\n\nTechnically this is a dupe of bug 1394862 but I'm leaving this open for now:\n1) people are more likely to find an rpm bug than a libdb one when installation hangs\n2) we might need to come up with some kind of workaround, we can't have every other upgrade blowing up in the middle\n\nAs for 2), we could have a trigger on glibc to always nuke the environment in that case, but I worry what it does to the already running rpm instance. Or we could have rpm use private bdb locking but that opens up other issues. Or something..."
							},
							{
								"isprivate": "0",
								"commentid": "10191601",
								"comment_count": "19",
								"who": {
									"text": "bcotton",
									"name": "Fedora End Of Life"
								},
								"bug_when": "2017-02-28 10:38:42 +0000",
								"thetext": "This bug appears to have been reported against 'rawhide' during the Fedora 26 development cycle.\nChanging version to '26'."
							},
							{
								"isprivate": "0",
								"commentid": "10301867",
								"comment_count": "20",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2017-04-04 10:27:13 +0000",
								"thetext": "*** Bug 1435927 has been marked as a duplicate of this bug. ***"
							},
							{
								"isprivate": "0",
								"commentid": "10459635",
								"comment_count": "21",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-05-30 17:44:51 +0000",
								"thetext": "To interject with a bit of blocker bureaucracy: I suggest we make this an Accepted0Day+AcceptedPreviousRelease blocker rather than an AcceptedBlocker. It would still prevent us shipping Beta, but we could at least build and test an RC and ensure there are no *other* blockers.\n\nTo refresh folks' memories: Accepted0Day means an update must be pushed for the release in question by Beta release day. AcceptedPreviousRelease means an update must be pushed for relevant *previous* releases by Beta release day. This would be both since it's likely we need updates for both the previous stable releases (24/25) *and* the new release (26) to ensure a successful upgrade. If that winds up not being the case with the solution we pick, we can drop whichever status is no longer relevant.\n\nSound OK to everyone? Any objections?"
							},
							{
								"isprivate": "0",
								"commentid": "10460061",
								"comment_count": "22",
								"who": {
									"text": "sgallagh",
									"name": "Stephen Gallagher"
								},
								"bug_when": "2017-05-30 19:05:28 +0000",
								"thetext": "+1 Accepted0Day\n+1 AcceptedPreviousRelease"
							},
							{
								"isprivate": "0",
								"commentid": "10460068",
								"comment_count": "23",
								"who": {
									"text": "mruckman",
									"name": "Mike Ruckman"
								},
								"bug_when": "2017-05-30 19:08:59 +0000",
								"thetext": "+1 on both counts for me as well."
							},
							{
								"isprivate": "0",
								"commentid": "10460070",
								"comment_count": "24",
								"who": {
									"text": "dennis",
									"name": "Dennis Gilmore"
								},
								"bug_when": "2017-05-30 19:09:32 +0000",
								"thetext": "+1 Accepted0Day\n+1 AcceptedPreviousRelease"
							},
							{
								"isprivate": "0",
								"commentid": "10460137",
								"comment_count": "25",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-05-30 19:40:51 +0000",
								"thetext": "Whoops, this one isn't actually the blocker at present...but I think it makes more sense to make this specifically a blocker, rather than the tracker bug. Giving blocker status to a tracker bug doesn't make a lot of sense as its 'meaning' can change over time. So I'll transfer the status from the tracker bug and make it accepted0day and acceptedpreviousrelease. Thanks folks!\n\nFor the record: we're transferring blocker status from https://bugzilla.redhat.com/show_bug.cgi?id=1443415 to this bug, as it was really this issue specifically we voted on as a blocker."
							},
							{
								"isprivate": "0",
								"commentid": "10461764",
								"comment_count": "26",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2017-05-31 05:59:06 +0000",
								"thetext": "Yes, dnf is merely a passanger in all this. The deeper bug here is bug 1394862 of course but if we can't find a workable solution there we might need to (additionally) apply some workaround on rpm-side so it's just as well this is the actualy blocker."
							},
							{
								"isprivate": "0",
								"commentid": "10462029",
								"comment_count": "27",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-05-31 07:22:08 +0000",
								"thetext": "Yep, that was my thought exactly in making this rather than 1394862 the blocker."
							},
							{
								"isprivate": "0",
								"commentid": "10468551",
								"comment_count": "28",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-01 12:44:20 +0000",
								"thetext": "libdb-5.3.28-21.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
							},
							{
								"isprivate": "0",
								"commentid": "10468562",
								"comment_count": "29",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-01 12:45:37 +0000",
								"thetext": "libdb-5.3.28-21.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
							},
							{
								"isprivate": "0",
								"commentid": "10469828",
								"comment_count": "30",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-06-01 17:57:51 +0000",
								"thetext": "does this also need to be sent out for 24/25?"
							},
							{
								"isprivate": "0",
								"commentid": "10471092",
								"comment_count": "31",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-06-02 05:30:25 +0000",
								"thetext": "It'd be really great if people could help test the new update hard: test that it fixes the actual bug, test it in the scenarios that caused trouble with -18 and -19, etc. We want to get this fix out for Beta, but we don't want to send it unless we're sure it's good. Thanks a lot!"
							},
							{
								"isprivate": "0",
								"commentid": "10472110",
								"comment_count": "32",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2017-06-02 11:42:00 +0000",
								"thetext": "(In reply to Adam Williamson from comment #31)\n> It'd be really great if people could help test the new update hard: test\n> that it fixes the actual bug, test it in the scenarios that caused trouble\n> with -18 and -19, etc. We want to get this fix out for Beta, but we don't\n> want to send it unless we're sure it's good. Thanks a lot!\n\nI tried dnf update https://kojipkgs.fedoraproject.org//packages/libdb/5.3.28/21.fc26/x86_64/libdb-5.3.28-21.fc26.x86_64.rpm https://kojipkgs.fedoraproject.org//packages/libdb/5.3.28/21.fc26/x86_64/libdb-utils-5.3.28-21.fc26.x86_64.rpm\n\nAnd I could not see any problem with installed package openldap-servers"
							},
							{
								"isprivate": "0",
								"commentid": "10473206",
								"comment_count": "33",
								"who": {
									"text": "aliakc",
									"name": "Ali Akcaagac"
								},
								"bug_when": "2017-06-02 17:07:28 +0000",
								"thetext": "Hi!\n\nI am not sure whether this might be related to the issue reported here. But in doubt I better put it on here so it can be verified.\n\nI am running what will become Fedora 26 (with all the latest updates that got pushed to the repositories). Around 2 weeks ago I was compiling some Xfce packages using an automated bash script.\n\nWhat it does is pulling in the tar files, adjusting some Fedora specs and pulling in needed dependencies using dnf builddep.\n\nThis script runs for a few years without errors but recently I saw that the RPM database often gets locked and crashed.\n\nToday I tried to re-run the script again and ran into the same RPM database crash again.\n\nPlease allow me to add the logfile so you can see whether this might be related to the RPM issue (directly or indirectly).\n\nThe log is full of this:\n\nRPM build errors:\n    db5 error(5) from dbenv->open: Input/output error\n    cannot open Packages index using db5 - Input/output error (5)\n    cannot open Packages database in /var/lib/rpm\n    Bad exit status from /var/tmp/rpm-tmp.GjSmLj (%build)\nerror: db5 error(5) from dbenv->open: Input/output error\nerror: cannot open Packages index using db5 - Input/output error (5)\nerror: cannot open Packages database in /var/lib/rpm\nerror: db5 error(5) from dbenv->open: Input/output error\nerror: cannot open Packages index using db5 - Input/output error (5)\nerror: cannot open Packages database in /var/lib/rpm\nerror: db5 error(5) from dbenv->open: Input/output error\nerror: cannot open Packages index using db5 - Input/output error (5)\nerror: cannot open Packages database in /var/lib/rpm\nError: Error: rpmdb open failed\n\nThe only thing happens here is just running dnf builddep that pulls in all the requirements to build the packages...."
							},
							{
								"isprivate": "0",
								"commentid": "10473208",
								"comment_count": "34",
								"who": {
									"text": "aliakc",
									"name": "Ali Akcaagac"
								},
								"bug_when": "2017-06-02 17:08:18 +0000",
								"thetext": "Created attachment 1284488\nPlease grep for \"db5 error\""
							},
							{
								"isprivate": "0",
								"commentid": "10473236",
								"comment_count": "35",
								"who": {
									"text": "striker",
									"name": "Striker Leggette"
								},
								"bug_when": "2017-06-02 17:18:42 +0000",
								"thetext": "Upgraded:\nlibdb.x86_64 5.3.28-21.fc26\nlibdb-utils.x86_64 5.3.28-21.fc26\n\nComplete!\n[root@f26beta14 folder]# rpm -qa | tail -n 2\nfedora-release-notes-25.01-2.fc26.noarch\npasswdqc-lib-1.3.0-7.fc26.x86_64\n[root@f26beta14 folder]#\n\nKarma given"
							},
							{
								"isprivate": "0",
								"commentid": "10474074",
								"comment_count": "36",
								"who": {
									"text": "aliakc",
									"name": "Ali Akcaagac"
								},
								"bug_when": "2017-06-03 06:18:08 +0000",
								"thetext": "I just like to inform that I updated to the latest libdb packages (manually).\n\nUnfortunately within the process of building packages, I found out that some Fedora 26 related packages (during resolving builddep) downgrades libdb back to the -17 version, which in the flow of building the packages lead into a db5 error again.\n\nIt would be nice if you could guarantee, that no Fedora 26 package enforces a downgrade (in my case I've instructed dnf builddep to use --allowerasing). What I mean by this can be described as follows:\n\nPackages and versions of packages tend to change over time. But quite often building (or re-building) an RPM SRC packages have a strict dependency for older versions of a package (most likely the one it initially was compiled against with).\n\nIn a flow of dependency resolving (one package resolves the requirements of another) this might cause (quite often) the issue that one or other *required* packages (for building things) wants an older version. dnf can keep up doing this by using --allowerasing so it can resolve conflicts on its own and downgrade the packages as needed. Usually the downgrades are required for some header files. After compiling the packages they usually run perfectly with never versions of any libraries. But if the downgrading also requires that an older version of the library must be installed back (as the example below) then there is a risk, that on building farms and building machines, that the issue with db5 crashes comes back (as it happened a few moments ago).\n\nSo one of the packages below (in the dependency tree) enforces a downgrade of libdb (I haven't verified this yet!!!).\n\nDependencies resolved.\n================================================================================\n Package                   Arch     Version             Repository         Size\n================================================================================\nInstalling:\n dbus-glib-devel           x86_64   0.108-2.fc26        fedora             73 k\n perl-ExtUtils-Depends     noarch   0.405-4.fc26        fedora             30 k\n perl-ExtUtils-MakeMaker   noarch   7.24-2.fc26         fedora            295 k\n perl-ExtUtils-PkgConfig   noarch   1.15-7.fc26         fedora             19 k\n perl-Glib                 x86_64   1.324-2.fc26        fedora            368 k\n perl-Glib-devel           x86_64   1.324-2.fc26        fedora             70 k\n perl-devel                x86_64   4:5.24.1-390.fc26   updates-testing   575 k\n perl-generators           noarch   1.10-2.fc26         fedora             16 k\nInstalling dependencies:\n gdbm-devel                x86_64   1.13-1.fc26         updates-testing    62 k\n libdb-devel               x86_64   5.3.28-17.fc26      fedora             42 k\n perl-ExtUtils-Command     noarch   7.24-2.fc26         fedora             17 k\n perl-ExtUtils-Install     noarch   2.04-367.fc26       fedora             44 k\n perl-ExtUtils-Manifest    noarch   1.70-366.fc26       fedora             35 k\n perl-ExtUtils-ParseXS     noarch   1:3.31-368.fc26     fedora             81 k\n perl-Fedora-VSP           noarch   0.001-5.fc26        fedora             23 k\n perl-Storable             x86_64   1:2.56-368.fc26     fedora             83 k\n perl-Test-Harness         noarch   3.39-1.fc26         updates-testing   276 k\n perl-version              x86_64   5:0.99.18-1.fc26    updates-testing    64 k\n systemtap-sdt-devel       x86_64   3.1-5.fc26          updates-testing    71 k\nDowngrading:\n libdb                     x86_64   5.3.28-17.fc26      fedora            748 k\n libdb-utils               x86_64   5.3.28-17.fc26      fedora            137 k\n\nTransaction Summary\n================================================================================\nInstall    19 Packages\nDowngrade   2 Packages"
							},
							{
								"isprivate": "0",
								"commentid": "10474079",
								"comment_count": "37",
								"who": {
									"text": "fweimer",
									"name": "Florian Weimer"
								},
								"bug_when": "2017-06-03 06:33:01 +0000",
								"thetext": "(In reply to Ali Akcaagac from comment #36)\n> So one of the packages below (in the dependency tree) enforces a downgrade\n> of libdb (I haven't verified this yet!!!).\n\n> Installing dependencies:\n>  gdbm-devel                x86_64   1.13-1.fc26         updates-testing   \n> 62 k\n>  libdb-devel               x86_64   5.3.28-17.fc26      fedora            \n> 42 k\n\nIt's likely that libdb-devel in its newer version just isn't available from the configured repositories, so in order to install the package, the already-upgraded subpackages are downgraded to match the available package version."
							},
							{
								"isprivate": "0",
								"commentid": "10474134",
								"comment_count": "38",
								"who": {
									"text": "aliakc",
									"name": "Ali Akcaagac"
								},
								"bug_when": "2017-06-03 08:16:05 +0000",
								"thetext": "(In reply to Florian Weimer from comment #37)\n> It's likely that libdb-devel in its newer version just isn't available from\n> the configured repositories, so in order to install the package, the\n> already-upgraded subpackages are downgraded to match the available package\n> version.\n\nYes you are right! This was exactly the case here after re-investigating into the issue... I am a a bit overworked recently and was focussing on the db5 issue only..."
							},
							{
								"isprivate": "0",
								"commentid": "10474624",
								"comment_count": "39",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-04 05:10:59 +0000",
								"thetext": "libdb-5.3.28-21.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
							},
							{
								"isprivate": "0",
								"commentid": "10486563",
								"comment_count": "40",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-06-07 17:42:29 +0000",
								"thetext": "So by all accounts -21 is looking pretty good as a fix for this. I propose we go ahead and push it stable for all releases. Could people please karma the F24 and F25 updates, so long as you're happy with them, so they can be pushed out? Thanks."
							},
							{
								"isprivate": "0",
								"commentid": "10490655",
								"comment_count": "41",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-08 19:24:40 +0000",
								"thetext": "libdb-5.3.28-21.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf"
							},
							{
								"isprivate": "0",
								"commentid": "10490657",
								"comment_count": "42",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-08 19:25:02 +0000",
								"thetext": "libdb-5.3.28-21.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
							},
							{
								"isprivate": "0",
								"commentid": "10490937",
								"comment_count": "43",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-08 21:07:36 +0000",
								"thetext": "libdb-5.3.28-21.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "10492219",
								"comment_count": "44",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-09 09:24:13 +0000",
								"thetext": "libdb-5.3.28-21.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "10492601",
								"comment_count": "45",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-09 11:29:32 +0000",
								"thetext": "libdb-5.3.28-21.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report."
							},
							{
								"isprivate": "0",
								"commentid": "10494555",
								"comment_count": "46",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-06-09 20:35:21 +0000",
								"thetext": "Unfortunately, while no-one reported such issues in the last week or so, now -21 has gone stable, I've seen several reports of problems very much along the lines we saw with -18 and -19. Here's one from Eric Blake (hope you don't mind me quoting it, Eric):\n\n==========\n\nOn an F25 box, I ran 'dnf update', and it installed libdb.x86_64\n5.3.28-21.fc25 among others.  That run of 'dnf' dumped core, and all\nsubsequent runs of dnf were unhappy:\n\n# dnf update\n...\n  Verifying   : libdb-5.3.28-21.fc25.x86_64\n 18/80\n...\nComplete!\nSegmentation fault (core dumped)\n# dnf update\nerror: rpmdb: BDB0113 Thread/process 6173/140680480651008 failed:\nBDB1507 Thread died in Berkeley DB library\nerror: db5 error(-30973) from dbenv->failchk: BDB0087 DB_RUNRECOVERY:\nFatal error, run database recovery\nerror: cannot open Packages index using db5 -  (-30973)\nerror: cannot open Packages database in /var/lib/rpm\nError: Error: rpmdb open failed\n\nI don't know how many others will have hosed systems now that libdb\nappears to have been pushed to stable, but it's a bummer that it\nhappened to me.\n\n=========\n\nCan we please look into this again as a matter of urgency? It's obviously bad to be breaking F24/F25 systems. Perhaps we should look into removing the update and/or doing a reverted -22 as an exceptional step also."
							},
							{
								"isprivate": "0",
								"commentid": "10494558",
								"comment_count": "47",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-06-09 20:36:37 +0000",
								"thetext": "Eric, can you get a backtrace from the core dump if possible? Can you also provide a full list of what was in the update transaction (the entire console log would be great if you still have it, otherwise dnf history should do)? Thanks a lot."
							},
							{
								"isprivate": "0",
								"commentid": "10494593",
								"comment_count": "48",
								"who": {
									"text": "eblake",
									"name": "Eric Blake"
								},
								"bug_when": "2017-06-09 20:52:05 +0000",
								"thetext": "[root@red eblake]# dnf update\nLast metadata expiration check: 0:47:27 ago on Fri Jun  9 09:07:41 2017.\nDependencies resolved.\n================================================================================\n Package                      Arch      Version               Repository   Size\n================================================================================\nInstalling:\n kernel                       x86_64    4.11.3-202.fc25       updates     100 k\n kernel-core                  x86_64    4.11.3-202.fc25       updates      21 M\n kernel-debug-devel           x86_64    4.11.3-202.fc25       updates      11 M\n kernel-modules               x86_64    4.11.3-202.fc25       updates      23 M\n python-qpid-proton           x86_64    0.17.0-2.fc25         updates     220 k\n python-rhmsg                 noarch    0.5-1.fc25            rhpkg        27 k\n python2-simplejson           x86_64    3.10.0-1.fc25         updates     285 k\n qpid-proton-c                x86_64    0.17.0-2.fc25         updates     159 k\n rpmdiff                      x86_64    4.1.1-1.fc25          rhpkg       274 k\n rpmdiff-remote               x86_64    4.1.1-1.fc25          rhpkg       132 k\nUpgrading:\n google-noto-emoji-fonts      noarch    20170523-1.fc25       updates     4.4 M\n hplip                        x86_64    3.17.4-2.fc25         updates      13 M\n hplip-common                 x86_64    3.17.4-2.fc25         updates     102 k\n hplip-libs                   x86_64    3.17.4-2.fc25         updates     191 k\n hwdata                       noarch    0.301-1.fc25          updates     1.4 M\n kernel-headers               x86_64    4.11.3-202.fc25       updates     1.1 M\n libdb                        x86_64    5.3.28-21.fc25        updates     749 k\n libdb-devel                  x86_64    5.3.28-21.fc25        updates      43 k\n libdb-utils                  x86_64    5.3.28-21.fc25        updates     138 k\n libmicrohttpd                x86_64    1:0.9.55-1.fc25       updates      77 k\n libsane-hpaio                x86_64    3.17.4-2.fc25         updates     120 k\n mesa-dri-drivers             x86_64    17.0.5-3.fc25         updates      12 M\n mesa-filesystem              x86_64    17.0.5-3.fc25         updates      25 k\n mesa-libEGL                  x86_64    17.0.5-3.fc25         updates     104 k\n mesa-libEGL-devel            x86_64    17.0.5-3.fc25         updates      41 k\n mesa-libGL                   x86_64    17.0.5-3.fc25         updates     165 k\n mesa-libGL-devel             x86_64    17.0.5-3.fc25         updates     161 k\n mesa-libGLES                 x86_64    17.0.5-3.fc25         updates      22 k\n mesa-libGLES-devel           x86_64    17.0.5-3.fc25         updates      63 k\n mesa-libOpenCL               x86_64    17.0.5-3.fc25         updates     581 k\n mesa-libgbm                  x86_64    17.0.5-3.fc25         updates      43 k\n mesa-libgbm-devel            x86_64    17.0.5-3.fc25         updates      27 k\n mesa-libglapi                x86_64    17.0.5-3.fc25         updates      50 k\n mesa-libwayland-egl          x86_64    17.0.5-3.fc25         updates      26 k\n mesa-libwayland-egl-devel    x86_64    17.0.5-3.fc25         updates      23 k\n mesa-libxatracker            x86_64    17.0.5-3.fc25         updates     1.4 M\n ntfs-3g                      x86_64    2:2017.3.23-1.fc25    updates     273 k\n ntfsprogs                    x86_64    2:2017.3.23-1.fc25    updates     382 k\n perl-Net-HTTP                noarch    6.16-1.fc25           updates      41 k\n perl-threads                 x86_64    1:2.16-1.fc25         updates      58 k\n qrencode-libs                x86_64    3.4.4-1.fc25          updates      55 k\n rhpkg                        noarch    1.32-2.fc25           rhpkg       121 k\n vim-minimal                  x86_64    2:8.0.617-1.fc25      updates     520 k\nRemoving:\n kernel                       x86_64    4.10.16-200.fc25      @updates      0  \n kernel-core                  x86_64    4.10.16-200.fc25      @updates     53 M\n kernel-debug-devel           x86_64    4.10.16-200.fc25      @updates     42 M\n kernel-modules               x86_64    4.10.16-200.fc25      @updates     22 M\n\nTransaction Summary\n================================================================================\nInstall  10 Packages\nUpgrade  33 Packages\nRemove    4 Packages\n\nTotal download size: 93 M\nIs this ok [y/N]: y\nDownloading Packages:\n(1/43): hplip-libs-3.17.4-1.fc25_3.17.4-2.fc25.  88 kB/s |  51 kB     00:00    \n(2/43): hplip-common-3.17.4-1.fc25_3.17.4-2.fc2 320 kB/s |  48 kB     00:00    \n[DRPM] hplip-libs-3.17.4-1.fc25_3.17.4-2.fc25.x86_64.drpm: done                \n(3/43): hplip-3.17.4-1.fc25_3.17.4-2.fc25.x86_6 353 kB/s | 346 kB     00:00    \n[DRPM] hplip-common-3.17.4-1.fc25_3.17.4-2.fc25.x86_64.drpm: done              \n(4/43): libsane-hpaio-3.17.4-1.fc25_3.17.4-2.fc 144 kB/s |  51 kB     00:00    \n(5/43): hwdata-0.300-1.fc25_0.301-1.fc25.noarch  45 kB/s |  41 kB     00:00    \n[DRPM] libsane-hpaio-3.17.4-1.fc25_3.17.4-2.fc25.x86_64.drpm: done             \n(6/43): kernel-debug-devel-4.11.3-200.fc25_4.11 1.2 MB/s | 2.7 MB     00:02    \n(7/43): libdb-devel-5.3.28-16.fc25_5.3.28-21.fc 138 kB/s |  10 kB     00:00    \n(8/43): libdb-5.3.28-16.fc25_5.3.28-21.fc25.x86 260 kB/s | 129 kB     00:00    \n[DRPM] libdb-devel-5.3.28-16.fc25_5.3.28-21.fc25.x86_64.drpm: done             \n(9/43): libmicrohttpd-0.9.54-1.fc25_0.9.55-1.fc 243 kB/s |  32 kB     00:00    \n(10/43): mesa-libEGL-17.0.5-2.fc25_17.0.5-3.fc2 343 kB/s |  28 kB     00:00    \n[DRPM] libmicrohttpd-0.9.54-1.fc25_0.9.55-1.fc25.x86_64.drpm: done             \n(11/43): mesa-libGL-17.0.5-2.fc25_17.0.5-3.fc25 438 kB/s |  39 kB     00:00    \n[DRPM] mesa-libEGL-17.0.5-2.fc25_17.0.5-3.fc25.x86_64.drpm: done               \n(12/43): mesa-libglapi-17.0.5-2.fc25_17.0.5-3.f 265 kB/s |  21 kB     00:00    \n(13/43): mesa-libGL-devel-17.0.5-2.fc25_17.0.5- 263 kB/s |  22 kB     00:00    \n[DRPM] mesa-libGL-17.0.5-2.fc25_17.0.5-3.fc25.x86_64.drpm: done                \n[DRPM] mesa-libglapi-17.0.5-2.fc25_17.0.5-3.fc25.x86_64.drpm: done             \n(14/43): kernel-headers-4.11.3-200.fc25_4.11.3- 116 kB/s | 208 kB     00:01    \n(15/43): mesa-libGLES-devel-17.0.5-2.fc25_17.0. 222 kB/s |  22 kB     00:00    \n[DRPM] libdb-5.3.28-16.fc25_5.3.28-21.fc25.x86_64.drpm: done                   \n(16/43): mesa-libgbm-17.0.5-2.fc25_17.0.5-3.fc2 215 kB/s |  21 kB     00:00    \n[DRPM] hwdata-0.300-1.fc25_0.301-1.fc25.noarch.drpm: done                      \n[DRPM] mesa-libGL-devel-17.0.5-2.fc25_17.0.5-3.fc25.x86_64.drpm: done          \n[DRPM] mesa-libGLES-devel-17.0.5-2.fc25_17.0.5-3.fc25.x86_64.drpm: done        \n(17/43): mesa-libOpenCL-17.0.5-2.fc25_17.0.5-3. 114 kB/s |  22 kB     00:00    \n[DRPM] mesa-libgbm-17.0.5-2.fc25_17.0.5-3.fc25.x86_64.drpm: done               \n(18/43): perl-Net-HTTP-6.15-1.fc25_6.16-1.fc25. 124 kB/s |  18 kB     00:00    \n(19/43): mesa-libxatracker-17.0.5-2.fc25_17.0.5 632 kB/s | 161 kB     00:00    \n[DRPM] perl-Net-HTTP-6.15-1.fc25_6.16-1.fc25.noarch.drpm: done                 \n(20/43): qrencode-libs-3.4.2-6.fc24_3.4.4-1.fc2 219 kB/s |  18 kB     00:00    \n(21/43): perl-threads-2.15-1.fc25_2.16-1.fc25.x 131 kB/s |  23 kB     00:00    \n[DRPM] mesa-libOpenCL-17.0.5-2.fc25_17.0.5-3.fc25.x86_64.drpm: done            \n[DRPM] qrencode-libs-3.4.2-6.fc24_3.4.4-1.fc25.x86_64.drpm: done               \n(22/43): kernel-4.11.3-202.fc25.x86_64.rpm      176 kB/s | 100 kB     00:00    \n(23/43): mesa-dri-drivers-17.0.5-2.fc25_17.0.5- 502 kB/s | 1.1 MB     00:02    \n[DRPM] kernel-headers-4.11.3-200.fc25_4.11.3-202.fc25.x86_64.drpm: done        \n[DRPM] mesa-libxatracker-17.0.5-2.fc25_17.0.5-3.fc25.x86_64.drpm: done         \n[DRPM] perl-threads-2.15-1.fc25_2.16-1.fc25.x86_64.drpm: done                  \n(24/43): python-rhmsg-0.5-1.fc25.noarch.rpm      60 kB/s |  27 kB     00:00    \n(25/43): rpmdiff-remote-4.1.1-1.fc25.x86_64.rpm 376 kB/s | 132 kB     00:00    \n(26/43): rpmdiff-4.1.1-1.fc25.x86_64.rpm        615 kB/s | 274 kB     00:00    \n(27/43): python2-simplejson-3.10.0-1.fc25.x86_6 411 kB/s | 285 kB     00:00    \n(28/43): python-qpid-proton-0.17.0-2.fc25.x86_6 459 kB/s | 220 kB     00:00    \n(29/43): qpid-proton-c-0.17.0-2.fc25.x86_64.rpm 406 kB/s | 159 kB     00:00    \n(30/43): google-noto-emoji-fonts-20170523-1.fc2 700 kB/s | 4.4 MB     00:06    \n(31/43): libdb-utils-5.3.28-21.fc25.x86_64.rpm  531 kB/s | 138 kB     00:00    \n(32/43): mesa-filesystem-17.0.5-3.fc25.x86_64.r 268 kB/s |  25 kB     00:00    \n(33/43): mesa-libEGL-devel-17.0.5-3.fc25.x86_64 466 kB/s |  41 kB     00:00    \n(34/43): mesa-libGLES-17.0.5-3.fc25.x86_64.rpm  285 kB/s |  22 kB     00:00    \n(35/43): mesa-libgbm-devel-17.0.5-3.fc25.x86_64 333 kB/s |  27 kB     00:00    \n(36/43): mesa-libwayland-egl-17.0.5-3.fc25.x86_ 198 kB/s |  26 kB     00:00    \n(37/43): mesa-libwayland-egl-devel-17.0.5-3.fc2 164 kB/s |  23 kB     00:00    \n(38/43): ntfs-3g-2017.3.23-1.fc25.x86_64.rpm    562 kB/s | 273 kB     00:00    \n(39/43): ntfsprogs-2017.3.23-1.fc25.x86_64.rpm  734 kB/s | 382 kB     00:00    \n(40/43): rhpkg-1.32-2.fc25.noarch.rpm           313 kB/s | 121 kB     00:00    \n(41/43): vim-minimal-8.0.617-1.fc25.x86_64.rpm  708 kB/s | 520 kB     00:00    \n(42/43): kernel-core-4.11.3-202.fc25.x86_64.rpm 809 kB/s |  21 MB     00:26    \n(43/43): kernel-modules-4.11.3-202.fc25.x86_64. 910 kB/s |  23 MB     00:25    \n[DRPM] hplip-3.17.4-1.fc25_3.17.4-2.fc25.x86_64.drpm: done                     \n[DRPM] kernel-debug-devel-4.11.3-200.fc25_4.11.3-202.fc25.x86_64.drpm: done    \n[DRPM] mesa-dri-drivers-17.0.5-2.fc25_17.0.5-3.fc25.x86_64.drpm: done          \n--------------------------------------------------------------------------------\nTotal                                           1.6 MB/s |  56 MB     00:35     \nDelta RPMs reduced 93.2 MB of updates to 55.8 MB (40.1% saved)\nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Upgrading   : mesa-libglapi-17.0.5-3.fc25.x86_64                         1/80 \n  Upgrading   : mesa-libgbm-17.0.5-3.fc25.x86_64                           2/80 \n  Upgrading   : libdb-5.3.28-21.fc25.x86_64                                3/80 \n  Installing  : kernel-core-4.11.3-202.fc25.x86_64                         4/80 \n  Installing  : kernel-modules-4.11.3-202.fc25.x86_64                      5/80 \n  Upgrading   : mesa-libEGL-17.0.5-3.fc25.x86_64                           6/80 \n  Upgrading   : mesa-libGL-17.0.5-3.fc25.x86_64                            7/80 \n  Upgrading   : mesa-libGLES-17.0.5-3.fc25.x86_64                          8/80 \n  Upgrading   : ntfs-3g-2:2017.3.23-1.fc25.x86_64                          9/80 \n  Upgrading   : mesa-libwayland-egl-17.0.5-3.fc25.x86_64                  10/80 \n  Upgrading   : mesa-filesystem-17.0.5-3.fc25.x86_64                      11/80 \n  Upgrading   : hplip-common-3.17.4-2.fc25.x86_64                         12/80 \n  Upgrading   : hplip-libs-3.17.4-2.fc25.x86_64                           13/80 \n  Installing  : qpid-proton-c-0.17.0-2.fc25.x86_64                        14/80 \n  Installing  : python-qpid-proton-0.17.0-2.fc25.x86_64                   15/80 \n  Installing  : python-rhmsg-0.5-1.fc25.noarch                            16/80 \n  Installing  : python2-simplejson-3.10.0-1.fc25.x86_64                   17/80 \n  Installing  : rpmdiff-4.1.1-1.fc25.x86_64                               18/80 \n  Installing  : rpmdiff-remote-4.1.1-1.fc25.x86_64                        19/80 \n  Upgrading   : rhpkg-1.32-2.fc25.noarch                                  20/80 \n  Upgrading   : hplip-3.17.4-2.fc25.x86_64                                21/80 \n  Upgrading   : libsane-hpaio-3.17.4-2.fc25.x86_64                        22/80 \n  Upgrading   : mesa-dri-drivers-17.0.5-3.fc25.x86_64                     23/80 \n  Upgrading   : mesa-libwayland-egl-devel-17.0.5-3.fc25.x86_64            24/80 \n  Upgrading   : ntfsprogs-2:2017.3.23-1.fc25.x86_64                       25/80 \n  Upgrading   : mesa-libGLES-devel-17.0.5-3.fc25.x86_64                   26/80 \n  Upgrading   : mesa-libGL-devel-17.0.5-3.fc25.x86_64                     27/80 \n  Upgrading   : mesa-libEGL-devel-17.0.5-3.fc25.x86_64                    28/80 \n  Installing  : kernel-4.11.3-202.fc25.x86_64                             29/80 \n  Upgrading   : libdb-utils-5.3.28-21.fc25.x86_64                         30/80 \n  Upgrading   : libdb-devel-5.3.28-21.fc25.x86_64                         31/80 \n  Upgrading   : mesa-libOpenCL-17.0.5-3.fc25.x86_64                       32/80 \n  Upgrading   : mesa-libgbm-devel-17.0.5-3.fc25.x86_64                    33/80 \n  Upgrading   : vim-minimal-2:8.0.617-1.fc25.x86_64                       34/80 \n  Upgrading   : qrencode-libs-3.4.4-1.fc25.x86_64                         35/80 \n  Upgrading   : perl-threads-1:2.16-1.fc25.x86_64                         36/80 \n  Upgrading   : perl-Net-HTTP-6.16-1.fc25.noarch                          37/80 \n  Upgrading   : mesa-libxatracker-17.0.5-3.fc25.x86_64                    38/80 \n  Upgrading   : libmicrohttpd-1:0.9.55-1.fc25.x86_64                      39/80 \n  Upgrading   : kernel-headers-4.11.3-202.fc25.x86_64                     40/80 \n  Upgrading   : hwdata-0.301-1.fc25.noarch                                41/80 \n  Upgrading   : google-noto-emoji-fonts-20170523-1.fc25.noarch            42/80 \n  Installing  : kernel-debug-devel-4.11.3-202.fc25.x86_64                 43/80 \n  Erasing     : kernel-4.10.16-200.fc25.x86_64                            44/80 \n  Cleanup     : mesa-libGL-devel-17.0.5-2.fc25.x86_64                     45/80 \n  Cleanup     : mesa-libwayland-egl-devel-17.0.5-2.fc25.x86_64            46/80 \n  Cleanup     : mesa-libgbm-devel-17.0.5-2.fc25.x86_64                    47/80 \n  Cleanup     : mesa-libGLES-devel-17.0.5-2.fc25.x86_64                   48/80 \n  Cleanup     : mesa-libGLES-17.0.5-2.fc25.x86_64                         49/80 \n  Cleanup     : mesa-libEGL-devel-17.0.5-2.fc25.x86_64                    50/80 \n  Cleanup     : libdb-devel-5.3.28-16.fc25.x86_64                         51/80 \n  Cleanup     : libsane-hpaio-3.17.4-1.fc25.x86_64                        52/80 \n  Cleanup     : hplip-3.17.4-1.fc25.x86_64                                53/80 \n  Cleanup     : hplip-libs-3.17.4-1.fc25.x86_64                           54/80 \n  Cleanup     : hplip-common-3.17.4-1.fc25.x86_64                         55/80 \n  Erasing     : kernel-debug-devel-4.10.16-200.fc25.x86_64                56/80 \n  Cleanup     : rhpkg-1.31-1.fc25.noarch                                  57/80 \n  Cleanup     : perl-Net-HTTP-6.15-1.fc25.noarch                          58/80 \n  Cleanup     : kernel-headers-4.11.3-200.fc25.x86_64                     59/80 \n  Cleanup     : hwdata-0.300-1.fc25.noarch                                60/80 \n  Cleanup     : google-noto-emoji-fonts-20170426-1.fc25.noarch            61/80 \n  Cleanup     : mesa-dri-drivers-17.0.5-2.fc25.x86_64                     62/80 \n  Cleanup     : mesa-libEGL-17.0.5-2.fc25.x86_64                          63/80 \n  Cleanup     : mesa-libGL-17.0.5-2.fc25.x86_64                           64/80 \n  Erasing     : kernel-modules-4.10.16-200.fc25.x86_64                    65/80 \n  Cleanup     : ntfsprogs-2:2016.2.22-4.fc25.x86_64                       66/80 \n  Cleanup     : mesa-libOpenCL-17.0.5-2.fc25.x86_64                       67/80 \n  Cleanup     : libdb-utils-5.3.28-16.fc25.x86_64                         68/80 \n  Cleanup     : mesa-filesystem-17.0.5-2.fc25.x86_64                      69/80 \n  Cleanup     : libdb-5.3.28-16.fc25.x86_64                               70/80 \n  Cleanup     : mesa-libgbm-17.0.5-2.fc25.x86_64                          71/80 \n  Cleanup     : ntfs-3g-2:2016.2.22-4.fc25.x86_64                         72/80 \n  Erasing     : kernel-core-4.10.16-200.fc25.x86_64                       73/80 \n  Cleanup     : mesa-libglapi-17.0.5-2.fc25.x86_64                        74/80 \n  Cleanup     : mesa-libwayland-egl-17.0.5-2.fc25.x86_64                  75/80 \n  Cleanup     : vim-minimal-2:8.0.600-1.fc25.x86_64                       76/80 \n  Cleanup     : qrencode-libs-3.4.2-6.fc24.x86_64                         77/80 \n  Cleanup     : perl-threads-1:2.15-1.fc25.x86_64                         78/80 \n  Cleanup     : mesa-libxatracker-17.0.5-2.fc25.x86_64                    79/80 \n  Cleanup     : libmicrohttpd-1:0.9.54-1.fc25.x86_64                      80/80 \n  Verifying   : kernel-core-4.11.3-202.fc25.x86_64                         1/80 \n  Verifying   : kernel-4.11.3-202.fc25.x86_64                              2/80 \n  Verifying   : kernel-debug-devel-4.11.3-202.fc25.x86_64                  3/80 \n  Verifying   : kernel-modules-4.11.3-202.fc25.x86_64                      4/80 \n  Verifying   : python-rhmsg-0.5-1.fc25.noarch                             5/80 \n  Verifying   : rpmdiff-remote-4.1.1-1.fc25.x86_64                         6/80 \n  Verifying   : rpmdiff-4.1.1-1.fc25.x86_64                                7/80 \n  Verifying   : python2-simplejson-3.10.0-1.fc25.x86_64                    8/80 \n  Verifying   : python-qpid-proton-0.17.0-2.fc25.x86_64                    9/80 \n  Verifying   : qpid-proton-c-0.17.0-2.fc25.x86_64                        10/80 \n  Verifying   : google-noto-emoji-fonts-20170523-1.fc25.noarch            11/80 \n  Verifying   : hplip-3.17.4-2.fc25.x86_64                                12/80 \n  Verifying   : hplip-libs-3.17.4-2.fc25.x86_64                           13/80 \n  Verifying   : hplip-common-3.17.4-2.fc25.x86_64                         14/80 \n  Verifying   : libsane-hpaio-3.17.4-2.fc25.x86_64                        15/80 \n  Verifying   : hwdata-0.301-1.fc25.noarch                                16/80 \n  Verifying   : kernel-headers-4.11.3-202.fc25.x86_64                     17/80 \n  Verifying   : libdb-5.3.28-21.fc25.x86_64                               18/80 \n  Verifying   : libdb-utils-5.3.28-21.fc25.x86_64                         19/80 \n  Verifying   : libdb-devel-5.3.28-21.fc25.x86_64                         20/80 \n  Verifying   : libmicrohttpd-1:0.9.55-1.fc25.x86_64                      21/80 \n  Verifying   : mesa-dri-drivers-17.0.5-3.fc25.x86_64                     22/80 \n  Verifying   : mesa-filesystem-17.0.5-3.fc25.x86_64                      23/80 \n  Verifying   : mesa-libEGL-17.0.5-3.fc25.x86_64                          24/80 \n  Verifying   : mesa-libEGL-devel-17.0.5-3.fc25.x86_64                    25/80 \n  Verifying   : mesa-libGL-17.0.5-3.fc25.x86_64                           26/80 \n  Verifying   : mesa-libglapi-17.0.5-3.fc25.x86_64                        27/80 \n  Verifying   : mesa-libGL-devel-17.0.5-3.fc25.x86_64                     28/80 \n  Verifying   : mesa-libGLES-17.0.5-3.fc25.x86_64                         29/80 \n  Verifying   : mesa-libGLES-devel-17.0.5-3.fc25.x86_64                   30/80 \n  Verifying   : mesa-libOpenCL-17.0.5-3.fc25.x86_64                       31/80 \n  Verifying   : mesa-libgbm-17.0.5-3.fc25.x86_64                          32/80 \n  Verifying   : mesa-libgbm-devel-17.0.5-3.fc25.x86_64                    33/80 \n  Verifying   : mesa-libwayland-egl-17.0.5-3.fc25.x86_64                  34/80 \n  Verifying   : mesa-libwayland-egl-devel-17.0.5-3.fc25.x86_64            35/80 \n  Verifying   : mesa-libxatracker-17.0.5-3.fc25.x86_64                    36/80 \n  Verifying   : ntfs-3g-2:2017.3.23-1.fc25.x86_64                         37/80 \n  Verifying   : ntfsprogs-2:2017.3.23-1.fc25.x86_64                       38/80 \n  Verifying   : perl-Net-HTTP-6.16-1.fc25.noarch                          39/80 \n  Verifying   : perl-threads-1:2.16-1.fc25.x86_64                         40/80 \n  Verifying   : qrencode-libs-3.4.4-1.fc25.x86_64                         41/80 \n  Verifying   : rhpkg-1.32-2.fc25.noarch                                  42/80 \n  Verifying   : vim-minimal-2:8.0.617-1.fc25.x86_64                       43/80 \n  Verifying   : qrencode-libs-3.4.2-6.fc24.x86_64                         44/80 \n  Verifying   : libdb-5.3.28-16.fc25.x86_64                               45/80 \n  Verifying   : libsane-hpaio-3.17.4-1.fc25.x86_64                        46/80 \n  Verifying   : libdb-utils-5.3.28-16.fc25.x86_64                         47/80 \n  Verifying   : libdb-devel-5.3.28-16.fc25.x86_64                         48/80 \n  Verifying   : ntfs-3g-2:2016.2.22-4.fc25.x86_64                         49/80 \n  Verifying   : ntfsprogs-2:2016.2.22-4.fc25.x86_64                       50/80 \n  Verifying   : libmicrohttpd-1:0.9.54-1.fc25.x86_64                      51/80 \n  Verifying   : vim-minimal-2:8.0.600-1.fc25.x86_64                       52/80 \n  Verifying   : kernel-4.10.16-200.fc25.x86_64                            53/80 \n  Verifying   : rhpkg-1.31-1.fc25.noarch                                  54/80 \n  Verifying   : kernel-core-4.10.16-200.fc25.x86_64                       55/80 \n  Verifying   : kernel-debug-devel-4.10.16-200.fc25.x86_64                56/80 \n  Verifying   : perl-Net-HTTP-6.15-1.fc25.noarch                          57/80 \n  Verifying   : kernel-headers-4.11.3-200.fc25.x86_64                     58/80 \n  Verifying   : kernel-modules-4.10.16-200.fc25.x86_64                    59/80 \n  Verifying   : hplip-3.17.4-1.fc25.x86_64                                60/80 \n  Verifying   : hplip-common-3.17.4-1.fc25.x86_64                         61/80 \n  Verifying   : hplip-libs-3.17.4-1.fc25.x86_64                           62/80 \n  Verifying   : hwdata-0.300-1.fc25.noarch                                63/80 \n  Verifying   : google-noto-emoji-fonts-20170426-1.fc25.noarch            64/80 \n  Verifying   : mesa-dri-drivers-17.0.5-2.fc25.x86_64                     65/80 \n  Verifying   : mesa-filesystem-17.0.5-2.fc25.x86_64                      66/80 \n  Verifying   : mesa-libEGL-devel-17.0.5-2.fc25.x86_64                    67/80 \n  Verifying   : mesa-libGL-17.0.5-2.fc25.x86_64                           68/80 \n  Verifying   : mesa-libEGL-17.0.5-2.fc25.x86_64                          69/80 \n  Verifying   : mesa-libGL-devel-17.0.5-2.fc25.x86_64                     70/80 \n  Verifying   : mesa-libGLES-17.0.5-2.fc25.x86_64                         71/80 \n  Verifying   : mesa-libGLES-devel-17.0.5-2.fc25.x86_64                   72/80 \n  Verifying   : perl-threads-1:2.15-1.fc25.x86_64                         73/80 \n  Verifying   : mesa-libOpenCL-17.0.5-2.fc25.x86_64                       74/80 \n  Verifying   : mesa-libgbm-17.0.5-2.fc25.x86_64                          75/80 \n  Verifying   : mesa-libgbm-devel-17.0.5-2.fc25.x86_64                    76/80 \n  Verifying   : mesa-libglapi-17.0.5-2.fc25.x86_64                        77/80 \n  Verifying   : mesa-libwayland-egl-17.0.5-2.fc25.x86_64                  78/80 \n  Verifying   : mesa-libwayland-egl-devel-17.0.5-2.fc25.x86_64            79/80 \n  Verifying   : mesa-libxatracker-17.0.5-2.fc25.x86_64                    80/80 \n\nRemoved:\n  kernel.x86_64 4.10.16-200.fc25                                                \n  kernel-core.x86_64 4.10.16-200.fc25                                           \n  kernel-debug-devel.x86_64 4.10.16-200.fc25                                    \n  kernel-modules.x86_64 4.10.16-200.fc25                                        \n\nInstalled:\n  kernel.x86_64 4.11.3-202.fc25                                                 \n  kernel-core.x86_64 4.11.3-202.fc25                                            \n  kernel-debug-devel.x86_64 4.11.3-202.fc25                                     \n  kernel-modules.x86_64 4.11.3-202.fc25                                         \n  python-qpid-proton.x86_64 0.17.0-2.fc25                                       \n  python-rhmsg.noarch 0.5-1.fc25                                                \n  python2-simplejson.x86_64 3.10.0-1.fc25                                       \n  qpid-proton-c.x86_64 0.17.0-2.fc25                                            \n  rpmdiff.x86_64 4.1.1-1.fc25                                                   \n  rpmdiff-remote.x86_64 4.1.1-1.fc25                                            \n\nUpgraded:\n  google-noto-emoji-fonts.noarch 20170523-1.fc25                                \n  hplip.x86_64 3.17.4-2.fc25                                                    \n  hplip-common.x86_64 3.17.4-2.fc25                                             \n  hplip-libs.x86_64 3.17.4-2.fc25                                               \n  hwdata.noarch 0.301-1.fc25                                                    \n  kernel-headers.x86_64 4.11.3-202.fc25                                         \n  libdb.x86_64 5.3.28-21.fc25                                                   \n  libdb-devel.x86_64 5.3.28-21.fc25                                             \n  libdb-utils.x86_64 5.3.28-21.fc25                                             \n  libmicrohttpd.x86_64 1:0.9.55-1.fc25                                          \n  libsane-hpaio.x86_64 3.17.4-2.fc25                                            \n  mesa-dri-drivers.x86_64 17.0.5-3.fc25                                         \n  mesa-filesystem.x86_64 17.0.5-3.fc25                                          \n  mesa-libEGL.x86_64 17.0.5-3.fc25                                              \n  mesa-libEGL-devel.x86_64 17.0.5-3.fc25                                        \n  mesa-libGL.x86_64 17.0.5-3.fc25                                               \n  mesa-libGL-devel.x86_64 17.0.5-3.fc25                                         \n  mesa-libGLES.x86_64 17.0.5-3.fc25                                             \n  mesa-libGLES-devel.x86_64 17.0.5-3.fc25                                       \n  mesa-libOpenCL.x86_64 17.0.5-3.fc25                                           \n  mesa-libgbm.x86_64 17.0.5-3.fc25                                              \n  mesa-libgbm-devel.x86_64 17.0.5-3.fc25                                        \n  mesa-libglapi.x86_64 17.0.5-3.fc25                                            \n  mesa-libwayland-egl.x86_64 17.0.5-3.fc25                                      \n  mesa-libwayland-egl-devel.x86_64 17.0.5-3.fc25                                \n  mesa-libxatracker.x86_64 17.0.5-3.fc25                                        \n  ntfs-3g.x86_64 2:2017.3.23-1.fc25                                             \n  ntfsprogs.x86_64 2:2017.3.23-1.fc25                                           \n  perl-Net-HTTP.noarch 6.16-1.fc25                                              \n  perl-threads.x86_64 1:2.16-1.fc25                                             \n  qrencode-libs.x86_64 3.4.4-1.fc25                                             \n  rhpkg.noarch 1.32-2.fc25                                                      \n  vim-minimal.x86_64 2:8.0.617-1.fc25                                           \n\netckeeper warning: hardlinked files could cause problems with git:\nchromium/native-messaging-hosts/browser_test_resources/mock_client_plugin.js\nchromium/native-messaging-hosts/browser_test_resources/mock_host_list_api.js\nchromium/native-messaging-hosts/browser_test_resources/mock_identity.js\nchromium/native-messaging-hosts/browser_test_resources/mock_signal_strategy.js\nchromium/native-messaging-hosts/browser_test_resources/sinon.js\nchromium/native-messaging-hosts/unittests/mock_client_plugin.js\nchromium/native-messaging-hosts/unittests/mock_host_list_api.js\nchromium/native-messaging-hosts/unittests/mock_identity.js\nchromium/native-messaging-hosts/unittests/mock_signal_strategy.js\nchromium/native-messaging-hosts/unittests/sinonjs/sinon.js\nComplete!\nSegmentation fault (core dumped)"
							},
							{
								"isprivate": "0",
								"commentid": "10494595",
								"comment_count": "49",
								"who": {
									"text": "eblake",
									"name": "Eric Blake"
								},
								"bug_when": "2017-06-09 20:54:14 +0000",
								"thetext": "Where would the core dump be saved, or am I beyond hope there? ABRT didn't seem to see a recent crash"
							},
							{
								"isprivate": "0",
								"commentid": "10494598",
								"comment_count": "50",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-06-09 20:56:17 +0000",
								"thetext": "If you can't find it in /var/spool/abrt or /var/tmp/abrt or / , probably no chance (I don't think the systemd coredump thingy is enabled on F25)..."
							},
							{
								"isprivate": "0",
								"commentid": "10494605",
								"comment_count": "51",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-06-09 21:02:06 +0000",
								"thetext": "Other reports:\n\nhttps://bugzilla.redhat.com/show_bug.cgi?id=1394862#c92\n\n\"That's not true. I was just hit with -21.fc25 from updates which broke\ndnf until I ran rpm --rebuilddb manually.\" - Dominik Mierzejewski, on devel@\n\nDominik managed to get abrt to file a crash report, in fact, with stack trace: https://bugzilla.redhat.com/show_bug.cgi?id=1460303\n\nI think I saw another report on IRC, but can't find it right now."
							},
							{
								"isprivate": "0",
								"commentid": "10494611",
								"comment_count": "52",
								"who": {
									"text": "eblake",
									"name": "Eric Blake"
								},
								"bug_when": "2017-06-09 21:07:43 +0000",
								"thetext": "Okay, I found the core dump in /var/spool/abrt/ccpp-2017-06-09-15\\:14\\:27-8088/, but I can't seem to make ABRT parse it, and right now I have a lame backtrace:\n\n(gdb) bt\n#0  0x0000559ddacdd528 in ?? ()\n#1  0x00007f41b8cc7f30 in ?? ()\n#2  0x0000559ddc834670 in ?? ()\n#3  0x00007f41b8cc7f50 in ?? ()\n#4  0x0000559ddad040e7 in ?? ()\n#5  0x0000000000000000 in ?? ()"
							},
							{
								"isprivate": "0",
								"commentid": "10494613",
								"comment_count": "53",
								"who": {
									"text": "eblake",
									"name": "Eric Blake"
								},
								"bug_when": "2017-06-09 21:09:41 +0000",
								"thetext": "(In reply to Eric Blake from comment #52)\n> Okay, I found the core dump in\n> /var/spool/abrt/ccpp-2017-06-09-15\\:14\\:27-8088/, but I can't seem to make\n> ABRT parse it, and right now I have a lame backtrace:\n> \n> (gdb) bt\n> #0  0x0000559ddacdd528 in ?? ()\n> #1  0x00007f41b8cc7f30 in ?? ()\n> #2  0x0000559ddc834670 in ?? ()\n> #3  0x00007f41b8cc7f50 in ?? ()\n> #4  0x0000559ddad040e7 in ?? ()\n> #5  0x0000000000000000 in ?? ()\n\nSorry for the noise; I just read ccpp-*/cmdline, and realized that it is an unrelated dump also from today, so it's not helpful here. There's nothing in /var/spool for my dnf crash :("
							},
							{
								"isprivate": "0",
								"commentid": "10496825",
								"comment_count": "54",
								"who": {
									"text": "pkubat",
									"name": "Petr Kubat"
								},
								"bug_when": "2017-06-12 07:34:09 +0000",
								"thetext": "Looking into this right now but from what I can see the issue should be easily fixable by running \"rpmdb --rebuilddb\" if you already hit the crash."
							},
							{
								"isprivate": "0",
								"commentid": "10500250",
								"comment_count": "55",
								"who": {
									"text": "michal.halenka",
									"name": "Michal Halenka"
								},
								"bug_when": "2017-06-13 08:30:45 +0000",
								"thetext": "I can confirm that"
							},
							{
								"isprivate": "0",
								"commentid": "10511648",
								"comment_count": "56",
								"who": {
									"text": "jmontleo",
									"name": "Jason Montleon"
								},
								"bug_when": "2017-06-16 04:01:06 +0000",
								"thetext": "I am seeing the same on one system with -22:\n\n$ rpm -q libdb; sudo dnf -y update\nlibdb-5.3.28-22.fc26.x86_64\nerror: db5 error(5) from dbenv->open: Input/output error\nerror: cannot open Packages index using db5 - Input/output error (5)\nerror: cannot open Packages database in /var/lib/rpm\nError: Error: rpmdb open failed\n\nrpm --rebuilddb gets it back in order, but I use dnf-automatic and have found that it's busted more than it is not over the last few days."
							},
							{
								"isprivate": "0",
								"commentid": "10511936",
								"comment_count": "57",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-06-16 07:03:43 +0000",
								"thetext": "yes, it's known that it happens on update from -21 to -22, which is why we withdrew -22."
							},
							{
								"isprivate": "0",
								"commentid": "10536418",
								"comment_count": "58",
								"who": {
									"text": "mcatanzaro+wrong-account-do-not-cc",
									"name": "Michael Catanzaro"
								},
								"bug_when": "2017-06-23 19:03:07 +0000",
								"thetext": "So this is an accepted F26 beta blocker, but not yet closed. What's up here? Does it need to be moved to F26 final blocker?"
							},
							{
								"isprivate": "0",
								"commentid": "10536474",
								"comment_count": "59",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-06-23 19:34:04 +0000",
								"thetext": "It was being left open while we sorted through all the messy consequences of the updates, but the bug covered *here* is in fact fixed by -21. Since we decided to just leave -21 in stable and help people who hit the RPM db issue on update to -21 one-by-one, there's really not a lot left to do here, and I think we can just go ahead and close the bug."
							}
						]
					}
				],
				"external_bugs": {
					"text": "21119",
					"name": "Sourceware"
				},
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "9888750",
						"comment_count": "0",
						"who": {
							"text": "jpazdziora",
							"name": "Jan Pazdziora"
						},
						"bug_when": "2016-11-14 15:35:21 +0000",
						"thetext": "Description of problem:\n\nBuilding Fedora rawhide container image from Dockerfile\n\nFROM fedora:rawhide\nRUN dnf install -y httpd\n\nworks fine.\n\nHowever, adding RUN dnf upgrade -y glibc before the dnf install line causes the build process to hang.\n\nVersion-Release number of selected component (if applicable):\n\nglibc-2.24.90-13.fc26.x86_64\n\nHow reproducible:\n\nDeterministic for this particular Dockerfile on my machines. But it's not always apr-util or the second package on which it gets stuck.\n\nSteps to Reproduce:\n1. Have Dockerfile\n\nFROM fedora:rawhide\nRUN dnf upgrade -y glibc\nRUN dnf install -y httpd\n\n2. Attempt to build the image: docker build -t rawhide .\n\nActual results:\n\nInstall  7 Packages\n\nTotal download size: 1.7 M\nInstalled size: 4.7 M\nDownloading Packages:\n--------------------------------------------------------------------------------\nTotal                                           1.1 MB/s | 1.7 MB     00:01     \nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Installing  : apr-1.5.2-4.fc25.x86_64                                     1/7 \n  Installing  : apr-util-1.5.4-3.fc24.x86_64                                2/7\n\nand here the process hangs.\n\nExpected results:\n\nAll packages installed, image created.\n\nAdditional info:\n\nThe same hang happens with plain docker run:\n\ndocker run --rm -ti fedora:rawhide bash -c 'dnf upgrade -y glibc && dnf install -y httpd'\n\nWith glibc-2.24.90-2.fc26.x86_64 (which is on the 3 month old fedora:rawhide image), things work, that's why filing against glibc."
					},
					{
						"isprivate": "0",
						"commentid": "9888769",
						"comment_count": "1",
						"who": {
							"text": "jpazdziora",
							"name": "Jan Pazdziora"
						},
						"bug_when": "2016-11-14 15:38:05 +0000",
						"thetext": "The OS and environment on the host do not matter -- I see the same hang on Fedora 24 with docker-1.10.3-54.gite03ddb8.fc24.x86_64 and on RHEL 7.3 with docker-1.12.3-4.el7.x86_64."
					},
					{
						"isprivate": "0",
						"commentid": "9888773",
						"comment_count": "2",
						"who": {
							"text": "fweimer",
							"name": "Florian Weimer"
						},
						"bug_when": "2016-11-14 15:38:50 +0000",
						"thetext": "Please provide a process tree (ps axuf) when the hang occurs.  Attaching GDB to the hanging subprocess would be helpful, too, but it could prove difficult to get GDB to pick up the proper separate debuginfo.  Alternatively, please create a coredump of the hanging process with gcore and upload it somewhere.  Then we can analyze it offline."
					},
					{
						"isprivate": "0",
						"commentid": "9892011",
						"comment_count": "3",
						"who": {
							"text": "jpazdziora",
							"name": "Jan Pazdziora"
						},
						"bug_when": "2016-11-15 10:48:29 +0000",
						"thetext": "The bt against the hung process is\n\n#0  0x00007fd8520f82c1 in futex_wait (private=<optimized out>, expected=4294967295, futex_word=0x7fd842759c04) at ../sysdeps/unix/sysv/linux/futex-internal.h:61\n#1  futex_wait_simple (private=<optimized out>, expected=4294967295, futex_word=0x7fd842759c04) at ../sysdeps/nptl/futex-internal.h:135\n#2  __pthread_cond_destroy (cond=cond@entry=0x7fd842759be0) at pthread_cond_destroy.c:54\n#3  0x00007fd846d969cf in __db_pthread_mutex_destroy (env=env@entry=0x55ac4daae720, mutex=mutex@entry=340) at ../../src/mutex/mut_pthread.c:757\n#4  0x00007fd846d9610f in __db_tas_mutex_destroy (env=env@entry=0x55ac4daae720, mutex=mutex@entry=340) at ../../src/mutex/mut_tas.c:602\n#5  0x00007fd846e4dda8 in __mutex_free_int (env=0x55ac4daae720, locksys=locksys@entry=1, indxp=indxp@entry=0x7fd84036f550) at ../../src/mutex/mut_alloc.c:248\n#6  0x00007fd846e4e3c5 in __mutex_free (env=env@entry=0x55ac4daae720, indxp=indxp@entry=0x7fd84036f550) at ../../src/mutex/mut_alloc.c:217\n#7  0x00007fd846eb329b in __memp_bhfree (dbmp=dbmp@entry=0x55ac4cc383f0, infop=0x55ac4daf5b30, mfp=mfp@entry=0x7fd8403052d0, hp=<optimized out>, \n    bhp=bhp@entry=0x7fd84036f550, flags=flags@entry=1) at ../../src/mp/mp_bh.c:663\n#8  0x00007fd846eb5aca in __memp_fget (dbmfp=dbmfp@entry=0x55ac4d9e50f0, pgnoaddr=pgnoaddr@entry=0x7ffc5622bb5c, ip=ip@entry=0x7fd84045f770, txn=txn@entry=0x0, \n    flags=flags@entry=8, addrp=addrp@entry=0x7ffc5622bb60) at ../../src/mp/mp_fget.c:479\n#9  0x00007fd846ebb4fc in __memp_ftruncate (dbmfp=dbmfp@entry=0x55ac4d9e50f0, txn=0x0, ip=0x7fd84045f770, pgno=pgno@entry=19, flags=flags@entry=0)\n    at ../../src/mp/mp_method.c:856\n#10 0x00007fd846e7199e in __db_free (dbc=dbc@entry=0x55ac4d9e8280, h=<optimized out>, flags=flags@entry=0) at ../../src/db/db_meta.c:525\n#11 0x00007fd846e75ddb in __db_doff (dbc=dbc@entry=0x55ac4d9e8280, pgno=<optimized out>) at ../../src/db/db_overflow.c:479\n#12 0x00007fd846da3a8f in __bam_ditem (dbc=dbc@entry=0x55ac4d9e8280, h=0x7fd84036b388, indx=indx@entry=7) at ../../src/btree/bt_delete.c:138\n#13 0x00007fd846da8160 in __bam_iitem (dbc=dbc@entry=0x55ac4d9e8280, key=key@entry=0x7ffc5622c1d0, data=data@entry=0x7ffc5622c1a0, op=6, flags=flags@entry=0)\n    at ../../src/btree/bt_put.c:421\n#14 0x00007fd846da2e5d in __bamc_put (dbc=0x55ac4d9e8280, key=0x7ffc5622c1d0, data=0x7ffc5622c1a0, flags=14, pgnop=0x7ffc5622c0b4)\n    at ../../src/btree/bt_cursor.c:2240\n#15 0x00007fd846e5d1dc in __dbc_iput (dbc=0x55ac4daad330, key=0x7ffc5622c1d0, data=0x7ffc5622c1a0, flags=14) at ../../src/db/db_cam.c:2136\n#16 0x00007fd846e5f70d in __dbc_put (dbc=dbc@entry=0x55ac4daad330, key=key@entry=0x7ffc5622c1d0, data=data@entry=0x7ffc5622c1a0, flags=<optimized out>, \n    flags@entry=14) at ../../src/db/db_cam.c:2049\n#17 0x00007fd846e6c9c1 in __dbc_put_pp (dbc=0x55ac4daad330, key=0x7ffc5622c1d0, data=0x7ffc5622c1a0, flags=14) at ../../src/db/db_iface.c:2751\n#18 0x00007fd84754b235 in dbiCursorPut.isra.5 () from /lib64/librpm.so.7\n#19 0x00007fd84754d211 in updateIndex.part.8 () from /lib64/librpm.so.7\n#20 0x00007fd84754d5e1 in db3_idxdbPut () from /lib64/librpm.so.7\n#21 0x00007fd847553168 in tag2index () from /lib64/librpm.so.7\n#22 0x00007fd847556c6b in rpmdbAdd () from /lib64/librpm.so.7\n#23 0x00007fd84756a86d in rpmpsmRun () from /lib64/librpm.so.7\n#24 0x00007fd84757e125 in rpmteProcess () from /lib64/librpm.so.7\n#25 0x00007fd847584a3e in rpmtsRun () from /lib64/librpm.so.7\n#26 0x00007fd84559d204 in rpmts_Run () from /usr/lib64/python3.5/site-packages/rpm/_rpm.cpython-35m-x86_64-linux-gnu.so\n#27 0x00007fd8523b67e9 in PyCFunction_Call (func=<built-in method run of TransactionSet object at remote 0x7fd843940b28>, \n    args=(<method at remote 0x7fd84458a1c8>, '', 64), kwds=<optimized out>) at /usr/src/debug/Python-3.5.2/Objects/methodobject.c:98\n#28 0x00007fd85236eeb7 in PyObject_Call (func=<built-in method run of TransactionSet object at remote 0x7fd843940b28>, arg=<optimized out>, kw=<optimized out>)\n    at /usr/src/debug/Python-3.5.2/Objects/abstract.c:2165\n#29 0x00007fd852425d17 in PyEval_CallObjectWithKeywords (func=func@entry=<built-in method run of TransactionSet object at remote 0x7fd843940b28>, \n    arg=arg@entry=(<method at remote 0x7fd84458a1c8>, '', 64), kw=kw@entry=0x0) at /usr/src/debug/Python-3.5.2/Python/ceval.c:4609\n#30 0x00007fd852389b38 in methoddescr_call (descr=<optimized out>, args=(<method at remote 0x7fd84458a1c8>, '', 64), kwds=0x0)\n    at /usr/src/debug/Python-3.5.2/Objects/descrobject.c:250\n#31 0x00007fd85236eeb7 in PyObject_Call (func=<method_descriptor at remote 0x7fd845bfd708>, arg=<optimized out>, kw=<optimized out>)\n    at /usr/src/debug/Python-3.5.2/Objects/abstract.c:2165\n#32 0x00007fd85242a491 in do_call (nk=<optimized out>, na=4, pp_stack=0x7ffc5622ca60, func=<optimized out>) at /usr/src/debug/Python-3.5.2/Python/ceval.c:4965\n#33 call_function (oparg=<optimized out>, pp_stack=0x7ffc5622ca60) at /usr/src/debug/Python-3.5.2/Python/ceval.c:4761\n#34 PyEval_EvalFrameEx (\n    f=f@entry=Frame 0x7fd842bae048, for file /usr/lib64/python3.5/site-packages/rpm/transaction.py, line 103, in run (self=<TransactionSet(_probFilter=64) at remote 0x7fd843940b28>, callback=<method at remote 0x7fd84458a1c8>, data=''), throwflag=throwflag@entry=0) at /usr/src/debug/Python-3.5.2/Python/ceval.c:3260\n#35 0x00007fd85242dcfb in fast_function (nk=<optimized out>, na=<optimized out>, n=3, pp_stack=0x7ffc5622cba0, func=<optimized out>)\n    at /usr/src/debug/Python-3.5.2/Python/ceval.c:4832\n#36 call_function (oparg=<optimized out>, pp_stack=0x7ffc5622cba0) at /usr/src/debug/Python-3.5.2/Python/ceval.c:4759\n#37 PyEval_EvalFrameEx (\n    f=f@entry=Frame 0x55ac4da0bba8, for file /usr/lib/python3.5/site-packages/dnf/base.py, line 735, in _run_transaction (self=<BaseCli(_tempfile_persistor=None, _ds_callback=<DepSolveProgressCallBack(loops=1) at remote 0x7fd843950710>, _comps=None, _group_persistor=None, _plugins=<Plugins(plugin_cls=[<type at remote 0x55ac4bdef758>, <type at remote 0x55ac4bde9c38>, <type at remote 0x55ac4bdef3a8>, <type at remote 0x55ac4bdf24b8>, <type at remote 0x55ac4bdfcdd8>, <type at remote 0x55ac4bdf1f58>, <type at remote 0x55ac4bde8a38>, <type at remote 0x55ac4bdedaa8>, <type at remote 0x55ac4bdf3f08>, <type at remote 0x55ac4bdf3b58>], plugins=[<DebuginfoInstall(cli=<Cli(cmdstring='dnf install -y httpd ', command=<InstallCommand(cli=<...>, opts=<Namespace(ip_resolve=None, debuglevel=None, command=['install'], help=False, color=None, setopts=[], allowerasing=None, rpmverbosity=None, quiet=None, repos_ed=[], showdupesfromrepos=None, releasever=None, verbose=None, plugins=None, assumeno=None, version=None, excludepkgs=[], debugsolver=N...(truncated), throwflag=throwflag@entry=0) at /usr/src/debug/Python-3.5.2/Python/ceval.c:3260\n#38 0x00007fd85242f5c3 in _PyEval_EvalCodeWithName (_co=<optimized out>, globals=<optimized out>, locals=locals@entry=0x0, args=args@entry=0x55ac4c8bac90, \n    argcount=1, kws=0x55ac4c8bac98, kwcount=1, defs=0x0, defcount=0, kwdefs=0x0, closure=0x0, name='_run_transaction', qualname='Base._run_transaction')\n    at /usr/src/debug/Python-3.5.2/Python/ceval.c:4047\n#39 0x00007fd85242be39 in fast_function (nk=<optimized out>, na=<optimized out>, n=<optimized out>, pp_stack=0x7ffc5622cdb0, func=<optimized out>)\n    at /usr/src/debug/Python-3.5.2/Python/ceval.c:4842\n#40 call_function (oparg=<optimized out>, pp_stack=0x7ffc5622cdb0) at /usr/src/debug/Python-3.5.2/Python/ceval.c:4759\n#41 PyEval_EvalFrameEx (\n    f=f@entry=Frame 0x55ac4c8baaa8, for file /usr/lib/python3.5/site-packages/dnf/base.py, line 661, in do_transaction (self=<BaseCli(_tempfile_persistor=None, _ds_callback=<DepSolveProgressCallBack(loops=1) at remote 0x7fd843950710>, _comps=None, _group_persistor=None, _plugins=<Plugins(plugin_cls=[<type at remote 0x55ac4bdef758>, <type at remote 0x55ac4bde9c38>, <type at remote 0x55ac4bdef3a8>, <type at remote 0x55ac4bdf24b8>, <type at remote 0x55ac4bdfcdd8>, <type at remote 0x55ac4bdf1f58>, <type at remote 0x55ac4bde8a38>, <type at remote 0x55ac4bdedaa8>, <type at remote 0x55ac4bdf3f08>, <type at remote 0x55ac4bdf3b58>], plugins=[<Debugi---Type <return> to continue, or q <return> to quit---\n\nThe ps output in the container is\n\n# ps axuwwf\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot        11  0.0  0.0  12588  3716 ?        Ss   10:46   0:00 bash\nroot        34  0.0  0.0  39828  3256 ?        R+   10:48   0:00  \\_ ps axuwwf\nroot         1  1.3  2.2 541256 91700 ?        Ss+  10:46   0:01 /usr/libexec/system-python /usr/bin/dnf install -y httpd"
					},
					{
						"isprivate": "0",
						"commentid": "9892027",
						"comment_count": "4",
						"who": {
							"text": "fweimer",
							"name": "Florian Weimer"
						},
						"bug_when": "2016-11-15 10:56:46 +0000",
						"thetext": "(In reply to Jan Pazdziora from comment #3)\n> The bt against the hung process is\n> \n> #0  0x00007fd8520f82c1 in futex_wait (private=<optimized out>,\n> expected=4294967295, futex_word=0x7fd842759c04) at\n> ../sysdeps/unix/sysv/linux/futex-internal.h:61\n> #1  futex_wait_simple (private=<optimized out>, expected=4294967295,\n> futex_word=0x7fd842759c04) at ../sysdeps/nptl/futex-internal.h:135\n> #2  __pthread_cond_destroy (cond=cond@entry=0x7fd842759be0) at\n> pthread_cond_destroy.c:54\n\nThis could be due to glibc-swbz13165.patch (new condition variable implementation)."
					},
					{
						"isprivate": "0",
						"commentid": "9892712",
						"comment_count": "5",
						"who": {
							"text": "fweimer",
							"name": "Florian Weimer"
						},
						"bug_when": "2016-11-15 13:41:29 +0000",
						"thetext": "I was able to reproduce it, but only in a Docker image.  Here's the condvar state:\n\n(gdb) print *cond\n$2 = {__data = {{__wseq = 0, __wseq32 = {__low = 0, __high = 0}}, {\n      __g1_start = 0, __g1_start32 = {__low = 0, __high = 0}}, \n    __g_refs = {0, 0}, __g_size = {0, 0}, \n    __g1_orig_size = 4294967295, __wrefs = 4294967295, \n    __g_signals = {0, 0}}, \n  __size = '\\000' <repeats 32 times>, \"\\377\\377\\377\\377\\377\\377\\377\\377\\000\\000\\000\\000\\000\\000\\000\", __align = 0}"
					},
					{
						"isprivate": "0",
						"commentid": "9893108",
						"comment_count": "6",
						"who": {
							"text": "triegel",
							"name": "Torvald Riegel"
						},
						"bug_when": "2016-11-15 15:19:53 +0000",
						"thetext": "It seems that the root cause is that the program tries to use a condvar instance that has been initialized with a prior version of glibc.  The condvar appears to be in a database file (/var/lib/rpm/__db.002 in our reproducer).  With the (glibc-internal) condvar definition in the old glibc version, the bits represent a valid, unused condvar:\n$4 = {__data = {__lock = 0, __futex = 0, __total_seq = 0, \n                __wakeup_seq = 0,  __woken_seq = 0, __mutex = \n                0xffffffffffffffff, __nwaiters = 0,  __broadcast_seq = 0},\n\nThe same bits do not represent a valid condvar if given the condvar definition in the new version of glibc.\n\nStoring the condvar in the database file means that effectively, the program is expecting different versions of glibc to use the same bit representations of internal data structures.  This is not guaranteed to work.\n\nIt seems that either BDB should be changed to not store the condvar in database files, or dnf needs to reinitialize the databases it relies on when glibc is updated."
					},
					{
						"isprivate": "0",
						"commentid": "9893130",
						"comment_count": "7",
						"who": {
							"text": "fweimer",
							"name": "Florian Weimer"
						},
						"bug_when": "2016-11-15 15:23:57 +0000",
						"thetext": "The hang goes away if I add a rpm --rebuilddb step to the container build file:\n\nFROM fedora:rawhide\nRUN dnf upgrade -y glibc\nRUN rpm --rebuilddb\nRUN dnf install -y httpd"
					},
					{
						"isprivate": "0",
						"commentid": "9893331",
						"comment_count": "8",
						"who": {
							"text": "jpazdziora",
							"name": "Jan Pazdziora"
						},
						"bug_when": "2016-11-15 16:15:42 +0000",
						"thetext": "(In reply to Torvald Riegel from comment #6)\n> It seems that the root cause is that the program tries to use a condvar\n> instance that has been initialized with a prior version of glibc.\n\nThank you for the analysis.\n\n> The\n> condvar appears to be in a database file (/var/lib/rpm/__db.002 in our\n> reproducer).  With the (glibc-internal) condvar definition in the old glibc\n> version, the bits represent a valid, unused condvar:\n> $4 = {__data = {__lock = 0, __futex = 0, __total_seq = 0, \n>                 __wakeup_seq = 0,  __woken_seq = 0, __mutex = \n>                 0xffffffffffffffff, __nwaiters = 0,  __broadcast_seq = 0},\n> \n> The same bits do not represent a valid condvar if given the condvar\n> definition in the new version of glibc.\n\nCan the same issue happen during upgrade from (say) Fedora 24 to rawhide?\n\nHow hard would it be to make this old unused bit value also understood as unused value in new glibc?\n\n> Storing the condvar in the database file means that effectively, the program\n> is expecting different versions of glibc to use the same bit representations\n> of internal data structures.  This is not guaranteed to work.\n> \n> It seems that either BDB should be changed to not store the condvar in\n> database files, or dnf needs to reinitialize the databases it relies on when\n> glibc is updated.\n\nIt would likely need to be rpm, not dnf."
					},
					{
						"isprivate": "0",
						"commentid": "9893453",
						"comment_count": "9",
						"who": {
							"text": "codonell",
							"name": "Carlos O'Donell"
						},
						"bug_when": "2016-11-15 16:46:50 +0000",
						"thetext": "(In reply to Torvald Riegel from comment #6)\n> It seems that the root cause is that the program tries to use a condvar\n> instance that has been initialized with a prior version of glibc.  The\n> condvar appears to be in a database file (/var/lib/rpm/__db.002 in our\n> reproducer).  With the (glibc-internal) condvar definition in the old glibc\n> version, the bits represent a valid, unused condvar:\n> $4 = {__data = {__lock = 0, __futex = 0, __total_seq = 0, \n>                 __wakeup_seq = 0,  __woken_seq = 0, __mutex = \n>                 0xffffffffffffffff, __nwaiters = 0,  __broadcast_seq = 0},\n> \n> The same bits do not represent a valid condvar if given the condvar\n> definition in the new version of glibc.\n> \n> Storing the condvar in the database file means that effectively, the program\n> is expecting different versions of glibc to use the same bit representations\n> of internal data structures.  This is not guaranteed to work.\n> \n> It seems that either BDB should be changed to not store the condvar in\n> database files, or dnf needs to reinitialize the databases it relies on when\n> glibc is updated.\n\nThis is unsupported by POSIX, you must _always_ reinitialize the POISX thread objects per:\n~~~\n2.9.9 Synchronization Object Copies and Alternative Mappings\n\nFor barriers, condition variables, mutexes, and read-write locks, [TSH] [Option Start]  if the process-shared attribute is set to PTHREAD_PROCESS_PRIVATE, [Option End]  only the synchronization object at the address used to initialize it can be used for performing synchronization. The effect of referring to another mapping of the same object when locking, unlocking, or destroying the object is undefined. [TSH] [Option Start]  If the process-shared attribute is set to PTHREAD_PROCESS_SHARED, only the synchronization object itself can be used for performing synchronization; however, it need not be referenced at the address used to initalize it (that is, another mapping of the same object can be used). [Option End]  The effect of referring to a copy of the object when locking, unlocking, or destroying it is undefined.\n\nFor spin locks, the above requirements shall apply as if spin locks have a process-shared attribute that is set from the pshared argument to pthread_spin_init(). For semaphores, the above requirements shall apply as if semaphores have a process-shared attribute that is set to PTHREAD_PROCESS_PRIVATE if the pshared argument to sem_init() is zero and set to PTHREAD_PROCESS_SHARED if pshared is non-zero.\n~~~\n\nThe serialization of the POSIX thread object into the database is undefined behaviour as noted under \"The effect of referring to a copy of the object when locking, unlocking, or destroying it is undefined.\"\n\nYou may only use initialized objects.\n\nI'm moving this to libdb to get fixed."
					},
					{
						"isprivate": "0",
						"commentid": "9893486",
						"comment_count": "10",
						"who": {
							"text": "fweimer",
							"name": "Florian Weimer"
						},
						"bug_when": "2016-11-15 16:57:49 +0000",
						"thetext": "(In reply to Carlos O'Donell from comment #9)\n\nTorvald and I looked at the POSIX wording as well, and it is not sufficiently clear if the libdb usage is actually undefined.  POSIX likely intends this to be undefined: some implementations do not have a unified page cache, and the effect of the mutex/condition variable initialization may happen completely outside the context of the file mapping.\n\nThe key question is whether you may continue to use the resource after the process which has initialized it unmapped the file and exited.  The historic Berkeley DB use case requires the initialization to persist, although I do think it is problematic, as explained above.  Even the existing database environment liveness checks are likely insufficient because they cannot detect the case where all applications detached orderly, and reattach after a glibc update."
					},
					{
						"isprivate": "0",
						"commentid": "9894225",
						"comment_count": "11",
						"who": {
							"text": "fweimer",
							"name": "Florian Weimer"
						},
						"bug_when": "2016-11-15 20:30:04 +0000",
						"thetext": "I found where POSIX says that the libdb usage is undefined.  It's in the specfication for mmap and unmmap:\n\nThe state of synchronization objects such as mutexes, semaphores, barriers, and conditional variables placed in shared memory mapped with MAP_SHARED becomes undefined when the last region in any process containing the synchronization object is unmapped.\n\nIf we posit that glibc updates need system reboots, this means that the format of these data structures on disk does not have to be retained across glibc updates."
					},
					{
						"isprivate": "0",
						"commentid": "9894291",
						"comment_count": "12",
						"who": {
							"text": "codonell",
							"name": "Carlos O'Donell"
						},
						"bug_when": "2016-11-15 20:58:10 +0000",
						"thetext": "(In reply to Florian Weimer from comment #11)\n> I found where POSIX says that the libdb usage is undefined.  It's in the\n> specfication for mmap and unmmap:\n> \n> The state of synchronization objects such as mutexes, semaphores, barriers,\n> and conditional variables placed in shared memory mapped with MAP_SHARED\n> becomes undefined when the last region in any process containing the\n> synchronization object is unmapped.\n> \n> If we posit that glibc updates need system reboots, this means that the\n> format of these data structures on disk does not have to be retained across\n> glibc updates.\n\nCorrect, with the alignment and size being constrained by the ABI, so that needs to remain constant, but yes, the internal details of the type and the bit patterns and their meanings can and may change from release to release. You must reinitialize the objects before using them.\n\n(In reply to Florian Weimer from comment #10)\n> (In reply to Carlos O'Donell from comment #9)\n> \n> Torvald and I looked at the POSIX wording as well, and it is not\n> sufficiently clear if the libdb usage is actually undefined.  POSIX likely\n> intends this to be undefined: some implementations do not have a unified\n> page cache, and the effect of the mutex/condition variable initialization\n> may happen completely outside the context of the file mapping.\n\nThe \"why\" is covered in the non-normative text under \"Alternate Implementations Possible\" here:\nhttp://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_mutex_init.html\n\n> The key question is whether you may continue to use the resource after the\n> process which has initialized it unmapped the file and exited.  The historic\n> Berkeley DB use case requires the initialization to persist, although I do\n> think it is problematic, as explained above.  Even the existing database\n> environment liveness checks are likely insufficient because they cannot\n> detect the case where all applications detached orderly, and reattach after\n> a glibc update.\n\nYou cannot continue to use the synchronization resource after the last mapping is removed, as you noted in comment 11.\n\n(In reply to Jan Pazdziora from comment #8)\n> (In reply to Torvald Riegel from comment #6)\n> > The\n> > condvar appears to be in a database file (/var/lib/rpm/__db.002 in our\n> > reproducer).  With the (glibc-internal) condvar definition in the old glibc\n> > version, the bits represent a valid, unused condvar:\n> > $4 = {__data = {__lock = 0, __futex = 0, __total_seq = 0, \n> >                 __wakeup_seq = 0,  __woken_seq = 0, __mutex = \n> >                 0xffffffffffffffff, __nwaiters = 0,  __broadcast_seq = 0},\n> > \n> > The same bits do not represent a valid condvar if given the condvar\n> > definition in the new version of glibc.\n> \n> Can the same issue happen during upgrade from (say) Fedora 24 to rawhide?\n\nYes, the same issue may happen when upgrading from Fedora 24 to Rawhide. It is conceivable that this issue becomes a blocker for F26 if it reproduces consistently during installs or upgrades.\n\nThis needs to be fixed in Berkeley DB, this is a error in the use of the POSIX threads primitives which constrains the implementation from moving forward with beneficial changes e.g. correctness and performance for condition variables (the reason the internal type representation changed).\n\n> How hard would it be to make this old unused bit value also understood as\n> unused value in new glibc?\n\nTLDR; we would never support detecting of the old unused bit value. The cost is too high for other applications.\n\nYou would have to detect all possible marshalled bit patterns and reinitialize the condition variable in all API interfaces that might be passed the unmarshalled state. The cost is non-zero, the cost is on the hot path for all other applications that use the type (even with versioning apps pay the price until they are recompiled), and it would be only to support an undefined use.\n\n> > Storing the condvar in the database file means that effectively, the program\n> > is expecting different versions of glibc to use the same bit representations\n> > of internal data structures.  This is not guaranteed to work.\n> > \n> > It seems that either BDB should be changed to not store the condvar in\n> > database files, or dnf needs to reinitialize the databases it relies on when\n> > glibc is updated.\n> \n> It would likely need to be rpm, not dnf.\n\nIt would actually be in Berkeley DB, which is where we have assigned this bug to e.g. libdb."
					},
					{
						"isprivate": "0",
						"commentid": "9894316",
						"comment_count": "13",
						"who": {
							"text": "codonell",
							"name": "Carlos O'Donell"
						},
						"bug_when": "2016-11-15 21:08:36 +0000",
						"thetext": "(In reply to Carlos O'Donell from comment #12)\n> > How hard would it be to make this old unused bit value also understood as\n> > unused value in new glibc?\n> \n> TLDR; we would never support detecting of the old unused bit value. The cost\n> is too high for other applications.\n> \n> You would have to detect all possible marshalled bit patterns and\n> reinitialize the condition variable in all API interfaces that might be\n> passed the unmarshalled state. The cost is non-zero, the cost is on the hot\n> path for all other applications that use the type (even with versioning apps\n> pay the price until they are recompiled), and it would be only to support an\n> undefined use.\n\nFYI.\n\nFor the sake of openness and transparency there are two cases which glibc doesn't support which it could, and it is the following:\n\n(1) Mixed implementations with PTHREAD_PROCESS_SHARED.\n\n(a) Process A running glibc X initializes a condition variable in shared memory with PTHREAD_PROCESS_SHARED.\n(b) Process B running glibc X+1 (with a different condition variable definition) attaches to that shared memory and tries to use it.\n\nIt is clear that process A and process B have two different understandings of the condition variable. The use of PTHREAD_PROCESS_SHARED has to trigger some kind of versioned data interface e.g. a condvar with a version field which detects the version in use and switches to the appropriate algorithm. This would incur significant costs when using PTHREAD_PROCESS_SHARED objects, and the use case has never become so important to support that we have supported it. Either way the glibc upgrade for Process B required a reboot, so as Florian argues you need to reboot, in which case you get a consistent view of the condvar and everything works optimally. The text as written in POSIX argues the above should be supported, but glibc doesn't support it.\n\n(2) Mixed 32-bit and 64-bit implementations with PTHREAD_PROCESS_SHARED (similar to (1)).\n\nWhile this is similar to (1) and can be considered a case of \"another implementation of narrower type\" I want to call it out separately.\n\nThe other case is a mixed 32-bit and 64-bit process case where the processes share types in shared memory, and this doesn't work correctly for the obvious reasons that the types are different ABIs. Making it work could again be part of making PTHREAD_PROCESS_SHARED truly \"proces shared\" across an ABI boundary for 32-bit and 64-bit code (reserve a bit in the version field for an ABI flag). Again this use case has never been important enough from a user perspective that we would attempt to fix it (though we face a similar problem in nscd with shared maps of the database caches)."
					},
					{
						"isprivate": "0",
						"commentid": "9896147",
						"comment_count": "14",
						"who": {
							"text": "triegel",
							"name": "Torvald Riegel"
						},
						"bug_when": "2016-11-16 10:43:58 +0000",
						"thetext": "I had a quick look at src/mutex/mut_pthread.c, and I'd like to stress that this applies to all pthreads synchronization primitives, not just condvars.  libdb should not try to persist instances of these types; if it does, the database becomes tied to a particular glibc version.  A new rwlock implementation is in the queue for testing in Rawhide, and we may alter plain mutexes too in the future.\n\nlibdb will have to either implement custom synchronization, or it has to require clients to all use the same glibc version and architecture (including 32b vs. 64b on x86_64, for example)."
					},
					{
						"isprivate": "0",
						"commentid": "9896745",
						"comment_count": "15",
						"who": {
							"text": "fedora-admin-xmlrpc",
							"name": "Fedora Admin XMLRPC Client"
						},
						"bug_when": "2016-11-16 13:31:44 +0000",
						"thetext": "This package has changed ownership in the Fedora Package Database.  Reassigning to the new owner of this component."
					},
					{
						"isprivate": "0",
						"commentid": "10030579",
						"comment_count": "16",
						"who": {
							"text": "triegel",
							"name": "Torvald Riegel"
						},
						"bug_when": "2017-01-03 13:29:49 +0000",
						"thetext": "glibc upstream now contains the new condition variable.  Has any work been started on the libdb (users) side to fix this libdb bug?\n\nlibdb has to be fixed very soon or we will get into issues when updating glibc.  I can help with how to fix this in libdb, but I do need help from the libdb maintainers, in particular in terms of (1) testing, (2) ensuring that all users of libdb enable whatever solution we come up with, and (3) notifying other distributions about this.\n\nWho are the people that should be involved in this?  I suppose upstream-first isn't possible in this case?"
					},
					{
						"isprivate": "0",
						"commentid": "10030653",
						"comment_count": "17",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-01-03 13:54:28 +0000",
						"thetext": "Thanks for bringing this up.\nI have not yet managed to take a deeper look at this but I can see how this might prove problematic in the near future. I will definitely appreciate any help you can offer with fixing libdb.\nAs for testing this change, libdb has some kind of test suite that might be useful but has not been used yet in any way. I will take a look at it and see if I can get it working.\n\nI am not sure whether we are going to get any support from upstream with this issue given that we are running on an older (possibly already unsupported?) release, but I can try asking anyway."
					},
					{
						"isprivate": "0",
						"commentid": "10031237",
						"comment_count": "18",
						"who": {
							"text": "triegel",
							"name": "Torvald Riegel"
						},
						"bug_when": "2017-01-03 17:31:42 +0000",
						"thetext": "Note that I haven't ever worked with or on libdb before, so it would be good to get people involved that have some experience.  I don't have the spare time to see this through in detail.  I can help regarding how to use pthreads properly and with general concurrency considerations.\n\nTo reiterate, the problem is that libdb uses the glibc-internal binary representation in databases, and either (1) libdb or (2) how dnf uses libdb cause new glibc code to try to work on binary representation of old glibc code.  \n\nI'm splitting this up in (1) and (2) because it is not yet clear to me who exactly is at fault here.  libdb's documentation on upgrading libdb (see docs/upgrading/upgrade_process.html in libdb's source) is rather vague and fails to include glibc (or whatever provides pthreads) in it's consideration but does mention the compiler; this is odd at least from our perspective because things like datastructure layout are part of the ABI guarantees but glibc-internal representations are not part of the ABI.  libdb could state that any pthreads-implementation update is to be considered to be a libdb major/minor update -- but it does not do that AFAIK, and it's unclear whether that would help.\n\nlibdb could require that only the same build of libdb including the same build of the pthreads implementation are active on the same database concurrently.  If it would shut down all mutexes when there are no references left and reinitialize them when a new reference comes in, this should be sufficient to not trigger the glibc update problem under that requirement.  In this case, it may be simply dnf's fault if dnf does not enforce that no process must hold a reference on dnf's databases while glibc is upgraded.\nSecond, I have looked a bit at the code for libdb mutex, mutex regions, and environments, but I haven't figured out yet whether libdb actually destroys all mutexes when the last reference to a database is removed.\nNonetheless, making this scenario work could be a solution.\n\nAnother solution could be to say that glibc upgrades are like libdb major/minor upgrades, and then follow (some of) the steps outlined in docs/upgrading/upgrade_process.html for every user of libdb.  This requires touching more packages, but may be easier to enforce than the first solution, which requires checking whether libdb clients cannot hold a reference across updates of glibc.\n\nA third solution would be to version databases and include glibc's version in there.  But that doesn't provide automatic capability, and would probably require quite a few changes to libdb.\n\nI guess it would be best to look at the first solution first, starting with trying to find out what libdb actually guarantees or intends to guarantee.  Any suggestions for where to get this information?"
					},
					{
						"isprivate": "0",
						"commentid": "10032861",
						"comment_count": "19",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-01-04 06:53:47 +0000",
						"thetext": "Just FWIW: dnf does not use libdb directly, rpm does. Dnf is only involved as a librpm API consumer. The rpmdb is never closed during a transaction so there's always a \"reference\" to the database environment when an upgrade is in process.\n\nFrom rpm POV the simplest option would be to just flick on DB_PRIVATE mode. Which sort of equals disabling db locking but then non-root queries (which I'd assume to be the vast majority) run in DB_PRIVATE mode for the simple reason of not having permission to grab locks, and the world hasn't ended. Single writer is enforced via a separate transaction lock anyway."
					},
					{
						"isprivate": "0",
						"commentid": "10033443",
						"comment_count": "20",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-01-04 11:39:06 +0000",
						"thetext": "(In reply to Torvald Riegel from comment #18)\n> Second, I have looked a bit at the code for libdb mutex, mutex regions, and\n> environments, but I haven't figured out yet whether libdb actually destroys\n> all mutexes when the last reference to a database is removed.\n> Nonetheless, making this scenario work could be a solution.\n\nTo my knowledge, mutexes located in libdb's regions are not destroyed or re-initialized when the last process that references them exists.\n \n> Another solution could be to say that glibc upgrades are like libdb\n> major/minor upgrades, and then follow (some of) the steps outlined in\n> docs/upgrading/upgrade_process.html for every user of libdb.  This requires\n> touching more packages, but may be easier to enforce than the first\n> solution, which requires checking whether libdb clients cannot hold a\n> reference across updates of glibc.\n\nThis would be possible for the packages we know of but not helpful for user applications built upon libdb that would find themselves unable to use it and would have to make some manual changes on their own.\nThis could however be used as a workaround for rpm which would otherwise block the upgrade to F26.\n\n> A third solution would be to version databases and include glibc's version\n> in there.  But that doesn't provide automatic capability, and would probably\n> require quite a few changes to libdb.\n> \n> I guess it would be best to look at the first solution first, starting with\n> trying to find out what libdb actually guarantees or intends to guarantee. \n> Any suggestions for where to get this information?\n\nUnfortunately my knowledge about libdb is also very limited given that I have not been taking care of it for too long.\nI have contacted upstream regarding this issue. The thread is publicly available at:\nhttps://community.oracle.com/message/14170069\nMy hope is that Oracle might help us answer the questions we have about their implementation at least."
					},
					{
						"isprivate": "0",
						"commentid": "10039851",
						"comment_count": "21",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-01-06 07:49:59 +0000",
						"thetext": "Discussion with Oracle moved to email. They promised to take a look at this issue but it will take a while before they can work on it actively. Do we know when the new implementation is going to get into an upstream release? So Oracle know what timeframe to work with.\n\nI have also verified with Oracle that libdb does not do any reinitialization checks of synchronization primitives on its own, so the only way to currently work around this is by opening the environment with the DB_RECOVER (or DB_PRIVATE as Panu pointed out) flag set."
					},
					{
						"isprivate": "0",
						"commentid": "10142317",
						"comment_count": "22",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-02-13 09:53:40 +0000",
						"thetext": "Forwarding new information from upstream:\n\n----\n\nWe have been looking at this.  this is a bit tricky.   The problem as we see it, is the glibc library changes the pthread_cond_t structure in a way that breaks backward compatibility.   So we cannot look at structure size and make any conclusions.  The idea that we came up with is this ....\n\n   -  add a check in the configure code to see if gnu_get_libc_version() exists on the system -- This should be true for nearly all Linuxes\n - if true, we compile in some extra code that is executed during the environment open\n - This code will clean the mutex region if the glibc version is different.\n\n  consequences of this patch ....\n\n  - we will store the glibc version in the environment and on open we will grab the current version and if we detect a mismatch we will recreate the region files.  This should prevent the hang that you are seeing.\n\n----\n\nThis could work as a workaround to the issue, however I have voiced some concerns regarding already existing environments that do not have the glibc version variable yet (as we had problems with modifying environment structures before).\nAlso upstream asks whether it is possible to get into a situation in which two rpm processes are accessing libdb environment each using a different glibc version (after performing the glibc upgrade)."
					},
					{
						"isprivate": "0",
						"commentid": "10142364",
						"comment_count": "23",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-02-13 10:15:26 +0000",
						"thetext": "(In reply to Petr Kubat from comment #22)\n> Also upstream asks whether it is possible to get into a situation in which\n> two rpm processes are accessing libdb environment each using a different\n> glibc version (after performing the glibc upgrade).\n\nThis is one of the reasons why calling rpm from rpm scriptlets is such a bad idea: while it appears to work most of the time, every once in a blue moon it breaks in that single transaction where glibc innards change and there's no way to predict when this might happen and reproducing can be a bit tricky too.\n\nIt's also a fine example of the wacko complications involved with the rpm database..."
					},
					{
						"isprivate": "0",
						"commentid": "10142495",
						"comment_count": "24",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-02-13 11:09:02 +0000",
						"thetext": "(In reply to Panu Matilainen from comment #23)\n> This is one of the reasons why calling rpm from rpm scriptlets is such a bad\n> idea: while it appears to work most of the time, every once in a blue moon\n> it breaks in that single transaction where glibc innards change and there's\n> no way to predict when this might happen and reproducing can be a bit tricky\n> too.\n> \n> It's also a fine example of the wacko complications involved with the rpm\n> database...\n\nAh, right. I forgot running rpm inside a rpm scriptlet is a thing. Thanks for reminding me."
					},
					{
						"isprivate": "0",
						"commentid": "10142506",
						"comment_count": "25",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-02-13 11:15:03 +0000",
						"thetext": "(In reply to Petr Kubat from comment #24)\n> \n> Ah, right. I forgot running rpm inside a rpm scriptlet is a thing. Thanks\n> for reminding me.\n\nIt's very much a discouraged thing. Not that discouraging ever *stopped* people from doing it though..."
					},
					{
						"isprivate": "0",
						"commentid": "10142525",
						"comment_count": "26",
						"who": {
							"text": "fweimer",
							"name": "Florian Weimer"
						},
						"bug_when": "2017-02-13 11:19:34 +0000",
						"thetext": "(In reply to Petr Kubat from comment #22)\n> Forwarding new information from upstream:\n> \n> ----\n> \n> We have been looking at this.  this is a bit tricky.   The problem as we see\n> it, is the glibc library changes the pthread_cond_t structure in a way that\n> breaks backward compatibility.   So we cannot look at structure size and\n> make any conclusions.  The idea that we came up with is this ....\n> \n>    -  add a check in the configure code to see if gnu_get_libc_version()\n> exists on the system -- This should be true for nearly all Linuxes\n>  - if true, we compile in some extra code that is executed during the\n> environment open\n>  - This code will clean the mutex region if the glibc version is different.\n> \n>   consequences of this patch ....\n> \n>   - we will store the glibc version in the environment and on open we will\n> grab the current version and if we detect a mismatch we will recreate the\n> region files.  This should prevent the hang that you are seeing.\n> \n> ----\n\nI don't think this is quite sufficient because the data structure layout could change without the glibc version changing.\n\nI suppose we could provide a pthread_layout_version_np function in glibc which returns an int which refers to version number of the current pthread data structure layout.  it is a bit tricky to come up with a single version number which is consistent across all distributions, but we can probably provide something."
					},
					{
						"isprivate": "0",
						"commentid": "10142610",
						"comment_count": "27",
						"who": {
							"text": "triegel",
							"name": "Torvald Riegel"
						},
						"bug_when": "2017-02-13 11:57:58 +0000",
						"thetext": "(In reply to Florian Weimer from comment #26)\n> (In reply to Petr Kubat from comment #22)\n> > Forwarding new information from upstream:\n> > \n> > ----\n> > \n> > We have been looking at this.  this is a bit tricky.   The problem as we see\n> > it, is the glibc library changes the pthread_cond_t structure in a way that\n> > breaks backward compatibility.   So we cannot look at structure size and\n> > make any conclusions.  The idea that we came up with is this ....\n> > \n> >    -  add a check in the configure code to see if gnu_get_libc_version()\n> > exists on the system -- This should be true for nearly all Linuxes\n> >  - if true, we compile in some extra code that is executed during the\n> > environment open\n> >  - This code will clean the mutex region if the glibc version is different.\n> > \n> >   consequences of this patch ....\n> > \n> >   - we will store the glibc version in the environment and on open we will\n> > grab the current version and if we detect a mismatch we will recreate the\n> > region files.  This should prevent the hang that you are seeing.\n> > \n> > ----\n> \n> I don't think this is quite sufficient because the data structure layout\n> could change without the glibc version changing.\n> \n> I suppose we could provide a pthread_layout_version_np function in glibc\n> which returns an int which refers to version number of the current pthread\n> data structure layout.  it is a bit tricky to come up with a single version\n> number which is consistent across all distributions, but we can probably\n> provide something.\n\nI agree that we could be able to build such a version number, but I don't think we should.  First, libdb should show that it can't just do reference counting, for example, and re-initialize any condvars it uses whenever the a database transitions from not being used to used.  I'll talk with libdb upstream about this."
					},
					{
						"isprivate": "0",
						"commentid": "10142830",
						"comment_count": "28",
						"who": {
							"text": "hyc",
							"name": "Howard Chu"
						},
						"bug_when": "2017-02-13 12:46:51 +0000",
						"thetext": "If you can guarantee that a reboot will occur between version changes, a simple fix is to always configure BDB to use a shared memory region instead of a mmap'd file for its environment. Then the shared memory region is automatically destroyed/recreated by rebooting the system."
					},
					{
						"isprivate": "0",
						"commentid": "10170909",
						"comment_count": "29",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-02-21 13:46:51 +0000",
						"thetext": "Some more information from the discussion with libdb upstream.\n\nWe have 2 ideas we are looking at right now.\n\n1. have BDB scroll away the glibc version and on an open do some checking to see if glibc version changed and force a recovery under the covers\n2. DBENV recovery on glibc version change via a %posttrans cleanup action\n\nThe first idea I have already mentioned in comment 22.\nThe second idea is something I have thrown into the discussion as a workaround  specifically for rpm. I have tried looking at this idea a bit more to see if it would actually work and found out, that there are additional issues connected with it.\nAFAIK there are 3 ways to go about forcing the environment to recover:\nFirst \"rpm --rebuilddb\", but this does not work as it needs a transaction lock that is held by the rpm process doing the install/update action.\nSecond is \"db_recover -h /var/lib/rpm\" which is the libdb way of doing the recovery. This does work in recovering the environment but results in the rpm process throwing DB_RUNRECOVERY errors.\nThird way is just removing the problematic region files by force via \"rm -f /var/lib/__db.00*\" but it seems rpm is recreating them with the old glibc structures in place when the db/dbenv is closed.\n\nGenerally libdb upstream is against modifying their code to rebuild the environment every time it is accessed as that (together with the implementation of an \"in-use\" counter) would be a non-negligible hit to performance."
					},
					{
						"isprivate": "0",
						"commentid": "10173689",
						"comment_count": "30",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-02-22 08:48:49 +0000",
						"thetext": "A correction to the third way of environment recovery (\"rm -f /var/lib/__db.00*\") - the region files are not recreated on closing the db/dbenv, but during dnf's verification process, which is still a problem since the hang is not removed."
					},
					{
						"isprivate": "0",
						"commentid": "10173727",
						"comment_count": "31",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-02-22 09:03:53 +0000",
						"thetext": "The underlying problem with the verification step might be the same to the one that I encountered a while ago in yum (bug 1351060)."
					},
					{
						"isprivate": "0",
						"commentid": "10191572",
						"comment_count": "32",
						"who": {
							"text": "bcotton",
							"name": "Fedora End Of Life"
						},
						"bug_when": "2017-02-28 10:36:52 +0000",
						"thetext": "This bug appears to have been reported against 'rawhide' during the Fedora 26 development cycle.\nChanging version to '26'."
					},
					{
						"isprivate": "0",
						"commentid": "10381035",
						"comment_count": "33",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-03 06:37:14 +0000",
						"thetext": "Some more information from upstream:\n\nThey are going with the basic solution that they had originally proposed (cleaning up the environment files on glibc version change). The main issue is doing this in a dynamic way.\n\nRight now upstream is waiting for a pass on all of their regressions tests so hopefully we will get a patch we can work with soon."
					},
					{
						"isprivate": "0",
						"commentid": "10415698",
						"comment_count": "34",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-16 08:07:23 +0000",
						"thetext": "Created attachment 1279226\nupstream patch\n\nEarlier today, upstream sent me the promised patch for our version of libdb (attached).\nOnly had time to do a quick test but it seems to work out of the box. Will do a thorough review later."
					},
					{
						"isprivate": "0",
						"commentid": "10441650",
						"comment_count": "35",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-05-23 22:43:34 +0000",
						"thetext": "libdb-5.3.28-18.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
					},
					{
						"isprivate": "0",
						"commentid": "10441653",
						"comment_count": "36",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-05-23 22:44:08 +0000",
						"thetext": "libdb-5.3.28-18.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf"
					},
					{
						"isprivate": "0",
						"commentid": "10441655",
						"comment_count": "37",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-05-23 22:44:32 +0000",
						"thetext": "libdb-5.3.28-18.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
					},
					{
						"isprivate": "0",
						"commentid": "10441663",
						"comment_count": "38",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2017-05-23 22:50:49 +0000",
						"thetext": "As this is blocking Fedora 26 beta, and the patch tested out with a scratch build (see https://bugzilla.redhat.com/show_bug.cgi?id=1443415#c19 ), I went ahead and submitted updates for all releases. Petr, of course if you spot anything wrong on review, I will withdraw the updates.\n\nFor F24 and F25 I synced up with master, pulling in a couple of other recent fixes; I reviewed them and they seemed to be quite safe to include, but again, please let me know if not."
					},
					{
						"isprivate": "0",
						"commentid": "10442371",
						"comment_count": "39",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-24 06:36:10 +0000",
						"thetext": "As for the patch I found one thing that bothered me and also might pose some issues:\n\n~~~~~~~~~~~~~~snip~~~~~~~~~~~~~~\n\ndiff -r db78da0996b1 src/env/env_region.c\n--- a/src/env/env_region.c  Mon Sep 09 11:09:35 2013 -0400\n+++ b/src/env/env_region.c  Sat Apr 29 04:10:18 2017 -0700\n@@ -14,17 +14,54 @@\n #include \"dbinc/log.h\"\n #include \"dbinc/txn.h\"\n\n+#define static\n static int  __env_des_get __P((ENV *, REGINFO *, REGINFO *, REGION **));\n static int  __env_faultmem __P((ENV *, void *, size_t, int));\n static int  __env_sys_attach __P((ENV *, REGINFO *, REGION *));\n\n~~~~~~~~~~~~~~snip~~~~~~~~~~~~~~\n\nI already have a patch for this (and other minor things) prepared but wanted to first get in touch with upstream to ask if there is not a good reason for the define to stay in (there is not).\nI will make new builds for libdb across all the branches that already have the original fix."
					},
					{
						"isprivate": "0",
						"commentid": "10442433",
						"comment_count": "40",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2017-05-24 06:56:26 +0000",
						"thetext": "Thanks for the heads-up - please do go ahead and edit my updates with your new builds if you have the power, or submit new updates to supersede them."
					},
					{
						"isprivate": "0",
						"commentid": "10442637",
						"comment_count": "41",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-24 07:50:39 +0000",
						"thetext": "New builds have been added to the existing updates.\n\nAs for how libdb now handles environment rebuild checks - when the environment is opened libdb checks the modify timestamp of libpthread.so, compares it with the value stored in the environment and on mismatch exclusively locks the environment and rebuilds it with new variables in place.\nLibdb now also rebuilds the environment the same way when either the internal layout of its regions' variables changes (as is the case with the addition of pthreads_timestamp) or when libdb is updated to a newer version."
					},
					{
						"isprivate": "0",
						"commentid": "10448828",
						"comment_count": "42",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-05-25 19:20:08 +0000",
						"thetext": "libdb-5.3.28-19.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
					},
					{
						"isprivate": "0",
						"commentid": "10450221",
						"comment_count": "43",
						"who": {
							"text": "lslebodn",
							"name": "Lukas Slebodnik"
						},
						"bug_when": "2017-05-26 07:32:49 +0000",
						"thetext": "(In reply to Adam Williamson from comment #38)\n> As this is blocking Fedora 26 beta, and the patch tested out with a scratch\n> build (see https://bugzilla.redhat.com/show_bug.cgi?id=1443415#c19 ), I went\n> ahead and submitted updates for all releases. Petr, of course if you spot\n> anything wrong on review, I will withdraw the updates.\n> \n> For F24 and F25 I synced up with master, pulling in a couple of other recent\n> fixes; I reviewed them and they seemed to be quite safe to include, but\n> again, please let me know if not.\n\nAdam,\nThank you very much. I really appreciate that you \"tested\" this update properly.\n[root@vm-174 ~]# dnf check-update\nerror: rpmdb: BDB0113 Thread/process 17153/139837515298560 failed: BDB1507 Thread died in Berkeley DB library\nerror: db5 error(-30973) from dbenv->failchk: BDB0087 DB_RUNRECOVERY: Fatal error, run database recovery\nerror: cannot open Packages index using db5 -  (-30973)\nerror: cannot open Packages database in /var/lib/rpm\nError: Error: rpmdb open failed\n[root@vm-174 ~]# \n[root@vm-174 ~]# rpm -q libdb\nerror: rpmdb: BDB0113 Thread/process 17153/139837515298560 failed: BDB1507 Thread died in Berkeley DB library\nerror: db5 error(-30973) from dbenv->failchk: BDB0087 DB_RUNRECOVERY: Fatal error, run database recovery\nerror: cannot open Packages index using db5 -  (-30973)\nerror: cannot open Packages database in /var/lib/rpm\nerror: rpmdb: BDB0113 Thread/process 17153/139837515298560 failed: BDB1507 Thread died in Berkeley DB library\nerror: db5 error(-30973) from dbenv->failchk: BDB0087 DB_RUNRECOVERY: Fatal error, run database recovery\nerror: cannot open Packages index using db5 -  (-30973)\nerror: cannot open Packages database in /var/lib/rpm\npackage libdb is not installed"
					},
					{
						"isprivate": "0",
						"commentid": "10450233",
						"comment_count": "44",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2017-05-26 07:36:59 +0000",
						"thetext": "Lukas: I didn't test it; people hitting the bug did, and it fixed the bug. Updates go to testing in order to find problems like that. I already unpushed the updates several hours ago. You may want to follow https://bugzilla.redhat.com/show_bug.cgi?id=1443415 , the discussion is more active there."
					},
					{
						"isprivate": "0",
						"commentid": "10450297",
						"comment_count": "45",
						"who": {
							"text": "lslebodn",
							"name": "Lukas Slebodnik"
						},
						"bug_when": "2017-05-26 07:47:45 +0000",
						"thetext": "Then it would be good to close this BZ as a duplicate or vice versa."
					},
					{
						"isprivate": "0",
						"commentid": "10451047",
						"comment_count": "46",
						"who": {
							"text": "lslebodn",
							"name": "Lukas Slebodnik"
						},
						"bug_when": "2017-05-26 11:58:13 +0000",
						"thetext": "(In reply to Adam Williamson from comment #44)\n> Lukas: I didn't test it; people hitting the bug did, and it fixed the bug.\nAnd that is the biggest problem. It is a critical package and you blindly pushed 5.3.28-18 to updates-testing.\n\nYou would have not pushed package to updates-tesing if had tried dnf update + links from koji.\n  e.g. dnf update https://kojipkgs.fedoraproject.org//packages/libdb/5.3.28/18.fc26/x86_64/libdb-5.3.28-18.fc26.x86_64.rpm https://kojipkgs.fedoraproject.org//packages/libdb/5.3.28/18.fc26/x86_64/libdb-utils-5.3.28-18.fc26.x86_64.rpm\n\nBecause it does not work. I know is not just your problem because package maintainer didn't tested it's build either (5.3.28-19). (dnf update + links from koji)\n\n> Updates go to testing in order to find problems like that.\nFedora users should just help with testing packages in updates-testing. They should not supplement this role. updates-testing should be used to find corner-case. But this is a basic use case. Update from update -> updates testing.\n\n> I already unpushed the updates several hours ago.\nThen there is a bug in fedora release engineering. It is obvious that unpushed packages were released. It would be good to prevent such situation in future. If you know where to file ticket for fedora releng then I would appreciate if you could do that."
					},
					{
						"isprivate": "0",
						"commentid": "10451086",
						"comment_count": "47",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-26 12:08:33 +0000",
						"thetext": "Lukas,\nlibdb has been tested. It is unfortunate that another issue broke rpm in some configurations (I guess yours included) but that is something that most of the times cannot be forseen, which is exactly the reason why we are pushing packages to updates-testing where a lot of users with different configurations can install and test the package.\n\nThis is not a libdb issue, nor is it a dnf/yum issue. If anything this is either an issue of rpm, that allows calling rpm commands inside scriplets, or an issue of packages, that actually do it, even though it is strongly discouraged. But let us not throw blame around and concentrate on fixing things instead.\n\nFollows a log from my box for anyone interested with openldap-servers package installed and libdb being updated (via rpm -Uvv \"libdb-5.3.28-19.fc26.x86_64.rpm\")\n\n~~~~~~~~~~~~~~snip~~~~~~~~~~~~~~\nD: %triggerin(openldap-servers-2.4.44-10.fc25.x86_64): scriptlet start\nfdio:       2 writes,      368 total bytes in 0.000009 secs\nD: %triggerin(openldap-servers-2.4.44-10.fc25.x86_64): execv(/bin/sh) pid 8412\nD: Plugin: calling hook scriptlet_fork_post in selinux plugin\nD: setexecfilecon: (/bin/sh) \n+ '[' 2 -eq 2 ']'\n++ wc -l\n++ sort -u\n++ sed 's/\\.[0-9]*$//'\n++ rpm -q '--qf=%{version}\\n' libdb\n+ '[' 1 '!=' 1 ']'\n+ rm -f /var/lib/ldap/rpm_upgrade_libdb\n+ exit 0\nD: %triggerin(openldap-servers-2.4.44-10.fc25.x86_64): waitpid(8412) rc 8412 status 0\nerror: rpmdb: DB_LOCK->lock_put: Lock is no longer valid\nerror: db5 error(22) from dbcursor->c_close: Invalid argument\nSegmentation fault (core dumped)\n~~~~~~~~~~~~~~snip~~~~~~~~~~~~~~\n\nNot sure yet why libdb dies here with segfault. Should be complaining about environment version mismatch instead."
					},
					{
						"isprivate": "0",
						"commentid": "10451304",
						"comment_count": "48",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-05-26 13:14:48 +0000",
						"thetext": "It's not even just scriptlets calling rpm, it's *anything* opening the rpmdb ... during a transaction that happens to change the futex implementation or such. Which occurs once every few years - totally unpredictable except for the fact that the next time WILL come, most likely when everybody has mostly forgotten the issue exists at all :-/"
					},
					{
						"isprivate": "0",
						"commentid": "10451798",
						"comment_count": "49",
						"who": {
							"text": "lslebodn",
							"name": "Lukas Slebodnik"
						},
						"bug_when": "2017-05-26 14:54:13 +0000",
						"thetext": "(In reply to Petr Kubat from comment #47)\n> Lukas,\n> libdb has been tested. It is unfortunate that another issue broke rpm in\n> some configurations (I guess yours included)\n\nIt is not broken just in some configuration. It is broken for everyone on 26.\n\nI am sorry but you didn't tested upgrade of your own package and you try to persuade us that there is nothing wrong in libdb. If there is a change in libdb which required change in rpm then both packages should be updated at once. Or both maintainers should be in sync. But breaking upgrade for everyone is not a solution. libdb is ***critical*** package on fedora (due to rpm)\n\n> but that is something that most\n> of the times cannot be forseen, which is exactly the reason why we are\n> pushing packages to updates-testing where a lot of users with different\n> configurations can install and test the package.\n>\n\nBTW the updates-testing is a poor excuse. I do not want to say that you had to test all test cases with rpm. But upgrading of own package is a minimal use-case which should not be tested by users.\n\n\n\nAre you sure it is not bug in libdb?\nThen please explain why it happens when libdb-5.3.28-17.fc26.x86_64.rpm is upgraded to newer version. And libdb-5.3.28-17.fc26.x86_64.rpm is a default version in f26 https://apps.fedoraproject.org/packages/libdb\n\nsh# rpm -qa libdb*\nlibdb-utils-5.3.28-17.fc26.x86_64\nlibdb-5.3.28-17.fc26.x86_64\n\nsh# rpm -q --scripts libdb libdb-utils\npostinstall program: /sbin/ldconfig\npostuninstall program: /sbin/ldconfig\n\nsh# rpm -Uvh https://kojipkgs.fedoraproject.org//packages/libdb/5.3.28/19.fc26/x86_64/libdb-5.3.28-19.fc26.x86_64.rpm https://kojipkgs.fedoraproject.org//packages/libdb/5.3.28/19.fc26/x86_64/libdb-utils-5.3.28-19.fc26.x86_64.rpm\nRetrieving https://kojipkgs.fedoraproject.org//packages/libdb/5.3.28/19.fc26/x86_64/libdb-5.3.28-19.fc26.x86_64.rpm\nRetrieving https://kojipkgs.fedoraproject.org//packages/libdb/5.3.28/19.fc26/x86_64/libdb-utils-5.3.28-19.fc26.x86_64.rpm\n\nPreparing...                          ################################# [100%]\nUpdating / installing...\n   1:libdb-5.3.28-19.fc26             ################################# [ 25%]\nerror: rpmdb: DB_LOCK->lock_put: Lock is no longer valid\nerror: db5 error(22) from dbcursor->c_close: Invalid argument"
					},
					{
						"isprivate": "0",
						"commentid": "10452178",
						"comment_count": "50",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-26 16:49:56 +0000",
						"thetext": ">Then please explain why it happens when libdb-5.3.28-17.fc26.x86_64.rpm is upgraded to newer version.\n\nIf you were to provide a proper debugging output (like with the example I posted in my last comment) I would be able to answer that question. Alas you failed and so I cannot.\n\n>It's not even just scriptlets calling rpm, it's *anything* opening the rpmdb ... \n\nTrue but it feels like the scriplets use case is one of the more visible ones given I seem to hit some issues with them pretty often.\nIn any way I am out of ideas on how to make this work for scriplets. We cannot remove the environment during scriplets as that breaks rpm since it does not expect that a scriplet might do that. On the other hand even if we were able to make scriplets use the old libdb shared library (is that even possible after it is already installed?) that would just cause issues in the packages running those scriplets (since those would just fail on environment version mismatch).\nThis leaves us once again with trying to keep the environment signature the same between those two versions, which, however would cause us to not be able to remember the pthreads version libdb was build against as it is currently saved in the environment."
					},
					{
						"isprivate": "0",
						"commentid": "10454876",
						"comment_count": "51",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-29 07:49:38 +0000",
						"thetext": ">On the other hand even if we were able to make scriplets use the old libdb shared library (is that even possible after it is already installed?) that would just cause issues in the packages running those scriplets\n\nExtending on this idea, a (very) dirty way to make this work would be to install the newer libdb-5.3.so file to some other location (or under a different name, say libdb-5.3.so.new) and then move it to the proper location in a %posttrans. This way openldap-server's scriplets would use the old version of libdb as it is still installed. As a result of openldap-server's trigger being run against the older version its libdb environment would not be upgraded but that should not pose any issues as far as I can see since libdb would just rebuild the environment by itself on the next time it is opened.\n\nHowever, as the new shared library would essentially be available only after the the %posttrans has gone through, any %postun or other %posttrans scriptlets that need libdb installed to work would fail...\n\nWhat do you guys think? Any other ideas?"
					},
					{
						"isprivate": "0",
						"commentid": "10454938",
						"comment_count": "52",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-05-29 08:16:22 +0000",
						"thetext": "I think all it needs is to fail cleanly in this situation, whether it's a scriptlet or manual rpm query that's causing the mismatch.\n\nIf somebodys scriptlets fail to do the right thing, it's only a case of \"told you so\" - we dont want to go out of our way and introduce dirty hacks to support an unsupported thing."
					},
					{
						"isprivate": "0",
						"commentid": "10455030",
						"comment_count": "53",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-29 08:49:05 +0000",
						"thetext": ">I think all it needs is to fail cleanly in this situation, whether it's a scriptlet or manual rpm query that's causing the mismatch.\n\nI agree, but making the scriplet/another rpm process fail cleanly in this situation will be pretty difficult given the patch introduces an automatic environment rebuild mechanism specifically designed to avoid failing due to version mismatch...\n\nI guess I could remove the environment rebuild on signature change for the time being to just fail on version mismatch but that would need some additional modifications from the rpm side - it would need to rebuild its environment as it would find itself failing for the same reason (due to the addition of pthreads timestamp tracking)."
					},
					{
						"isprivate": "0",
						"commentid": "10455126",
						"comment_count": "54",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-05-29 09:11:57 +0000",
						"thetext": "I only skimmed through the patch, but it seems to me the ingredients to do the right thing are there: it (tries) to get an exclusive lock on the primary region initially for creation of the environment, and then downgrade to shared lock for the rest of operation. \n\nClearly it should only try to rebuild the environment if it's the sole owner of the environment (and AFAICS that's what the patch does) and during a transaction that would not be the case. \n\nExcept that of course in transaction where libdb itself is being upgraded, the region is not locked at all. So possible implementation bugs aside, the patch looks sound to me, only it doesn't handle the rather special case of update of itself. So it should somehow detect that the region is in use but not locked, and just fail without trying to rebuild the environment in that case."
					},
					{
						"isprivate": "0",
						"commentid": "10455141",
						"comment_count": "55",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-29 09:20:09 +0000",
						"thetext": ">So it should somehow detect that the region is in use but not locked, and just fail without trying to rebuild the environment in that case.\n\nAs the addition of using locks on the first region file was a result of trying to make libdb aware of whether there are other processes accessing the environment I am not sure there is any other way to check this right now.\nBut it is a good direction to follow, thanks! Will also ask upstream if there are some other solutions they might have scrapped in favour of locking."
					},
					{
						"isprivate": "0",
						"commentid": "10455148",
						"comment_count": "56",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-05-29 09:24:40 +0000",
						"thetext": "Another possibility could be making rpm take the the region lock too, that should  then make the current patch do the right thing."
					},
					{
						"isprivate": "0",
						"commentid": "10455157",
						"comment_count": "57",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-05-29 09:26:47 +0000",
						"thetext": "Hmph, but of course that still depends on somehow getting a newer rpm into the users' system before trying to update libdb, so it just shifts the problem elsewhere, doesn't actually solve it."
					},
					{
						"isprivate": "0",
						"commentid": "10455188",
						"comment_count": "58",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-05-29 09:40:38 +0000",
						"thetext": "One more note: in the short term at least, might be best to just leave out the automatic environment rebuild. Rpm still has this workaround in its %posttrans:\n\n> # XXX this is klunky and ugly, rpm itself should handle this\n> dbstat=/usr/lib/rpm/rpmdb_stat\n> if [ -x \"$dbstat\" ]; then\n>    if \"$dbstat\" -e -h /var/lib/rpm 2>&1 | grep -q \"doesn't match library version \\| Invalid argument\"; then\n>        rm -f /var/lib/rpm/__db.*\n>    fi\n>fi\n>exit 0"
					},
					{
						"isprivate": "0",
						"commentid": "10455381",
						"comment_count": "59",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-29 10:41:27 +0000",
						"thetext": ">Hmph, but of course that still depends on somehow getting a newer rpm into the users' system before trying to update libdb, so it just shifts the problem elsewhere, doesn't actually solve it.\n\nYep that is the major difficulty in fixing this - how to do it only via a libdb update.\n\n>Rpm still has this workaround in its %posttrans: ...\n\nI am aware of this workaround but this does not help us in any way for two main reasons:\n1) This only removes the region files when either the minor or major versions of libdb change so we would either have to bump the versions downstream or change this %posttrans even on DB_VERSION_MISMATCH\n2) afaik there is still the issue with yum/dnf which I touched in comment 31 so the environment would just be recreated with the old structures in place after nuking it..."
					},
					{
						"isprivate": "0",
						"commentid": "10456163",
						"comment_count": "60",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-29 14:02:22 +0000",
						"thetext": ">Another possibility could be making rpm take the the region lock too, that should  then make the current patch do the right thing.\n\nActually how about the other way around?\nafaik rpm creates some .lock files during the update of packages. How are these being used? Would it be possible for libdb to check if an update is in progress?"
					},
					{
						"isprivate": "0",
						"commentid": "10457910",
						"comment_count": "61",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-30 10:22:57 +0000",
						"thetext": "Created attachment 1283384\nrpm lock check patch\n\nThe solution of looking at rpm's .lock file for information about a possible ongoing update looked like a good way to work around the issue (although it is very much another rpm specific hack) so I have tried it out (patch attached) and confirmed it is working. Tested with a complete update from F25 to F26 without any hangs occurring. All packages using rpm in their scriplets failed to remove the environment, resulted in DB_VERSION_MISMATCH as expected and the environment  got rebuilt when next accessed.\n\nAs far as I can see there should not be any negative influence when using this patch as the check is only used when an incompatible environment is encountered and is non-blocking, falling back to normal environment checks when the rpm lock is unavailable.\n\nIt would be nice if someone could take a look at the patch and review it. One thing I am not sure is whether to try get an exclusive lock on rpm's .lock file, or just a reader lock...\nAlso need to modify configure to properly set up the path to the .lock file."
					},
					{
						"isprivate": "0",
						"commentid": "10458282",
						"comment_count": "62",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-05-30 12:05:18 +0000",
						"thetext": "AFAICS that hits problems with the crazy semantics of fcntl() locks: if (and when) that test runs in the rpm that is actually doing the transaction, the lock it holds gets released there. It's not just the explicit F_UNLCK, the mere act of closing the fd will cause the lock to get released.\n\nYou could avoid the F_UNLCK by doing a F_GETLK instead of actually locking - if F_GETLK fails then somebody else is holding the lock already and libdb should not rebuild the environment. It's racy of course but no more so than what your patch does I think.\n\nHowever that still leaves the problem of fd closing. You'd have to deliberately leak the fd, or maybe store it into a static variable and only close it from an atexit() handler or such - closing it on db close is not okay because rpm reopens the db while holding the transaction lock. So it gets really ugly :-/\n\nRpm itself would be in a better position to fiddle with these locks of course. One possibility might be having rpm drop to readonly DB_PRIVATE mode when it detects a held transaction lock, which should avoid most disasters even if the exact behavior is murky."
					},
					{
						"isprivate": "0",
						"commentid": "10458387",
						"comment_count": "63",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-30 12:27:58 +0000",
						"thetext": ">AFAICS that hits problems with the crazy semantics of fcntl() locks: if (and when) that test runs in the rpm that is actually doing the transaction, the lock it holds gets released there. It's not just the explicit F_UNLCK, the mere act of closing the fd will cause the lock to get released.\n\nAh, damn. Completely forgot about this. So libdb would essentially remove the lock from rpm right at the start next time the db is accessed after the update since a rebuild of the environment would be needed... messy. Thanks for spotting this!\n\n>However that still leaves the problem of fd closing. You'd have to deliberately leak the fd, or maybe store it into a static variable and only close it from an atexit() handler or such - closing it on db close is not okay because rpm reopens the db while holding the transaction lock. So it gets really ugly :-\n\nI know libdb has some form of fd management built-in that might help but would have to look into this some more to check where and when the descriptors are released. I guess that it would most likely be at environment close though..."
					},
					{
						"isprivate": "0",
						"commentid": "10458540",
						"comment_count": "64",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-05-30 13:00:21 +0000",
						"thetext": "While we're talking about *cough* creative *cough* approaches: one could check for the existence of a lock without interfering with it by looking at /proc/locks. Determine the inode of /var/lib/rpm/.rpm.lock if it exists and look for it in /proc/locks in the sixth column:\n\n[pmatilai@sopuli ~]$ ls -i /srv/test/var/lib/rpm/.rpm.lock \n13631516 /srv/test/var/lib/rpm/.rpm.lock\n[pmatilai@sopuli ~]$ grep :13631516 /proc/locks \n1: POSIX  ADVISORY  WRITE 13458 fd:01:13631516 0 EOF\n\nIf it's there, it means rpm is in middle of transaction."
					},
					{
						"isprivate": "0",
						"commentid": "10462712",
						"comment_count": "65",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-31 10:04:20 +0000",
						"thetext": "Looked at libdb's fd management subsytem and, as I expected, it is able to release still held descriptors on closing the environment which does not help us at all since rpm opens and closes the environment multiple times during an upgrade. Libdb is also very vocal about having to release the descriptors...\n\n>Determine the inode of /var/lib/rpm/.rpm.lock if it exists and look for it in /proc/locks in the sixth column:\n\nCreativity aside, wouldn't that approach also need having the .rpm.lock file open when trying to look at its inode number?\n\nI wonder if we could not just get away with using the rpm lock check in libdb as is (well with the modification of only trying to see if we could lock the file as Panu suggested) ...\nThe way I see it, right now (using the patch) we are able to survive the update of libdb which is the most important thing as any updates for rpm (or dnf, but rpm makes more sense I guess) itself would be applied by the time the next rpm command would be run. Which makes our hands a little bit less tied.\nAt this point rpm would just need to make sure that the environment is touched (hence rebuilt) before the transaction lock is taken since the rpm lock check will never get hit when the environment does not need to be rebuilt.\n\nafaics dnf opens the environment before any rpm transactions take place so this should already be safe when only working through dnf."
					},
					{
						"isprivate": "0",
						"commentid": "10462754",
						"comment_count": "66",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-31 10:17:47 +0000",
						"thetext": ">Creativity aside, wouldn't that approach also need having the .rpm.lock file open when trying to look at its inode number?\n\nI guess we wouldn't need to actually open the file if we went through directory's dirents trying to find the .rpm.lock's entry..."
					},
					{
						"isprivate": "0",
						"commentid": "10462821",
						"comment_count": "67",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-05-31 10:47:38 +0000",
						"thetext": "You can stat() a file to get the inode without opening, that's not a problem.\n\nBut the more I think about this, having system libdb muck about rpm locks seems ... not so healthy. Rpm spec has an option to build with bundled libdb, for occasions just like this one might say :)"
					},
					{
						"isprivate": "0",
						"commentid": "10462991",
						"comment_count": "68",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-05-31 11:39:05 +0000",
						"thetext": ">But the more I think about this, having system libdb muck about rpm locks seems ... not so healthy. Rpm spec has an option to build with bundled libdb, for occasions just like this one might say :)\n\nWell yes. As I said before it is still an ugly hack that we would need to remove as soon as possible if we went through with it.\n\nThe only \"clean\" alternative to this that I see right now is pushing the patch with the automatic rebuild stripped out, fixing rpm so it expects a DB_VERSION_MISMATCH error when opening the environment and hope other packages depending on libdb have some checks of their own in place."
					},
					{
						"isprivate": "0",
						"commentid": "10465645",
						"comment_count": "69",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2017-05-31 18:45:28 +0000",
						"thetext": "Note the parent bug is blocking Beta, and we have the second Go/No-Go for Beta tomorrow, and at present we have no *other* blockers. So it'd be really good to get something in that makes this work for now, if it's at all possible, even if it's technically a Dirty Hack (TM)."
					},
					{
						"isprivate": "0",
						"commentid": "10467169",
						"comment_count": "70",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-01 06:50:58 +0000",
						"thetext": "Adam, thanks for the heads-up.\nFor the time being I will just push the fix that looks at rpm's transaction lock since that does not need any modifications from rpm's side to work. I will change it so as to leak the descriptor (the test is not run every time the environment so it should not hog too many resources) in order to not drop rpm's lock.\n\nAlso upstream replied to me that they are looking into the issue so they might provide some other ideas later on."
					},
					{
						"isprivate": "0",
						"commentid": "10467750",
						"comment_count": "71",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-01 09:10:34 +0000",
						"thetext": "Created attachment 1284053\nrpm lock check patch v2\n\nAttached modified patch as per comment 70. Would be nice if someone took a quick look at it before I push it"
					},
					{
						"isprivate": "0",
						"commentid": "10467867",
						"comment_count": "72",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-06-01 09:37:58 +0000",
						"thetext": "+    fd = open(RPMLOCK_PATH, O_RDWR);\n+    if (fd == -1)\n+        return 1;\n\nIf the file doesn't exist at all then there can be no lock there either, so you could return 0 in that case. But probably doesn't matter.\n\nI have to say I would feel less bad about this if the patch limited this thing to environments whose path contains /var/lib/rpm, rather than doing this for all users of libdb. That way completely unrelated software doesn't end up leaking fds ominuous looking fds because of this."
					},
					{
						"isprivate": "0",
						"commentid": "10468140",
						"comment_count": "73",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-01 10:55:52 +0000",
						"thetext": "Created attachment 1284124\nrpm lock check patch v3\n\n>I have to say I would feel less bad about this if the patch limited this thing to environments whose path contains /var/lib/rpm\n\nYeah that might actually be a bit better. Thanks!\nmodified patch attached"
					},
					{
						"isprivate": "0",
						"commentid": "10468150",
						"comment_count": "74",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-06-01 11:00:13 +0000",
						"thetext": "/me likes (but didn't test), thanks.\n\nIt's still one helluva gross hack but at least it's now a precision hack :)"
					},
					{
						"isprivate": "0",
						"commentid": "10468559",
						"comment_count": "75",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-01 12:45:13 +0000",
						"thetext": "libdb-5.3.28-21.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
					},
					{
						"isprivate": "0",
						"commentid": "10468571",
						"comment_count": "76",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-01 12:48:20 +0000",
						"thetext": "Pushed the changes to rawhide and f26 branches and added the f26 build to the update.\n\nNote that previous releases do not need to have the fixes applied as all of the magic happens after libdb is updated to the fixed version. As such I have removed the upstream fix from those (f24, f25) branches."
					},
					{
						"isprivate": "0",
						"commentid": "10469973",
						"comment_count": "77",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2017-06-01 18:43:36 +0000",
						"thetext": "\"Note that previous releases do not need to have the fixes applied as all of the magic happens after libdb is updated to the fixed version. As such I have removed the upstream fix from those (f24, f25) branches.\"\n\nUh - but in that case, how do we know that libdb is updated before glibc/libpthread is updated? When you're upgrading from F24 or F25 to F26, if glibc/libpthread is updated before libdb, won't that trigger the bug?"
					},
					{
						"isprivate": "0",
						"commentid": "10471094",
						"comment_count": "78",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2017-06-02 05:30:43 +0000",
						"thetext": "It'd be really great if people could help test the new update hard: test that it fixes the actual bug, test it in the scenarios that caused trouble with -18 and -19, etc. We want to get this fix out for Beta, but we don't want to send it unless we're sure it's good. Thanks a lot!"
					},
					{
						"isprivate": "0",
						"commentid": "10471183",
						"comment_count": "79",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-02 06:19:08 +0000",
						"thetext": ">Uh - but in that case, how do we know that libdb is updated before glibc/libpthread is updated?\n\nI am not sure how the order of the installs is created from the list of packages but I would expect that the dependencies are installed first (and from testing out the F25 -> F26 update that seems to be the case). So the install order should be glibc -> libdb -> whatever package that depends on libdb.\n\nThis also means that by the time a package that would be able to trigger the bug is installed, a newer version of libdb should already be present on the box (if not then that pavckage's requires need to be changed) and would not trigger the condvar issue since a newer libdb environment (and a rebuild of the old one) would be needed first."
					},
					{
						"isprivate": "0",
						"commentid": "10472062",
						"comment_count": "80",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-06-02 11:21:24 +0000",
						"thetext": "Packages running rpm from scriptlets can happen anywhere in the order, never mind external accesses to the rpmdb.\n\nI think we really need to have a patched up libdb present on the system before upgrading to the new glibc."
					},
					{
						"isprivate": "0",
						"commentid": "10472357",
						"comment_count": "81",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-02 13:00:37 +0000",
						"thetext": "libdb-5.3.28-21.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf"
					},
					{
						"isprivate": "0",
						"commentid": "10472364",
						"comment_count": "82",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-02 13:01:12 +0000",
						"thetext": "libdb-5.3.28-21.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
					},
					{
						"isprivate": "0",
						"commentid": "10474623",
						"comment_count": "83",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-04 05:10:46 +0000",
						"thetext": "libdb-5.3.28-21.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
					},
					{
						"isprivate": "0",
						"commentid": "10477031",
						"comment_count": "84",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-05 12:07:44 +0000",
						"thetext": "libdb-5.3.28-21.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
					},
					{
						"isprivate": "0",
						"commentid": "10486559",
						"comment_count": "85",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-07 17:41:10 +0000",
						"thetext": "libdb-5.3.28-21.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
					},
					{
						"isprivate": "0",
						"commentid": "10487165",
						"comment_count": "86",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-07 20:16:03 +0000",
						"thetext": "libdb-5.3.28-21.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf"
					},
					{
						"isprivate": "0",
						"commentid": "10490143",
						"comment_count": "87",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-08 16:04:48 +0000",
						"thetext": "libdb-5.3.28-21.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
					},
					{
						"isprivate": "0",
						"commentid": "10490169",
						"comment_count": "88",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-08 16:10:48 +0000",
						"thetext": "libdb-5.3.28-21.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf"
					},
					{
						"isprivate": "0",
						"commentid": "10490935",
						"comment_count": "89",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-08 21:07:22 +0000",
						"thetext": "libdb-5.3.28-21.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "10492218",
						"comment_count": "90",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-09 09:23:58 +0000",
						"thetext": "libdb-5.3.28-21.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "10492599",
						"comment_count": "91",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-09 11:29:18 +0000",
						"thetext": "libdb-5.3.28-21.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "10494594",
						"comment_count": "92",
						"who": {
							"text": "gryt2",
							"name": "stan"
						},
						"bug_when": "2017-06-09 20:53:16 +0000",
						"thetext": "I just did a dnf update in F25 and picked up the libdb-5.3.28-21.fc25 package.  Not sure if it was from testing or stable, as I have both enabled.  However, there are issues.  When the libdb package was being installed, dnf popped up an error saying there was a database mismatch in the rpm database, though the rest of the updates completed.  But, at the end, dnf hung, and put up this message,\n\nBDB1537 //var/lib/rpm/__db.001: unable to read system-memory information: Input/output error.\n\nI remembered reading an email about this in the test list, and followed the instructions in that email.\nrm /var/lib/rpm/_db.*\nrpm --rebuilddb\n\nThat completed, and I will reboot and see if there are any problems.  I had to restart my mail client in order for it to access its database of stored passwords."
					},
					{
						"isprivate": "0",
						"commentid": "10494600",
						"comment_count": "93",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2017-06-09 20:57:28 +0000",
						"thetext": "Yeah, you're not the only one, it now seems a few people are still having issues with -21 :( Very sorry about this, this bug is turning into a bit of a nightmare. We'll try and do all we can to deal with it."
					},
					{
						"isprivate": "0",
						"commentid": "10494616",
						"comment_count": "94",
						"who": {
							"text": "gryt2",
							"name": "stan"
						},
						"bug_when": "2017-06-09 21:13:17 +0000",
						"thetext": "After the rpm database rebuild, and a reboot, everything seems to be working just fine again.  I ran a dnf update, and it properly told me that there was nothing to do, so the update that had the rpm db problems got integrated.  \n\nA little excitement, and no lasting harm done.  :-)\n\n> Very sorry about this,\n\nNot to worry."
					},
					{
						"isprivate": "0",
						"commentid": "10495678",
						"comment_count": "95",
						"who": {
							"text": "chkr",
							"name": "Christian Krause"
						},
						"bug_when": "2017-06-11 08:45:19 +0000",
						"thetext": "I just stumbled over this bug during a regular \"dnf update\" was well:\n\nDuring the update libdb was updated tolibdb.x86_64 5.3.28-21.fc25\n\n$ dnf update\n...\nComplete!\nSegmentation fault (core dumped)\n$\n\nThe error messages of following \"dnf update\" or \"rpm -qa\" are similar to the ones already reported in:\n\nhttps://bugzilla.redhat.com/show_bug.cgi?id=1394862#c43\n\nI recovered from the situation via \"rpm -v --rebuilddb\"."
					},
					{
						"isprivate": "0",
						"commentid": "10497200",
						"comment_count": "96",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-06-12 09:59:47 +0000",
						"thetext": "So people are seeing crashes after dnf prints out \"Complete!\", at which point there shouldn't be much going on except rpmdb being *closed*. \n\nUnless there's something else at play, that is: for example https://bugzilla.redhat.com/show_bug.cgi?id=1397087#c48 shows etckeeper being involved. I'm not really familiar with it, but it does involve dnf plugins that execute before and after (and maybe during, dunno) transaction, and seems to query rpmdb before and after the transaction.\n\nBut try as I might, I'm not able to reproduce those post-trans crashes, with or without etckeeper :-/"
					},
					{
						"isprivate": "0",
						"commentid": "10497549",
						"comment_count": "97",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-12 11:57:52 +0000",
						"thetext": "From what I can see in dnf's code nothing else should access the rpmdb after the \"Complete!\" string is printed out, except a call to \"cli.command.run_transaction()\" which for the upgrade command seems to be a nop...\n\nUnfortunately I cannot reproduce either. From what I can see from the logs it seems like something is accessing the rpmdb (and rebuilding it) after the transaction goes through (same behaviour as we have seen when it was removed during scriplets). The difference here is that it segfaults after the transaction has successfully completed so a \"rpmdb --rebuilddb\" fixes the issue."
					},
					{
						"isprivate": "0",
						"commentid": "10498093",
						"comment_count": "98",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-12 14:17:40 +0000",
						"thetext": "Managed to reproduce the issue artificially by introducing a sleep() directly after the part of dnf's code where the \"Complete!\" is printed out and accessing the rpmdb from another process (rpm -qi libdb as root).\nAt this point it makes sense that the transaction lock is no longer taken by rpm as the transaction has already gone through so the environment is removed by the other process.\nAs for where the segfault happens, here is the python bt:\n\n~~~~~~~~~~~~~~snip~~~~~~~~~~~~~~\nTraceback (most recent call first):\n  File \"/usr/lib/python3.5/site-packages/dnf/rpm/transaction.py\", line 48, in close\n    self.ts.closeDB()\n  File \"/usr/lib/python3.5/site-packages/dnf/base.py\", line 373, in _ts\n    self._priv_ts.close()\n  File \"/usr/lib/python3.5/site-packages/dnf/base.py\", line 329, in _closeRpmDB\n    del self._ts\n  File \"/usr/lib/python3.5/site-packages/dnf/base.py\", line 301, in close\n    self._closeRpmDB()\n  File \"/usr/lib/python3.5/site-packages/dnf/base.py\", line 102, in __exit__\n    self.close()\n  File \"/usr/lib/python3.5/site-packages/dnf/cli/main.py\", line 62, in main\n    return _main(base, args)\n  File \"/usr/lib/python3.5/site-packages/dnf/cli/main.py\", line 177, in user_main\n    errcode = main(args)\n  File \"/usr/bin/dnf\", line 58, in <module>\n    main.user_main(sys.argv[1:], exit_code=True)\n~~~~~~~~~~~~~~snip~~~~~~~~~~~~~~\n\nWe can see dnf tries to close the rpmdb handle but fails to do so since it has already been removed by the other process."
					},
					{
						"isprivate": "0",
						"commentid": "10499088",
						"comment_count": "99",
						"who": {
							"text": "lslebodn",
							"name": "Lukas Slebodnik"
						},
						"bug_when": "2017-06-12 20:28:27 +0000",
						"thetext": "Created attachment 1287101\nfailed upgrade\n\nBTW I can see failure when upgrading from -21 to -22 on f26\nI didn't catch it earlier because my nightly tests were not running due to maintenance of hypervisors."
					},
					{
						"isprivate": "0",
						"commentid": "10499098",
						"comment_count": "100",
						"who": {
							"text": "sixpack13",
							"name": "sixpack13"
						},
						"bug_when": "2017-06-12 20:32:00 +0000",
						"thetext": "TL,DR\n\nhit this bug today\n\nupdate/-grade was \nfrom libdb.x86_64 5.3.28-21.fc26\nto   libdb.x86_64 5.3.28-22.fc26\n\nNO messages during upgrade, but after \"sudo dnf update --refresh -v\" I got:\nerror: db5 error(5) from dbenv->open: Input/output error\nerror: cannot open Packages index using db5 - Input/output error (5)\nerror: cannot open Packages database in /var/lib/rpm\nError: Error: rpmdb open failed\n\nrm -rf __db* and rpm -v --rebuilddb fixed it (so far)"
					},
					{
						"isprivate": "0",
						"commentid": "10499107",
						"comment_count": "101",
						"who": {
							"text": "sixpack13",
							"name": "sixpack13"
						},
						"bug_when": "2017-06-12 20:36:00 +0000",
						"thetext": "sorry, Lukas and I wrote ours comments simultaneously, but Lukas saved it first !"
					},
					{
						"isprivate": "0",
						"commentid": "10499224",
						"comment_count": "102",
						"who": {
							"text": "gryt2",
							"name": "stan"
						},
						"bug_when": "2017-06-12 21:47:56 +0000",
						"thetext": "Well, I hit this bug today again when updating to libdb.x86_64 5.3.28-22.fc26 in F25.  But it didn't happen after the Complete!, it happened before it.  I don't think I was doing anything to access the rpm database.\n\nHere's the error message\n\nUpgraded:\n  exfalso.noarch 3.9.1-1.fc25        fusion-icon.noarch 1:0.2.4-1.fc25  jansson.x86_64 2.10-2.fc25      jansson-devel.x86_64\n  2.10-2.fc25  libdb.x86_64 5.3.28-22.fc25   libdb-cxx.x86_64 5.3.28-22.fc25  libdb-cxx-devel.x86_64 5.3.28-22.fc25\n    libdb-devel.x86_64 5.3.28-22.fc25  libdb-utils.x86_64 5.3.28-22.fc25  lua-lxc.x86_64 2.0.8-2.fc25     lxc.x86_64\n    2.0.8-2.fc25           lxc-libs.x86_64 2.0.8-2.fc25  lxqt-admin.x86_64 0.11.1-5.fc25  python3-lxc.x86_64 2.0.8-2.fc25\n      quodlibet.noarch 3.9.1-1.fc25      tbb.x86_64 2017.7-1.fc25           tbb-devel.x86_64 2017.7-1.fc25  tbb-doc.x86_64\n      2017.7-1.fc25\n\n      Tracer:\n        Program 'tracer' crashed with following error:\n\n        b'error: db5 error(5) from dbenv->open: Input/output error\\nerror: cannot open Packages index using db5 -\n        Input/output error (5)\\nerror: cannot open Packages database in /var/lib/rpm\\nTraceback (most recent call last):\\n\n        File \"/usr/bin/tracer\", line 34, in <module>\\n    tracer.main.run()\\n  File\n        \"/usr/lib/python3.5/site-packages/tracer/main.py\", line 45, in run\\n    return router.dispatch()\\n  File\n        \"/usr/lib/python3.5/site-packages/tracer/resources/router.py\", line 52, in dispatch\\n    controller =\n        DefaultController(self.args, self.packages)\\n  File \"/usr/lib/python3.5/site-packages/tracer/controllers/default.py\",\n        line 62, in __init__\\n    self.applications = self.tracer.trace_affected(self._user(args.user))\\n  File\n        \"/usr/lib/python3.5/site-packages/tracer/resources/tracer.py\", line 96, in trace_affected\\n    for file in\n        self._PACKAGE_MANAGER.package_files(package.name):\\n  File\n        \"/usr/lib/python3.5/site-packages/tracer/resources/PackageManager.py\", line 55, in package_files\\n    return\n        self.package_managers[0].package_files(pkg_name)\\n  File\n        \"/usr/lib/python3.5/site-packages/tracer/packageManagers/dnf.py\", line 34, in package_files\\n    if\n        self._is_installed(pkg_name):\\n  File \"/usr/lib/python3.5/site-packages/tracer/packageManagers/rpm.py\", line 151, in\n        _is_installed\\n    mi = ts.dbMatch(\\'name\\', pkg_name)\\n_rpm.error: rpmdb open failed\\n'\n        Please visit https://github.com/FrostyX/tracer/issues and submit the issue. Thank you\n        We apologize for any inconvenience\n        Complete!\n\nI didn't go to github and enter the issue, as it seems like it probably isn't related to tracer.  That is, I'm thinking tracer is just an innocent victim of the issue in rpm."
					},
					{
						"isprivate": "0",
						"commentid": "10499238",
						"comment_count": "103",
						"who": {
							"text": "gryt2",
							"name": "stan"
						},
						"bug_when": "2017-06-12 22:04:32 +0000",
						"thetext": "I removed the temp files in /var/lib/rpm (__db.00?) and rebuilt the rpm database (rpm --rebuilddb), and a subsequent install using dnf completed flawlessly.  So, this doesn't seem to do any lasting harm."
					},
					{
						"isprivate": "0",
						"commentid": "10499241",
						"comment_count": "104",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2017-06-12 22:08:37 +0000",
						"thetext": "Hum, so if we send out -22, it's gonna cause problems *again* for people who already got -21? Great..."
					},
					{
						"isprivate": "0",
						"commentid": "10499663",
						"comment_count": "105",
						"who": {
							"text": "bugzilla",
							"name": "Chris Murphy"
						},
						"bug_when": "2017-06-13 03:41:37 +0000",
						"thetext": "I've got this happening as well on a dnf update of a system that had -21 with no problems, and now the rpmdb appears corrupt.\nhttps://bugzilla.redhat.com/show_bug.cgi?id=1394862#c100"
					},
					{
						"isprivate": "0",
						"commentid": "10499963",
						"comment_count": "106",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-13 06:43:01 +0000",
						"thetext": ">Hum, so if we send out -22, it's gonna cause problems *again* for people who already got -21?\n\nYep. This is due to -21 having modified libdb's internal environment structures which was need to fix the original issue of this bz. Since the older versions do not have the automatic rebuild mechanism libdb will fail when trying to access the new environment...\n\nAlso note that this will happen for everyone currently on -21 and not only those that hit the bug I described in comment 98."
					},
					{
						"isprivate": "0",
						"commentid": "10500158",
						"comment_count": "107",
						"who": {
							"text": "pmatilai",
							"name": "Panu Matilainen"
						},
						"bug_when": "2017-06-13 08:00:04 +0000",
						"thetext": "(In reply to Petr Kubat from comment #98)\n> Managed to reproduce the issue artificially by introducing a sleep()\n> directly after the part of dnf's code where the \"Complete!\" is printed out\n> and accessing the rpmdb from another process (rpm -qi libdb as root).\n> At this point it makes sense that the transaction lock is no longer taken by\n> rpm as the transaction has already gone through so the environment is\n> removed by the other process.\n\nOkay, this makes perfect sense then: dnf post-transaction plugins run after the rpm transaction has finished, and any such plugin executing rpm will cause such problems. etckeeper is the one plugin I know that would match the pattern, but maybe there are others. At any rate, this explains why many people are not seeing problems but some are.\n\nA dnf plugin executing rpm is just about as bad idea as running rpm queries from scriptlets, but changing that would require significant changes to etckeeper I suppose.\n\nAnyway, since the remaining issue with -21 is now pretty well understood, my suggestion is that -22 is pulled out of circulation ASAP (and/or replaced with -23 that includes the patch from -21 again), reverting the patch will only cause even more trouble at this point.\n\nThe more productive approach might be banging all drums available to tell people to:\n1) run the libdb -21 update in a transaction of its own, with --noplugins\n2) if it crashes, keep calm and run rpm --rebuilddb\n3) inform people about the known causes of problems (etckeeper-dnf at this point), most people will not experience any problems"
					},
					{
						"isprivate": "0",
						"commentid": "10500192",
						"comment_count": "108",
						"who": {
							"text": "lslebodn",
							"name": "Lukas Slebodnik"
						},
						"bug_when": "2017-06-13 08:10:08 +0000",
						"thetext": "(In reply to Panu Matilainen from comment #107)\n> The more productive approach might be banging all drums available to tell\n> people to:\n> 1) run the libdb -21 update in a transaction of its own, with --noplugins\n> 2) if it crashes, keep calm and run rpm --rebuilddb\n> 3) inform people about the known causes of problems (etckeeper-dnf at this\n> point), most people will not experience any problems\nHow do you want to achieve it. IIRC dnf does not have a way how to inform users before upgrade about important/breaking changes. Correct me If I am wrong.\nDebian(apt) has such feature.\n\nAnd I would say that most of fedora users does not follow fedora mailing lists before upgrade."
					},
					{
						"isprivate": "0",
						"commentid": "10500274",
						"comment_count": "109",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-13 08:42:31 +0000",
						"thetext": ">Anyway, since the remaining issue with -21 is now pretty well understood, my suggestion is that -22 is pulled out of circulation ASAP (and/or replaced with -23 that includes the patch from -21 again), reverting the patch will only cause even more trouble at this point.\n\nAgreed. Doing a -23 makes more sense since I still need to incorporate the fix for https://bugzilla.redhat.com/show_bug.cgi?id=1460003 anyway.\n\n>And I would say that most of fedora users does not follow fedora mailing lists before upgrade.\n\nTrue. But every user should be able to find information about the issue if it is hit, be it in Common bugs, one of the bugzillas, or the actual bodhi update, as long as it is properly documented.\nWe can also suggest the users to reboot (through the bodhi tool) which afaics also fixes the problem. But I am not sure what the result of marking the checkbox actually is since I have never had the need to use it..."
					},
					{
						"isprivate": "0",
						"commentid": "10502027",
						"comment_count": "110",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2017-06-13 16:15:11 +0000",
						"thetext": "Panu: yup, that's pretty much what we agreed upon in another discussion. I'll be pulling the -22 updates and writing some blog posts etc. about this today. Sorry for all the confusion and ping-ponging, everyone.\n\nPetr: I'll wait on you to do a -23, then, since you have that other fix to include."
					},
					{
						"isprivate": "0",
						"commentid": "10502939",
						"comment_count": "111",
						"who": {
							"text": "dominik",
							"name": "Dominik 'Rathann' Mierzejewski"
						},
						"bug_when": "2017-06-13 23:29:43 +0000",
						"thetext": "It looks like the \"tracer\" dnf plugin is another trigger for this (in my case).\n\npython3-dnf-plugins-extras-tracer-0.0.12-4.fc25.noarch\npython3-tracer-0.6.12-4.fc25.noarch\ntracer-common-0.6.12-4.fc25.noarch"
					},
					{
						"isprivate": "0",
						"commentid": "10503913",
						"comment_count": "112",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-14 07:06:15 +0000",
						"thetext": ">It looks like the \"tracer\" dnf plugin is another trigger for this (in my case).\n\nDominik, thanks for the report!\n\nI can confirm that the tracer dnf plugin does indeed trigger the issue some dnf users might be running into. Fortunately, once you rebuild the rpmdb after hitting the dnf-update crash you will unlikely run into any such issues again as libdb will just use its environment lock, which it holds until the environment is closed (= until after dnf plugins have run)."
					},
					{
						"isprivate": "0",
						"commentid": "10518233",
						"comment_count": "113",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-19 12:46:43 +0000",
						"thetext": "Attaching a new set of patches (applied after the upstream patch):\n\ndb-5.3.28-condition-variable-ppc.patch\nFixes issues described in bug 1460003. The root problem of this bug was libdb not failing when only the modify timestamp of libpthread has been changed, e.g. when glibc is updated after having first installed libdb -21 build (as is the case in F24/25-> F26 updates).\nUnfortunately the issue is not fixed as easy as by forcing libdb to fail every time it encounters a libpthread timestamp change. Dnf accesses the rpmdb a few times during the update process after the glibc has updated (= timestamp changed) and if libdb were to fail in those situations the update process might not be completed successfully.\nThe best fix I could come up with is taking a look at libdb's lock on its environment and checking if the pid of the process holding the lock is the same as the pid of the current process as that ensures that the environment is accessed with the correct glibc library version loaded.\nAfaik there is no easy way to do this check (for flock-style locks) so I have written a small parser that looks at /proc/locks and extracts the pid from there.\n\ndb-5.3.28-rpm-lock-check.patch\nSince I have written a /proc/locks parser as part of the patch described above I have modified the check for rpm's transaction lock to use it as well (to at least avoid fd leaks the original patch had).\nAlso fixed a few issues with the original patch (properly unlock the environment when not able to get the rpm lock, return success when the rpm lock file does not exist)."
					},
					{
						"isprivate": "0",
						"commentid": "10518246",
						"comment_count": "114",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-19 12:47:49 +0000",
						"thetext": "Created attachment 1289098\nCond var ppc fix"
					},
					{
						"isprivate": "0",
						"commentid": "10518248",
						"comment_count": "115",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-19 12:48:34 +0000",
						"thetext": "Created attachment 1289099\nrpm lock check patch v4"
					},
					{
						"isprivate": "0",
						"commentid": "10543056",
						"comment_count": "116",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-27 07:33:21 +0000",
						"thetext": "libdb-5.3.28-24.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-2b68e14594"
					},
					{
						"isprivate": "0",
						"commentid": "10545182",
						"comment_count": "117",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-27 17:21:23 +0000",
						"thetext": "libdb-5.3.28-24.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-014d67fa9d"
					},
					{
						"isprivate": "0",
						"commentid": "10545209",
						"comment_count": "118",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-27 17:26:46 +0000",
						"thetext": "libdb-5.3.28-24.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-372bb1edb3"
					},
					{
						"isprivate": "0",
						"commentid": "10545671",
						"comment_count": "119",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-27 20:26:18 +0000",
						"thetext": "libdb-5.3.28-24.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-2b68e14594"
					},
					{
						"isprivate": "0",
						"commentid": "10575998",
						"comment_count": "120",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-07-07 23:00:28 +0000",
						"thetext": "libdb-5.3.28-24.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "10585055",
						"comment_count": "121",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-07-12 01:50:18 +0000",
						"thetext": "libdb-5.3.28-24.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "10585236",
						"comment_count": "122",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-07-12 03:21:51 +0000",
						"thetext": "libdb-5.3.28-24.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "10768561",
						"comment_count": "123",
						"who": {
							"text": "walters",
							"name": "Colin Walters"
						},
						"bug_when": "2017-09-05 16:52:52 +0000",
						"thetext": "I'm not entirely sure if it's this bug, but it seems related; I can't do a `yum update` from the latest registry.fedoraproject.org/fedora:26 container:\n\n# docker run --rm -ti registry.fedoraproject.org/fedora:26 bash\n# yum update \nyum -y upgrade glibc\nLast metadata expiration check: 0:05:36 ago on Tue Sep  5 16:46:10 2017.\nDependencies resolved.\n...\nUpgrading:\n glibc                                                    x86_64                                        2.25-10.fc26                                          updates                                        3.4 M\n glibc-common                                             x86_64                                        2.25-10.fc26                                          updates                                        889 k\n glibc-langpack-en                                        x86_64                                        2.25-10.fc26                                          updates                                        291 k\n libcrypt-nss                                             x86_64                                        2.25-10.fc26                                          updates                                         53 k\n\nTransaction Summary\n...\nUpgrade  4 Packages\n\nTotal download size: 4.6 M\nDownloading Packages:\n...\nFailed Delta RPMs increased 4.6 MB of updates to 5.5 MB (-20.1% wasted)\nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Preparing        :                                                                                                                                                                                           1/1 \n  Upgrading        : glibc-common-2.25-10.fc26.x86_64                                                                                                                                                          1/8 \n  Upgrading        : glibc-langpack-en-2.25-10.fc26.x86_64                                                                                                                                                     2/8 \n  Running scriptlet: glibc-2.25-10.fc26.x86_64                                                                                                                                                                 3/8 \n  Upgrading        : glibc-2.25-10.fc26.x86_64                                                                                                                                                                 3/8 \n  Running scriptlet: glibc-2.25-10.fc26.x86_64                                                                                                                                                                 3/8 \n  Upgrading        : libcrypt-nss-2.25-10.fc26.x86_64                                                                                                                                                          4/8 \n  Running scriptlet: libcrypt-nss-2.25-10.fc26.x86_64                                                                                                                                                          4/8 \n  Cleanup          : libcrypt-nss-2.25-9.fc26.x86_64                                                                                                                                                           5/8 \n  Running scriptlet: libcrypt-nss-2.25-9.fc26.x86_64                                                                                                                                                           5/8 \n  Cleanup          : glibc-common-2.25-9.fc26.x86_64                                                                                                                                                           6/8 \n  Cleanup          : glibc-langpack-en-2.25-9.fc26.x86_64                                                                                                                                                      7/8 \n  Cleanup          : glibc-2.25-9.fc26.x86_64                                                                                                                                                                  8/8 \n  Running scriptlet: glibc-2.25-9.fc26.x86_64                                                                                                                                                                  8/8 \nBDB1539 Build signature doesn't match environment\nfailed loading RPMDB\nThe downloaded packages were saved in cache until the next successful transaction.\nYou can remove cached packages by executing 'dnf clean packages'."
					}
				]
			}
		},
		{
			"bug_id": 1460003,
			"feedback": [
				{
					"bug_id": 1460003,
					"comment": {
						"id": 628789,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works great!  LGTM!  =)",
						"timestamp": "2017-06-29 03:31:56",
						"update_id": 91024,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/307632fc7188138f052f244345e779451863879298f2e6d73023011a05b1f1f6?s=24&d=retro",
							"email": "besser82.fpo@gmail.com",
							"groups": [
								{
									"name": "proventesters"
								},
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "designteam"
								},
								{
									"name": "shogun-ca"
								},
								{
									"name": "alt-gtk-de-sig"
								}
							],
							"id": 206,
							"name": "besser82",
							"openid": "besser82.id.fedoraproject.org"
						},
						"user_id": 206
					},
					"comment_id": 628789,
					"karma": 1
				},
				{
					"bug_id": 1460003,
					"comment": {
						"id": 628790,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works great!  LGTM!  =)",
						"timestamp": "2017-06-29 03:32:04",
						"update_id": 91025,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/307632fc7188138f052f244345e779451863879298f2e6d73023011a05b1f1f6?s=24&d=retro",
							"email": "besser82.fpo@gmail.com",
							"groups": [
								{
									"name": "proventesters"
								},
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "designteam"
								},
								{
									"name": "shogun-ca"
								},
								{
									"name": "alt-gtk-de-sig"
								}
							],
							"id": 206,
							"name": "besser82",
							"openid": "besser82.id.fedoraproject.org"
						},
						"user_id": 206
					},
					"comment_id": 628790,
					"karma": 1
				},
				{
					"bug_id": 1460003,
					"comment": {
						"id": 629500,
						"karma": 1,
						"karma_critpath": 1,
						"text": "upgraded completed on armhfp.",
						"timestamp": "2017-06-30 20:26:25",
						"update_id": 91023,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/f10909406582318e3ebdf96e827351c846709a4f1aba17f5dc241c7efb6aa8d0?s=24&d=retro",
							"email": "pwhalen@redhat.com",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "sysadmin-releng"
								},
								{
									"name": "sysadmin-secondary"
								},
								{
									"name": "iot"
								},
								{
									"name": "arm-qa"
								},
								{
									"name": "fedora-arm"
								},
								{
									"name": "gitarm"
								},
								{
									"name": "gitfedora-arm-installer"
								}
							],
							"id": 1201,
							"name": "pwhalen",
							"openid": "pwhalen.id.fedoraproject.org"
						},
						"user_id": 1201
					},
					"comment_id": 629500,
					"karma": 1
				},
				{
					"bug_id": 1460003,
					"comment": {
						"id": 629566,
						"karma": 1,
						"karma_critpath": 1,
						"text": "No regressions noted.",
						"timestamp": "2017-06-30 20:56:40",
						"update_id": 91024,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/e62cb974458dc33fcf2225462b8765e0aadcbbd698560c8f8dad6c3e23d5e47e?s=24&d=retro",
							"email": "dhgutteridge@hotmail.com",
							"groups": [
								{
									"name": "ipausers"
								}
							],
							"id": 194,
							"name": "dhgutteridge",
							"openid": "dhgutteridge.id.fedoraproject.org"
						},
						"user_id": 194
					},
					"comment_id": 629566
				},
				{
					"bug_id": 1460003,
					"comment": {
						"id": 632718,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works for me.",
						"timestamp": "2017-07-08 21:43:49",
						"update_id": 91025,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/0fa05851f1f2f54b981d3c0ab58e0a15cc1384567409b91e76ec2e2078d47e5e?s=24&d=retro",
							"email": "jonathanecalloway@gmail.com",
							"id": 1359,
							"name": "jonathancalloway",
							"openid": "jonathancalloway.id.fedoraproject.org"
						},
						"user_id": 1359
					},
					"comment_id": 632718,
					"karma": 1
				}
			],
			"title": "upgrade f25 to f26 get stuck in Cleanup: krb5-list",
			"bugzilla": {
				"bug_id": "1460003",
				"creation_ts": "2017-06-08 19:39:08 +0000",
				"short_desc": "upgrade f25 to f26 get stuck in Cleanup: krb5-list",
				"delta_ts": "2017-07-12 12:20:45 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"priority": "unspecified",
				"bug_severity": "unspecified",
				"blocked": [
					{
						"bug_id": "1071880",
						"alias": "PPCTracker",
						"creation_ts": "2014-03-03 11:41:52 +0000",
						"short_desc": "(PPCTracker) Fedora for PowerPC architectures (ppc64,ppc64le): Bug Tracker",
						"delta_ts": "2024-07-04 11:18:17 +0000",
						"bug_status": "ASSIGNED",
						"keywords": "Tracking",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"238953",
							"1266508",
							"1562071",
							"1817976",
							"1909065",
							"1960848",
							"2209760",
							"2212765",
							"2240371",
							"2273668",
							"2293597",
							"2293909",
							"2294180",
							"179260",
							"468831",
							"810582",
							"834619",
							"864392",
							"968359",
							"990749",
							"999069",
							"1015497",
							"1035541",
							"1049976",
							"1058258",
							"1058289",
							"1058686",
							"1059234",
							"1059816",
							"1067470",
							"1070183",
							"1070206",
							"1070380",
							"1070892",
							"1071278",
							"1071284",
							"1071527",
							"1071845",
							"1079673",
							"1085127",
							"1085704",
							"1088339",
							"1090452",
							"1091538",
							"1093163",
							"1094513",
							"1094975",
							"1097109",
							"1097111",
							"1098151",
							"1100762",
							"1101996",
							"1104215",
							"1104279",
							"1104603",
							"1105552",
							"1108103",
							"1110892",
							"1111453",
							"1114240",
							"1122406",
							"1125883",
							"1128663",
							"1130079",
							"1132488",
							"1134566",
							"1136388",
							"1136532",
							"1136535",
							"1136544",
							"1140057",
							"1140189",
							"1143912",
							"1149159",
							"1149702",
							"1149704",
							"1151853",
							"1155291",
							"1155660",
							"1156300",
							"1158522",
							"1160429",
							"1160916",
							"1161098",
							"1161119",
							"1161152",
							"1161585",
							"1162245",
							"1162904",
							"1162914",
							"1164209",
							"1164221",
							"1165638",
							"1166474",
							"1166489",
							"1168634",
							"1172791",
							"1174607",
							"1175526",
							"1182677",
							"1185298",
							"1194704",
							"1195065",
							"1195663",
							"1196994",
							"1197007",
							"1197165",
							"1197721",
							"1197772",
							"1199041",
							"1201219",
							"1202876",
							"1204876",
							"1205359",
							"1206060",
							"1206161",
							"1208412",
							"1210003",
							"1211616",
							"1211638",
							"1212328",
							"1212472",
							"1214950",
							"1220294",
							"1220866",
							"1221689",
							"1223869",
							"1225035",
							"1225487",
							"1226316",
							"1228102",
							"1230233",
							"1232158",
							"1232650",
							"1232739",
							"1234277",
							"1234284",
							"1235709",
							"1235999",
							"1237089",
							"1238168",
							"1241214",
							"1247047",
							"1247567",
							"1247925",
							"1251120",
							"1251422",
							"1251520",
							"1251972",
							"1252074",
							"1252899",
							"1252905",
							"1252975",
							"1253763",
							"1254606",
							"1255074",
							"1255135",
							"1255682",
							"1256839",
							"1257201",
							"1257966",
							"1260297",
							"1261541",
							"1262402",
							"1262441",
							"1262444",
							"1264504",
							"1264912",
							"1265546",
							"1265674",
							"1267269",
							"1268789",
							"1269811",
							"1271230",
							"1273103",
							"1274974",
							"1275229",
							"1275619",
							"1276061",
							"1276959",
							"1277142",
							"1278066",
							"1278135",
							"1278428",
							"1281446",
							"1281764",
							"1284527",
							"1285786",
							"1286149",
							"1286249",
							"1286625",
							"1287015",
							"1287105",
							"1288561",
							"1289106",
							"1289940",
							"1290958",
							"1291565",
							"1292461",
							"1292462",
							"1292467",
							"1292969",
							"1294016",
							"1295350",
							"1296842",
							"1297387",
							"1297855",
							"1297894",
							"1299151",
							"1299193",
							"1299226",
							"1299599",
							"1300900",
							"1302224",
							"1303219",
							"1303223",
							"1304402",
							"1305512",
							"1305725",
							"1306214",
							"1308252",
							"1308424",
							"1309225",
							"1310495",
							"1311685",
							"1312018",
							"1312339",
							"1315225",
							"1315903",
							"1316840",
							"1319063",
							"1321113",
							"1322696",
							"1323193",
							"1324085",
							"1325114",
							"1325126",
							"1325858",
							"1326250",
							"1326366",
							"1328455",
							"1330098",
							"1330102",
							"1330108",
							"1330161",
							"1330174",
							"1331726",
							"1332146",
							"1332150",
							"1332449",
							"1332978",
							"1333344",
							"1333695",
							"1334125",
							"1334212",
							"1334315",
							"1334320",
							"1335162",
							"1335823",
							"1336466",
							"1340736",
							"1340829",
							"1341090",
							"1342146",
							"1342561",
							"1344636",
							"1345826",
							"1349945",
							"1350486",
							"1351737",
							"1351971",
							"1356152",
							"1356189",
							"1359680",
							"1361037",
							"1365739",
							"1365851",
							"1365862",
							"1365940",
							"1366328",
							"1368495",
							"1368932",
							"1369162",
							"1369169",
							"1371894",
							"1373576",
							"1374380",
							"1374382",
							"1374749",
							"1375942",
							"1377201",
							"1377395",
							"1378359",
							"1379123",
							"1380643",
							"1381206",
							"1383912",
							"1386180",
							"1387107",
							"1387601",
							"1388453",
							"1388561",
							"1389957",
							"1391932",
							"1392264",
							"1392340",
							"1392465",
							"1392478",
							"1392479",
							"1392848",
							"1392854",
							"1392887",
							"1392922",
							"1393834",
							"1396814",
							"1398322",
							"1398575",
							"1400476",
							"1401220",
							"1401707",
							"1402256",
							"1403216",
							"1403760",
							"1404305",
							"1409636",
							"1410774",
							"1410784",
							"1412274",
							"1412926",
							"1414489",
							"1417244",
							"1419355",
							"1420350",
							"1420753",
							"1426796",
							"1428310",
							"1429575",
							"1430827",
							"1430829",
							"1430830",
							"1433859",
							"1434007",
							"1434276",
							"1435154",
							"1435585",
							"1435953",
							"1437793",
							"1439051",
							"1439141",
							"1440047",
							"1440843",
							"1443415",
							"1447276",
							"1447777",
							"1447924",
							"1449582",
							"1450755",
							"1451115",
							"1451143",
							"1452813",
							"1455299",
							"1460003",
							"1461708",
							"1461775",
							"1463749",
							"1464115",
							"1465159",
							"1465171",
							"1465174",
							"1465176",
							"1465657",
							"1467647",
							"1470692",
							"1471785",
							"1472375",
							"1474744",
							"1475636",
							"1476380",
							"1481163",
							"1481611",
							"1482382",
							"1482447",
							"1484149",
							"1484151",
							"1484320",
							"1484474",
							"1484579",
							"1485690",
							"1486737",
							"1487787",
							"1491093",
							"1491751",
							"1494542",
							"1497720",
							"1498561",
							"1498922",
							"1501936",
							"1502009",
							"1512229",
							"1515934",
							"1516213",
							"1518707",
							"1524376",
							"1527692",
							"1528378",
							"1538300",
							"1538817",
							"1540995",
							"1541319",
							"1541613",
							"1544349",
							"1544833",
							"1546693",
							"1546743",
							"1547049",
							"1547467",
							"1548001",
							"1548425",
							"1548671",
							"1552648",
							"1552650",
							"1552653",
							"1552724",
							"1553626",
							"1553794",
							"1554345",
							"1556989",
							"1561011",
							"1562059",
							"1562061",
							"1562073",
							"1563466",
							"1565693",
							"1566066",
							"1566151",
							"1566225",
							"1569045",
							"1570256",
							"1571205",
							"1571860",
							"1572540",
							"1573538",
							"1574604",
							"1577587",
							"1578429",
							"1579708",
							"1585991",
							"1588130",
							"1588734",
							"1588774",
							"1591701",
							"1601259",
							"1605125",
							"1609208",
							"1609513",
							"1612490",
							"1612601",
							"1614948",
							"1619601",
							"1619690",
							"1624915",
							"1626057",
							"1628394",
							"1628540",
							"1631093",
							"1631759",
							"1633565",
							"1643729",
							"1647947",
							"1659239",
							"1660807",
							"1666298",
							"1668751",
							"1669055",
							"1669235",
							"1669256",
							"1675014",
							"1675573",
							"1676411",
							"1676475",
							"1679074",
							"1680040",
							"1687369",
							"1687882",
							"1689037",
							"1689819",
							"1691016",
							"1691487",
							"1691832",
							"1693676",
							"1713090",
							"1714489",
							"1719378",
							"1722181",
							"1723425",
							"1724800",
							"1725924",
							"1726444",
							"1730843",
							"1732612",
							"1733118",
							"1733673",
							"1733926",
							"1736762",
							"1737581",
							"1737587",
							"1738752",
							"1741266",
							"1745841",
							"1746405",
							"1746852",
							"1749729",
							"1756650",
							"1756838",
							"1757249",
							"1757250",
							"1757548",
							"1758225",
							"1762709",
							"1764666",
							"1766519",
							"1768551",
							"1769324",
							"1769445",
							"1769600",
							"1771031",
							"1772935",
							"1774507",
							"1777345",
							"1779589",
							"1782919",
							"1784961",
							"1789199",
							"1789854",
							"1790436",
							"1795575",
							"1798908",
							"1803351",
							"1816527",
							"1817004",
							"1817773",
							"1817959",
							"1820619",
							"1824208",
							"1825287",
							"1827397",
							"1838565",
							"1853217",
							"1856283",
							"1860811",
							"1860932",
							"1863685",
							"1864181",
							"1869980",
							"1870213",
							"1886303",
							"1894654",
							"1897661",
							"1899841",
							"1913493",
							"1915266",
							"1921479",
							"1921485",
							"1923654",
							"1933742",
							"1933794",
							"1934063",
							"1934065",
							"1937684",
							"1939775",
							"1941652",
							"1943729",
							"1948576",
							"1959353",
							"1965610",
							"1966347",
							"1987280",
							"1987972",
							"1989412",
							"1994599",
							"1996330",
							"1999118",
							"2022035",
							"2027889",
							"2030308",
							"2040887",
							"2041573",
							"2043517",
							"2044054",
							"2045152",
							"2045160",
							"2045186",
							"2045189",
							"2045310",
							"2045367",
							"2045456",
							"2045714",
							"2045780",
							"2045797",
							"2046802",
							"2046865",
							"2046907",
							"2048910",
							"2049371",
							"2056459",
							"2061022",
							"2064025",
							"2081451",
							"2095750",
							"2096956",
							"2100546",
							"2102907",
							"2109095",
							"2109120",
							"2112825",
							"2113609",
							"2115752",
							"2124845",
							"2131287",
							"2140618",
							"2142739",
							"2143393",
							"2154939",
							"2160760",
							"2162999",
							"2164029",
							"2173015",
							"2177410",
							"2177691",
							"2209435",
							"2212748",
							"2218314",
							"2221314",
							"2264712",
							"2275090"
						],
						"blocked": [
							{
								"bug_id": "2171964",
								"creation_ts": "2023-02-21 02:32:53 +0000",
								"short_desc": "ICE / segfault in process_function_and_variable_attributes() when building tokodon on ppc64le",
								"delta_ts": "2023-08-16 07:10:03 +0000",
								"bug_status": "NEW",
								"priority": "unspecified",
								"bug_severity": "unspecified",
								"depends_on": [
									"1071880"
								],
								"external_bugs": {
									"text": "108887",
									"name": "GNU Compiler Collection"
								},
								"long_desc": [
									{
										"isprivate": "0",
										"commentid": "17062382",
										"comment_count": "0",
										"who": {
											"text": "justin.zobel",
											"name": "Justin Zobel"
										},
										"bug_when": "2023-02-21 02:32:53 +0000",
										"thetext": "Build has failed only on ppc64le 4 times now, one build example https://koji.fedoraproject.org/koji/taskinfo?taskID=97784827\n\nUpstream has stated they will not support ppc64le.\n\nAdding ExcludeArch until this can be fixed."
									},
									{
										"isprivate": "0",
										"commentid": "17062632",
										"comment_count": "1",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2023-02-21 07:07:45 +0000",
										"thetext": "This is a gcc internal error, probably gcc13 related, I will try to get the details and switch the bug to gcc."
									},
									{
										"isprivate": "0",
										"commentid": "17062697",
										"comment_count": "2",
										"who": {
											"text": "justin.zobel",
											"name": "Justin Zobel"
										},
										"bug_when": "2023-02-21 07:29:45 +0000",
										"thetext": "Thanks Dan much appreciated!"
									},
									{
										"isprivate": "0",
										"commentid": "17062752",
										"comment_count": "3",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2023-02-21 08:04:58 +0000",
										"thetext": "(gdb) run\nStarting program: /usr/bin/g++ -DHAVE_KIO -DKCOREADDONS_LIB -DQT_CONCURRENT_LIB -DQT_CORE_LIB -DQT_DBUS_LIB -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_NO_DEBUG -DQT_NO_FOREACH -DQT_NO_KEYWORDS -DQT_QMLMODELS_LIB -DQT_QML_LIB -DQT_QUICKCONTROLS2_LIB -DQT_QUICK_LIB -DQT_WEBSOCKETS_LIB -DQT_WIDGETS_LIB -DQT_XML_LIB -D_GNU_SOURCE -D_LARGEFILE64_SOURCE -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src -I/home/sharkcz/tokodon/tokodon-23.02.0/src -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src/tokodon_static_autogen/include -isystem /usr/include/qt5 -isystem /usr/include/qt5/QtQuick -isystem /usr/include/qt5/QtQmlModels -isystem /usr/include/qt5/QtQml -isystem /usr/include/qt5/QtNetwork -isystem /usr/include/qt5/QtCore -isystem /usr/lib64/qt5/mkspecs/linux-g++ -isystem /usr/include/qt5/QtGui -isystem /usr/include/qt5/QtWebSockets -isystem /usr/include/qt5/QtQuickControls2 -isystem /usr/include/KF5/KI18n -isystem /usr/include/KF5 -isystem /usr/include/KF5/Kirigami2 -isystem /usr/include/KF5/KNotifications -isystem /usr/include/qt5/QtWidgets -isystem /usr/include/qt5/QtDBus -isystem /usr/include/KF5/KConfig -isystem /usr/include/KF5/KConfigCore -isystem /usr/include/KF5/KConfigGui -isystem /usr/include/qt5/QtXml -isystem /usr/include/KF5/KCoreAddons -isystem /usr/include/KF5/KIOWidgets -isystem /usr/include/KF5/KIOGui -isystem /usr/include/KF5/KIOCore -isystem /usr/include/KF5/KIO -isystem /usr/include/KF5/KService -isystem /usr/include/qt5/QtConcurrent -isystem /usr/include/KF5/KWindowSystem -isystem /usr/include/KF5/KJobWidgets -isystem /usr/include/KF5/Solid -isystem /usr/include/KF5/KCompletion -isystem /usr/include/KF5/KWidgetsAddons -isystem /usr/include/KF5/KConfigWidgets -isystem /usr/include/KF5/KCodecs -isystem /usr/include/KF5/KAuthWidgets -isystem /usr/include/KF5/KAuthCore -isystem /usr/include/KF5/KAuth -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-U_FORTIFY_SOURCE,-D_FORTIFY_SOURCE=3 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -fstack-protector-strong -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mcpu=power8 -mtune=power8 -fasynchronous-unwind-tables -fstack-clash-protection -fno-operator-names -fno-exceptions -Wall -Wextra -Wcast-align -Wchar-subscripts -Wformat-security -Wno-long-long -Wpointer-arith -Wundef -Wnon-virtual-dtor -Woverloaded-virtual -Werror=return-type -Werror=init-self -Wvla -Wdate-time -Wsuggest-override -Wlogical-op -DNDEBUG -std=gnu++17 -fvisibility=hidden -fvisibility-inlines-hidden -fPIC -MD -MT src/CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -MF CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o.d -o CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -c /home/sharkcz/tokodon/tokodon-23.02.0/src/linkpaginatedtimelinemodel.cpp\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n[Attaching after Thread 0x7ffff7ff34e0 (LWP 18708) vfork to child process 18710]\n[New inferior 2 (process 18710)]\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n[Detaching vfork parent process 18708 after child exec]\n[Inferior 1 (process 18708) detached]\nprocess 18710 is executing new program: /usr/libexec/gcc/ppc64le-redhat-linux/13/cc1plus\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n\nThread 2.1 \"cc1plus\" received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7ffff7ff53c0 (LWP 18710)]\nprocess_function_and_variable_attributes (first_var=0x7fffdc638a00, first=0x7fffdc539900) at ../../gcc/cgraphunit.cc:861\nDownloading 0.02 MB source file /usr/src/debug/gcc-13.0.1-0.4.fc39.ppc64le/obj-ppc64le-redhat-linux/gcc/../../gcc/cgraphunit.cc\n861\t      tree decl = node->decl;\n(gdb) cont\nContinuing.\n\nThread 2.1 \"cc1plus\" hit Breakpoint 1, 0x0000000010747e9c in internal_error (gmsgid=0x11927bf8 \"%s\") at ../../gcc/diagnostic.cc:2138\n2138\t{\n(gdb) bt\n#0  0x0000000010747e9c in internal_error (gmsgid=0x11927bf8 \"%s\") at ../../gcc/diagnostic.cc:2138\n#1  0x00000000103f7a5c in crash_signal (signo=11) at ../../gcc/toplev.cc:317\n#2  <signal handler called>\n#3  process_function_and_variable_attributes (first_var=0x7fffdc638a00, first=0x7fffdc539900) at ../../gcc/cgraphunit.cc:861\n#4  analyze_functions (first_time=first_time@entry=true) at ../../gcc/cgraphunit.cc:1181\n#5  0x00000000112bf628 in symbol_table::finalize_compilation_unit (this=0x7fffe8080000) at ../../gcc/cgraphunit.cc:2545\n#6  0x000000001125c410 in compile_file () at ../../gcc/toplev.cc:474\n#7  0x00000000111dd510 in do_compile (no_backend=<optimized out>) at ../../gcc/toplev.cc:2128\n#8  toplev::main (this=this@entry=0x7fffffffca00, argc=<optimized out>, argv=<optimized out>) at ../../gcc/toplev.cc:2282\n#9  0x00000000111dc5d0 in main (argc=<optimized out>, argv=<optimized out>) at ../../gcc/main.cc:39"
									},
									{
										"isprivate": "0",
										"commentid": "17062753",
										"comment_count": "4",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2023-02-21 08:05:48 +0000",
										"thetext": "Created attachment 1945415\npreprocessed sources"
									},
									{
										"isprivate": "0",
										"commentid": "17062834",
										"comment_count": "5",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2023-02-21 08:22:23 +0000",
										"thetext": "reduced g++ command line with only defines or include paths still reproducing the issue is\n\n/usr/bin/g++ -DHAVE_KIO -DKCOREADDONS_LIB -DQT_CONCURRENT_LIB -DQT_CORE_LIB -DQT_DBUS_LIB -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_NO_DEBUG -DQT_NO_FOREACH -DQT_NO_KEYWORDS -DQT_QMLMODELS_LIB -DQT_QML_LIB -DQT_QUICKCONTROLS2_LIB -DQT_QUICK_LIB -DQT_WEBSOCKETS_LIB -DQT_WIDGETS_LIB -DQT_XML_LIB -D_GNU_SOURCE -D_LARGEFILE64_SOURCE -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src -I/home/sharkcz/tokodon/tokodon-23.02.0/src -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src/tokodon_static_autogen/include -isystem /usr/include/qt5 -isystem /usr/include/qt5/QtQuick -isystem /usr/include/qt5/QtQmlModels -isystem /usr/include/qt5/QtQml -isystem /usr/include/qt5/QtNetwork -isystem /usr/include/qt5/QtCore -isystem /usr/lib64/qt5/mkspecs/linux-g++ -isystem /usr/include/qt5/QtGui -isystem /usr/include/qt5/QtWebSockets -isystem /usr/include/qt5/QtQuickControls2 -isystem /usr/include/KF5/KI18n -isystem /usr/include/KF5 -isystem /usr/include/KF5/Kirigami2 -isystem /usr/include/KF5/KNotifications -isystem /usr/include/qt5/QtWidgets -isystem /usr/include/qt5/QtDBus -isystem /usr/include/KF5/KConfig -isystem /usr/include/KF5/KConfigCore -isystem /usr/include/KF5/KConfigGui -isystem /usr/include/qt5/QtXml -isystem /usr/include/KF5/KCoreAddons -isystem /usr/include/KF5/KIOWidgets -isystem /usr/include/KF5/KIOGui -isystem /usr/include/KF5/KIOCore -isystem /usr/include/KF5/KIO -isystem /usr/include/KF5/KService -isystem /usr/include/qt5/QtConcurrent -isystem /usr/include/KF5/KWindowSystem -isystem /usr/include/KF5/KJobWidgets -isystem /usr/include/KF5/Solid -isystem /usr/include/KF5/KCompletion -isystem /usr/include/KF5/KWidgetsAddons -isystem /usr/include/KF5/KConfigWidgets -isystem /usr/include/KF5/KCodecs -isystem /usr/include/KF5/KAuthWidgets -isystem /usr/include/KF5/KAuthCore -isystem /usr/include/KF5/KAuth -O2 -pipe -m64 -mcpu=power8 -mtune=power8 -fPIC -o CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -c /home/sharkcz/tokodon/tokodon-23.02.0/src/linkpaginatedtimelinemodel.cpp"
									},
									{
										"isprivate": "0",
										"commentid": "17065288",
										"comment_count": "6",
										"who": {
											"text": "jakub",
											"name": "Jakub Jelinek"
										},
										"bug_when": "2023-02-21 21:14:20 +0000",
										"thetext": "cvise reduced to -std=gnu++17 -O2 -mcpu=power8:\n\ntemplate <int __v> struct integral_constant {\n  static constexpr int value = __v;\n};\nusing false_type = integral_constant<false>;\ntemplate <bool, bool, typename...> struct __result_of_impl;\ntemplate <typename _Functor, typename... _ArgTypes>\nstruct __result_of_impl<false, false, _Functor, _ArgTypes...> {\n  typedef decltype(0) type;\n};\ntemplate <typename... _ArgTypes>\nstruct __invoke_result\n    : __result_of_impl<false_type::value, false_type::value, _ArgTypes...> {};\ntemplate <typename, typename _Fn, typename... _Args>\nvoid __invoke_impl(_Fn __f, _Args... __args) {\n  __f(__args...);\n}\ntemplate <typename, typename _Callable, typename... _Args>\nvoid __invoke_r(_Callable __fn, _Args... __args) {\n  using __result = __invoke_result<_Args...>;\n  using __type = typename __result::type;\n  __invoke_impl<__type>(__fn, __args...);\n}\nstruct QString {\n  QString(const char *);\n};\ntemplate <typename> class function;\ntemplate <typename _Functor> struct _Base_manager {\n  static _Functor _M_get_pointer(int) { __builtin_abort (); }\n};\ntemplate <typename, typename> class _Function_handler;\ntemplate <typename _Res, typename _Functor, typename... _ArgTypes>\nstruct _Function_handler<_Res(_ArgTypes...), _Functor> {\n  using _Base = _Base_manager<_Functor>;\n  static _Res _M_invoke(const int &__functor, _ArgTypes &&...__args) {\n    auto __trans_tmp_1 = _Base::_M_get_pointer(__functor);\n    __invoke_r<_Res>(__trans_tmp_1, __args...);\n  }\n};\ntemplate <typename _Res, typename... _ArgTypes>\nstruct function<_Res(_ArgTypes...)> {\n  template <typename _Functor>\n  using _Handler = _Function_handler<_Res(_ArgTypes...), _Functor>;\n  template <typename _Functor> function(_Functor) {\n    using _My_handler = _Handler<_Functor>;\n    _M_invoker = _My_handler::_M_invoke;\n  }\n  using _Invoker_type = _Res (*)(const int &, _ArgTypes &&...);\n  _Invoker_type _M_invoker;\n};\nstruct QRegularExpression {\n  QRegularExpression(QString);\n};\nstruct AbstractAccount {\n  void get(function<void(AbstractAccount *)>,\n           function<void(AbstractAccount *)>);\n};\nstruct AbstractTimelineModel {\n  AbstractAccount m_account;\n};\nstruct LinkPaginationTimelineModel : AbstractTimelineModel {\n  void fillTimeline();\n};\nvoid LinkPaginationTimelineModel::fillTimeline() {\n  [] {};\n  m_account.get([](AbstractAccount *) { static QRegularExpression re(\"\"); },\n                [](AbstractAccount *) {});\n}\n\nBut, strangely can't reproduce with a cross-compiler from x86_64 to powerpc64le."
									},
									{
										"isprivate": "0",
										"commentid": "17540990",
										"comment_count": "7",
										"who": {
											"text": "releng",
											"name": "Fedora Release Engineering"
										},
										"bug_when": "2023-08-16 07:10:03 +0000",
										"thetext": "This bug appears to have been reported against 'rawhide' during the Fedora Linux 39 development cycle.\nChanging version to 39."
									}
								]
							},
							{
								"bug_id": "1929836",
								"creation_ts": "2021-02-17 18:32:37 +0000",
								"short_desc": "ppc64le: severe ptrace, tracing, and audit regression",
								"delta_ts": "2022-09-05 08:10:08 +0000",
								"bug_status": "CLOSED",
								"resolution": "CURRENTRELEASE",
								"bug_file_loc": "https://git.kernel.org/torvalds/c/d72500f992849d31ebae8f821a023660ddd0dcc2",
								"keywords": "BetaBlocker",
								"priority": "urgent",
								"bug_severity": "urgent",
								"depends_on": [
									"1071880"
								],
								"blocked": [
									{
										"bug_id": "1930252",
										"error": "NotPermitted"
									}
								],
								"long_desc": [
									{
										"isprivate": "0",
										"commentid": "14794276",
										"comment_count": "0",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-02-17 18:32:37 +0000",
										"thetext": "Hello, strace upstream is speaking. :)\n\nThere seems to be a severe ppc64le kernel regression detected by strace %check (625 of 972 tests failed).  This ruins strace and blocks any strace update.\n\nFor me it looks as if the kernel function syscall_get_error started to return 0 instead of the error code.\n\nThe logs are in the latest strace build task that failed:\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=62171493\n\nThe kernel used for build there was\nLinux buildvm-ppc64le-14.iad2.fedoraproject.org 5.10.15-200.fc33.ppc64le #1 SMP Wed Feb 10 17:31:04 UTC 2021 ppc64le ppc64le ppc64le GNU/Linux\n\nFor comparison, the same version of strace passes all tests on all other rawhide architectures, as well as on Debian ppc64le (kernel 5.10.13-1).\n\nThe latest successfull strace build to rawhide was about 2 months ago:\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1658216\n\nThe kernel used for build there was\nLinux buildvm-ppc64le-38.iad2.fedoraproject.org 5.9.11-200.fc33.ppc64le #1 SMP Tue Nov 24 18:02:53 UTC 2020 ppc64le ppc64le ppc64le GNU/Linux"
									},
									{
										"isprivate": "0",
										"commentid": "14797189",
										"comment_count": "1",
										"who": {
											"text": "esyr",
											"name": "Eugene Syromiatnikov"
										},
										"bug_when": "2021-02-18 13:45:03 +0000",
										"thetext": "Fedora's 5.10.7-200.fc33.ppc64le (on buildvm-ppc64le-19.iad2.fedoraproject.org) was broken as well, for the record."
									},
									{
										"isprivate": "0",
										"commentid": "14868304",
										"comment_count": "2",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-03-14 00:26:35 +0000",
										"thetext": "I'd like to reiterate: this kernel bug breaks strace badly, making it almost unusable."
									},
									{
										"isprivate": "0",
										"commentid": "14942947",
										"comment_count": "3",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-04-07 16:25:50 +0000",
										"thetext": "This is the reason why the latest strace release didn't get into Fedora, see\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1711422\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1711415\n\nUntil this bug is fixed, no strace updates in Fedora are possible."
									},
									{
										"isprivate": "0",
										"commentid": "15061049",
										"comment_count": "4",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-05-14 10:20:36 +0000",
										"thetext": "Using the latest strace that can decode the structure returned by PTRACE_GETREGSET,\none can see that's wrong in the data returned by the kernel.\n\nLinux buildvm-ppc64le-22.iad2.fedoraproject.org 5.11.10-200.fc33.ppc64le\non exiting chdir(\"\") syscall did the following:\n\nptrace(PTRACE_GETREGSET, 702867, NT_PRSTATUS, {iov_base={gpr=[0xc, 0x7fffd8c3f250, 0x7fffa60b7000, 0xfffffffffffffffe, 0x7fffd8c3f158, 0, 0x8, 0x20, 0xfffffffe7fffffff, 0, 0, 0, 0, 0x7fffa615a390, 0, 0, 0, 0x7fffd8c3fa58, 0x7fffd8c3f308, 0x7fffd8c3f304, 0x1228f4f68, 0x1228f4fb0, 0xab98c, 0xab991, 0x7fffa61533a0, 0x1228f5180, 0x1228f51b8, 0x122910010, 0, 0xab98c, 0x7fffa5c6fff0, 0x100000], nip=0x7fffa5fb4ad4, msr=0x800000000000d033, orig_gpr3=0x1228f52e8, ctr=0, link=0, xer=0, ccr=0x44000278, softe=0x1, trap=0x3000, dar=0x7fffa5fb4aa8, dsisr=0x40000000, result=0xfffffffffffffffe, ...}, iov_len=384}) = 0\n\nAs you can see, unlike any normal ppc64le kernel, here ccr does not have 0x10000000 bit set, and gpr[3] equals to 0xfffffffffffffffe (== -2L) instead of expected 0x2 (== ENOENT).\nSo yes, this kernel has an obviously broken ptrace ABI.\n\nYou can find this and much more in the scratch build log at https://koji.fedoraproject.org/koji/taskinfo?taskID=67867999"
									},
									{
										"isprivate": "0",
										"commentid": "15061494",
										"comment_count": "5",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2021-05-14 13:38:41 +0000",
										"thetext": "for the record, from my F-32 system (bare-metal Power9, not a VM) with kernel-5.11.19-100.fc32.ppc64le, strace built from master branch\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  905\n# SKIP:  97\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0"
									},
									{
										"isprivate": "0",
										"commentid": "15062263",
										"comment_count": "6",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2021-05-14 18:02:11 +0000",
										"thetext": "and I get these from a rawhide VM with kernel-5.13.0-0.rc1.20210512git88b06399c9c7.15.fc35.ppc64le\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  232\n# SKIP:  102\n# XFAIL: 0\n# FAIL:  668\n# XPASS: 0\n# ERROR: 0\n\n\nbut in F-32 VM with kernel kernel-5.11.19-100.fc32.ppc64le everything looks good\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  905\n# SKIP:  97\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0\n============================================================================\nand I get the same good result in the F-32 VM with kernel-5.12.3-300.fc34.ppc64le\n\nF-32 VM with kernel-5.13.0-0.rc1.20210512git88b06399c9c7.15.fc35.ppc64le then gives\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  901\n# SKIP:  101\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0\n============================================================================\n\n\nIt makes me think that the failures are not related to the kernel version, but to something else in the rawhide buildroot, perhaps glibc?"
									},
									{
										"isprivate": "0",
										"commentid": "15062268",
										"comment_count": "7",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2021-05-14 18:05:25 +0000",
										"thetext": "but kernel-headers-5.11.19-100.fc32.ppc64le was always used for the F-32 tests (if this should make the difference, will check ...)"
									},
									{
										"isprivate": "0",
										"commentid": "15062989",
										"comment_count": "8",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-05-15 01:03:06 +0000",
										"thetext": "(In reply to Dan Hork from comment #6)\n> It makes me think that the failures are not related to the kernel version,\n> but to something else in the rawhide buildroot, perhaps glibc?\n\nIf it's not the kernel but something else, then this something else is also capable of meddling both with struct ptrace_syscall_info returned by ptrace(PTRACE_GET_SYSCALL_INFO, pid, size, info) as described in the first comment, and with struct pt_regs returned by syscall(__NR_ptrace, PTRACE_GETREGSET, pid, NT_PRSTATUS, iov) in a very specific way described in #c4; in other words, this something is changing both ccr and gpr[3] in the kernel for all ptraced processes."
									},
									{
										"isprivate": "0",
										"commentid": "15074749",
										"comment_count": "9",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2021-05-18 14:05:24 +0000",
										"thetext": "after updating to glibc-2.33.9000-6.fc35 in my F-32 VM, where the tests were passing, I get now the failures\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  232\n# SKIP:  102\n# XFAIL: 0\n# FAIL:  668\n# XPASS: 0\n# ERROR: 0\n============================================================================"
									},
									{
										"isprivate": "0",
										"commentid": "15076721",
										"comment_count": "10",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2021-05-18 15:15:01 +0000",
										"thetext": "let's switch to glibc for their feedback ..."
									},
									{
										"isprivate": "0",
										"commentid": "15079009",
										"comment_count": "11",
										"who": {
											"text": "fweimer",
											"name": "Florian Weimer"
										},
										"bug_when": "2021-05-18 20:14:57 +0000",
										"thetext": "Is it possible to reproduce this issue with an already-built strace binary?\n\nWe added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to <sys/ptrace.h>, maybe that causes different execution paths in strace to be taken?"
									},
									{
										"isprivate": "0",
										"commentid": "15079018",
										"comment_count": "12",
										"who": {
											"text": "codonell",
											"name": "Carlos O'Donell"
										},
										"bug_when": "2021-05-18 20:19:39 +0000",
										"thetext": "(In reply to Florian Weimer from comment #11)\n> Is it possible to reproduce this issue with an already-built strace binary?\n> \n> We added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to\n> <sys/ptrace.h>, maybe that causes different execution paths in strace to be\n> taken?\n\nWe also have the 'sc' vs. 'svc' instruction selection in the same timeframe for power?"
									},
									{
										"isprivate": "0",
										"commentid": "15079022",
										"comment_count": "13",
										"who": {
											"text": "codonell",
											"name": "Carlos O'Donell"
										},
										"bug_when": "2021-05-18 20:20:48 +0000",
										"thetext": "(In reply to Carlos O'Donell from comment #12)\n> (In reply to Florian Weimer from comment #11)\n> > Is it possible to reproduce this issue with an already-built strace binary?\n> > \n> > We added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to\n> > <sys/ptrace.h>, maybe that causes different execution paths in strace to be\n> > taken?\n> \n> We also have the 'sc' vs. 'svc' instruction selection in the same timeframe\n> for power?\n\nSorry, 'scv'."
									},
									{
										"isprivate": "0",
										"commentid": "15079274",
										"comment_count": "14",
										"who": {
											"text": "codonell",
											"name": "Carlos O'Donell"
										},
										"bug_when": "2021-05-18 21:16:04 +0000",
										"thetext": "A recent scratch build failed on a POWER9 box, which would be the hardware under which glibc would switch to 'scv' for syscalls.\n\nJust two quick snippets:\n\n--- exp 2021-05-18 20:26:11.715277248 +0000\n+++ log 2021-05-18 20:26:11.715277248 +0000\n-chdir(0x7fffb053ffe0) = -1 EFAULT (Bad address)\n-chdir(0x7fffb053ffe1) = -1 EFAULT (Bad address)\n+chdir(0x7fffb053ffe0) = 18446744073709551602\n+chdir(0x7fffb053ffe1) = 18446744073709551602\nFAIL printpath-umovestr-legacy.test (exit status: 1)\nFAIL: printstrn-umoven-legacy\n\n--- exp 2021-05-18 20:26:44.524009554 +0000\n+++ log 2021-05-18 20:26:44.524009554 +0000\n@@ -1,2 +1,2 @@\n-writev(-1, [{iov_base=\"\", iov_len=0}, {iov_base=\"f\", iov_len=1}, {iov_base=\"ef\", iov_len=2}, {iov_base=\"def\", iov_len=3}, {iov_base=\"cdef\", iov_len=4}, {iov_base=\"bcdef\", iov_len=5}, {iov_base=\"abcdef\", iov_len=6}, {iov_base=\"zabcdef\", iov_len=7}, {iov_base=\"yzabcdef\", iov_len=8}, {iov_base=\"xyzabcdef\", iov_len=9}, {iov_base=\"wxyzabcdef\", iov_len=10}, {iov_base=\"vwxyzabcdef\", iov_len=11}, {iov_base=\"uvwxyzabcdef\", iov_len=12}, {iov_base=\"tuvwxyzabcdef\", iov_len=13}, {iov_base=\"stuvwxyzabcdef\", iov_len=14}, {iov_base=\"rstuvwxyzabcdef\", iov_len=15}, {iov_base=\"qrstuvwxyzabcdef\", iov_len=16}, {iov_base=\"pqrstuvwxyzabcdef\", iov_len=17}, {iov_base=\"opqrstuvwxyzabcdef\", iov_len=18}, {iov_base=\"nopqrstuvwxyzabcdef\", iov_len=19}, {iov_base=\"mnopqrstuvwxyzabcdef\", iov_len=20}, {iov_base=\"lmnopqrstuvwxyzabcdef\", iov_len=21}, {iov_base=\"klmnopqrstuvwxyzabcdef\", iov_len=22}, {iov_base=\"jklmnopqrstuvwxyzabcdef\", iov_len=23}, {iov_base=\"ijklmnopqrstuvwxyzabcdef\", iov_len=24}, {iov_base=\"hijklmnopqrstuvwxyzabcdef\", iov_len=25}, {iov_base=\"ghijklmnopqrstuvwxyzabcdef\", iov_len=26}, {iov_base=\"fghijklmnopqrstuvwxyzabcdef\", iov_len=27}, {iov_base=\"efghijklmnopqrstuvwxyzabcdef\", iov_len=28}, {iov_base=\"defghijklmnopqrstuvwxyzabcdef\", iov_len=29}, {iov_base=\"cdefghijklmnopqrstuvwxyzabcdef\", iov_len=30}, {iov_base=\"bcdefghijklmnopqrstuvwxyzabcdef\", iov_len=31}], 32) = -1 EBADF (Bad file descriptor)\n+writev(-1, [{iov_base=\"\", iov_len=0}, {iov_base=\"f\", iov_len=1}, {iov_base=\"ef\", iov_len=2}, {iov_base=\"def\", iov_len=3}, {iov_base=\"cdef\", iov_len=4}, {iov_base=\"bcdef\", iov_len=5}, {iov_base=\"abcdef\", iov_len=6}, {iov_base=\"zabcdef\", iov_len=7}, {iov_base=\"yzabcdef\", iov_len=8}, {iov_base=\"xyzabcdef\", iov_len=9}, {iov_base=\"wxyzabcdef\", iov_len=10}, {iov_base=\"vwxyzabcdef\", iov_len=11}, {iov_base=\"uvwxyzabcdef\", iov_len=12}, {iov_base=\"tuvwxyzabcdef\", iov_len=13}, {iov_base=\"stuvwxyzabcdef\", iov_len=14}, {iov_base=\"rstuvwxyzabcdef\", iov_len=15}, {iov_base=\"qrstuvwxyzabcdef\", iov_len=16}, {iov_base=\"pqrstuvwxyzabcdef\", iov_len=17}, {iov_base=\"opqrstuvwxyzabcdef\", iov_len=18}, {iov_base=\"nopqrstuvwxyzabcdef\", iov_len=19}, {iov_base=\"mnopqrstuvwxyzabcdef\", iov_len=20}, {iov_base=\"lmnopqrstuvwxyzabcdef\", iov_len=21}, {iov_base=\"klmnopqrstuvwxyzabcdef\", iov_len=22}, {iov_base=\"jklmnopqrstuvwxyzabcdef\", iov_len=23}, {iov_base=\"ijklmnopqrstuvwxyzabcdef\", iov_len=24}, {iov_base=\"hijklmnopqrstuvwxyzabcdef\", iov_len=25}, {iov_base=\"ghijklmnopqrstuvwxyzabcdef\", iov_len=26}, {iov_base=\"fghijklmnopqrstuvwxyzabcdef\", iov_len=27}, {iov_base=\"efghijklmnopqrstuvwxyzabcdef\", iov_len=28}, {iov_base=\"defghijklmnopqrstuvwxyzabcdef\", iov_len=29}, {iov_base=\"cdefghijklmnopqrstuvwxyzabcdef\", iov_len=30}, {iov_base=\"bcdefghijklmnopqrstuvwxyzabcdef\", iov_len=31}], 32) = 18446744073709551607\nFAIL umovestr_cached.test (exit status: 1)\n\nThe last successful strace build is with glibc-2.32.9000-20.fc34.ppc64le, which is ~4 builds before 'scv' is introduced.\n\nAll builds after 'scv' is introduced in glibc-2.32.9000-24 (2021-01-08) appear to fail.\n\nI don't see any 'scv' enablement in strace for ppc64le."
									},
									{
										"isprivate": "0",
										"commentid": "15079276",
										"comment_count": "15",
										"who": {
											"text": "tulioqm",
											"name": "Tulio Magno Quites Machado Filho"
										},
										"bug_when": "2021-05-18 21:18:21 +0000",
										"thetext": "(In reply to Carlos O'Donell from comment #14)\n> I don't see any 'scv' enablement in strace for ppc64le.\n\nI agree with you. strace upstream is missing support for scv.\ne.g. in this function https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\nWe can't trust on the value of CR0 anymore.  An error is returned when r3 is negative."
									},
									{
										"isprivate": "0",
										"commentid": "15079396",
										"comment_count": "16",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-05-18 22:40:03 +0000",
										"thetext": "(In reply to Tulio Magno Quites Machado Filho from comment #15)\n> (In reply to Carlos O'Donell from comment #14)\n> > I don't see any 'scv' enablement in strace for ppc64le.\n> \n> I agree with you. strace upstream is missing support for scv.\n> e.g. in this function\n> https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n> We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> negative.\n\nDoes this mean that the kernel function syscall_get_error and all its users including PTRACE_GET_SYSCALL_INFO API is broken when scv is used?"
									},
									{
										"isprivate": "0",
										"commentid": "15079417",
										"comment_count": "17",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-05-18 22:56:59 +0000",
										"thetext": "(In reply to Dmitry V. Levin from comment #16)\n> (In reply to Tulio Magno Quites Machado Filho from comment #15)\n> > (In reply to Carlos O'Donell from comment #14)\n> > > I don't see any 'scv' enablement in strace for ppc64le.\n> > \n> > I agree with you. strace upstream is missing support for scv.\n> > e.g. in this function\n> > https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n> > We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> > negative.\n> \n> Does this mean that the kernel function syscall_get_error and all its users\n> including PTRACE_GET_SYSCALL_INFO API are broken when scv is used?\n\nLooks like the answer is yes, the kernel commit v5.9-rc1~100^2~164 that introduced scv support was incomplete, all users of ccr in arch/powerpc/include/asm/ptrace.h and arch/powerpc/include/asm/syscall.h are broken when scv is used.\n\nSo while the idea of changing the error handling convention is questionable,\nthe bug is on the kernel side that failed to implement the new error handling convention."
									},
									{
										"isprivate": "0",
										"commentid": "15079459",
										"comment_count": "18",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-05-18 23:32:22 +0000",
										"thetext": "(In reply to Tulio Magno Quites Machado Filho from comment #15)\n> (In reply to Carlos O'Donell from comment #14)\n> > I don't see any 'scv' enablement in strace for ppc64le.\n> \n> I agree with you. strace upstream is missing support for scv.\n> e.g. in this function\n> https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n\nPlease note that this file is not used when PTRACE_GET_SYSCALL_INFO is working properly,\nthere is a runtime test for this, see\n\n$ strace -d -enone / 2>&1 |grep PTRACE_GET_SYSCALL_INFO\n\nHowever, there is going to be an issue with src/linux/powerpc/set_error.c and its users, e.g. syscall tampering.\n\n> We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> negative.\n\nI hope somebody who knows scv semantics would contribute missing parts of scv support to strace and the kernel before strace is kicked out from Fedora due to ftbfs."
									},
									{
										"isprivate": "0",
										"commentid": "15084949",
										"comment_count": "19",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-05-20 03:47:43 +0000",
										"thetext": "There was a short discussion in linux-api mailing list that identified two bugs:\n1. incomplete scv abi support in the kernel that breaks users of asm/syscall.h and asm/ptrace.h, these users include ptrace, tracing, and audit subsystems; detected by hundereds of tests from the strace test suite, proposed patch can be found at https://lore.kernel.org/linux-api/1621385544.nttlk5qugb.astroid@bobo.none/ ;\n2. a glibc bug detected by signal test from the strace test suite, proposed patch can be found at https://lore.kernel.org/linux-api/1621400263.gf0mbqhkrf.astroid@bobo.none/ .\n\nFeel free to split this bug report into two if necessary."
									},
									{
										"isprivate": "0",
										"commentid": "15088583",
										"comment_count": "20",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-05-20 23:06:30 +0000",
										"thetext": "Since the glibc bug is now tracked by #1962971, switching this bug back to the kernel component.\n\nMeanwhile, Nicholas Piggin submitted a patch that's likely to be the final, see\nhttps://lore.kernel.org/linuxppc-dev/20210520111931.2597127-2-npiggin@gmail.com/\n\nI'd like to remind that this bug was found by strace test suite and it blocks strace updates in Fedora.\n\nI hope the fix will be applied before strace is kicked out from Fedora due to ftbfs which is 19 weeks already."
									},
									{
										"isprivate": "0",
										"commentid": "15093123",
										"comment_count": "21",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-05-23 17:43:31 +0000",
										"thetext": "(In reply to Dmitry V. Levin from comment #20)\n> Meanwhile, Nicholas Piggin submitted a patch that's likely to be the final,\n> see\n> https://lore.kernel.org/linuxppc-dev/20210520111931.2597127-2-npiggin@gmail.\n> com/\n\nThis patch has been merged upstream, see\nhttps://git.kernel.org/torvalds/c/d72500f992849d31ebae8f821a023660ddd0dcc2"
									},
									{
										"isprivate": "0",
										"commentid": "15095587",
										"comment_count": "22",
										"who": {
											"text": "jforbes",
											"name": "Justin M. Forbes"
										},
										"bug_when": "2021-05-24 14:19:12 +0000",
										"thetext": "That should be in the 5.13-rc3 build today for rawhide. I have also cherry picked it for 5.12, so it should land in stable fedora with 5.12.7 and newer."
									},
									{
										"isprivate": "0",
										"commentid": "15185392",
										"comment_count": "23",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2021-06-14 15:35:34 +0000",
										"thetext": "Dmitry, is there still something blocking you from updating strace? I believe we already have all the kernel/glibc bits included for F-34+."
									},
									{
										"isprivate": "0",
										"commentid": "15195017",
										"comment_count": "24",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-06-16 12:06:57 +0000",
										"thetext": "Everything should have been fixed now, but I cannot tell for sure because something else is broken: a scratch build of strace HEAD failed with the following diagnostics: BuildrootError: could not init mock buildroot, mock exited with status 30; see root.log for more information\n\nThe corresponding root.log contains the following diagnostics:\nDEBUG util.py:444:  Error: \nDEBUG util.py:444:   Problem: package util-linux-2.37-2.fc35.x86_64 requires util-linux-core = 2.37-2.fc35, but none of the providers can be installed\nDEBUG util.py:444:    - conflicting requests\nDEBUG util.py:444:    - nothing provides libpcre2-posix.so.2()(64bit) needed by util-linux-core-2.37-2.fc35.x86_64\nDEBUG util.py:446:  (try to add '--skip-broken' to skip uninstallable packages)\nDEBUG util.py:598:  Child return code was: 1\n\nThis looks as if all builds to fc35 are currently broken.\nFor more details see the scratch build task: https://koji.fedoraproject.org/koji/taskinfo?taskID=70224999"
									},
									{
										"isprivate": "0",
										"commentid": "15195062",
										"comment_count": "25",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2021-06-16 12:17:33 +0000",
										"thetext": "The buildroot should be OK again, there was a pcre2 update with unexpected consequences, but it has been untagged."
									},
									{
										"isprivate": "0",
										"commentid": "15195850",
										"comment_count": "26",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2021-06-16 14:59:25 +0000",
										"thetext": "for the record, my local F-34 rebuild of strace HEAD with kernel-5.12.10-300.fc34.ppc64le and glibc-2.33-16.fc34.ppc64le was successful"
									},
									{
										"isprivate": "0",
										"commentid": "15197009",
										"comment_count": "27",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-06-16 23:19:42 +0000",
										"thetext": "(In reply to Dan Hork from comment #26)\n> for the record, my local F-34 rebuild of strace HEAD with\n> kernel-5.12.10-300.fc34.ppc64le and glibc-2.33-16.fc34.ppc64le was successful\n\nMy scratch build to fc34 was successful, too:\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=70227524"
									},
									{
										"isprivate": "0",
										"commentid": "16610110",
										"comment_count": "28",
										"who": {
											"text": "mcermak",
											"name": "Martin Cermak"
										},
										"bug_when": "2022-09-05 08:05:57 +0000",
										"thetext": "Maybe this one could be flipped to MODIFIED or further?  Thanks!"
									},
									{
										"isprivate": "0",
										"commentid": "16610124",
										"comment_count": "29",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2022-09-05 08:10:08 +0000",
										"thetext": "It was fixed long time ago, closing."
									}
								]
							},
							{
								"bug_id": "1962971",
								"creation_ts": "2021-05-20 22:54:06 +0000",
								"short_desc": "glibc: ppc64le: scv ABI error handling fails to check IS_ERR_VALUE",
								"delta_ts": "2021-07-06 13:32:49 +0000",
								"bug_status": "CLOSED",
								"resolution": "ERRATA",
								"keywords": "BetaBlocker",
								"priority": "unspecified",
								"bug_severity": "urgent",
								"depends_on": [
									"1071880"
								],
								"blocked": [
									{
										"bug_id": "1930252",
										"error": "NotPermitted"
									},
									{
										"bug_id": "1963901",
										"creation_ts": "2021-05-24 11:10:27 +0000",
										"short_desc": "RHEL9 - ppc64le: glibc fails to check IS_ERR_VALUE when using scv",
										"delta_ts": "2023-07-18 14:29:19 +0000",
										"bug_status": "CLOSED",
										"resolution": "CURRENTRELEASE",
										"keywords": "Bugfix, Patch, Triaged",
										"priority": "unspecified",
										"bug_severity": "high",
										"depends_on": [
											"1962971"
										],
										"blocked": [
											{
												"bug_id": "1875375",
												"error": "NotPermitted"
											}
										],
										"external_bugs": {
											"text": "27892",
											"name": "Sourceware"
										},
										"long_desc": [
											{
												"isprivate": "0",
												"commentid": "15094789",
												"comment_count": "0",
												"who": {
													"text": "bugproxy",
													"name": "IBM Bug Proxy"
												},
												"bug_when": "2021-05-24 11:10:27 +0000"
											},
											{
												"isprivate": "0",
												"commentid": "15094790",
												"comment_count": "1",
												"who": {
													"text": "bugproxy",
													"name": "IBM Bug Proxy"
												},
												"bug_when": "2021-05-24 11:10:35 +0000",
												"thetext": "== Comment: #0 - Tulio Magno Quites Machado Filho <tulioqm@br.ibm.com> - 2021-05-21 16:11:35 ==\n---Problem Description---\nglibc fails to check IS_ERR_VALUE when using scv.\n\nThis bug has been reported upstream as: https://sourceware.org/bugzilla/show_bug.cgi?id=27892\n\nIt has also been reported for Fedora 35: https://bugzilla.redhat.com/show_bug.cgi?id=1962971\n \nContact Information = Tulio Magno Quites Machado Filho/tulioqm@br.ibm.com \n \n---Additional Hardware Info---\nA POWER9 or POWER10 server with support for scv is required to reproduce the error.\n\n\n---Steps to Reproduce---\n 1. Build strace and its tests.\n 2. Run test tests/signal\n \nUserspace rpm: glibc \n \nThe userspace tool has the following bit modes: 64-bit"
											},
											{
												"isprivate": "0",
												"commentid": "15103462",
												"comment_count": "6",
												"who": {
													"text": "fweimer",
													"name": "Florian Weimer"
												},
												"bug_when": "2021-05-25 17:37:12 +0000",
												"thetext": "Merge request: https://gitlab.com/redhat/centos-stream/rpms/glibc/-/merge_requests/11"
											},
											{
												"isprivate": "0",
												"commentid": "15103633",
												"comment_count": "7",
												"who": {
													"text": "bugproxy",
													"name": "IBM Bug Proxy"
												},
												"bug_when": "2021-05-25 17:47:07 +0000",
												"thetext": "------- Comment From tulioqm@br.ibm.com 2021-05-24 10:12 EDT-------\n> May we make this bug report public? Thanks.\n\nYes, but I don't know how to do this.\nCould you help me, please?"
											}
										]
									}
								],
								"external_bugs": {
									"text": "27892",
									"name": "Sourceware"
								},
								"long_desc": [
									{
										"isprivate": "0",
										"commentid": "15088572",
										"comment_count": "0",
										"who": {
											"text": "ldv",
											"name": "Dmitry V. Levin"
										},
										"bug_when": "2021-05-20 22:54:06 +0000",
										"thetext": "+++ This bug was initially created as a clone of Bug #1929836 +++\n\nThe scv ABI introduced by glibc-2.32.9000-24 at 2021-01-08 has the following bug: RET_SCV macro (added by upstream commit glibc-2.33~117) treats any negative value returned by syscall via scv ABI as an error, but this is not correct.\n\nProposed fix was posted by Nicholas Piggin at\nhttps://sourceware.org/pipermail/libc-alpha/2021-May/126534.html\n\nThis bug was found by strace test suite and it blocks strace updates in Fedora.\n\nI hope the fix will be applied before strace is kicked out from Fedora due to ftbfs which is 19 weeks already."
									},
									{
										"isprivate": "0",
										"commentid": "15138481",
										"comment_count": "1",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2021-06-01 13:46:20 +0000",
										"thetext": "FEDORA-2021-abbb0d8a88 has been submitted as an update to Fedora 34. https://bodhi.fedoraproject.org/updates/FEDORA-2021-abbb0d8a88"
									},
									{
										"isprivate": "0",
										"commentid": "15138487",
										"comment_count": "2",
										"who": {
											"text": "codonell",
											"name": "Carlos O'Donell"
										},
										"bug_when": "2021-06-01 13:47:36 +0000",
										"thetext": "This fix is currently pending the Fedora Rawhide sync with the upstream development branch.\n\nThe fix is going into Fedora 34 with the next errata going through bodhi."
									},
									{
										"isprivate": "0",
										"commentid": "15140578",
										"comment_count": "3",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2021-06-02 01:41:09 +0000",
										"thetext": "FEDORA-2021-abbb0d8a88 has been pushed to the Fedora 34 testing repository.\nSoon you'll be able to install the update with the following command:\n`sudo dnf upgrade --enablerepo=updates-testing --advisory=FEDORA-2021-abbb0d8a88`\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2021-abbb0d8a88\n\nSee also https://fedoraproject.org/wiki/QA:Updates_Testing for more information on how to test updates."
									},
									{
										"isprivate": "0",
										"commentid": "15144856",
										"comment_count": "4",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2021-06-03 01:01:07 +0000",
										"thetext": "FEDORA-2021-abbb0d8a88 has been pushed to the Fedora 34 stable repository.\nIf problem still persists, please make note of it in this bug report."
									},
									{
										"isprivate": "0",
										"commentid": "15194139",
										"comment_count": "5",
										"who": {
											"text": "updates",
											"name": "Fedora Update System"
										},
										"bug_when": "2021-06-16 08:27:59 +0000",
										"thetext": "FEDORA-2021-9ce0f65a09 has been pushed to the Fedora 35 stable repository.\nIf problem still persists, please make note of it in this bug report."
									}
								]
							}
						],
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "6873212",
								"comment_count": "0",
								"who": {
									"text": "karsten",
									"name": "Karsten Hopp"
								},
								"bug_when": "2014-03-03 11:41:52 +0000",
								"thetext": "Description of problem:\nThis is a tracker for bugzillas and patches related to the PowerPC (ppc, ppc64) architectures.\n\nppc64le has its own tracker: bug 1051573"
							},
							{
								"isprivate": "0",
								"commentid": "10293511",
								"comment_count": "1",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-03-31 08:51:19 +0000",
								"thetext": "*** Bug 1051573 has been marked as a duplicate of this bug. ***"
							},
							{
								"isprivate": "0",
								"commentid": "10293516",
								"comment_count": "2",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-03-31 08:52:39 +0000",
								"thetext": "add open bugs from the ppc64le tracker"
							},
							{
								"isprivate": "0",
								"commentid": "13402189",
								"comment_count": "3",
								"who": {
									"text": "bcotton",
									"name": "Ben Cotton"
								},
								"bug_when": "2019-11-27 14:16:33 +0000",
								"thetext": "Fedora 29 changed to end-of-life (EOL) status on 2019-11-26. Fedora 29 is\nno longer maintained, which means that it will not receive any further\nsecurity or bug fix updates. As a result we are closing this bug.\n\nIf you can reproduce this bug against a currently maintained version of\nFedora please feel free to reopen this bug against that version. If you\nare unable to reopen this bug, please file a new report against the\ncurrent release. If you experience problems, please add a comment to this\nbug.\n\nThank you for reporting this bug and we are sorry it could not be fixed."
							},
							{
								"isprivate": "0",
								"commentid": "13403192",
								"comment_count": "4",
								"who": {
									"text": "bcotton",
									"name": "Ben Cotton"
								},
								"bug_when": "2019-11-27 16:41:04 +0000",
								"thetext": "This bug was accidentally closed due to a query error. Reopening."
							}
						]
					},
					{
						"bug_id": "1443415",
						"creation_ts": "2017-04-19 08:31:04 +0000",
						"short_desc": "[TRACKING] Upgrade f25 to f26 get stuck in Cleanup",
						"delta_ts": "2018-05-29 12:12:31 +0000",
						"bug_status": "CLOSED",
						"resolution": "EOL",
						"keywords": "Triaged",
						"priority": "unspecified",
						"bug_severity": "unspecified",
						"depends_on": [
							"1397087",
							"1460003"
						],
						"blocked": [
							{
								"bug_id": "1071880",
								"alias": "PPCTracker",
								"creation_ts": "2014-03-03 11:41:52 +0000",
								"short_desc": "(PPCTracker) Fedora for PowerPC architectures (ppc64,ppc64le): Bug Tracker",
								"delta_ts": "2024-07-04 11:18:17 +0000",
								"bug_status": "ASSIGNED",
								"keywords": "Tracking",
								"priority": "medium",
								"bug_severity": "medium",
								"depends_on": [
									"238953",
									"1266508",
									"1562071",
									"1817976",
									"1909065",
									"1960848",
									"2209760",
									"2212765",
									"2240371",
									"2273668",
									"2293597",
									"2293909",
									"2294180",
									"179260",
									"468831",
									"810582",
									"834619",
									"864392",
									"968359",
									"990749",
									"999069",
									"1015497",
									"1035541",
									"1049976",
									"1058258",
									"1058289",
									"1058686",
									"1059234",
									"1059816",
									"1067470",
									"1070183",
									"1070206",
									"1070380",
									"1070892",
									"1071278",
									"1071284",
									"1071527",
									"1071845",
									"1079673",
									"1085127",
									"1085704",
									"1088339",
									"1090452",
									"1091538",
									"1093163",
									"1094513",
									"1094975",
									"1097109",
									"1097111",
									"1098151",
									"1100762",
									"1101996",
									"1104215",
									"1104279",
									"1104603",
									"1105552",
									"1108103",
									"1110892",
									"1111453",
									"1114240",
									"1122406",
									"1125883",
									"1128663",
									"1130079",
									"1132488",
									"1134566",
									"1136388",
									"1136532",
									"1136535",
									"1136544",
									"1140057",
									"1140189",
									"1143912",
									"1149159",
									"1149702",
									"1149704",
									"1151853",
									"1155291",
									"1155660",
									"1156300",
									"1158522",
									"1160429",
									"1160916",
									"1161098",
									"1161119",
									"1161152",
									"1161585",
									"1162245",
									"1162904",
									"1162914",
									"1164209",
									"1164221",
									"1165638",
									"1166474",
									"1166489",
									"1168634",
									"1172791",
									"1174607",
									"1175526",
									"1182677",
									"1185298",
									"1194704",
									"1195065",
									"1195663",
									"1196994",
									"1197007",
									"1197165",
									"1197721",
									"1197772",
									"1199041",
									"1201219",
									"1202876",
									"1204876",
									"1205359",
									"1206060",
									"1206161",
									"1208412",
									"1210003",
									"1211616",
									"1211638",
									"1212328",
									"1212472",
									"1214950",
									"1220294",
									"1220866",
									"1221689",
									"1223869",
									"1225035",
									"1225487",
									"1226316",
									"1228102",
									"1230233",
									"1232158",
									"1232650",
									"1232739",
									"1234277",
									"1234284",
									"1235709",
									"1235999",
									"1237089",
									"1238168",
									"1241214",
									"1247047",
									"1247567",
									"1247925",
									"1251120",
									"1251422",
									"1251520",
									"1251972",
									"1252074",
									"1252899",
									"1252905",
									"1252975",
									"1253763",
									"1254606",
									"1255074",
									"1255135",
									"1255682",
									"1256839",
									"1257201",
									"1257966",
									"1260297",
									"1261541",
									"1262402",
									"1262441",
									"1262444",
									"1264504",
									"1264912",
									"1265546",
									"1265674",
									"1267269",
									"1268789",
									"1269811",
									"1271230",
									"1273103",
									"1274974",
									"1275229",
									"1275619",
									"1276061",
									"1276959",
									"1277142",
									"1278066",
									"1278135",
									"1278428",
									"1281446",
									"1281764",
									"1284527",
									"1285786",
									"1286149",
									"1286249",
									"1286625",
									"1287015",
									"1287105",
									"1288561",
									"1289106",
									"1289940",
									"1290958",
									"1291565",
									"1292461",
									"1292462",
									"1292467",
									"1292969",
									"1294016",
									"1295350",
									"1296842",
									"1297387",
									"1297855",
									"1297894",
									"1299151",
									"1299193",
									"1299226",
									"1299599",
									"1300900",
									"1302224",
									"1303219",
									"1303223",
									"1304402",
									"1305512",
									"1305725",
									"1306214",
									"1308252",
									"1308424",
									"1309225",
									"1310495",
									"1311685",
									"1312018",
									"1312339",
									"1315225",
									"1315903",
									"1316840",
									"1319063",
									"1321113",
									"1322696",
									"1323193",
									"1324085",
									"1325114",
									"1325126",
									"1325858",
									"1326250",
									"1326366",
									"1328455",
									"1330098",
									"1330102",
									"1330108",
									"1330161",
									"1330174",
									"1331726",
									"1332146",
									"1332150",
									"1332449",
									"1332978",
									"1333344",
									"1333695",
									"1334125",
									"1334212",
									"1334315",
									"1334320",
									"1335162",
									"1335823",
									"1336466",
									"1340736",
									"1340829",
									"1341090",
									"1342146",
									"1342561",
									"1344636",
									"1345826",
									"1349945",
									"1350486",
									"1351737",
									"1351971",
									"1356152",
									"1356189",
									"1359680",
									"1361037",
									"1365739",
									"1365851",
									"1365862",
									"1365940",
									"1366328",
									"1368495",
									"1368932",
									"1369162",
									"1369169",
									"1371894",
									"1373576",
									"1374380",
									"1374382",
									"1374749",
									"1375942",
									"1377201",
									"1377395",
									"1378359",
									"1379123",
									"1380643",
									"1381206",
									"1383912",
									"1386180",
									"1387107",
									"1387601",
									"1388453",
									"1388561",
									"1389957",
									"1391932",
									"1392264",
									"1392340",
									"1392465",
									"1392478",
									"1392479",
									"1392848",
									"1392854",
									"1392887",
									"1392922",
									"1393834",
									"1396814",
									"1398322",
									"1398575",
									"1400476",
									"1401220",
									"1401707",
									"1402256",
									"1403216",
									"1403760",
									"1404305",
									"1409636",
									"1410774",
									"1410784",
									"1412274",
									"1412926",
									"1414489",
									"1417244",
									"1419355",
									"1420350",
									"1420753",
									"1426796",
									"1428310",
									"1429575",
									"1430827",
									"1430829",
									"1430830",
									"1433859",
									"1434007",
									"1434276",
									"1435154",
									"1435585",
									"1435953",
									"1437793",
									"1439051",
									"1439141",
									"1440047",
									"1440843",
									"1443415",
									"1447276",
									"1447777",
									"1447924",
									"1449582",
									"1450755",
									"1451115",
									"1451143",
									"1452813",
									"1455299",
									"1460003",
									"1461708",
									"1461775",
									"1463749",
									"1464115",
									"1465159",
									"1465171",
									"1465174",
									"1465176",
									"1465657",
									"1467647",
									"1470692",
									"1471785",
									"1472375",
									"1474744",
									"1475636",
									"1476380",
									"1481163",
									"1481611",
									"1482382",
									"1482447",
									"1484149",
									"1484151",
									"1484320",
									"1484474",
									"1484579",
									"1485690",
									"1486737",
									"1487787",
									"1491093",
									"1491751",
									"1494542",
									"1497720",
									"1498561",
									"1498922",
									"1501936",
									"1502009",
									"1512229",
									"1515934",
									"1516213",
									"1518707",
									"1524376",
									"1527692",
									"1528378",
									"1538300",
									"1538817",
									"1540995",
									"1541319",
									"1541613",
									"1544349",
									"1544833",
									"1546693",
									"1546743",
									"1547049",
									"1547467",
									"1548001",
									"1548425",
									"1548671",
									"1552648",
									"1552650",
									"1552653",
									"1552724",
									"1553626",
									"1553794",
									"1554345",
									"1556989",
									"1561011",
									"1562059",
									"1562061",
									"1562073",
									"1563466",
									"1565693",
									"1566066",
									"1566151",
									"1566225",
									"1569045",
									"1570256",
									"1571205",
									"1571860",
									"1572540",
									"1573538",
									"1574604",
									"1577587",
									"1578429",
									"1579708",
									"1585991",
									"1588130",
									"1588734",
									"1588774",
									"1591701",
									"1601259",
									"1605125",
									"1609208",
									"1609513",
									"1612490",
									"1612601",
									"1614948",
									"1619601",
									"1619690",
									"1624915",
									"1626057",
									"1628394",
									"1628540",
									"1631093",
									"1631759",
									"1633565",
									"1643729",
									"1647947",
									"1659239",
									"1660807",
									"1666298",
									"1668751",
									"1669055",
									"1669235",
									"1669256",
									"1675014",
									"1675573",
									"1676411",
									"1676475",
									"1679074",
									"1680040",
									"1687369",
									"1687882",
									"1689037",
									"1689819",
									"1691016",
									"1691487",
									"1691832",
									"1693676",
									"1713090",
									"1714489",
									"1719378",
									"1722181",
									"1723425",
									"1724800",
									"1725924",
									"1726444",
									"1730843",
									"1732612",
									"1733118",
									"1733673",
									"1733926",
									"1736762",
									"1737581",
									"1737587",
									"1738752",
									"1741266",
									"1745841",
									"1746405",
									"1746852",
									"1749729",
									"1756650",
									"1756838",
									"1757249",
									"1757250",
									"1757548",
									"1758225",
									"1762709",
									"1764666",
									"1766519",
									"1768551",
									"1769324",
									"1769445",
									"1769600",
									"1771031",
									"1772935",
									"1774507",
									"1777345",
									"1779589",
									"1782919",
									"1784961",
									"1789199",
									"1789854",
									"1790436",
									"1795575",
									"1798908",
									"1803351",
									"1816527",
									"1817004",
									"1817773",
									"1817959",
									"1820619",
									"1824208",
									"1825287",
									"1827397",
									"1838565",
									"1853217",
									"1856283",
									"1860811",
									"1860932",
									"1863685",
									"1864181",
									"1869980",
									"1870213",
									"1886303",
									"1894654",
									"1897661",
									"1899841",
									"1913493",
									"1915266",
									"1921479",
									"1921485",
									"1923654",
									"1933742",
									"1933794",
									"1934063",
									"1934065",
									"1937684",
									"1939775",
									"1941652",
									"1943729",
									"1948576",
									"1959353",
									"1965610",
									"1966347",
									"1987280",
									"1987972",
									"1989412",
									"1994599",
									"1996330",
									"1999118",
									"2022035",
									"2027889",
									"2030308",
									"2040887",
									"2041573",
									"2043517",
									"2044054",
									"2045152",
									"2045160",
									"2045186",
									"2045189",
									"2045310",
									"2045367",
									"2045456",
									"2045714",
									"2045780",
									"2045797",
									"2046802",
									"2046865",
									"2046907",
									"2048910",
									"2049371",
									"2056459",
									"2061022",
									"2064025",
									"2081451",
									"2095750",
									"2096956",
									"2100546",
									"2102907",
									"2109095",
									"2109120",
									"2112825",
									"2113609",
									"2115752",
									"2124845",
									"2131287",
									"2140618",
									"2142739",
									"2143393",
									"2154939",
									"2160760",
									"2162999",
									"2164029",
									"2173015",
									"2177410",
									"2177691",
									"2209435",
									"2212748",
									"2218314",
									"2221314",
									"2264712",
									"2275090"
								],
								"blocked": [
									{
										"bug_id": "2171964",
										"creation_ts": "2023-02-21 02:32:53 +0000",
										"short_desc": "ICE / segfault in process_function_and_variable_attributes() when building tokodon on ppc64le",
										"delta_ts": "2023-08-16 07:10:03 +0000",
										"bug_status": "NEW",
										"priority": "unspecified",
										"bug_severity": "unspecified",
										"depends_on": [
											"1071880"
										],
										"external_bugs": {
											"text": "108887",
											"name": "GNU Compiler Collection"
										},
										"long_desc": [
											{
												"isprivate": "0",
												"commentid": "17062382",
												"comment_count": "0",
												"who": {
													"text": "justin.zobel",
													"name": "Justin Zobel"
												},
												"bug_when": "2023-02-21 02:32:53 +0000",
												"thetext": "Build has failed only on ppc64le 4 times now, one build example https://koji.fedoraproject.org/koji/taskinfo?taskID=97784827\n\nUpstream has stated they will not support ppc64le.\n\nAdding ExcludeArch until this can be fixed."
											},
											{
												"isprivate": "0",
												"commentid": "17062632",
												"comment_count": "1",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2023-02-21 07:07:45 +0000",
												"thetext": "This is a gcc internal error, probably gcc13 related, I will try to get the details and switch the bug to gcc."
											},
											{
												"isprivate": "0",
												"commentid": "17062697",
												"comment_count": "2",
												"who": {
													"text": "justin.zobel",
													"name": "Justin Zobel"
												},
												"bug_when": "2023-02-21 07:29:45 +0000",
												"thetext": "Thanks Dan much appreciated!"
											},
											{
												"isprivate": "0",
												"commentid": "17062752",
												"comment_count": "3",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2023-02-21 08:04:58 +0000",
												"thetext": "(gdb) run\nStarting program: /usr/bin/g++ -DHAVE_KIO -DKCOREADDONS_LIB -DQT_CONCURRENT_LIB -DQT_CORE_LIB -DQT_DBUS_LIB -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_NO_DEBUG -DQT_NO_FOREACH -DQT_NO_KEYWORDS -DQT_QMLMODELS_LIB -DQT_QML_LIB -DQT_QUICKCONTROLS2_LIB -DQT_QUICK_LIB -DQT_WEBSOCKETS_LIB -DQT_WIDGETS_LIB -DQT_XML_LIB -D_GNU_SOURCE -D_LARGEFILE64_SOURCE -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src -I/home/sharkcz/tokodon/tokodon-23.02.0/src -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src/tokodon_static_autogen/include -isystem /usr/include/qt5 -isystem /usr/include/qt5/QtQuick -isystem /usr/include/qt5/QtQmlModels -isystem /usr/include/qt5/QtQml -isystem /usr/include/qt5/QtNetwork -isystem /usr/include/qt5/QtCore -isystem /usr/lib64/qt5/mkspecs/linux-g++ -isystem /usr/include/qt5/QtGui -isystem /usr/include/qt5/QtWebSockets -isystem /usr/include/qt5/QtQuickControls2 -isystem /usr/include/KF5/KI18n -isystem /usr/include/KF5 -isystem /usr/include/KF5/Kirigami2 -isystem /usr/include/KF5/KNotifications -isystem /usr/include/qt5/QtWidgets -isystem /usr/include/qt5/QtDBus -isystem /usr/include/KF5/KConfig -isystem /usr/include/KF5/KConfigCore -isystem /usr/include/KF5/KConfigGui -isystem /usr/include/qt5/QtXml -isystem /usr/include/KF5/KCoreAddons -isystem /usr/include/KF5/KIOWidgets -isystem /usr/include/KF5/KIOGui -isystem /usr/include/KF5/KIOCore -isystem /usr/include/KF5/KIO -isystem /usr/include/KF5/KService -isystem /usr/include/qt5/QtConcurrent -isystem /usr/include/KF5/KWindowSystem -isystem /usr/include/KF5/KJobWidgets -isystem /usr/include/KF5/Solid -isystem /usr/include/KF5/KCompletion -isystem /usr/include/KF5/KWidgetsAddons -isystem /usr/include/KF5/KConfigWidgets -isystem /usr/include/KF5/KCodecs -isystem /usr/include/KF5/KAuthWidgets -isystem /usr/include/KF5/KAuthCore -isystem /usr/include/KF5/KAuth -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-U_FORTIFY_SOURCE,-D_FORTIFY_SOURCE=3 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -fstack-protector-strong -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mcpu=power8 -mtune=power8 -fasynchronous-unwind-tables -fstack-clash-protection -fno-operator-names -fno-exceptions -Wall -Wextra -Wcast-align -Wchar-subscripts -Wformat-security -Wno-long-long -Wpointer-arith -Wundef -Wnon-virtual-dtor -Woverloaded-virtual -Werror=return-type -Werror=init-self -Wvla -Wdate-time -Wsuggest-override -Wlogical-op -DNDEBUG -std=gnu++17 -fvisibility=hidden -fvisibility-inlines-hidden -fPIC -MD -MT src/CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -MF CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o.d -o CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -c /home/sharkcz/tokodon/tokodon-23.02.0/src/linkpaginatedtimelinemodel.cpp\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n[Attaching after Thread 0x7ffff7ff34e0 (LWP 18708) vfork to child process 18710]\n[New inferior 2 (process 18710)]\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n[Detaching vfork parent process 18708 after child exec]\n[Inferior 1 (process 18708) detached]\nprocess 18710 is executing new program: /usr/libexec/gcc/ppc64le-redhat-linux/13/cc1plus\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n\nThread 2.1 \"cc1plus\" received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7ffff7ff53c0 (LWP 18710)]\nprocess_function_and_variable_attributes (first_var=0x7fffdc638a00, first=0x7fffdc539900) at ../../gcc/cgraphunit.cc:861\nDownloading 0.02 MB source file /usr/src/debug/gcc-13.0.1-0.4.fc39.ppc64le/obj-ppc64le-redhat-linux/gcc/../../gcc/cgraphunit.cc\n861\t      tree decl = node->decl;\n(gdb) cont\nContinuing.\n\nThread 2.1 \"cc1plus\" hit Breakpoint 1, 0x0000000010747e9c in internal_error (gmsgid=0x11927bf8 \"%s\") at ../../gcc/diagnostic.cc:2138\n2138\t{\n(gdb) bt\n#0  0x0000000010747e9c in internal_error (gmsgid=0x11927bf8 \"%s\") at ../../gcc/diagnostic.cc:2138\n#1  0x00000000103f7a5c in crash_signal (signo=11) at ../../gcc/toplev.cc:317\n#2  <signal handler called>\n#3  process_function_and_variable_attributes (first_var=0x7fffdc638a00, first=0x7fffdc539900) at ../../gcc/cgraphunit.cc:861\n#4  analyze_functions (first_time=first_time@entry=true) at ../../gcc/cgraphunit.cc:1181\n#5  0x00000000112bf628 in symbol_table::finalize_compilation_unit (this=0x7fffe8080000) at ../../gcc/cgraphunit.cc:2545\n#6  0x000000001125c410 in compile_file () at ../../gcc/toplev.cc:474\n#7  0x00000000111dd510 in do_compile (no_backend=<optimized out>) at ../../gcc/toplev.cc:2128\n#8  toplev::main (this=this@entry=0x7fffffffca00, argc=<optimized out>, argv=<optimized out>) at ../../gcc/toplev.cc:2282\n#9  0x00000000111dc5d0 in main (argc=<optimized out>, argv=<optimized out>) at ../../gcc/main.cc:39"
											},
											{
												"isprivate": "0",
												"commentid": "17062753",
												"comment_count": "4",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2023-02-21 08:05:48 +0000",
												"thetext": "Created attachment 1945415\npreprocessed sources"
											},
											{
												"isprivate": "0",
												"commentid": "17062834",
												"comment_count": "5",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2023-02-21 08:22:23 +0000",
												"thetext": "reduced g++ command line with only defines or include paths still reproducing the issue is\n\n/usr/bin/g++ -DHAVE_KIO -DKCOREADDONS_LIB -DQT_CONCURRENT_LIB -DQT_CORE_LIB -DQT_DBUS_LIB -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_NO_DEBUG -DQT_NO_FOREACH -DQT_NO_KEYWORDS -DQT_QMLMODELS_LIB -DQT_QML_LIB -DQT_QUICKCONTROLS2_LIB -DQT_QUICK_LIB -DQT_WEBSOCKETS_LIB -DQT_WIDGETS_LIB -DQT_XML_LIB -D_GNU_SOURCE -D_LARGEFILE64_SOURCE -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src -I/home/sharkcz/tokodon/tokodon-23.02.0/src -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src/tokodon_static_autogen/include -isystem /usr/include/qt5 -isystem /usr/include/qt5/QtQuick -isystem /usr/include/qt5/QtQmlModels -isystem /usr/include/qt5/QtQml -isystem /usr/include/qt5/QtNetwork -isystem /usr/include/qt5/QtCore -isystem /usr/lib64/qt5/mkspecs/linux-g++ -isystem /usr/include/qt5/QtGui -isystem /usr/include/qt5/QtWebSockets -isystem /usr/include/qt5/QtQuickControls2 -isystem /usr/include/KF5/KI18n -isystem /usr/include/KF5 -isystem /usr/include/KF5/Kirigami2 -isystem /usr/include/KF5/KNotifications -isystem /usr/include/qt5/QtWidgets -isystem /usr/include/qt5/QtDBus -isystem /usr/include/KF5/KConfig -isystem /usr/include/KF5/KConfigCore -isystem /usr/include/KF5/KConfigGui -isystem /usr/include/qt5/QtXml -isystem /usr/include/KF5/KCoreAddons -isystem /usr/include/KF5/KIOWidgets -isystem /usr/include/KF5/KIOGui -isystem /usr/include/KF5/KIOCore -isystem /usr/include/KF5/KIO -isystem /usr/include/KF5/KService -isystem /usr/include/qt5/QtConcurrent -isystem /usr/include/KF5/KWindowSystem -isystem /usr/include/KF5/KJobWidgets -isystem /usr/include/KF5/Solid -isystem /usr/include/KF5/KCompletion -isystem /usr/include/KF5/KWidgetsAddons -isystem /usr/include/KF5/KConfigWidgets -isystem /usr/include/KF5/KCodecs -isystem /usr/include/KF5/KAuthWidgets -isystem /usr/include/KF5/KAuthCore -isystem /usr/include/KF5/KAuth -O2 -pipe -m64 -mcpu=power8 -mtune=power8 -fPIC -o CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -c /home/sharkcz/tokodon/tokodon-23.02.0/src/linkpaginatedtimelinemodel.cpp"
											},
											{
												"isprivate": "0",
												"commentid": "17065288",
												"comment_count": "6",
												"who": {
													"text": "jakub",
													"name": "Jakub Jelinek"
												},
												"bug_when": "2023-02-21 21:14:20 +0000",
												"thetext": "cvise reduced to -std=gnu++17 -O2 -mcpu=power8:\n\ntemplate <int __v> struct integral_constant {\n  static constexpr int value = __v;\n};\nusing false_type = integral_constant<false>;\ntemplate <bool, bool, typename...> struct __result_of_impl;\ntemplate <typename _Functor, typename... _ArgTypes>\nstruct __result_of_impl<false, false, _Functor, _ArgTypes...> {\n  typedef decltype(0) type;\n};\ntemplate <typename... _ArgTypes>\nstruct __invoke_result\n    : __result_of_impl<false_type::value, false_type::value, _ArgTypes...> {};\ntemplate <typename, typename _Fn, typename... _Args>\nvoid __invoke_impl(_Fn __f, _Args... __args) {\n  __f(__args...);\n}\ntemplate <typename, typename _Callable, typename... _Args>\nvoid __invoke_r(_Callable __fn, _Args... __args) {\n  using __result = __invoke_result<_Args...>;\n  using __type = typename __result::type;\n  __invoke_impl<__type>(__fn, __args...);\n}\nstruct QString {\n  QString(const char *);\n};\ntemplate <typename> class function;\ntemplate <typename _Functor> struct _Base_manager {\n  static _Functor _M_get_pointer(int) { __builtin_abort (); }\n};\ntemplate <typename, typename> class _Function_handler;\ntemplate <typename _Res, typename _Functor, typename... _ArgTypes>\nstruct _Function_handler<_Res(_ArgTypes...), _Functor> {\n  using _Base = _Base_manager<_Functor>;\n  static _Res _M_invoke(const int &__functor, _ArgTypes &&...__args) {\n    auto __trans_tmp_1 = _Base::_M_get_pointer(__functor);\n    __invoke_r<_Res>(__trans_tmp_1, __args...);\n  }\n};\ntemplate <typename _Res, typename... _ArgTypes>\nstruct function<_Res(_ArgTypes...)> {\n  template <typename _Functor>\n  using _Handler = _Function_handler<_Res(_ArgTypes...), _Functor>;\n  template <typename _Functor> function(_Functor) {\n    using _My_handler = _Handler<_Functor>;\n    _M_invoker = _My_handler::_M_invoke;\n  }\n  using _Invoker_type = _Res (*)(const int &, _ArgTypes &&...);\n  _Invoker_type _M_invoker;\n};\nstruct QRegularExpression {\n  QRegularExpression(QString);\n};\nstruct AbstractAccount {\n  void get(function<void(AbstractAccount *)>,\n           function<void(AbstractAccount *)>);\n};\nstruct AbstractTimelineModel {\n  AbstractAccount m_account;\n};\nstruct LinkPaginationTimelineModel : AbstractTimelineModel {\n  void fillTimeline();\n};\nvoid LinkPaginationTimelineModel::fillTimeline() {\n  [] {};\n  m_account.get([](AbstractAccount *) { static QRegularExpression re(\"\"); },\n                [](AbstractAccount *) {});\n}\n\nBut, strangely can't reproduce with a cross-compiler from x86_64 to powerpc64le."
											},
											{
												"isprivate": "0",
												"commentid": "17540990",
												"comment_count": "7",
												"who": {
													"text": "releng",
													"name": "Fedora Release Engineering"
												},
												"bug_when": "2023-08-16 07:10:03 +0000",
												"thetext": "This bug appears to have been reported against 'rawhide' during the Fedora Linux 39 development cycle.\nChanging version to 39."
											}
										]
									},
									{
										"bug_id": "1929836",
										"creation_ts": "2021-02-17 18:32:37 +0000",
										"short_desc": "ppc64le: severe ptrace, tracing, and audit regression",
										"delta_ts": "2022-09-05 08:10:08 +0000",
										"bug_status": "CLOSED",
										"resolution": "CURRENTRELEASE",
										"bug_file_loc": "https://git.kernel.org/torvalds/c/d72500f992849d31ebae8f821a023660ddd0dcc2",
										"keywords": "BetaBlocker",
										"priority": "urgent",
										"bug_severity": "urgent",
										"depends_on": [
											"1071880"
										],
										"blocked": [
											{
												"bug_id": "1930252",
												"error": "NotPermitted"
											}
										],
										"long_desc": [
											{
												"isprivate": "0",
												"commentid": "14794276",
												"comment_count": "0",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-02-17 18:32:37 +0000",
												"thetext": "Hello, strace upstream is speaking. :)\n\nThere seems to be a severe ppc64le kernel regression detected by strace %check (625 of 972 tests failed).  This ruins strace and blocks any strace update.\n\nFor me it looks as if the kernel function syscall_get_error started to return 0 instead of the error code.\n\nThe logs are in the latest strace build task that failed:\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=62171493\n\nThe kernel used for build there was\nLinux buildvm-ppc64le-14.iad2.fedoraproject.org 5.10.15-200.fc33.ppc64le #1 SMP Wed Feb 10 17:31:04 UTC 2021 ppc64le ppc64le ppc64le GNU/Linux\n\nFor comparison, the same version of strace passes all tests on all other rawhide architectures, as well as on Debian ppc64le (kernel 5.10.13-1).\n\nThe latest successfull strace build to rawhide was about 2 months ago:\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1658216\n\nThe kernel used for build there was\nLinux buildvm-ppc64le-38.iad2.fedoraproject.org 5.9.11-200.fc33.ppc64le #1 SMP Tue Nov 24 18:02:53 UTC 2020 ppc64le ppc64le ppc64le GNU/Linux"
											},
											{
												"isprivate": "0",
												"commentid": "14797189",
												"comment_count": "1",
												"who": {
													"text": "esyr",
													"name": "Eugene Syromiatnikov"
												},
												"bug_when": "2021-02-18 13:45:03 +0000",
												"thetext": "Fedora's 5.10.7-200.fc33.ppc64le (on buildvm-ppc64le-19.iad2.fedoraproject.org) was broken as well, for the record."
											},
											{
												"isprivate": "0",
												"commentid": "14868304",
												"comment_count": "2",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-03-14 00:26:35 +0000",
												"thetext": "I'd like to reiterate: this kernel bug breaks strace badly, making it almost unusable."
											},
											{
												"isprivate": "0",
												"commentid": "14942947",
												"comment_count": "3",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-04-07 16:25:50 +0000",
												"thetext": "This is the reason why the latest strace release didn't get into Fedora, see\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1711422\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1711415\n\nUntil this bug is fixed, no strace updates in Fedora are possible."
											},
											{
												"isprivate": "0",
												"commentid": "15061049",
												"comment_count": "4",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-05-14 10:20:36 +0000",
												"thetext": "Using the latest strace that can decode the structure returned by PTRACE_GETREGSET,\none can see that's wrong in the data returned by the kernel.\n\nLinux buildvm-ppc64le-22.iad2.fedoraproject.org 5.11.10-200.fc33.ppc64le\non exiting chdir(\"\") syscall did the following:\n\nptrace(PTRACE_GETREGSET, 702867, NT_PRSTATUS, {iov_base={gpr=[0xc, 0x7fffd8c3f250, 0x7fffa60b7000, 0xfffffffffffffffe, 0x7fffd8c3f158, 0, 0x8, 0x20, 0xfffffffe7fffffff, 0, 0, 0, 0, 0x7fffa615a390, 0, 0, 0, 0x7fffd8c3fa58, 0x7fffd8c3f308, 0x7fffd8c3f304, 0x1228f4f68, 0x1228f4fb0, 0xab98c, 0xab991, 0x7fffa61533a0, 0x1228f5180, 0x1228f51b8, 0x122910010, 0, 0xab98c, 0x7fffa5c6fff0, 0x100000], nip=0x7fffa5fb4ad4, msr=0x800000000000d033, orig_gpr3=0x1228f52e8, ctr=0, link=0, xer=0, ccr=0x44000278, softe=0x1, trap=0x3000, dar=0x7fffa5fb4aa8, dsisr=0x40000000, result=0xfffffffffffffffe, ...}, iov_len=384}) = 0\n\nAs you can see, unlike any normal ppc64le kernel, here ccr does not have 0x10000000 bit set, and gpr[3] equals to 0xfffffffffffffffe (== -2L) instead of expected 0x2 (== ENOENT).\nSo yes, this kernel has an obviously broken ptrace ABI.\n\nYou can find this and much more in the scratch build log at https://koji.fedoraproject.org/koji/taskinfo?taskID=67867999"
											},
											{
												"isprivate": "0",
												"commentid": "15061494",
												"comment_count": "5",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2021-05-14 13:38:41 +0000",
												"thetext": "for the record, from my F-32 system (bare-metal Power9, not a VM) with kernel-5.11.19-100.fc32.ppc64le, strace built from master branch\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  905\n# SKIP:  97\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0"
											},
											{
												"isprivate": "0",
												"commentid": "15062263",
												"comment_count": "6",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2021-05-14 18:02:11 +0000",
												"thetext": "and I get these from a rawhide VM with kernel-5.13.0-0.rc1.20210512git88b06399c9c7.15.fc35.ppc64le\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  232\n# SKIP:  102\n# XFAIL: 0\n# FAIL:  668\n# XPASS: 0\n# ERROR: 0\n\n\nbut in F-32 VM with kernel kernel-5.11.19-100.fc32.ppc64le everything looks good\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  905\n# SKIP:  97\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0\n============================================================================\nand I get the same good result in the F-32 VM with kernel-5.12.3-300.fc34.ppc64le\n\nF-32 VM with kernel-5.13.0-0.rc1.20210512git88b06399c9c7.15.fc35.ppc64le then gives\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  901\n# SKIP:  101\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0\n============================================================================\n\n\nIt makes me think that the failures are not related to the kernel version, but to something else in the rawhide buildroot, perhaps glibc?"
											},
											{
												"isprivate": "0",
												"commentid": "15062268",
												"comment_count": "7",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2021-05-14 18:05:25 +0000",
												"thetext": "but kernel-headers-5.11.19-100.fc32.ppc64le was always used for the F-32 tests (if this should make the difference, will check ...)"
											},
											{
												"isprivate": "0",
												"commentid": "15062989",
												"comment_count": "8",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-05-15 01:03:06 +0000",
												"thetext": "(In reply to Dan Hork from comment #6)\n> It makes me think that the failures are not related to the kernel version,\n> but to something else in the rawhide buildroot, perhaps glibc?\n\nIf it's not the kernel but something else, then this something else is also capable of meddling both with struct ptrace_syscall_info returned by ptrace(PTRACE_GET_SYSCALL_INFO, pid, size, info) as described in the first comment, and with struct pt_regs returned by syscall(__NR_ptrace, PTRACE_GETREGSET, pid, NT_PRSTATUS, iov) in a very specific way described in #c4; in other words, this something is changing both ccr and gpr[3] in the kernel for all ptraced processes."
											},
											{
												"isprivate": "0",
												"commentid": "15074749",
												"comment_count": "9",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2021-05-18 14:05:24 +0000",
												"thetext": "after updating to glibc-2.33.9000-6.fc35 in my F-32 VM, where the tests were passing, I get now the failures\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  232\n# SKIP:  102\n# XFAIL: 0\n# FAIL:  668\n# XPASS: 0\n# ERROR: 0\n============================================================================"
											},
											{
												"isprivate": "0",
												"commentid": "15076721",
												"comment_count": "10",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2021-05-18 15:15:01 +0000",
												"thetext": "let's switch to glibc for their feedback ..."
											},
											{
												"isprivate": "0",
												"commentid": "15079009",
												"comment_count": "11",
												"who": {
													"text": "fweimer",
													"name": "Florian Weimer"
												},
												"bug_when": "2021-05-18 20:14:57 +0000",
												"thetext": "Is it possible to reproduce this issue with an already-built strace binary?\n\nWe added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to <sys/ptrace.h>, maybe that causes different execution paths in strace to be taken?"
											},
											{
												"isprivate": "0",
												"commentid": "15079018",
												"comment_count": "12",
												"who": {
													"text": "codonell",
													"name": "Carlos O'Donell"
												},
												"bug_when": "2021-05-18 20:19:39 +0000",
												"thetext": "(In reply to Florian Weimer from comment #11)\n> Is it possible to reproduce this issue with an already-built strace binary?\n> \n> We added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to\n> <sys/ptrace.h>, maybe that causes different execution paths in strace to be\n> taken?\n\nWe also have the 'sc' vs. 'svc' instruction selection in the same timeframe for power?"
											},
											{
												"isprivate": "0",
												"commentid": "15079022",
												"comment_count": "13",
												"who": {
													"text": "codonell",
													"name": "Carlos O'Donell"
												},
												"bug_when": "2021-05-18 20:20:48 +0000",
												"thetext": "(In reply to Carlos O'Donell from comment #12)\n> (In reply to Florian Weimer from comment #11)\n> > Is it possible to reproduce this issue with an already-built strace binary?\n> > \n> > We added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to\n> > <sys/ptrace.h>, maybe that causes different execution paths in strace to be\n> > taken?\n> \n> We also have the 'sc' vs. 'svc' instruction selection in the same timeframe\n> for power?\n\nSorry, 'scv'."
											},
											{
												"isprivate": "0",
												"commentid": "15079274",
												"comment_count": "14",
												"who": {
													"text": "codonell",
													"name": "Carlos O'Donell"
												},
												"bug_when": "2021-05-18 21:16:04 +0000",
												"thetext": "A recent scratch build failed on a POWER9 box, which would be the hardware under which glibc would switch to 'scv' for syscalls.\n\nJust two quick snippets:\n\n--- exp 2021-05-18 20:26:11.715277248 +0000\n+++ log 2021-05-18 20:26:11.715277248 +0000\n-chdir(0x7fffb053ffe0) = -1 EFAULT (Bad address)\n-chdir(0x7fffb053ffe1) = -1 EFAULT (Bad address)\n+chdir(0x7fffb053ffe0) = 18446744073709551602\n+chdir(0x7fffb053ffe1) = 18446744073709551602\nFAIL printpath-umovestr-legacy.test (exit status: 1)\nFAIL: printstrn-umoven-legacy\n\n--- exp 2021-05-18 20:26:44.524009554 +0000\n+++ log 2021-05-18 20:26:44.524009554 +0000\n@@ -1,2 +1,2 @@\n-writev(-1, [{iov_base=\"\", iov_len=0}, {iov_base=\"f\", iov_len=1}, {iov_base=\"ef\", iov_len=2}, {iov_base=\"def\", iov_len=3}, {iov_base=\"cdef\", iov_len=4}, {iov_base=\"bcdef\", iov_len=5}, {iov_base=\"abcdef\", iov_len=6}, {iov_base=\"zabcdef\", iov_len=7}, {iov_base=\"yzabcdef\", iov_len=8}, {iov_base=\"xyzabcdef\", iov_len=9}, {iov_base=\"wxyzabcdef\", iov_len=10}, {iov_base=\"vwxyzabcdef\", iov_len=11}, {iov_base=\"uvwxyzabcdef\", iov_len=12}, {iov_base=\"tuvwxyzabcdef\", iov_len=13}, {iov_base=\"stuvwxyzabcdef\", iov_len=14}, {iov_base=\"rstuvwxyzabcdef\", iov_len=15}, {iov_base=\"qrstuvwxyzabcdef\", iov_len=16}, {iov_base=\"pqrstuvwxyzabcdef\", iov_len=17}, {iov_base=\"opqrstuvwxyzabcdef\", iov_len=18}, {iov_base=\"nopqrstuvwxyzabcdef\", iov_len=19}, {iov_base=\"mnopqrstuvwxyzabcdef\", iov_len=20}, {iov_base=\"lmnopqrstuvwxyzabcdef\", iov_len=21}, {iov_base=\"klmnopqrstuvwxyzabcdef\", iov_len=22}, {iov_base=\"jklmnopqrstuvwxyzabcdef\", iov_len=23}, {iov_base=\"ijklmnopqrstuvwxyzabcdef\", iov_len=24}, {iov_base=\"hijklmnopqrstuvwxyzabcdef\", iov_len=25}, {iov_base=\"ghijklmnopqrstuvwxyzabcdef\", iov_len=26}, {iov_base=\"fghijklmnopqrstuvwxyzabcdef\", iov_len=27}, {iov_base=\"efghijklmnopqrstuvwxyzabcdef\", iov_len=28}, {iov_base=\"defghijklmnopqrstuvwxyzabcdef\", iov_len=29}, {iov_base=\"cdefghijklmnopqrstuvwxyzabcdef\", iov_len=30}, {iov_base=\"bcdefghijklmnopqrstuvwxyzabcdef\", iov_len=31}], 32) = -1 EBADF (Bad file descriptor)\n+writev(-1, [{iov_base=\"\", iov_len=0}, {iov_base=\"f\", iov_len=1}, {iov_base=\"ef\", iov_len=2}, {iov_base=\"def\", iov_len=3}, {iov_base=\"cdef\", iov_len=4}, {iov_base=\"bcdef\", iov_len=5}, {iov_base=\"abcdef\", iov_len=6}, {iov_base=\"zabcdef\", iov_len=7}, {iov_base=\"yzabcdef\", iov_len=8}, {iov_base=\"xyzabcdef\", iov_len=9}, {iov_base=\"wxyzabcdef\", iov_len=10}, {iov_base=\"vwxyzabcdef\", iov_len=11}, {iov_base=\"uvwxyzabcdef\", iov_len=12}, {iov_base=\"tuvwxyzabcdef\", iov_len=13}, {iov_base=\"stuvwxyzabcdef\", iov_len=14}, {iov_base=\"rstuvwxyzabcdef\", iov_len=15}, {iov_base=\"qrstuvwxyzabcdef\", iov_len=16}, {iov_base=\"pqrstuvwxyzabcdef\", iov_len=17}, {iov_base=\"opqrstuvwxyzabcdef\", iov_len=18}, {iov_base=\"nopqrstuvwxyzabcdef\", iov_len=19}, {iov_base=\"mnopqrstuvwxyzabcdef\", iov_len=20}, {iov_base=\"lmnopqrstuvwxyzabcdef\", iov_len=21}, {iov_base=\"klmnopqrstuvwxyzabcdef\", iov_len=22}, {iov_base=\"jklmnopqrstuvwxyzabcdef\", iov_len=23}, {iov_base=\"ijklmnopqrstuvwxyzabcdef\", iov_len=24}, {iov_base=\"hijklmnopqrstuvwxyzabcdef\", iov_len=25}, {iov_base=\"ghijklmnopqrstuvwxyzabcdef\", iov_len=26}, {iov_base=\"fghijklmnopqrstuvwxyzabcdef\", iov_len=27}, {iov_base=\"efghijklmnopqrstuvwxyzabcdef\", iov_len=28}, {iov_base=\"defghijklmnopqrstuvwxyzabcdef\", iov_len=29}, {iov_base=\"cdefghijklmnopqrstuvwxyzabcdef\", iov_len=30}, {iov_base=\"bcdefghijklmnopqrstuvwxyzabcdef\", iov_len=31}], 32) = 18446744073709551607\nFAIL umovestr_cached.test (exit status: 1)\n\nThe last successful strace build is with glibc-2.32.9000-20.fc34.ppc64le, which is ~4 builds before 'scv' is introduced.\n\nAll builds after 'scv' is introduced in glibc-2.32.9000-24 (2021-01-08) appear to fail.\n\nI don't see any 'scv' enablement in strace for ppc64le."
											},
											{
												"isprivate": "0",
												"commentid": "15079276",
												"comment_count": "15",
												"who": {
													"text": "tulioqm",
													"name": "Tulio Magno Quites Machado Filho"
												},
												"bug_when": "2021-05-18 21:18:21 +0000",
												"thetext": "(In reply to Carlos O'Donell from comment #14)\n> I don't see any 'scv' enablement in strace for ppc64le.\n\nI agree with you. strace upstream is missing support for scv.\ne.g. in this function https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\nWe can't trust on the value of CR0 anymore.  An error is returned when r3 is negative."
											},
											{
												"isprivate": "0",
												"commentid": "15079396",
												"comment_count": "16",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-05-18 22:40:03 +0000",
												"thetext": "(In reply to Tulio Magno Quites Machado Filho from comment #15)\n> (In reply to Carlos O'Donell from comment #14)\n> > I don't see any 'scv' enablement in strace for ppc64le.\n> \n> I agree with you. strace upstream is missing support for scv.\n> e.g. in this function\n> https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n> We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> negative.\n\nDoes this mean that the kernel function syscall_get_error and all its users including PTRACE_GET_SYSCALL_INFO API is broken when scv is used?"
											},
											{
												"isprivate": "0",
												"commentid": "15079417",
												"comment_count": "17",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-05-18 22:56:59 +0000",
												"thetext": "(In reply to Dmitry V. Levin from comment #16)\n> (In reply to Tulio Magno Quites Machado Filho from comment #15)\n> > (In reply to Carlos O'Donell from comment #14)\n> > > I don't see any 'scv' enablement in strace for ppc64le.\n> > \n> > I agree with you. strace upstream is missing support for scv.\n> > e.g. in this function\n> > https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n> > We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> > negative.\n> \n> Does this mean that the kernel function syscall_get_error and all its users\n> including PTRACE_GET_SYSCALL_INFO API are broken when scv is used?\n\nLooks like the answer is yes, the kernel commit v5.9-rc1~100^2~164 that introduced scv support was incomplete, all users of ccr in arch/powerpc/include/asm/ptrace.h and arch/powerpc/include/asm/syscall.h are broken when scv is used.\n\nSo while the idea of changing the error handling convention is questionable,\nthe bug is on the kernel side that failed to implement the new error handling convention."
											},
											{
												"isprivate": "0",
												"commentid": "15079459",
												"comment_count": "18",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-05-18 23:32:22 +0000",
												"thetext": "(In reply to Tulio Magno Quites Machado Filho from comment #15)\n> (In reply to Carlos O'Donell from comment #14)\n> > I don't see any 'scv' enablement in strace for ppc64le.\n> \n> I agree with you. strace upstream is missing support for scv.\n> e.g. in this function\n> https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n\nPlease note that this file is not used when PTRACE_GET_SYSCALL_INFO is working properly,\nthere is a runtime test for this, see\n\n$ strace -d -enone / 2>&1 |grep PTRACE_GET_SYSCALL_INFO\n\nHowever, there is going to be an issue with src/linux/powerpc/set_error.c and its users, e.g. syscall tampering.\n\n> We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> negative.\n\nI hope somebody who knows scv semantics would contribute missing parts of scv support to strace and the kernel before strace is kicked out from Fedora due to ftbfs."
											},
											{
												"isprivate": "0",
												"commentid": "15084949",
												"comment_count": "19",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-05-20 03:47:43 +0000",
												"thetext": "There was a short discussion in linux-api mailing list that identified two bugs:\n1. incomplete scv abi support in the kernel that breaks users of asm/syscall.h and asm/ptrace.h, these users include ptrace, tracing, and audit subsystems; detected by hundereds of tests from the strace test suite, proposed patch can be found at https://lore.kernel.org/linux-api/1621385544.nttlk5qugb.astroid@bobo.none/ ;\n2. a glibc bug detected by signal test from the strace test suite, proposed patch can be found at https://lore.kernel.org/linux-api/1621400263.gf0mbqhkrf.astroid@bobo.none/ .\n\nFeel free to split this bug report into two if necessary."
											},
											{
												"isprivate": "0",
												"commentid": "15088583",
												"comment_count": "20",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-05-20 23:06:30 +0000",
												"thetext": "Since the glibc bug is now tracked by #1962971, switching this bug back to the kernel component.\n\nMeanwhile, Nicholas Piggin submitted a patch that's likely to be the final, see\nhttps://lore.kernel.org/linuxppc-dev/20210520111931.2597127-2-npiggin@gmail.com/\n\nI'd like to remind that this bug was found by strace test suite and it blocks strace updates in Fedora.\n\nI hope the fix will be applied before strace is kicked out from Fedora due to ftbfs which is 19 weeks already."
											},
											{
												"isprivate": "0",
												"commentid": "15093123",
												"comment_count": "21",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-05-23 17:43:31 +0000",
												"thetext": "(In reply to Dmitry V. Levin from comment #20)\n> Meanwhile, Nicholas Piggin submitted a patch that's likely to be the final,\n> see\n> https://lore.kernel.org/linuxppc-dev/20210520111931.2597127-2-npiggin@gmail.\n> com/\n\nThis patch has been merged upstream, see\nhttps://git.kernel.org/torvalds/c/d72500f992849d31ebae8f821a023660ddd0dcc2"
											},
											{
												"isprivate": "0",
												"commentid": "15095587",
												"comment_count": "22",
												"who": {
													"text": "jforbes",
													"name": "Justin M. Forbes"
												},
												"bug_when": "2021-05-24 14:19:12 +0000",
												"thetext": "That should be in the 5.13-rc3 build today for rawhide. I have also cherry picked it for 5.12, so it should land in stable fedora with 5.12.7 and newer."
											},
											{
												"isprivate": "0",
												"commentid": "15185392",
												"comment_count": "23",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2021-06-14 15:35:34 +0000",
												"thetext": "Dmitry, is there still something blocking you from updating strace? I believe we already have all the kernel/glibc bits included for F-34+."
											},
											{
												"isprivate": "0",
												"commentid": "15195017",
												"comment_count": "24",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-06-16 12:06:57 +0000",
												"thetext": "Everything should have been fixed now, but I cannot tell for sure because something else is broken: a scratch build of strace HEAD failed with the following diagnostics: BuildrootError: could not init mock buildroot, mock exited with status 30; see root.log for more information\n\nThe corresponding root.log contains the following diagnostics:\nDEBUG util.py:444:  Error: \nDEBUG util.py:444:   Problem: package util-linux-2.37-2.fc35.x86_64 requires util-linux-core = 2.37-2.fc35, but none of the providers can be installed\nDEBUG util.py:444:    - conflicting requests\nDEBUG util.py:444:    - nothing provides libpcre2-posix.so.2()(64bit) needed by util-linux-core-2.37-2.fc35.x86_64\nDEBUG util.py:446:  (try to add '--skip-broken' to skip uninstallable packages)\nDEBUG util.py:598:  Child return code was: 1\n\nThis looks as if all builds to fc35 are currently broken.\nFor more details see the scratch build task: https://koji.fedoraproject.org/koji/taskinfo?taskID=70224999"
											},
											{
												"isprivate": "0",
												"commentid": "15195062",
												"comment_count": "25",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2021-06-16 12:17:33 +0000",
												"thetext": "The buildroot should be OK again, there was a pcre2 update with unexpected consequences, but it has been untagged."
											},
											{
												"isprivate": "0",
												"commentid": "15195850",
												"comment_count": "26",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2021-06-16 14:59:25 +0000",
												"thetext": "for the record, my local F-34 rebuild of strace HEAD with kernel-5.12.10-300.fc34.ppc64le and glibc-2.33-16.fc34.ppc64le was successful"
											},
											{
												"isprivate": "0",
												"commentid": "15197009",
												"comment_count": "27",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-06-16 23:19:42 +0000",
												"thetext": "(In reply to Dan Hork from comment #26)\n> for the record, my local F-34 rebuild of strace HEAD with\n> kernel-5.12.10-300.fc34.ppc64le and glibc-2.33-16.fc34.ppc64le was successful\n\nMy scratch build to fc34 was successful, too:\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=70227524"
											},
											{
												"isprivate": "0",
												"commentid": "16610110",
												"comment_count": "28",
												"who": {
													"text": "mcermak",
													"name": "Martin Cermak"
												},
												"bug_when": "2022-09-05 08:05:57 +0000",
												"thetext": "Maybe this one could be flipped to MODIFIED or further?  Thanks!"
											},
											{
												"isprivate": "0",
												"commentid": "16610124",
												"comment_count": "29",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2022-09-05 08:10:08 +0000",
												"thetext": "It was fixed long time ago, closing."
											}
										]
									},
									{
										"bug_id": "1962971",
										"creation_ts": "2021-05-20 22:54:06 +0000",
										"short_desc": "glibc: ppc64le: scv ABI error handling fails to check IS_ERR_VALUE",
										"delta_ts": "2021-07-06 13:32:49 +0000",
										"bug_status": "CLOSED",
										"resolution": "ERRATA",
										"keywords": "BetaBlocker",
										"priority": "unspecified",
										"bug_severity": "urgent",
										"depends_on": [
											"1071880"
										],
										"blocked": [
											{
												"bug_id": "1930252",
												"error": "NotPermitted"
											},
											{
												"bug_id": "1963901",
												"creation_ts": "2021-05-24 11:10:27 +0000",
												"short_desc": "RHEL9 - ppc64le: glibc fails to check IS_ERR_VALUE when using scv",
												"delta_ts": "2023-07-18 14:29:19 +0000",
												"bug_status": "CLOSED",
												"resolution": "CURRENTRELEASE",
												"keywords": "Bugfix, Patch, Triaged",
												"priority": "unspecified",
												"bug_severity": "high",
												"depends_on": [
													"1962971"
												],
												"blocked": [
													{
														"bug_id": "1875375",
														"error": "NotPermitted"
													}
												],
												"external_bugs": {
													"text": "27892",
													"name": "Sourceware"
												},
												"long_desc": [
													{
														"isprivate": "0",
														"commentid": "15094789",
														"comment_count": "0",
														"who": {
															"text": "bugproxy",
															"name": "IBM Bug Proxy"
														},
														"bug_when": "2021-05-24 11:10:27 +0000"
													},
													{
														"isprivate": "0",
														"commentid": "15094790",
														"comment_count": "1",
														"who": {
															"text": "bugproxy",
															"name": "IBM Bug Proxy"
														},
														"bug_when": "2021-05-24 11:10:35 +0000",
														"thetext": "== Comment: #0 - Tulio Magno Quites Machado Filho <tulioqm@br.ibm.com> - 2021-05-21 16:11:35 ==\n---Problem Description---\nglibc fails to check IS_ERR_VALUE when using scv.\n\nThis bug has been reported upstream as: https://sourceware.org/bugzilla/show_bug.cgi?id=27892\n\nIt has also been reported for Fedora 35: https://bugzilla.redhat.com/show_bug.cgi?id=1962971\n \nContact Information = Tulio Magno Quites Machado Filho/tulioqm@br.ibm.com \n \n---Additional Hardware Info---\nA POWER9 or POWER10 server with support for scv is required to reproduce the error.\n\n\n---Steps to Reproduce---\n 1. Build strace and its tests.\n 2. Run test tests/signal\n \nUserspace rpm: glibc \n \nThe userspace tool has the following bit modes: 64-bit"
													},
													{
														"isprivate": "0",
														"commentid": "15103462",
														"comment_count": "6",
														"who": {
															"text": "fweimer",
															"name": "Florian Weimer"
														},
														"bug_when": "2021-05-25 17:37:12 +0000",
														"thetext": "Merge request: https://gitlab.com/redhat/centos-stream/rpms/glibc/-/merge_requests/11"
													},
													{
														"isprivate": "0",
														"commentid": "15103633",
														"comment_count": "7",
														"who": {
															"text": "bugproxy",
															"name": "IBM Bug Proxy"
														},
														"bug_when": "2021-05-25 17:47:07 +0000",
														"thetext": "------- Comment From tulioqm@br.ibm.com 2021-05-24 10:12 EDT-------\n> May we make this bug report public? Thanks.\n\nYes, but I don't know how to do this.\nCould you help me, please?"
													}
												]
											}
										],
										"external_bugs": {
											"text": "27892",
											"name": "Sourceware"
										},
										"long_desc": [
											{
												"isprivate": "0",
												"commentid": "15088572",
												"comment_count": "0",
												"who": {
													"text": "ldv",
													"name": "Dmitry V. Levin"
												},
												"bug_when": "2021-05-20 22:54:06 +0000",
												"thetext": "+++ This bug was initially created as a clone of Bug #1929836 +++\n\nThe scv ABI introduced by glibc-2.32.9000-24 at 2021-01-08 has the following bug: RET_SCV macro (added by upstream commit glibc-2.33~117) treats any negative value returned by syscall via scv ABI as an error, but this is not correct.\n\nProposed fix was posted by Nicholas Piggin at\nhttps://sourceware.org/pipermail/libc-alpha/2021-May/126534.html\n\nThis bug was found by strace test suite and it blocks strace updates in Fedora.\n\nI hope the fix will be applied before strace is kicked out from Fedora due to ftbfs which is 19 weeks already."
											},
											{
												"isprivate": "0",
												"commentid": "15138481",
												"comment_count": "1",
												"who": {
													"text": "updates",
													"name": "Fedora Update System"
												},
												"bug_when": "2021-06-01 13:46:20 +0000",
												"thetext": "FEDORA-2021-abbb0d8a88 has been submitted as an update to Fedora 34. https://bodhi.fedoraproject.org/updates/FEDORA-2021-abbb0d8a88"
											},
											{
												"isprivate": "0",
												"commentid": "15138487",
												"comment_count": "2",
												"who": {
													"text": "codonell",
													"name": "Carlos O'Donell"
												},
												"bug_when": "2021-06-01 13:47:36 +0000",
												"thetext": "This fix is currently pending the Fedora Rawhide sync with the upstream development branch.\n\nThe fix is going into Fedora 34 with the next errata going through bodhi."
											},
											{
												"isprivate": "0",
												"commentid": "15140578",
												"comment_count": "3",
												"who": {
													"text": "updates",
													"name": "Fedora Update System"
												},
												"bug_when": "2021-06-02 01:41:09 +0000",
												"thetext": "FEDORA-2021-abbb0d8a88 has been pushed to the Fedora 34 testing repository.\nSoon you'll be able to install the update with the following command:\n`sudo dnf upgrade --enablerepo=updates-testing --advisory=FEDORA-2021-abbb0d8a88`\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2021-abbb0d8a88\n\nSee also https://fedoraproject.org/wiki/QA:Updates_Testing for more information on how to test updates."
											},
											{
												"isprivate": "0",
												"commentid": "15144856",
												"comment_count": "4",
												"who": {
													"text": "updates",
													"name": "Fedora Update System"
												},
												"bug_when": "2021-06-03 01:01:07 +0000",
												"thetext": "FEDORA-2021-abbb0d8a88 has been pushed to the Fedora 34 stable repository.\nIf problem still persists, please make note of it in this bug report."
											},
											{
												"isprivate": "0",
												"commentid": "15194139",
												"comment_count": "5",
												"who": {
													"text": "updates",
													"name": "Fedora Update System"
												},
												"bug_when": "2021-06-16 08:27:59 +0000",
												"thetext": "FEDORA-2021-9ce0f65a09 has been pushed to the Fedora 35 stable repository.\nIf problem still persists, please make note of it in this bug report."
											}
										]
									}
								],
								"long_desc": [
									{
										"isprivate": "0",
										"commentid": "6873212",
										"comment_count": "0",
										"who": {
											"text": "karsten",
											"name": "Karsten Hopp"
										},
										"bug_when": "2014-03-03 11:41:52 +0000",
										"thetext": "Description of problem:\nThis is a tracker for bugzillas and patches related to the PowerPC (ppc, ppc64) architectures.\n\nppc64le has its own tracker: bug 1051573"
									},
									{
										"isprivate": "0",
										"commentid": "10293511",
										"comment_count": "1",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-03-31 08:51:19 +0000",
										"thetext": "*** Bug 1051573 has been marked as a duplicate of this bug. ***"
									},
									{
										"isprivate": "0",
										"commentid": "10293516",
										"comment_count": "2",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-03-31 08:52:39 +0000",
										"thetext": "add open bugs from the ppc64le tracker"
									},
									{
										"isprivate": "0",
										"commentid": "13402189",
										"comment_count": "3",
										"who": {
											"text": "bcotton",
											"name": "Ben Cotton"
										},
										"bug_when": "2019-11-27 14:16:33 +0000",
										"thetext": "Fedora 29 changed to end-of-life (EOL) status on 2019-11-26. Fedora 29 is\nno longer maintained, which means that it will not receive any further\nsecurity or bug fix updates. As a result we are closing this bug.\n\nIf you can reproduce this bug against a currently maintained version of\nFedora please feel free to reopen this bug against that version. If you\nare unable to reopen this bug, please file a new report against the\ncurrent release. If you experience problems, please add a comment to this\nbug.\n\nThank you for reporting this bug and we are sorry it could not be fixed."
									},
									{
										"isprivate": "0",
										"commentid": "13403192",
										"comment_count": "4",
										"who": {
											"text": "bcotton",
											"name": "Ben Cotton"
										},
										"bug_when": "2019-11-27 16:41:04 +0000",
										"thetext": "This bug was accidentally closed due to a query error. Reopening."
									}
								]
							},
							{
								"bug_id": "1430829",
								"alias": "F26PPCBeta",
								"creation_ts": "2017-03-09 16:33:28 +0000",
								"short_desc": "F26 PPC Beta Blocker Tracker",
								"delta_ts": "2017-12-04 11:21:20 +0000",
								"bug_status": "CLOSED",
								"resolution": "CURRENTRELEASE",
								"keywords": "Tracking",
								"priority": "unspecified",
								"bug_severity": "unspecified",
								"depends_on": [
									"1439051",
									"1443415",
									"1447276",
									"1447777",
									"1447924",
									"1450755"
								],
								"blocked": [
									{
										"bug_id": "1071880",
										"alias": "PPCTracker",
										"creation_ts": "2014-03-03 11:41:52 +0000",
										"short_desc": "(PPCTracker) Fedora for PowerPC architectures (ppc64,ppc64le): Bug Tracker",
										"delta_ts": "2024-07-04 11:18:17 +0000",
										"bug_status": "ASSIGNED",
										"keywords": "Tracking",
										"priority": "medium",
										"bug_severity": "medium",
										"depends_on": [
											"238953",
											"1266508",
											"1562071",
											"1817976",
											"1909065",
											"1960848",
											"2209760",
											"2212765",
											"2240371",
											"2273668",
											"2293597",
											"2293909",
											"2294180",
											"179260",
											"468831",
											"810582",
											"834619",
											"864392",
											"968359",
											"990749",
											"999069",
											"1015497",
											"1035541",
											"1049976",
											"1058258",
											"1058289",
											"1058686",
											"1059234",
											"1059816",
											"1067470",
											"1070183",
											"1070206",
											"1070380",
											"1070892",
											"1071278",
											"1071284",
											"1071527",
											"1071845",
											"1079673",
											"1085127",
											"1085704",
											"1088339",
											"1090452",
											"1091538",
											"1093163",
											"1094513",
											"1094975",
											"1097109",
											"1097111",
											"1098151",
											"1100762",
											"1101996",
											"1104215",
											"1104279",
											"1104603",
											"1105552",
											"1108103",
											"1110892",
											"1111453",
											"1114240",
											"1122406",
											"1125883",
											"1128663",
											"1130079",
											"1132488",
											"1134566",
											"1136388",
											"1136532",
											"1136535",
											"1136544",
											"1140057",
											"1140189",
											"1143912",
											"1149159",
											"1149702",
											"1149704",
											"1151853",
											"1155291",
											"1155660",
											"1156300",
											"1158522",
											"1160429",
											"1160916",
											"1161098",
											"1161119",
											"1161152",
											"1161585",
											"1162245",
											"1162904",
											"1162914",
											"1164209",
											"1164221",
											"1165638",
											"1166474",
											"1166489",
											"1168634",
											"1172791",
											"1174607",
											"1175526",
											"1182677",
											"1185298",
											"1194704",
											"1195065",
											"1195663",
											"1196994",
											"1197007",
											"1197165",
											"1197721",
											"1197772",
											"1199041",
											"1201219",
											"1202876",
											"1204876",
											"1205359",
											"1206060",
											"1206161",
											"1208412",
											"1210003",
											"1211616",
											"1211638",
											"1212328",
											"1212472",
											"1214950",
											"1220294",
											"1220866",
											"1221689",
											"1223869",
											"1225035",
											"1225487",
											"1226316",
											"1228102",
											"1230233",
											"1232158",
											"1232650",
											"1232739",
											"1234277",
											"1234284",
											"1235709",
											"1235999",
											"1237089",
											"1238168",
											"1241214",
											"1247047",
											"1247567",
											"1247925",
											"1251120",
											"1251422",
											"1251520",
											"1251972",
											"1252074",
											"1252899",
											"1252905",
											"1252975",
											"1253763",
											"1254606",
											"1255074",
											"1255135",
											"1255682",
											"1256839",
											"1257201",
											"1257966",
											"1260297",
											"1261541",
											"1262402",
											"1262441",
											"1262444",
											"1264504",
											"1264912",
											"1265546",
											"1265674",
											"1267269",
											"1268789",
											"1269811",
											"1271230",
											"1273103",
											"1274974",
											"1275229",
											"1275619",
											"1276061",
											"1276959",
											"1277142",
											"1278066",
											"1278135",
											"1278428",
											"1281446",
											"1281764",
											"1284527",
											"1285786",
											"1286149",
											"1286249",
											"1286625",
											"1287015",
											"1287105",
											"1288561",
											"1289106",
											"1289940",
											"1290958",
											"1291565",
											"1292461",
											"1292462",
											"1292467",
											"1292969",
											"1294016",
											"1295350",
											"1296842",
											"1297387",
											"1297855",
											"1297894",
											"1299151",
											"1299193",
											"1299226",
											"1299599",
											"1300900",
											"1302224",
											"1303219",
											"1303223",
											"1304402",
											"1305512",
											"1305725",
											"1306214",
											"1308252",
											"1308424",
											"1309225",
											"1310495",
											"1311685",
											"1312018",
											"1312339",
											"1315225",
											"1315903",
											"1316840",
											"1319063",
											"1321113",
											"1322696",
											"1323193",
											"1324085",
											"1325114",
											"1325126",
											"1325858",
											"1326250",
											"1326366",
											"1328455",
											"1330098",
											"1330102",
											"1330108",
											"1330161",
											"1330174",
											"1331726",
											"1332146",
											"1332150",
											"1332449",
											"1332978",
											"1333344",
											"1333695",
											"1334125",
											"1334212",
											"1334315",
											"1334320",
											"1335162",
											"1335823",
											"1336466",
											"1340736",
											"1340829",
											"1341090",
											"1342146",
											"1342561",
											"1344636",
											"1345826",
											"1349945",
											"1350486",
											"1351737",
											"1351971",
											"1356152",
											"1356189",
											"1359680",
											"1361037",
											"1365739",
											"1365851",
											"1365862",
											"1365940",
											"1366328",
											"1368495",
											"1368932",
											"1369162",
											"1369169",
											"1371894",
											"1373576",
											"1374380",
											"1374382",
											"1374749",
											"1375942",
											"1377201",
											"1377395",
											"1378359",
											"1379123",
											"1380643",
											"1381206",
											"1383912",
											"1386180",
											"1387107",
											"1387601",
											"1388453",
											"1388561",
											"1389957",
											"1391932",
											"1392264",
											"1392340",
											"1392465",
											"1392478",
											"1392479",
											"1392848",
											"1392854",
											"1392887",
											"1392922",
											"1393834",
											"1396814",
											"1398322",
											"1398575",
											"1400476",
											"1401220",
											"1401707",
											"1402256",
											"1403216",
											"1403760",
											"1404305",
											"1409636",
											"1410774",
											"1410784",
											"1412274",
											"1412926",
											"1414489",
											"1417244",
											"1419355",
											"1420350",
											"1420753",
											"1426796",
											"1428310",
											"1429575",
											"1430827",
											"1430829",
											"1430830",
											"1433859",
											"1434007",
											"1434276",
											"1435154",
											"1435585",
											"1435953",
											"1437793",
											"1439051",
											"1439141",
											"1440047",
											"1440843",
											"1443415",
											"1447276",
											"1447777",
											"1447924",
											"1449582",
											"1450755",
											"1451115",
											"1451143",
											"1452813",
											"1455299",
											"1460003",
											"1461708",
											"1461775",
											"1463749",
											"1464115",
											"1465159",
											"1465171",
											"1465174",
											"1465176",
											"1465657",
											"1467647",
											"1470692",
											"1471785",
											"1472375",
											"1474744",
											"1475636",
											"1476380",
											"1481163",
											"1481611",
											"1482382",
											"1482447",
											"1484149",
											"1484151",
											"1484320",
											"1484474",
											"1484579",
											"1485690",
											"1486737",
											"1487787",
											"1491093",
											"1491751",
											"1494542",
											"1497720",
											"1498561",
											"1498922",
											"1501936",
											"1502009",
											"1512229",
											"1515934",
											"1516213",
											"1518707",
											"1524376",
											"1527692",
											"1528378",
											"1538300",
											"1538817",
											"1540995",
											"1541319",
											"1541613",
											"1544349",
											"1544833",
											"1546693",
											"1546743",
											"1547049",
											"1547467",
											"1548001",
											"1548425",
											"1548671",
											"1552648",
											"1552650",
											"1552653",
											"1552724",
											"1553626",
											"1553794",
											"1554345",
											"1556989",
											"1561011",
											"1562059",
											"1562061",
											"1562073",
											"1563466",
											"1565693",
											"1566066",
											"1566151",
											"1566225",
											"1569045",
											"1570256",
											"1571205",
											"1571860",
											"1572540",
											"1573538",
											"1574604",
											"1577587",
											"1578429",
											"1579708",
											"1585991",
											"1588130",
											"1588734",
											"1588774",
											"1591701",
											"1601259",
											"1605125",
											"1609208",
											"1609513",
											"1612490",
											"1612601",
											"1614948",
											"1619601",
											"1619690",
											"1624915",
											"1626057",
											"1628394",
											"1628540",
											"1631093",
											"1631759",
											"1633565",
											"1643729",
											"1647947",
											"1659239",
											"1660807",
											"1666298",
											"1668751",
											"1669055",
											"1669235",
											"1669256",
											"1675014",
											"1675573",
											"1676411",
											"1676475",
											"1679074",
											"1680040",
											"1687369",
											"1687882",
											"1689037",
											"1689819",
											"1691016",
											"1691487",
											"1691832",
											"1693676",
											"1713090",
											"1714489",
											"1719378",
											"1722181",
											"1723425",
											"1724800",
											"1725924",
											"1726444",
											"1730843",
											"1732612",
											"1733118",
											"1733673",
											"1733926",
											"1736762",
											"1737581",
											"1737587",
											"1738752",
											"1741266",
											"1745841",
											"1746405",
											"1746852",
											"1749729",
											"1756650",
											"1756838",
											"1757249",
											"1757250",
											"1757548",
											"1758225",
											"1762709",
											"1764666",
											"1766519",
											"1768551",
											"1769324",
											"1769445",
											"1769600",
											"1771031",
											"1772935",
											"1774507",
											"1777345",
											"1779589",
											"1782919",
											"1784961",
											"1789199",
											"1789854",
											"1790436",
											"1795575",
											"1798908",
											"1803351",
											"1816527",
											"1817004",
											"1817773",
											"1817959",
											"1820619",
											"1824208",
											"1825287",
											"1827397",
											"1838565",
											"1853217",
											"1856283",
											"1860811",
											"1860932",
											"1863685",
											"1864181",
											"1869980",
											"1870213",
											"1886303",
											"1894654",
											"1897661",
											"1899841",
											"1913493",
											"1915266",
											"1921479",
											"1921485",
											"1923654",
											"1933742",
											"1933794",
											"1934063",
											"1934065",
											"1937684",
											"1939775",
											"1941652",
											"1943729",
											"1948576",
											"1959353",
											"1965610",
											"1966347",
											"1987280",
											"1987972",
											"1989412",
											"1994599",
											"1996330",
											"1999118",
											"2022035",
											"2027889",
											"2030308",
											"2040887",
											"2041573",
											"2043517",
											"2044054",
											"2045152",
											"2045160",
											"2045186",
											"2045189",
											"2045310",
											"2045367",
											"2045456",
											"2045714",
											"2045780",
											"2045797",
											"2046802",
											"2046865",
											"2046907",
											"2048910",
											"2049371",
											"2056459",
											"2061022",
											"2064025",
											"2081451",
											"2095750",
											"2096956",
											"2100546",
											"2102907",
											"2109095",
											"2109120",
											"2112825",
											"2113609",
											"2115752",
											"2124845",
											"2131287",
											"2140618",
											"2142739",
											"2143393",
											"2154939",
											"2160760",
											"2162999",
											"2164029",
											"2173015",
											"2177410",
											"2177691",
											"2209435",
											"2212748",
											"2218314",
											"2221314",
											"2264712",
											"2275090"
										],
										"blocked": [
											{
												"bug_id": "2171964",
												"creation_ts": "2023-02-21 02:32:53 +0000",
												"short_desc": "ICE / segfault in process_function_and_variable_attributes() when building tokodon on ppc64le",
												"delta_ts": "2023-08-16 07:10:03 +0000",
												"bug_status": "NEW",
												"priority": "unspecified",
												"bug_severity": "unspecified",
												"depends_on": [
													"1071880"
												],
												"external_bugs": {
													"text": "108887",
													"name": "GNU Compiler Collection"
												},
												"long_desc": [
													{
														"isprivate": "0",
														"commentid": "17062382",
														"comment_count": "0",
														"who": {
															"text": "justin.zobel",
															"name": "Justin Zobel"
														},
														"bug_when": "2023-02-21 02:32:53 +0000",
														"thetext": "Build has failed only on ppc64le 4 times now, one build example https://koji.fedoraproject.org/koji/taskinfo?taskID=97784827\n\nUpstream has stated they will not support ppc64le.\n\nAdding ExcludeArch until this can be fixed."
													},
													{
														"isprivate": "0",
														"commentid": "17062632",
														"comment_count": "1",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2023-02-21 07:07:45 +0000",
														"thetext": "This is a gcc internal error, probably gcc13 related, I will try to get the details and switch the bug to gcc."
													},
													{
														"isprivate": "0",
														"commentid": "17062697",
														"comment_count": "2",
														"who": {
															"text": "justin.zobel",
															"name": "Justin Zobel"
														},
														"bug_when": "2023-02-21 07:29:45 +0000",
														"thetext": "Thanks Dan much appreciated!"
													},
													{
														"isprivate": "0",
														"commentid": "17062752",
														"comment_count": "3",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2023-02-21 08:04:58 +0000",
														"thetext": "(gdb) run\nStarting program: /usr/bin/g++ -DHAVE_KIO -DKCOREADDONS_LIB -DQT_CONCURRENT_LIB -DQT_CORE_LIB -DQT_DBUS_LIB -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_NO_DEBUG -DQT_NO_FOREACH -DQT_NO_KEYWORDS -DQT_QMLMODELS_LIB -DQT_QML_LIB -DQT_QUICKCONTROLS2_LIB -DQT_QUICK_LIB -DQT_WEBSOCKETS_LIB -DQT_WIDGETS_LIB -DQT_XML_LIB -D_GNU_SOURCE -D_LARGEFILE64_SOURCE -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src -I/home/sharkcz/tokodon/tokodon-23.02.0/src -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src/tokodon_static_autogen/include -isystem /usr/include/qt5 -isystem /usr/include/qt5/QtQuick -isystem /usr/include/qt5/QtQmlModels -isystem /usr/include/qt5/QtQml -isystem /usr/include/qt5/QtNetwork -isystem /usr/include/qt5/QtCore -isystem /usr/lib64/qt5/mkspecs/linux-g++ -isystem /usr/include/qt5/QtGui -isystem /usr/include/qt5/QtWebSockets -isystem /usr/include/qt5/QtQuickControls2 -isystem /usr/include/KF5/KI18n -isystem /usr/include/KF5 -isystem /usr/include/KF5/Kirigami2 -isystem /usr/include/KF5/KNotifications -isystem /usr/include/qt5/QtWidgets -isystem /usr/include/qt5/QtDBus -isystem /usr/include/KF5/KConfig -isystem /usr/include/KF5/KConfigCore -isystem /usr/include/KF5/KConfigGui -isystem /usr/include/qt5/QtXml -isystem /usr/include/KF5/KCoreAddons -isystem /usr/include/KF5/KIOWidgets -isystem /usr/include/KF5/KIOGui -isystem /usr/include/KF5/KIOCore -isystem /usr/include/KF5/KIO -isystem /usr/include/KF5/KService -isystem /usr/include/qt5/QtConcurrent -isystem /usr/include/KF5/KWindowSystem -isystem /usr/include/KF5/KJobWidgets -isystem /usr/include/KF5/Solid -isystem /usr/include/KF5/KCompletion -isystem /usr/include/KF5/KWidgetsAddons -isystem /usr/include/KF5/KConfigWidgets -isystem /usr/include/KF5/KCodecs -isystem /usr/include/KF5/KAuthWidgets -isystem /usr/include/KF5/KAuthCore -isystem /usr/include/KF5/KAuth -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-U_FORTIFY_SOURCE,-D_FORTIFY_SOURCE=3 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -fstack-protector-strong -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mcpu=power8 -mtune=power8 -fasynchronous-unwind-tables -fstack-clash-protection -fno-operator-names -fno-exceptions -Wall -Wextra -Wcast-align -Wchar-subscripts -Wformat-security -Wno-long-long -Wpointer-arith -Wundef -Wnon-virtual-dtor -Woverloaded-virtual -Werror=return-type -Werror=init-self -Wvla -Wdate-time -Wsuggest-override -Wlogical-op -DNDEBUG -std=gnu++17 -fvisibility=hidden -fvisibility-inlines-hidden -fPIC -MD -MT src/CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -MF CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o.d -o CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -c /home/sharkcz/tokodon/tokodon-23.02.0/src/linkpaginatedtimelinemodel.cpp\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n[Attaching after Thread 0x7ffff7ff34e0 (LWP 18708) vfork to child process 18710]\n[New inferior 2 (process 18710)]\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n[Detaching vfork parent process 18708 after child exec]\n[Inferior 1 (process 18708) detached]\nprocess 18710 is executing new program: /usr/libexec/gcc/ppc64le-redhat-linux/13/cc1plus\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n\nThread 2.1 \"cc1plus\" received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7ffff7ff53c0 (LWP 18710)]\nprocess_function_and_variable_attributes (first_var=0x7fffdc638a00, first=0x7fffdc539900) at ../../gcc/cgraphunit.cc:861\nDownloading 0.02 MB source file /usr/src/debug/gcc-13.0.1-0.4.fc39.ppc64le/obj-ppc64le-redhat-linux/gcc/../../gcc/cgraphunit.cc\n861\t      tree decl = node->decl;\n(gdb) cont\nContinuing.\n\nThread 2.1 \"cc1plus\" hit Breakpoint 1, 0x0000000010747e9c in internal_error (gmsgid=0x11927bf8 \"%s\") at ../../gcc/diagnostic.cc:2138\n2138\t{\n(gdb) bt\n#0  0x0000000010747e9c in internal_error (gmsgid=0x11927bf8 \"%s\") at ../../gcc/diagnostic.cc:2138\n#1  0x00000000103f7a5c in crash_signal (signo=11) at ../../gcc/toplev.cc:317\n#2  <signal handler called>\n#3  process_function_and_variable_attributes (first_var=0x7fffdc638a00, first=0x7fffdc539900) at ../../gcc/cgraphunit.cc:861\n#4  analyze_functions (first_time=first_time@entry=true) at ../../gcc/cgraphunit.cc:1181\n#5  0x00000000112bf628 in symbol_table::finalize_compilation_unit (this=0x7fffe8080000) at ../../gcc/cgraphunit.cc:2545\n#6  0x000000001125c410 in compile_file () at ../../gcc/toplev.cc:474\n#7  0x00000000111dd510 in do_compile (no_backend=<optimized out>) at ../../gcc/toplev.cc:2128\n#8  toplev::main (this=this@entry=0x7fffffffca00, argc=<optimized out>, argv=<optimized out>) at ../../gcc/toplev.cc:2282\n#9  0x00000000111dc5d0 in main (argc=<optimized out>, argv=<optimized out>) at ../../gcc/main.cc:39"
													},
													{
														"isprivate": "0",
														"commentid": "17062753",
														"comment_count": "4",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2023-02-21 08:05:48 +0000",
														"thetext": "Created attachment 1945415\npreprocessed sources"
													},
													{
														"isprivate": "0",
														"commentid": "17062834",
														"comment_count": "5",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2023-02-21 08:22:23 +0000",
														"thetext": "reduced g++ command line with only defines or include paths still reproducing the issue is\n\n/usr/bin/g++ -DHAVE_KIO -DKCOREADDONS_LIB -DQT_CONCURRENT_LIB -DQT_CORE_LIB -DQT_DBUS_LIB -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_NO_DEBUG -DQT_NO_FOREACH -DQT_NO_KEYWORDS -DQT_QMLMODELS_LIB -DQT_QML_LIB -DQT_QUICKCONTROLS2_LIB -DQT_QUICK_LIB -DQT_WEBSOCKETS_LIB -DQT_WIDGETS_LIB -DQT_XML_LIB -D_GNU_SOURCE -D_LARGEFILE64_SOURCE -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src -I/home/sharkcz/tokodon/tokodon-23.02.0/src -I/home/sharkcz/tokodon/tokodon-23.02.0/redhat-linux-build/src/tokodon_static_autogen/include -isystem /usr/include/qt5 -isystem /usr/include/qt5/QtQuick -isystem /usr/include/qt5/QtQmlModels -isystem /usr/include/qt5/QtQml -isystem /usr/include/qt5/QtNetwork -isystem /usr/include/qt5/QtCore -isystem /usr/lib64/qt5/mkspecs/linux-g++ -isystem /usr/include/qt5/QtGui -isystem /usr/include/qt5/QtWebSockets -isystem /usr/include/qt5/QtQuickControls2 -isystem /usr/include/KF5/KI18n -isystem /usr/include/KF5 -isystem /usr/include/KF5/Kirigami2 -isystem /usr/include/KF5/KNotifications -isystem /usr/include/qt5/QtWidgets -isystem /usr/include/qt5/QtDBus -isystem /usr/include/KF5/KConfig -isystem /usr/include/KF5/KConfigCore -isystem /usr/include/KF5/KConfigGui -isystem /usr/include/qt5/QtXml -isystem /usr/include/KF5/KCoreAddons -isystem /usr/include/KF5/KIOWidgets -isystem /usr/include/KF5/KIOGui -isystem /usr/include/KF5/KIOCore -isystem /usr/include/KF5/KIO -isystem /usr/include/KF5/KService -isystem /usr/include/qt5/QtConcurrent -isystem /usr/include/KF5/KWindowSystem -isystem /usr/include/KF5/KJobWidgets -isystem /usr/include/KF5/Solid -isystem /usr/include/KF5/KCompletion -isystem /usr/include/KF5/KWidgetsAddons -isystem /usr/include/KF5/KConfigWidgets -isystem /usr/include/KF5/KCodecs -isystem /usr/include/KF5/KAuthWidgets -isystem /usr/include/KF5/KAuthCore -isystem /usr/include/KF5/KAuth -O2 -pipe -m64 -mcpu=power8 -mtune=power8 -fPIC -o CMakeFiles/tokodon_static.dir/linkpaginatedtimelinemodel.cpp.o -c /home/sharkcz/tokodon/tokodon-23.02.0/src/linkpaginatedtimelinemodel.cpp"
													},
													{
														"isprivate": "0",
														"commentid": "17065288",
														"comment_count": "6",
														"who": {
															"text": "jakub",
															"name": "Jakub Jelinek"
														},
														"bug_when": "2023-02-21 21:14:20 +0000",
														"thetext": "cvise reduced to -std=gnu++17 -O2 -mcpu=power8:\n\ntemplate <int __v> struct integral_constant {\n  static constexpr int value = __v;\n};\nusing false_type = integral_constant<false>;\ntemplate <bool, bool, typename...> struct __result_of_impl;\ntemplate <typename _Functor, typename... _ArgTypes>\nstruct __result_of_impl<false, false, _Functor, _ArgTypes...> {\n  typedef decltype(0) type;\n};\ntemplate <typename... _ArgTypes>\nstruct __invoke_result\n    : __result_of_impl<false_type::value, false_type::value, _ArgTypes...> {};\ntemplate <typename, typename _Fn, typename... _Args>\nvoid __invoke_impl(_Fn __f, _Args... __args) {\n  __f(__args...);\n}\ntemplate <typename, typename _Callable, typename... _Args>\nvoid __invoke_r(_Callable __fn, _Args... __args) {\n  using __result = __invoke_result<_Args...>;\n  using __type = typename __result::type;\n  __invoke_impl<__type>(__fn, __args...);\n}\nstruct QString {\n  QString(const char *);\n};\ntemplate <typename> class function;\ntemplate <typename _Functor> struct _Base_manager {\n  static _Functor _M_get_pointer(int) { __builtin_abort (); }\n};\ntemplate <typename, typename> class _Function_handler;\ntemplate <typename _Res, typename _Functor, typename... _ArgTypes>\nstruct _Function_handler<_Res(_ArgTypes...), _Functor> {\n  using _Base = _Base_manager<_Functor>;\n  static _Res _M_invoke(const int &__functor, _ArgTypes &&...__args) {\n    auto __trans_tmp_1 = _Base::_M_get_pointer(__functor);\n    __invoke_r<_Res>(__trans_tmp_1, __args...);\n  }\n};\ntemplate <typename _Res, typename... _ArgTypes>\nstruct function<_Res(_ArgTypes...)> {\n  template <typename _Functor>\n  using _Handler = _Function_handler<_Res(_ArgTypes...), _Functor>;\n  template <typename _Functor> function(_Functor) {\n    using _My_handler = _Handler<_Functor>;\n    _M_invoker = _My_handler::_M_invoke;\n  }\n  using _Invoker_type = _Res (*)(const int &, _ArgTypes &&...);\n  _Invoker_type _M_invoker;\n};\nstruct QRegularExpression {\n  QRegularExpression(QString);\n};\nstruct AbstractAccount {\n  void get(function<void(AbstractAccount *)>,\n           function<void(AbstractAccount *)>);\n};\nstruct AbstractTimelineModel {\n  AbstractAccount m_account;\n};\nstruct LinkPaginationTimelineModel : AbstractTimelineModel {\n  void fillTimeline();\n};\nvoid LinkPaginationTimelineModel::fillTimeline() {\n  [] {};\n  m_account.get([](AbstractAccount *) { static QRegularExpression re(\"\"); },\n                [](AbstractAccount *) {});\n}\n\nBut, strangely can't reproduce with a cross-compiler from x86_64 to powerpc64le."
													},
													{
														"isprivate": "0",
														"commentid": "17540990",
														"comment_count": "7",
														"who": {
															"text": "releng",
															"name": "Fedora Release Engineering"
														},
														"bug_when": "2023-08-16 07:10:03 +0000",
														"thetext": "This bug appears to have been reported against 'rawhide' during the Fedora Linux 39 development cycle.\nChanging version to 39."
													}
												]
											},
											{
												"bug_id": "1929836",
												"creation_ts": "2021-02-17 18:32:37 +0000",
												"short_desc": "ppc64le: severe ptrace, tracing, and audit regression",
												"delta_ts": "2022-09-05 08:10:08 +0000",
												"bug_status": "CLOSED",
												"resolution": "CURRENTRELEASE",
												"bug_file_loc": "https://git.kernel.org/torvalds/c/d72500f992849d31ebae8f821a023660ddd0dcc2",
												"keywords": "BetaBlocker",
												"priority": "urgent",
												"bug_severity": "urgent",
												"depends_on": [
													"1071880"
												],
												"blocked": [
													{
														"bug_id": "1930252",
														"error": "NotPermitted"
													}
												],
												"long_desc": [
													{
														"isprivate": "0",
														"commentid": "14794276",
														"comment_count": "0",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-02-17 18:32:37 +0000",
														"thetext": "Hello, strace upstream is speaking. :)\n\nThere seems to be a severe ppc64le kernel regression detected by strace %check (625 of 972 tests failed).  This ruins strace and blocks any strace update.\n\nFor me it looks as if the kernel function syscall_get_error started to return 0 instead of the error code.\n\nThe logs are in the latest strace build task that failed:\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=62171493\n\nThe kernel used for build there was\nLinux buildvm-ppc64le-14.iad2.fedoraproject.org 5.10.15-200.fc33.ppc64le #1 SMP Wed Feb 10 17:31:04 UTC 2021 ppc64le ppc64le ppc64le GNU/Linux\n\nFor comparison, the same version of strace passes all tests on all other rawhide architectures, as well as on Debian ppc64le (kernel 5.10.13-1).\n\nThe latest successfull strace build to rawhide was about 2 months ago:\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1658216\n\nThe kernel used for build there was\nLinux buildvm-ppc64le-38.iad2.fedoraproject.org 5.9.11-200.fc33.ppc64le #1 SMP Tue Nov 24 18:02:53 UTC 2020 ppc64le ppc64le ppc64le GNU/Linux"
													},
													{
														"isprivate": "0",
														"commentid": "14797189",
														"comment_count": "1",
														"who": {
															"text": "esyr",
															"name": "Eugene Syromiatnikov"
														},
														"bug_when": "2021-02-18 13:45:03 +0000",
														"thetext": "Fedora's 5.10.7-200.fc33.ppc64le (on buildvm-ppc64le-19.iad2.fedoraproject.org) was broken as well, for the record."
													},
													{
														"isprivate": "0",
														"commentid": "14868304",
														"comment_count": "2",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-03-14 00:26:35 +0000",
														"thetext": "I'd like to reiterate: this kernel bug breaks strace badly, making it almost unusable."
													},
													{
														"isprivate": "0",
														"commentid": "14942947",
														"comment_count": "3",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-04-07 16:25:50 +0000",
														"thetext": "This is the reason why the latest strace release didn't get into Fedora, see\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1711422\nhttps://koji.fedoraproject.org/koji/buildinfo?buildID=1711415\n\nUntil this bug is fixed, no strace updates in Fedora are possible."
													},
													{
														"isprivate": "0",
														"commentid": "15061049",
														"comment_count": "4",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-14 10:20:36 +0000",
														"thetext": "Using the latest strace that can decode the structure returned by PTRACE_GETREGSET,\none can see that's wrong in the data returned by the kernel.\n\nLinux buildvm-ppc64le-22.iad2.fedoraproject.org 5.11.10-200.fc33.ppc64le\non exiting chdir(\"\") syscall did the following:\n\nptrace(PTRACE_GETREGSET, 702867, NT_PRSTATUS, {iov_base={gpr=[0xc, 0x7fffd8c3f250, 0x7fffa60b7000, 0xfffffffffffffffe, 0x7fffd8c3f158, 0, 0x8, 0x20, 0xfffffffe7fffffff, 0, 0, 0, 0, 0x7fffa615a390, 0, 0, 0, 0x7fffd8c3fa58, 0x7fffd8c3f308, 0x7fffd8c3f304, 0x1228f4f68, 0x1228f4fb0, 0xab98c, 0xab991, 0x7fffa61533a0, 0x1228f5180, 0x1228f51b8, 0x122910010, 0, 0xab98c, 0x7fffa5c6fff0, 0x100000], nip=0x7fffa5fb4ad4, msr=0x800000000000d033, orig_gpr3=0x1228f52e8, ctr=0, link=0, xer=0, ccr=0x44000278, softe=0x1, trap=0x3000, dar=0x7fffa5fb4aa8, dsisr=0x40000000, result=0xfffffffffffffffe, ...}, iov_len=384}) = 0\n\nAs you can see, unlike any normal ppc64le kernel, here ccr does not have 0x10000000 bit set, and gpr[3] equals to 0xfffffffffffffffe (== -2L) instead of expected 0x2 (== ENOENT).\nSo yes, this kernel has an obviously broken ptrace ABI.\n\nYou can find this and much more in the scratch build log at https://koji.fedoraproject.org/koji/taskinfo?taskID=67867999"
													},
													{
														"isprivate": "0",
														"commentid": "15061494",
														"comment_count": "5",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-05-14 13:38:41 +0000",
														"thetext": "for the record, from my F-32 system (bare-metal Power9, not a VM) with kernel-5.11.19-100.fc32.ppc64le, strace built from master branch\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  905\n# SKIP:  97\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0"
													},
													{
														"isprivate": "0",
														"commentid": "15062263",
														"comment_count": "6",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-05-14 18:02:11 +0000",
														"thetext": "and I get these from a rawhide VM with kernel-5.13.0-0.rc1.20210512git88b06399c9c7.15.fc35.ppc64le\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  232\n# SKIP:  102\n# XFAIL: 0\n# FAIL:  668\n# XPASS: 0\n# ERROR: 0\n\n\nbut in F-32 VM with kernel kernel-5.11.19-100.fc32.ppc64le everything looks good\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  905\n# SKIP:  97\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0\n============================================================================\nand I get the same good result in the F-32 VM with kernel-5.12.3-300.fc34.ppc64le\n\nF-32 VM with kernel-5.13.0-0.rc1.20210512git88b06399c9c7.15.fc35.ppc64le then gives\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  901\n# SKIP:  101\n# XFAIL: 0\n# FAIL:  0\n# XPASS: 0\n# ERROR: 0\n============================================================================\n\n\nIt makes me think that the failures are not related to the kernel version, but to something else in the rawhide buildroot, perhaps glibc?"
													},
													{
														"isprivate": "0",
														"commentid": "15062268",
														"comment_count": "7",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-05-14 18:05:25 +0000",
														"thetext": "but kernel-headers-5.11.19-100.fc32.ppc64le was always used for the F-32 tests (if this should make the difference, will check ...)"
													},
													{
														"isprivate": "0",
														"commentid": "15062989",
														"comment_count": "8",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-15 01:03:06 +0000",
														"thetext": "(In reply to Dan Hork from comment #6)\n> It makes me think that the failures are not related to the kernel version,\n> but to something else in the rawhide buildroot, perhaps glibc?\n\nIf it's not the kernel but something else, then this something else is also capable of meddling both with struct ptrace_syscall_info returned by ptrace(PTRACE_GET_SYSCALL_INFO, pid, size, info) as described in the first comment, and with struct pt_regs returned by syscall(__NR_ptrace, PTRACE_GETREGSET, pid, NT_PRSTATUS, iov) in a very specific way described in #c4; in other words, this something is changing both ccr and gpr[3] in the kernel for all ptraced processes."
													},
													{
														"isprivate": "0",
														"commentid": "15074749",
														"comment_count": "9",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-05-18 14:05:24 +0000",
														"thetext": "after updating to glibc-2.33.9000-6.fc35 in my F-32 VM, where the tests were passing, I get now the failures\n\n============================================================================\nTestsuite summary for strace 5.12.0.54.05c8\n============================================================================\n# TOTAL: 1002\n# PASS:  232\n# SKIP:  102\n# XFAIL: 0\n# FAIL:  668\n# XPASS: 0\n# ERROR: 0\n============================================================================"
													},
													{
														"isprivate": "0",
														"commentid": "15076721",
														"comment_count": "10",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-05-18 15:15:01 +0000",
														"thetext": "let's switch to glibc for their feedback ..."
													},
													{
														"isprivate": "0",
														"commentid": "15079009",
														"comment_count": "11",
														"who": {
															"text": "fweimer",
															"name": "Florian Weimer"
														},
														"bug_when": "2021-05-18 20:14:57 +0000",
														"thetext": "Is it possible to reproduce this issue with an already-built strace binary?\n\nWe added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to <sys/ptrace.h>, maybe that causes different execution paths in strace to be taken?"
													},
													{
														"isprivate": "0",
														"commentid": "15079018",
														"comment_count": "12",
														"who": {
															"text": "codonell",
															"name": "Carlos O'Donell"
														},
														"bug_when": "2021-05-18 20:19:39 +0000",
														"thetext": "(In reply to Florian Weimer from comment #11)\n> Is it possible to reproduce this issue with an already-built strace binary?\n> \n> We added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to\n> <sys/ptrace.h>, maybe that causes different execution paths in strace to be\n> taken?\n\nWe also have the 'sc' vs. 'svc' instruction selection in the same timeframe for power?"
													},
													{
														"isprivate": "0",
														"commentid": "15079022",
														"comment_count": "13",
														"who": {
															"text": "codonell",
															"name": "Carlos O'Donell"
														},
														"bug_when": "2021-05-18 20:20:48 +0000",
														"thetext": "(In reply to Carlos O'Donell from comment #12)\n> (In reply to Florian Weimer from comment #11)\n> > Is it possible to reproduce this issue with an already-built strace binary?\n> > \n> > We added definitions of PTRACE_SYSEMU and PTRACE_SYSEMU_SINGLESTEP to\n> > <sys/ptrace.h>, maybe that causes different execution paths in strace to be\n> > taken?\n> \n> We also have the 'sc' vs. 'svc' instruction selection in the same timeframe\n> for power?\n\nSorry, 'scv'."
													},
													{
														"isprivate": "0",
														"commentid": "15079274",
														"comment_count": "14",
														"who": {
															"text": "codonell",
															"name": "Carlos O'Donell"
														},
														"bug_when": "2021-05-18 21:16:04 +0000",
														"thetext": "A recent scratch build failed on a POWER9 box, which would be the hardware under which glibc would switch to 'scv' for syscalls.\n\nJust two quick snippets:\n\n--- exp 2021-05-18 20:26:11.715277248 +0000\n+++ log 2021-05-18 20:26:11.715277248 +0000\n-chdir(0x7fffb053ffe0) = -1 EFAULT (Bad address)\n-chdir(0x7fffb053ffe1) = -1 EFAULT (Bad address)\n+chdir(0x7fffb053ffe0) = 18446744073709551602\n+chdir(0x7fffb053ffe1) = 18446744073709551602\nFAIL printpath-umovestr-legacy.test (exit status: 1)\nFAIL: printstrn-umoven-legacy\n\n--- exp 2021-05-18 20:26:44.524009554 +0000\n+++ log 2021-05-18 20:26:44.524009554 +0000\n@@ -1,2 +1,2 @@\n-writev(-1, [{iov_base=\"\", iov_len=0}, {iov_base=\"f\", iov_len=1}, {iov_base=\"ef\", iov_len=2}, {iov_base=\"def\", iov_len=3}, {iov_base=\"cdef\", iov_len=4}, {iov_base=\"bcdef\", iov_len=5}, {iov_base=\"abcdef\", iov_len=6}, {iov_base=\"zabcdef\", iov_len=7}, {iov_base=\"yzabcdef\", iov_len=8}, {iov_base=\"xyzabcdef\", iov_len=9}, {iov_base=\"wxyzabcdef\", iov_len=10}, {iov_base=\"vwxyzabcdef\", iov_len=11}, {iov_base=\"uvwxyzabcdef\", iov_len=12}, {iov_base=\"tuvwxyzabcdef\", iov_len=13}, {iov_base=\"stuvwxyzabcdef\", iov_len=14}, {iov_base=\"rstuvwxyzabcdef\", iov_len=15}, {iov_base=\"qrstuvwxyzabcdef\", iov_len=16}, {iov_base=\"pqrstuvwxyzabcdef\", iov_len=17}, {iov_base=\"opqrstuvwxyzabcdef\", iov_len=18}, {iov_base=\"nopqrstuvwxyzabcdef\", iov_len=19}, {iov_base=\"mnopqrstuvwxyzabcdef\", iov_len=20}, {iov_base=\"lmnopqrstuvwxyzabcdef\", iov_len=21}, {iov_base=\"klmnopqrstuvwxyzabcdef\", iov_len=22}, {iov_base=\"jklmnopqrstuvwxyzabcdef\", iov_len=23}, {iov_base=\"ijklmnopqrstuvwxyzabcdef\", iov_len=24}, {iov_base=\"hijklmnopqrstuvwxyzabcdef\", iov_len=25}, {iov_base=\"ghijklmnopqrstuvwxyzabcdef\", iov_len=26}, {iov_base=\"fghijklmnopqrstuvwxyzabcdef\", iov_len=27}, {iov_base=\"efghijklmnopqrstuvwxyzabcdef\", iov_len=28}, {iov_base=\"defghijklmnopqrstuvwxyzabcdef\", iov_len=29}, {iov_base=\"cdefghijklmnopqrstuvwxyzabcdef\", iov_len=30}, {iov_base=\"bcdefghijklmnopqrstuvwxyzabcdef\", iov_len=31}], 32) = -1 EBADF (Bad file descriptor)\n+writev(-1, [{iov_base=\"\", iov_len=0}, {iov_base=\"f\", iov_len=1}, {iov_base=\"ef\", iov_len=2}, {iov_base=\"def\", iov_len=3}, {iov_base=\"cdef\", iov_len=4}, {iov_base=\"bcdef\", iov_len=5}, {iov_base=\"abcdef\", iov_len=6}, {iov_base=\"zabcdef\", iov_len=7}, {iov_base=\"yzabcdef\", iov_len=8}, {iov_base=\"xyzabcdef\", iov_len=9}, {iov_base=\"wxyzabcdef\", iov_len=10}, {iov_base=\"vwxyzabcdef\", iov_len=11}, {iov_base=\"uvwxyzabcdef\", iov_len=12}, {iov_base=\"tuvwxyzabcdef\", iov_len=13}, {iov_base=\"stuvwxyzabcdef\", iov_len=14}, {iov_base=\"rstuvwxyzabcdef\", iov_len=15}, {iov_base=\"qrstuvwxyzabcdef\", iov_len=16}, {iov_base=\"pqrstuvwxyzabcdef\", iov_len=17}, {iov_base=\"opqrstuvwxyzabcdef\", iov_len=18}, {iov_base=\"nopqrstuvwxyzabcdef\", iov_len=19}, {iov_base=\"mnopqrstuvwxyzabcdef\", iov_len=20}, {iov_base=\"lmnopqrstuvwxyzabcdef\", iov_len=21}, {iov_base=\"klmnopqrstuvwxyzabcdef\", iov_len=22}, {iov_base=\"jklmnopqrstuvwxyzabcdef\", iov_len=23}, {iov_base=\"ijklmnopqrstuvwxyzabcdef\", iov_len=24}, {iov_base=\"hijklmnopqrstuvwxyzabcdef\", iov_len=25}, {iov_base=\"ghijklmnopqrstuvwxyzabcdef\", iov_len=26}, {iov_base=\"fghijklmnopqrstuvwxyzabcdef\", iov_len=27}, {iov_base=\"efghijklmnopqrstuvwxyzabcdef\", iov_len=28}, {iov_base=\"defghijklmnopqrstuvwxyzabcdef\", iov_len=29}, {iov_base=\"cdefghijklmnopqrstuvwxyzabcdef\", iov_len=30}, {iov_base=\"bcdefghijklmnopqrstuvwxyzabcdef\", iov_len=31}], 32) = 18446744073709551607\nFAIL umovestr_cached.test (exit status: 1)\n\nThe last successful strace build is with glibc-2.32.9000-20.fc34.ppc64le, which is ~4 builds before 'scv' is introduced.\n\nAll builds after 'scv' is introduced in glibc-2.32.9000-24 (2021-01-08) appear to fail.\n\nI don't see any 'scv' enablement in strace for ppc64le."
													},
													{
														"isprivate": "0",
														"commentid": "15079276",
														"comment_count": "15",
														"who": {
															"text": "tulioqm",
															"name": "Tulio Magno Quites Machado Filho"
														},
														"bug_when": "2021-05-18 21:18:21 +0000",
														"thetext": "(In reply to Carlos O'Donell from comment #14)\n> I don't see any 'scv' enablement in strace for ppc64le.\n\nI agree with you. strace upstream is missing support for scv.\ne.g. in this function https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\nWe can't trust on the value of CR0 anymore.  An error is returned when r3 is negative."
													},
													{
														"isprivate": "0",
														"commentid": "15079396",
														"comment_count": "16",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-18 22:40:03 +0000",
														"thetext": "(In reply to Tulio Magno Quites Machado Filho from comment #15)\n> (In reply to Carlos O'Donell from comment #14)\n> > I don't see any 'scv' enablement in strace for ppc64le.\n> \n> I agree with you. strace upstream is missing support for scv.\n> e.g. in this function\n> https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n> We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> negative.\n\nDoes this mean that the kernel function syscall_get_error and all its users including PTRACE_GET_SYSCALL_INFO API is broken when scv is used?"
													},
													{
														"isprivate": "0",
														"commentid": "15079417",
														"comment_count": "17",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-18 22:56:59 +0000",
														"thetext": "(In reply to Dmitry V. Levin from comment #16)\n> (In reply to Tulio Magno Quites Machado Filho from comment #15)\n> > (In reply to Carlos O'Donell from comment #14)\n> > > I don't see any 'scv' enablement in strace for ppc64le.\n> > \n> > I agree with you. strace upstream is missing support for scv.\n> > e.g. in this function\n> > https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n> > We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> > negative.\n> \n> Does this mean that the kernel function syscall_get_error and all its users\n> including PTRACE_GET_SYSCALL_INFO API are broken when scv is used?\n\nLooks like the answer is yes, the kernel commit v5.9-rc1~100^2~164 that introduced scv support was incomplete, all users of ccr in arch/powerpc/include/asm/ptrace.h and arch/powerpc/include/asm/syscall.h are broken when scv is used.\n\nSo while the idea of changing the error handling convention is questionable,\nthe bug is on the kernel side that failed to implement the new error handling convention."
													},
													{
														"isprivate": "0",
														"commentid": "15079459",
														"comment_count": "18",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-18 23:32:22 +0000",
														"thetext": "(In reply to Tulio Magno Quites Machado Filho from comment #15)\n> (In reply to Carlos O'Donell from comment #14)\n> > I don't see any 'scv' enablement in strace for ppc64le.\n> \n> I agree with you. strace upstream is missing support for scv.\n> e.g. in this function\n> https://github.com/strace/strace/blob/master/src/linux/powerpc/get_error.c\n\nPlease note that this file is not used when PTRACE_GET_SYSCALL_INFO is working properly,\nthere is a runtime test for this, see\n\n$ strace -d -enone / 2>&1 |grep PTRACE_GET_SYSCALL_INFO\n\nHowever, there is going to be an issue with src/linux/powerpc/set_error.c and its users, e.g. syscall tampering.\n\n> We can't trust on the value of CR0 anymore.  An error is returned when r3 is\n> negative.\n\nI hope somebody who knows scv semantics would contribute missing parts of scv support to strace and the kernel before strace is kicked out from Fedora due to ftbfs."
													},
													{
														"isprivate": "0",
														"commentid": "15084949",
														"comment_count": "19",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-20 03:47:43 +0000",
														"thetext": "There was a short discussion in linux-api mailing list that identified two bugs:\n1. incomplete scv abi support in the kernel that breaks users of asm/syscall.h and asm/ptrace.h, these users include ptrace, tracing, and audit subsystems; detected by hundereds of tests from the strace test suite, proposed patch can be found at https://lore.kernel.org/linux-api/1621385544.nttlk5qugb.astroid@bobo.none/ ;\n2. a glibc bug detected by signal test from the strace test suite, proposed patch can be found at https://lore.kernel.org/linux-api/1621400263.gf0mbqhkrf.astroid@bobo.none/ .\n\nFeel free to split this bug report into two if necessary."
													},
													{
														"isprivate": "0",
														"commentid": "15088583",
														"comment_count": "20",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-20 23:06:30 +0000",
														"thetext": "Since the glibc bug is now tracked by #1962971, switching this bug back to the kernel component.\n\nMeanwhile, Nicholas Piggin submitted a patch that's likely to be the final, see\nhttps://lore.kernel.org/linuxppc-dev/20210520111931.2597127-2-npiggin@gmail.com/\n\nI'd like to remind that this bug was found by strace test suite and it blocks strace updates in Fedora.\n\nI hope the fix will be applied before strace is kicked out from Fedora due to ftbfs which is 19 weeks already."
													},
													{
														"isprivate": "0",
														"commentid": "15093123",
														"comment_count": "21",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-23 17:43:31 +0000",
														"thetext": "(In reply to Dmitry V. Levin from comment #20)\n> Meanwhile, Nicholas Piggin submitted a patch that's likely to be the final,\n> see\n> https://lore.kernel.org/linuxppc-dev/20210520111931.2597127-2-npiggin@gmail.\n> com/\n\nThis patch has been merged upstream, see\nhttps://git.kernel.org/torvalds/c/d72500f992849d31ebae8f821a023660ddd0dcc2"
													},
													{
														"isprivate": "0",
														"commentid": "15095587",
														"comment_count": "22",
														"who": {
															"text": "jforbes",
															"name": "Justin M. Forbes"
														},
														"bug_when": "2021-05-24 14:19:12 +0000",
														"thetext": "That should be in the 5.13-rc3 build today for rawhide. I have also cherry picked it for 5.12, so it should land in stable fedora with 5.12.7 and newer."
													},
													{
														"isprivate": "0",
														"commentid": "15185392",
														"comment_count": "23",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-06-14 15:35:34 +0000",
														"thetext": "Dmitry, is there still something blocking you from updating strace? I believe we already have all the kernel/glibc bits included for F-34+."
													},
													{
														"isprivate": "0",
														"commentid": "15195017",
														"comment_count": "24",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-06-16 12:06:57 +0000",
														"thetext": "Everything should have been fixed now, but I cannot tell for sure because something else is broken: a scratch build of strace HEAD failed with the following diagnostics: BuildrootError: could not init mock buildroot, mock exited with status 30; see root.log for more information\n\nThe corresponding root.log contains the following diagnostics:\nDEBUG util.py:444:  Error: \nDEBUG util.py:444:   Problem: package util-linux-2.37-2.fc35.x86_64 requires util-linux-core = 2.37-2.fc35, but none of the providers can be installed\nDEBUG util.py:444:    - conflicting requests\nDEBUG util.py:444:    - nothing provides libpcre2-posix.so.2()(64bit) needed by util-linux-core-2.37-2.fc35.x86_64\nDEBUG util.py:446:  (try to add '--skip-broken' to skip uninstallable packages)\nDEBUG util.py:598:  Child return code was: 1\n\nThis looks as if all builds to fc35 are currently broken.\nFor more details see the scratch build task: https://koji.fedoraproject.org/koji/taskinfo?taskID=70224999"
													},
													{
														"isprivate": "0",
														"commentid": "15195062",
														"comment_count": "25",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-06-16 12:17:33 +0000",
														"thetext": "The buildroot should be OK again, there was a pcre2 update with unexpected consequences, but it has been untagged."
													},
													{
														"isprivate": "0",
														"commentid": "15195850",
														"comment_count": "26",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2021-06-16 14:59:25 +0000",
														"thetext": "for the record, my local F-34 rebuild of strace HEAD with kernel-5.12.10-300.fc34.ppc64le and glibc-2.33-16.fc34.ppc64le was successful"
													},
													{
														"isprivate": "0",
														"commentid": "15197009",
														"comment_count": "27",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-06-16 23:19:42 +0000",
														"thetext": "(In reply to Dan Hork from comment #26)\n> for the record, my local F-34 rebuild of strace HEAD with\n> kernel-5.12.10-300.fc34.ppc64le and glibc-2.33-16.fc34.ppc64le was successful\n\nMy scratch build to fc34 was successful, too:\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=70227524"
													},
													{
														"isprivate": "0",
														"commentid": "16610110",
														"comment_count": "28",
														"who": {
															"text": "mcermak",
															"name": "Martin Cermak"
														},
														"bug_when": "2022-09-05 08:05:57 +0000",
														"thetext": "Maybe this one could be flipped to MODIFIED or further?  Thanks!"
													},
													{
														"isprivate": "0",
														"commentid": "16610124",
														"comment_count": "29",
														"who": {
															"text": "dan",
															"name": "Dan Hork"
														},
														"bug_when": "2022-09-05 08:10:08 +0000",
														"thetext": "It was fixed long time ago, closing."
													}
												]
											},
											{
												"bug_id": "1962971",
												"creation_ts": "2021-05-20 22:54:06 +0000",
												"short_desc": "glibc: ppc64le: scv ABI error handling fails to check IS_ERR_VALUE",
												"delta_ts": "2021-07-06 13:32:49 +0000",
												"bug_status": "CLOSED",
												"resolution": "ERRATA",
												"keywords": "BetaBlocker",
												"priority": "unspecified",
												"bug_severity": "urgent",
												"depends_on": [
													"1071880"
												],
												"blocked": [
													{
														"bug_id": "1930252",
														"error": "NotPermitted"
													},
													{
														"bug_id": "1963901",
														"creation_ts": "2021-05-24 11:10:27 +0000",
														"short_desc": "RHEL9 - ppc64le: glibc fails to check IS_ERR_VALUE when using scv",
														"delta_ts": "2023-07-18 14:29:19 +0000",
														"bug_status": "CLOSED",
														"resolution": "CURRENTRELEASE",
														"keywords": "Bugfix, Patch, Triaged",
														"priority": "unspecified",
														"bug_severity": "high",
														"depends_on": [
															"1962971"
														],
														"blocked": [
															{
																"bug_id": "1875375",
																"error": "NotPermitted"
															}
														],
														"external_bugs": {
															"text": "27892",
															"name": "Sourceware"
														},
														"long_desc": [
															{
																"isprivate": "0",
																"commentid": "15094789",
																"comment_count": "0",
																"who": {
																	"text": "bugproxy",
																	"name": "IBM Bug Proxy"
																},
																"bug_when": "2021-05-24 11:10:27 +0000"
															},
															{
																"isprivate": "0",
																"commentid": "15094790",
																"comment_count": "1",
																"who": {
																	"text": "bugproxy",
																	"name": "IBM Bug Proxy"
																},
																"bug_when": "2021-05-24 11:10:35 +0000",
																"thetext": "== Comment: #0 - Tulio Magno Quites Machado Filho <tulioqm@br.ibm.com> - 2021-05-21 16:11:35 ==\n---Problem Description---\nglibc fails to check IS_ERR_VALUE when using scv.\n\nThis bug has been reported upstream as: https://sourceware.org/bugzilla/show_bug.cgi?id=27892\n\nIt has also been reported for Fedora 35: https://bugzilla.redhat.com/show_bug.cgi?id=1962971\n \nContact Information = Tulio Magno Quites Machado Filho/tulioqm@br.ibm.com \n \n---Additional Hardware Info---\nA POWER9 or POWER10 server with support for scv is required to reproduce the error.\n\n\n---Steps to Reproduce---\n 1. Build strace and its tests.\n 2. Run test tests/signal\n \nUserspace rpm: glibc \n \nThe userspace tool has the following bit modes: 64-bit"
															},
															{
																"isprivate": "0",
																"commentid": "15103462",
																"comment_count": "6",
																"who": {
																	"text": "fweimer",
																	"name": "Florian Weimer"
																},
																"bug_when": "2021-05-25 17:37:12 +0000",
																"thetext": "Merge request: https://gitlab.com/redhat/centos-stream/rpms/glibc/-/merge_requests/11"
															},
															{
																"isprivate": "0",
																"commentid": "15103633",
																"comment_count": "7",
																"who": {
																	"text": "bugproxy",
																	"name": "IBM Bug Proxy"
																},
																"bug_when": "2021-05-25 17:47:07 +0000",
																"thetext": "------- Comment From tulioqm@br.ibm.com 2021-05-24 10:12 EDT-------\n> May we make this bug report public? Thanks.\n\nYes, but I don't know how to do this.\nCould you help me, please?"
															}
														]
													}
												],
												"external_bugs": {
													"text": "27892",
													"name": "Sourceware"
												},
												"long_desc": [
													{
														"isprivate": "0",
														"commentid": "15088572",
														"comment_count": "0",
														"who": {
															"text": "ldv",
															"name": "Dmitry V. Levin"
														},
														"bug_when": "2021-05-20 22:54:06 +0000",
														"thetext": "+++ This bug was initially created as a clone of Bug #1929836 +++\n\nThe scv ABI introduced by glibc-2.32.9000-24 at 2021-01-08 has the following bug: RET_SCV macro (added by upstream commit glibc-2.33~117) treats any negative value returned by syscall via scv ABI as an error, but this is not correct.\n\nProposed fix was posted by Nicholas Piggin at\nhttps://sourceware.org/pipermail/libc-alpha/2021-May/126534.html\n\nThis bug was found by strace test suite and it blocks strace updates in Fedora.\n\nI hope the fix will be applied before strace is kicked out from Fedora due to ftbfs which is 19 weeks already."
													},
													{
														"isprivate": "0",
														"commentid": "15138481",
														"comment_count": "1",
														"who": {
															"text": "updates",
															"name": "Fedora Update System"
														},
														"bug_when": "2021-06-01 13:46:20 +0000",
														"thetext": "FEDORA-2021-abbb0d8a88 has been submitted as an update to Fedora 34. https://bodhi.fedoraproject.org/updates/FEDORA-2021-abbb0d8a88"
													},
													{
														"isprivate": "0",
														"commentid": "15138487",
														"comment_count": "2",
														"who": {
															"text": "codonell",
															"name": "Carlos O'Donell"
														},
														"bug_when": "2021-06-01 13:47:36 +0000",
														"thetext": "This fix is currently pending the Fedora Rawhide sync with the upstream development branch.\n\nThe fix is going into Fedora 34 with the next errata going through bodhi."
													},
													{
														"isprivate": "0",
														"commentid": "15140578",
														"comment_count": "3",
														"who": {
															"text": "updates",
															"name": "Fedora Update System"
														},
														"bug_when": "2021-06-02 01:41:09 +0000",
														"thetext": "FEDORA-2021-abbb0d8a88 has been pushed to the Fedora 34 testing repository.\nSoon you'll be able to install the update with the following command:\n`sudo dnf upgrade --enablerepo=updates-testing --advisory=FEDORA-2021-abbb0d8a88`\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2021-abbb0d8a88\n\nSee also https://fedoraproject.org/wiki/QA:Updates_Testing for more information on how to test updates."
													},
													{
														"isprivate": "0",
														"commentid": "15144856",
														"comment_count": "4",
														"who": {
															"text": "updates",
															"name": "Fedora Update System"
														},
														"bug_when": "2021-06-03 01:01:07 +0000",
														"thetext": "FEDORA-2021-abbb0d8a88 has been pushed to the Fedora 34 stable repository.\nIf problem still persists, please make note of it in this bug report."
													},
													{
														"isprivate": "0",
														"commentid": "15194139",
														"comment_count": "5",
														"who": {
															"text": "updates",
															"name": "Fedora Update System"
														},
														"bug_when": "2021-06-16 08:27:59 +0000",
														"thetext": "FEDORA-2021-9ce0f65a09 has been pushed to the Fedora 35 stable repository.\nIf problem still persists, please make note of it in this bug report."
													}
												]
											}
										],
										"long_desc": [
											{
												"isprivate": "0",
												"commentid": "6873212",
												"comment_count": "0",
												"who": {
													"text": "karsten",
													"name": "Karsten Hopp"
												},
												"bug_when": "2014-03-03 11:41:52 +0000",
												"thetext": "Description of problem:\nThis is a tracker for bugzillas and patches related to the PowerPC (ppc, ppc64) architectures.\n\nppc64le has its own tracker: bug 1051573"
											},
											{
												"isprivate": "0",
												"commentid": "10293511",
												"comment_count": "1",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2017-03-31 08:51:19 +0000",
												"thetext": "*** Bug 1051573 has been marked as a duplicate of this bug. ***"
											},
											{
												"isprivate": "0",
												"commentid": "10293516",
												"comment_count": "2",
												"who": {
													"text": "dan",
													"name": "Dan Hork"
												},
												"bug_when": "2017-03-31 08:52:39 +0000",
												"thetext": "add open bugs from the ppc64le tracker"
											},
											{
												"isprivate": "0",
												"commentid": "13402189",
												"comment_count": "3",
												"who": {
													"text": "bcotton",
													"name": "Ben Cotton"
												},
												"bug_when": "2019-11-27 14:16:33 +0000",
												"thetext": "Fedora 29 changed to end-of-life (EOL) status on 2019-11-26. Fedora 29 is\nno longer maintained, which means that it will not receive any further\nsecurity or bug fix updates. As a result we are closing this bug.\n\nIf you can reproduce this bug against a currently maintained version of\nFedora please feel free to reopen this bug against that version. If you\nare unable to reopen this bug, please file a new report against the\ncurrent release. If you experience problems, please add a comment to this\nbug.\n\nThank you for reporting this bug and we are sorry it could not be fixed."
											},
											{
												"isprivate": "0",
												"commentid": "13403192",
												"comment_count": "4",
												"who": {
													"text": "bcotton",
													"name": "Ben Cotton"
												},
												"bug_when": "2019-11-27 16:41:04 +0000",
												"thetext": "This bug was accidentally closed due to a query error. Reopening."
											}
										]
									}
								],
								"long_desc": [
									{
										"isprivate": "0",
										"commentid": "10225644",
										"comment_count": "0",
										"who": {
											"text": "dan",
											"name": "Dan Hork"
										},
										"bug_when": "2017-03-09 16:33:28 +0000"
									}
								]
							}
						],
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "10344739",
								"comment_count": "0",
								"who": {
									"text": "menantea",
									"name": "Menanteau Guy"
								},
								"bug_when": "2017-04-19 08:31:04 +0000",
								"thetext": "openQA \"upgrade\" tests failed on ppc64 and ppc64le architectures with f26 nigthly compose since 20170417.\nhttps://kojipkgs.fedoraproject.org/compose/branched/Fedora-26-20170417.n.0/...\n-> with new krb5-libs-1.15.1-6\n\nThere was no problem on compose of 20170416 and before (with krb5-libs-1.15.1-3)\n\nFailing tests:\nhttps://fedoraproject.org/wiki/QA:Testcase_upgrade_dnf_current_server\nhttps://fedoraproject.org/wiki/QA:Testcase_upgrade_dnf_current_minimal\nhttps://fedoraproject.org/wiki/QA:Testcase_upgrade_dnf_previous_server\nhttps://fedoraproject.org/wiki/QA:Testcase_upgrade_dnf_previous_minimal\n\nI analysed specifically the QA:Testcase_upgrade_dnf_current_server (upgrade from f25 to f26) and I got a guest stuck (unable to pass any command at console) during the command:\n\"dnf system-upgrade reboot\"\n\nI can see in the log that the last trace of dnf.rpm.log is:\nINFO Cleanup: crypto-policies-20160921-4.gitf3018dd.fc25.noarch\nthen everything get stuck and I am not able to access anymore to the guest.\n\nOn normal behaviour, I have seen that the Cleanup just after the crypto-policies is the krb5-libs so I guessed the problems occurs during the krb5-libs Cleanup phase.\n\nI tried to execute the test without the upgrade of krb5-libs by adding the option:\nexclude=krb5-libs\nin the fedora.repo used by dnf. The upgrade process went to the end without any problem (and without updating krb5-libs). This make me feel the new krb5-libs is the one responsible of the freeze. \nNote that I was able to install then the krb5-libs-1.15.1-6 successfully after the upgrade."
							},
							{
								"isprivate": "0",
								"commentid": "10345353",
								"comment_count": "1",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-04-19 11:24:17 +0000",
								"thetext": "We saw a similar case (arch agnostic) with texlive, where a scriptlet was wrong and entered an endless loop. Guy, can't you check from console if there is something running when the dnf update process is stuck?"
							},
							{
								"isprivate": "0",
								"commentid": "10345909",
								"comment_count": "2",
								"who": {
									"text": "menantea",
									"name": "Menanteau Guy"
								},
								"bug_when": "2017-04-19 13:41:43 +0000",
								"thetext": "Dan, unfortunately I didn't find a way to do that. After the \"dnf system-upgrade reboot\", the upgrade process takes the focus of the console on the boot screen and I am not able to use this console or to connect to the guest."
							},
							{
								"isprivate": "0",
								"commentid": "10346937",
								"comment_count": "3",
								"who": {
									"text": "rharwood",
									"name": "Robbie Harwood"
								},
								"bug_when": "2017-04-19 18:29:24 +0000",
								"thetext": "Well, that's odd.  I don't know why it would hang here; there isn't anything that can loop.  The only change from -4 to -6 is the addition of this trigger https://github.com/frozencemetery/krb5_fedora/blob/master/krb5.spec#L515-L529 so I assume it's hanging there.\n\nYou mention it's failing on ppc64{,le}; if it's not failing on any other architectures, I don't think this is a krb5 problem (maybe dnf?)."
							},
							{
								"isprivate": "0",
								"commentid": "10349640",
								"comment_count": "4",
								"who": {
									"text": "menantea",
									"name": "Menanteau Guy"
								},
								"bug_when": "2017-04-20 12:54:07 +0000",
								"thetext": "ok I will try to add code to get a trace of what is running by krb5 at reboot during the \"system-upgrade\" to see if krb5 is involved."
							},
							{
								"isprivate": "0",
								"commentid": "10350137",
								"comment_count": "5",
								"who": {
									"text": "pwhalen",
									"name": "Paul Whalen"
								},
								"bug_when": "2017-04-20 14:33:12 +0000",
								"thetext": "I'm hitting this on aarch64 and armhfp during server upgrade. Seemingly hanging during cleanup of 'crypto-policies-20160921-4.gitf3018dd.fc25.noarch'\n\narmhfp:\n[968/1030] Cleanup gzip-1.8-1.fc25.armv7hl...\n[969/1030] Cleanup crypto-policies-20160921-4.gitf3018dd.fc25.noarch...\n[970/1030] Cleanup krb5-libs-1.14.4-7.fc25.armv7hl...\n\naarch64:\n[979/1118] Cleanup python3-libs-3.5.3-4.fc25.aarch64...\n[980/1118] Cleanup system-python-libs-3.5.3-4.fc25.aarch64...\n[981/1118] Cleanup crypto-policies-20160921-4.gitf3018dd.fc25.noarch..."
							},
							{
								"isprivate": "0",
								"commentid": "10350499",
								"comment_count": "6",
								"who": {
									"text": "rharwood",
									"name": "Robbie Harwood"
								},
								"bug_when": "2017-04-20 15:46:56 +0000",
								"thetext": "That's interesting: you're both on an older version of Fedora, and seeing this on different packages.  Let's ask the dnf folks."
							},
							{
								"isprivate": "0",
								"commentid": "10364045",
								"comment_count": "7",
								"who": {
									"text": "ignatenko",
									"name": "Igor Gnatenko"
								},
								"bug_when": "2017-04-26 10:54:13 +0000",
								"thetext": "you could run --rpmverbosity=debug and see what's going on there.."
							},
							{
								"isprivate": "0",
								"commentid": "10365579",
								"comment_count": "8",
								"who": {
									"text": "pwhalen",
									"name": "Paul Whalen"
								},
								"bug_when": "2017-04-26 17:02:56 +0000",
								"thetext": "Created attachment 1274331\ndnf rpm log\n\nUpgrade attempted with:\n\ndnf system-upgrade download --releasever=26 --debuglevel 9 --rpmverbosity=debug\ndnf system-upgrade --debuglevel 9 --rpmverbosity=debug reboot\n\nLogs attached."
							},
							{
								"isprivate": "0",
								"commentid": "10365583",
								"comment_count": "9",
								"who": {
									"text": "pwhalen",
									"name": "Paul Whalen"
								},
								"bug_when": "2017-04-26 17:03:37 +0000",
								"thetext": "Created attachment 1274333\ndnf.log"
							},
							{
								"isprivate": "0",
								"commentid": "10372931",
								"comment_count": "10",
								"who": {
									"text": "pwhalen",
									"name": "Paul Whalen"
								},
								"bug_when": "2017-04-28 16:30:40 +0000",
								"thetext": "Created attachment 1274977\ntruncated strace log with maxcpus=1\n\nThis hang is also reproducible with 'dnf distro-sync --releasever=26' and allows for network access for troubleshooting. \n\nIt does not always happen with the same package during Cleanup, and can also occur during the 'Upgrade' phase. When it does hang, it ends with 'FUTEX_WAIT' even when limiting maxcpus=1."
							},
							{
								"isprivate": "0",
								"commentid": "10372982",
								"comment_count": "11",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-04-28 16:42:13 +0000",
								"thetext": "Hanging in the futex(FUTEX_WAIT) syscall often means a deadlock situation in a multi-threaded application ... The kernel bug with the same symptom should be fixed for a long time."
							},
							{
								"isprivate": "0",
								"commentid": "10373666",
								"comment_count": "12",
								"who": {
									"text": "pwhalen",
									"name": "Paul Whalen"
								},
								"bug_when": "2017-04-28 20:00:06 +0000",
								"thetext": "Also reproducible by attempting to upgrade dnf and deps to f26\n\ndnf --releasever=26 update dnf -y\n...\n Installing  : libXft-2.3.2-5.fc26.aarch64                              60/127 \n Installing  : tk-1:8.6.6-1.fc26.aarch64                                61/127 \n Installing  : python35-3.5.2-9.fc26.aarch64                            62/127 \n\n\n\n[root@mustang ~]# strace -f -p 1030\nstrace: Process 1030 attached\nfutex(0xffff8fc717d0, FUTEX_WAIT, 2, NULL\n\n\nUpgrading dnf was successful 5/6 attempts. After dnf is upgraded, distro-sync completed 5/5."
							},
							{
								"isprivate": "0",
								"commentid": "10376681",
								"comment_count": "13",
								"who": {
									"text": "pwhalen",
									"name": "Paul Whalen"
								},
								"bug_when": "2017-05-01 17:09:44 +0000",
								"thetext": "Proposing as a blocker for Beta, criteria:\n\n\"... it must be possible to successfully complete a direct upgrade from fully updated installations of the last two stable Fedora releases with that package set installed.\""
							},
							{
								"isprivate": "0",
								"commentid": "10376903",
								"comment_count": "14",
								"who": {
									"text": "gmarr",
									"name": "Geoffrey Marr"
								},
								"bug_when": "2017-05-01 18:38:49 +0000",
								"thetext": "Discussed during the 2017-05-01 blocker review meeting: [1]\n\nThe decision to classify this bug as an AcceptedBlocker was made as it violates the following blocker criteria:\n\n\"... it must be possible to successfully complete a direct upgrade from fully updated installations of the last two stable Fedora releases with that package set installed.\"\n\n[1] https://meetbot.fedoraproject.org/fedora-blocker-review/2017-05-01/f26-blocker-review.2017-05-01-16.02.txt"
							},
							{
								"isprivate": "0",
								"commentid": "10381943",
								"comment_count": "15",
								"who": {
									"text": "ignatenko",
									"name": "Igor Gnatenko"
								},
								"bug_when": "2017-05-03 11:44:13 +0000",
								"thetext": "*** Bug 1443610 has been marked as a duplicate of this bug. ***"
							},
							{
								"isprivate": "0",
								"commentid": "10418991",
								"comment_count": "16",
								"who": {
									"text": "code",
									"name": "Daniel"
								},
								"bug_when": "2017-05-17 02:19:21 +0000",
								"thetext": "Also a problem when upgrading on armhfp."
							},
							{
								"isprivate": "0",
								"commentid": "10420719",
								"comment_count": "17",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-05-17 11:54:52 +0000",
								"thetext": "s390x is affected as well"
							},
							{
								"isprivate": "0",
								"commentid": "10440948",
								"comment_count": "18",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-05-23 17:03:19 +0000",
								"thetext": "So Igor says this is basically https://bugzilla.redhat.com/show_bug.cgi?id=1394862 , which upstream has a possible fix for. He has done F25 and F26 scratch builds with the fix:\n\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=19706601\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=19706649\n\ncan affected folks on armhfp please test in the following way?\n\n1) Install the patched F25 scratch build\n2) Do your upgrade in such a way that the patched F26 scratch build will be included\n\nIn other words, the fix needs to be applied 'at both ends'.\n\nDue to Koji's F25 config, there are no builds for aarch64 or ppc64 - if you want to test on those arches you'll have to grab the SRPM and rebuild it. To test on s390 you'll have to rebuild both F25 and F26 from SRPM."
							},
							{
								"isprivate": "0",
								"commentid": "10441464",
								"comment_count": "19",
								"who": {
									"text": "pwhalen",
									"name": "Paul Whalen"
								},
								"bug_when": "2017-05-23 20:37:11 +0000",
								"thetext": "using those scratch builds, f25 minimal successfully upgraded to f26 on armhfp."
							},
							{
								"isprivate": "0",
								"commentid": "10441649",
								"comment_count": "20",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-05-23 22:43:13 +0000",
								"thetext": "libdb-5.3.28-18.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
							},
							{
								"isprivate": "0",
								"commentid": "10441652",
								"comment_count": "21",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-05-23 22:43:59 +0000",
								"thetext": "libdb-5.3.28-18.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf"
							},
							{
								"isprivate": "0",
								"commentid": "10441654",
								"comment_count": "22",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-05-23 22:44:22 +0000",
								"thetext": "libdb-5.3.28-18.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
							},
							{
								"isprivate": "0",
								"commentid": "10441656",
								"comment_count": "23",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-05-23 22:44:50 +0000",
								"thetext": "Thanks. I've now submitted official updates for 24, 25 and 26 with the patch applied. If more folks could test and confirm the fix (and provide karma on the updates), that'd be great. We should ensure all three updates are pushed stable before closing this bug."
							},
							{
								"isprivate": "0",
								"commentid": "10448425",
								"comment_count": "24",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-05-25 17:10:01 +0000",
								"thetext": "So it seems like this libdb update is causing problems in the compose process; I'm going to unpush all the updates for safety:\n\n<adamw> there seem to be some issues in the compose process; both the RC compose attempts got stuck in STARTED state\n<jkurik> afaik some builders went down and needed to be restarted, that slowed down the compose\n<dgilmore> adamw: from looking there may be issues witha  libdb update\n<nirik> right... they are hanging in lorax... and several failed in lorax -> libdb\n<adamw> ooh.\n<adamw> there's a libdb blocker fix which is supposed to *prevent* update hangs...\n<dgilmore> it may be causeing compose hangs\n<nirik> yep.\n<adamw> maybe the fix has problems\n<adamw> can you tell what libdb nevr is involved?\n<adamw> well, maybe we should do this in #fedora-releng...\n<dgilmore> DEBUG util.py:439:  (68/714) libdb-5.3.28-19.fc26.aarch64\n<adamw> mmf, that's the latest one :/\n\nCCing dgilmore and nirik for further details."
							},
							{
								"isprivate": "0",
								"commentid": "10448491",
								"comment_count": "25",
								"who": {
									"text": "kevin",
									"name": "Kevin Fenzi"
								},
								"bug_when": "2017-05-25 17:39:45 +0000",
								"thetext": "Here's a failed koji task from the attempted rc compose: \n\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=19719675\n\nLooking at root.log there: \n\nDEBUG util.py:439:  creating the runtime image\nDEBUG util.py:439:  /bin/sh: line 1: 12545 Floating point exception(core dumped) lorax --product=Fedora --version=26 --release=26 --source=file:///mnt/koji/compose/26/Fedora-26-20170524.1/work/x86_64/repo --variant=Everything --noupgrade --buildarch=x86_64 --volid=Fedora-E-dvd-x86_64-26 --logfile=/mnt/koji/compose/26/Fedora-26-20170524.1/logs/x86_64/buildinstall-Everything-logs/lorax.log /mnt/koji/compose/26/Fedora-26-20170524.1/work/x86_64/buildinstall/Everything\nDEBUG util.py:577:  Child return code was: 136\n\nLooking on that builder ( buildhw-01.phx2.fedoraproject.org ):\n\n[Wed May 24 04:34:45 2017] traps: lorax[37508] trap divide error ip:7f5d7af41b04 sp:7ffe7afae730 error:0\n[Wed May 24 04:34:45 2017]  in libdb-5.3.so[7f5d7ae64000+1b5000]\n[Wed May 24 04:37:17 2017] traps: lorax[37259] trap divide error ip:f56eff8c sp:ffd6f1c0 error:0\n[Wed May 24 04:37:17 2017]  in libdb-5.3.so[f5604000+1d1000]\n[Wed May 24 04:41:25 2017] traps: lorax[36579] trap divide error ip:7fb5ecf68b04 sp:7ffe0644ed70 error:0\n[Wed May 24 04:41:25 2017]  in libdb-5.3.so[7fb5ece8b000+1b5000]\n[Wed May 24 23:30:05 2017] traps: lorax[12545] trap divide error ip:7f0cbd3cfb04 sp:7ffed72fd010 error:0\n[Wed May 24 23:30:05 2017]  in libdb-5.3.so[7f0cbd2f2000+1b5000]\n[Wed May 24 23:32:07 2017] traps: lorax[12320] trap divide error ip:f569cf8c sp:ff8e5610 error:0\n[Wed May 24 23:32:07 2017]  in libdb-5.3.so[f55b1000+1d1000]\n[Wed May 24 23:32:23 2017] traps: lorax[12313] trap divide error ip:f56b5f8c sp:ffc11490 error:0\n[Wed May 24 23:32:23 2017]  in libdb-5.3.so[f55ca000+1d1000]\n[Wed May 24 23:38:25 2017] traps: lorax[12491] trap divide error ip:7fed6c14bb04 sp:7ffd94c8aef0 error:0\n[Wed May 24 23:38:25 2017]  in libdb-5.3.so[7fed6c06e000+1b5000]"
							},
							{
								"isprivate": "0",
								"commentid": "10448498",
								"comment_count": "26",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-05-25 17:42:54 +0000",
								"thetext": "It's worth noting that all compose tasks run in mock chroots, so the issue here could be something missing from the mock environment that the code assumes will be available."
							},
							{
								"isprivate": "0",
								"commentid": "10448507",
								"comment_count": "27",
								"who": {
									"text": "fweimer",
									"name": "Florian Weimer"
								},
								"bug_when": "2017-05-25 17:46:51 +0000",
								"thetext": "(In reply to Adam Williamson from comment #26)\n> It's worth noting that all compose tasks run in mock chroots, so the issue\n> here could be something missing from the mock environment that the code\n> assumes will be available.\n\nOr the RPM database was created from outside of the chroot in the old libdb format, and the first attempt to touch it triggers an upgrade attempt, which fails."
							},
							{
								"isprivate": "0",
								"commentid": "10448826",
								"comment_count": "28",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-05-25 19:19:57 +0000",
								"thetext": "libdb-5.3.28-19.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
							},
							{
								"isprivate": "0",
								"commentid": "10449806",
								"comment_count": "29",
								"who": {
									"text": "bitlord0xff",
									"name": "Branko Grubi"
								},
								"bug_when": "2017-05-26 04:39:19 +0000",
								"thetext": "Created attachment 1282477\nupgrade_fail\n\nThis could be relate to this bug. During upgrade my dnf crashed with:\n\n...\n  Running scriptlet: qpdf-libs-6.0.0-4.fc26.x86_64                                                                                                                                                      107/112 \n  Cleanup          : microcode_ctl-2:2.1-14.1.fc26.x86_64                                                                                                                                               108/112 \n  Cleanup          : libv4l-1.12.5-1.fc26.x86_64                                                                                                                                                        109/112 \n  Running scriptlet: libv4l-1.12.5-1.fc26.x86_64                                                                                                                                                        109/112 \n  Running scriptlet: gssproxy-0.7.0-7.fc26.x86_64                                                                                                                                                       110/112 \nFloating point exception (core dumped)\n\nNow even 'rpm' doesn't work it crashes."
							},
							{
								"isprivate": "0",
								"commentid": "10449837",
								"comment_count": "30",
								"who": {
									"text": "robatino",
									"name": "Andre Robatino"
								},
								"bug_when": "2017-05-26 05:12:31 +0000",
								"thetext": "> Now even 'rpm' doesn't work it crashes.\n\nThat happened to me yesterday during a yum update of a F26 guest. It looks like the rpm database format changed. You have to rebuild the rpm database. I followed the instructions at https://ma.ttias.be/yum-update-db_runrecovery-fatal-error-run-database-recovery/ (you'd use the corresponding instructions for dnf) and then ran yum-complete-transaction (don't know the dnf command) and then everything was fine again."
							},
							{
								"isprivate": "0",
								"commentid": "10449863",
								"comment_count": "31",
								"who": {
									"text": "robatino",
									"name": "Andre Robatino"
								},
								"bug_when": "2017-05-26 05:33:29 +0000",
								"thetext": "I take it back - AFAIK the rpm database format didn't change, but as I said, rebuilding the rpm database did fix my problem."
							},
							{
								"isprivate": "0",
								"commentid": "10450039",
								"comment_count": "32",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-05-26 06:05:47 +0000",
								"thetext": "It certainly seems plausible that you ran into basically the same problem the composes are hitting, whatever it is, and a database rebuild would shift it. I've now unpushed the update for F26 as well, so hopefully no-one else will run into it."
							},
							{
								"isprivate": "0",
								"commentid": "10450147",
								"comment_count": "33",
								"who": {
									"text": "pkubat",
									"name": "Petr Kubat"
								},
								"bug_when": "2017-05-26 07:09:23 +0000",
								"thetext": "I think there is some scriptlet magic involved in this.\nJust tested to a newer libdb+glibc version with having openldap-servers package installed (which I know for a fact has a triggerin on libdb and touches the rpmdb) and failed the same way. Most likely due to the fact that the trigger rebuilds the db with newer version of libdb and rpm then tries to open it with the older version... But will have to look into this further."
							},
							{
								"isprivate": "0",
								"commentid": "10450169",
								"comment_count": "34",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2017-05-26 07:19:07 +0000",
								"thetext": "The database *environment* changes with the new libdb version, and once the database has been accessed with the newer version the older version can no longer access it and will barf in one way or the other. At least that's what I saw on Wednesday in my brief testing of the new libdb.\n\nAnyway, you don't need a full --rebuilddb in this situation, \"rm -f /var/lib/rpm/__*.db\" to nuke the environment is enough."
							},
							{
								"isprivate": "0",
								"commentid": "10450307",
								"comment_count": "35",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2017-05-26 07:50:38 +0000",
								"thetext": "Moving to assigned because upgrade to libdb-5.3.28-19.fc26\nstill does not work as expected and rpmdb is broken"
							},
							{
								"isprivate": "0",
								"commentid": "10450543",
								"comment_count": "36",
								"who": {
									"text": "hdegoede",
									"name": "Hans de Goede"
								},
								"bug_when": "2017-05-26 09:15:50 +0000",
								"thetext": "Hi,\n\nI'm seeing this too, not sure if it is related to the libdb update, I've updated to F26 a while ago and I already have manually run rpm --rebuilddb, yet after sucking in just 2 days of F26 updates today my dnf update is stuck at:\n\n  Running scriptlet: gssproxy-0.7.0-7.fc26.x86_64                     1029/1040 \n\n(yes lots of updates in the last 2 days, texlive is in the set)\n\nSo it seems that the gssproxy scriptlet is doing something which triggers this.\n\nNote no fp exception for me just dnf stuck using 100% CPU.\n\nRegards,\n\nHans"
							},
							{
								"isprivate": "0",
								"commentid": "10450557",
								"comment_count": "37",
								"who": {
									"text": "hdegoede",
									"name": "Hans de Goede"
								},
								"bug_when": "2017-05-26 09:22:41 +0000",
								"thetext": "A bit more input, I had to kill -9 dnf, after that dnf repoquery --duplicates showed a few duplicates so I did\ndnf remove --duplicates, this time the gssproxy scriptlet did run successfully.\n\nI did do a rpm --rebuild after they kill -9 as I was not sure the rpmdb would still be in a sane state after that.\n\nNot sure if this is helpful, feel free to ignore."
							},
							{
								"isprivate": "0",
								"commentid": "10450850",
								"comment_count": "38",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2017-05-26 10:51:19 +0000",
								"thetext": "Hans,\nIt is not related to gssproxy. It crashed even with updating just a libdb\n\nsh# dnf update libdb*\nLast metadata expiration check: 0:13:01 ago on Fri May 26 12:36:04 2017 CEST.\nDependencies resolved.\n================================================================================\n Package          Arch        Version                Repository            Size\n================================================================================\nUpgrading:\n libdb            x86_64      5.3.28-19.fc26         updates-testing      749 k\n libdb-utils      x86_64      5.3.28-19.fc26         updates-testing      137 k\n\nTransaction Summary\n================================================================================\nUpgrade  2 Packages\n\nTotal download size: 886 k\nIs this ok [y/N]: y\nDownloading Packages:\n(1/2): libdb-utils-5.3.28-19.fc26.x86_64.rpm    4.8 MB/s | 137 kB     00:00    \n(2/2): libdb-5.3.28-17.fc26_5.3.28-19.fc26.x86_ 7.8 MB/s | 236 kB     00:00    \n[DRPM] libdb-5.3.28-17.fc26_5.3.28-19.fc26.x86_64.drpm: done                   \n--------------------------------------------------------------------------------\nTotal                                           337 kB/s | 373 kB     00:01     \nDelta RPMs reduced 0.9 MB of updates to 0.4 MB (57.1% saved)\nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Preparing        :                                                        1/1 \n  Upgrading        : libdb-5.3.28-19.fc26.x86_64                            1/4 \n  Running scriptlet: libdb-5.3.28-19.fc26.x86_64                            1/4 \nSegmentation fault (core dumped)\n\nsh# rpm -q libdb\nSegmentation fault (core dumped)"
							},
							{
								"isprivate": "0",
								"commentid": "10450873",
								"comment_count": "39",
								"who": {
									"text": "ignatenko",
									"name": "Igor Gnatenko"
								},
								"bug_when": "2017-05-26 10:57:06 +0000",
								"thetext": "*** Bug 1455823 has been marked as a duplicate of this bug. ***"
							},
							{
								"isprivate": "0",
								"commentid": "10450876",
								"comment_count": "40",
								"who": {
									"text": "ignatenko",
									"name": "Igor Gnatenko"
								},
								"bug_when": "2017-05-26 10:57:39 +0000",
								"thetext": "*** Bug 1455864 has been marked as a duplicate of this bug. ***"
							},
							{
								"isprivate": "0",
								"commentid": "10450892",
								"comment_count": "41",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2017-05-26 11:05:35 +0000",
								"thetext": "I hit submit too fast.\n\nsh# rpm -q libdb\nSegmentation fault (core dumped)\n\nsh# rpm --rebuilddb \n\nsh# rpm -q libdb\nlibdb-5.3.28-19.fc26.x86_64\nlibdb-5.3.28-17.fc26.x86_64\n\nsh# rpm -q --scripts libdb\npostinstall program: /sbin/ldconfig\npostuninstall program: /sbin/ldconfig\npostinstall program: /sbin/ldconfig\npostuninstall program: /sbin/ldconfig\n\nI doubt anyone tested package before pushing to updates-testing.\n\nBTW it is not bug in dnf because similar problems are with yum-deprecated or microdnf. It is bug in libdb"
							},
							{
								"isprivate": "0",
								"commentid": "10451916",
								"comment_count": "42",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2017-05-26 15:33:17 +0000",
								"thetext": "Lukas, try to understand that not everybody's experience equals yours. \n\nFor example I did test the thing and saw ZERO crashes, only when downgrading back to previous libdb version did I see problems (which doesn't always happen but is not unexpected). \n\nThe actual bug is that librpm doesn't sufficiently isolate libdb from the rest of the world, and s*** like this hits the fan once every few years in that one transaction where some deep magic like glibc futex internals change. Truly fixing that would likely require drastic architectural change in rpm to force all database access through a single daemon so there can never be two different versions trying to access the same db."
							},
							{
								"isprivate": "0",
								"commentid": "10452142",
								"comment_count": "43",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2017-05-26 16:33:13 +0000",
								"thetext": "(In reply to Panu Matilainen from comment #42)\n> Lukas, try to understand that not everybody's experience equals yours. \n> \n> For example I did test the thing and saw ZERO crashes, only when downgrading\n> back to previous libdb version did I see problems (which doesn't always\n> happen but is not unexpected). \n> \n> The actual bug is that librpm doesn't sufficiently isolate libdb from the\n> rest of the world, and s*** like this hits the fan once every few years in\n> that one transaction where some deep magic like glibc futex internals\n> change. Truly fixing that would likely require drastic architectural change\n> in rpm to force all database access through a single daemon so there can\n> never be two different versions trying to access the same db.\n\nPannu, what did you test and where/which machine?\n\nBecause upgrade on fedora 26 does not work for me with rpm, yum-deprecated (upgrade does not finish) snd -> crash. And I tested with 3 different fedora 26 machines. It crashed even in f26 docker containers(x86_64, i686) which I use for integration testing of unrelated project. It does not look like a corner-case to me. Or only very low change that only I hit bug everywhere.\n\nBTW If you really cannot reproduce yourself and need more logs/info/valgrind output ... then I will be glad to provide them."
							},
							{
								"isprivate": "0",
								"commentid": "10452201",
								"comment_count": "44",
								"who": {
									"text": "plroskin",
									"name": "Pavel Roskin"
								},
								"bug_when": "2017-05-26 16:59:44 +0000",
								"thetext": "I don't know if that's the original issue, but I also experienced dnf crash on update of Fedora 26 that required \"rpm --rebuilddb\". I experienced the same issue on two different systems in the recent hours. Both track Fedora 26. One was upgraded two months ago (when alpha was released), another was installed as Fedora 26 around the same time. Both systems have fedora-updates-testing enabled. The symptoms are:\n\n\"dnf upgrade\" tries to upgrade a large number of packages and crashes:\n\n  Running scriptlet: qpdf-libs-6.0.0-4.fc26.x86_64\n  Cleanup          : microcode_ctl-2:2.1-14.1.fc26.x86_64\n  Cleanup          : libv4l-1.12.5-1.fc26.x86_64\n  Running scriptlet: libv4l-1.12.5-1.fc26.x86_64\n  Running scriptlet: gssproxy-0.7.0-7.fc26.x86_64\nFloating point exception\n\nKernel log shows divide error in deleted (!!!) libdb-5.3.so\n\n[  340.774423] traps: dnf[2177] trap divide error ip:7fdd2eaa9f32 sp:7ffc3f07cb00 error:0 in libdb-5.3.so (deleted)[7fdd2e9d2000+1b5000]\n\n\"package-cleanup --cleandupes\" segfaults\n\n[  413.885836] traps: package-cleanup[4076] general protection ip:7f86c15d6683 sp:7ffcc0cf2190 error:0 in libdb-5.3.so[7f86c14b1000+1b6000]\n\n\"rpm --rebuilddb\" works\n\n\"package-cleanup --cleandupes\" works\n\n  Erasing    : 1:dmidecode-3.0-8.fc26.x86_64\n  Erasing    : gssproxy-0.7.0-7.fc26.x86_64\n  Erasing    : gperftools-libs-2.5.91-1.fc26.x86_64\n\n\"dnf check\" passes"
							},
							{
								"isprivate": "0",
								"commentid": "10452217",
								"comment_count": "45",
								"who": {
									"text": "pkubat",
									"name": "Petr Kubat"
								},
								"bug_when": "2017-05-26 17:12:46 +0000",
								"thetext": "Lukas, Pavel and anyone other hitting this issue:\nPlease provide us with result of either \"dnf --rpmverbosity debug update\", or \"rpm -Uvv\" when upgrading through rpm. This will tell us much more about where in the update process the failure takes place.\n\nThank you!"
							},
							{
								"isprivate": "0",
								"commentid": "10452373",
								"comment_count": "46",
								"who": {
									"text": "plroskin",
									"name": "Pavel Roskin"
								},
								"bug_when": "2017-05-26 18:37:07 +0000",
								"thetext": "I cannot reproduce the issue by downgrading the packages that were upgraded today and redoing the upgrade. But I noticed that if I downgrade libdb, I need to run \"rpm --rebuilddb\". I don't know if it's normal."
							},
							{
								"isprivate": "0",
								"commentid": "10452422",
								"comment_count": "47",
								"who": {
									"text": "fedora",
									"name": "Christian Stadelmann"
								},
								"bug_when": "2017-05-26 19:03:25 +0000",
								"thetext": "(In reply to Pavel Roskin from comment #46)\n> I cannot reproduce the issue by downgrading the packages that were upgraded\n> today and redoing the upgrade. But I noticed that if I downgrade libdb, I\n> need to run \"rpm --rebuilddb\". I don't know if it's normal.\n\nIt looks like you have reproduced the issue, if your RPM database broke. Sometimes the crash happens after dnf finishes or in a separate process using RPM, e.g. dnf makecache."
							},
							{
								"isprivate": "0",
								"commentid": "10452529",
								"comment_count": "48",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2017-05-26 20:09:32 +0000",
								"thetext": "[root@host rpms]# rpm -qa \"libdb*\"\nlibdb-utils-5.3.28-17.fc26.x86_64\nlibdb-5.3.28-17.fc26.x86_64\n\n[root@host rpms]# rpm -Uvvv libdb-5.3.28-19.fc26.x86_64.rpm  libdb-utils-5.3.28-19.fc26.x86_64.rpm\nufdio:       1 reads,    16960 total bytes in 0.000016 secs\nufdio:       1 reads,     4874 total bytes in 0.000001 secs\nufdio:       1 reads,    16960 total bytes in 0.000006 secs\nD: ============== libdb-5.3.28-19.fc26.x86_64.rpm\nD: loading keyring from pubkeys in /var/lib/rpm/pubkeys/*.key\nD: couldn't find any keys in /var/lib/rpm/pubkeys/*.key\nD: loading keyring from rpmdb\nD: opening  db environment /var/lib/rpm cdb:0x401\nD: opening  db index       /var/lib/rpm/Packages 0x400 mode=0x0\nD: locked   db index       /var/lib/rpm/Packages\nD: opening  db index       /var/lib/rpm/Name 0x400 mode=0x0\nD:  read h#      50 Header SHA1 digest: OK (3faba9ffbffc3a2d283452d115959d3d0c6fe2fa)\nD: added key gpg-pubkey-fdb19c98-56fd6333 to keyring\nD:  read h#     983 Header SHA1 digest: OK (44dfac3a3ed2ad52f6139c5313da593614f56803)\nD: added key gpg-pubkey-34ec9cba-54e38751 to keyring\nD:  read h#    1020 Header SHA1 digest: OK (cfe21d873624cf8171e50d34136dbc005df076ed)\nD: added key gpg-pubkey-81b46521-55b3ca9a to keyring\nD:  read h#    1894 Header SHA1 digest: OK (5e75131638942274458bbc47adc744c3f502a8e8)\nD: added key gpg-pubkey-64dab85d-57d33e22 to keyring\nD:  read h#    1923 Header SHA1 digest: OK (10c972a7cd84e939380e135e42e6566833a140f6)\nD: added key gpg-pubkey-f5282ee4-58ac92a3 to keyring\nD:  read h#    2062 Header SHA1 digest: OK (6ece1dbaaa4150376442430d5a07f4d54c135dec)\nD: added key gpg-pubkey-98ab5139-4bf2d0b0 to keyring\nD: Using legacy gpg-pubkey(s) from rpmdb\nD: Expected size:       767222 = lead(96)+sigs(4324)+pad(4)+data(762798)\nD:   Actual size:       767222\nD: libdb-5.3.28-19.fc26.x86_64.rpm: Header SHA1 digest: OK (cc6f9b160a1c8a2f128b48d77a88bd8c1009d710)\nufdio:       6 reads,    14370 total bytes in 0.000009 secs\nD: Plugin: calling hook init in systemd_inhibit plugin\nD:  read h#     750 Header SHA1 digest: OK (fd008120d31275ac46e0759e0e41ef7d9d4f9fbc)\nD:      added binary package [0]\nD: ============== libdb-utils-5.3.28-19.fc26.x86_64.rpm\nD: Expected size:       140406 = lead(96)+sigs(4324)+pad(4)+data(135982)\nD:   Actual size:       140406\nD: libdb-utils-5.3.28-19.fc26.x86_64.rpm: Header SHA1 digest: OK (863b47cdec17d7cda4df885dd1438a8629c31f04)\nufdio:       6 reads,    20738 total bytes in 0.000014 secs\nD:  read h#    1547 Header SHA1 digest: OK (137fb7a99f7ae0f5a59fd12b724a29c348be1e60)\nD:      added binary package [1]\nD: found 0 source and 2 binary packages\nD: opening  db index       /var/lib/rpm/Conflictname 0x400 mode=0x0\nD: opening  db index       /var/lib/rpm/Requirename 0x400 mode=0x0\nD: ========== +++ libdb-5.3.28-19.fc26 x86_64/linux 0x2\nD: opening  db index       /var/lib/rpm/Basenames 0x400 mode=0x0\nD:  read h#    1413 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: /sbin/ldconfig                                YES (db files)\nD:  Requires: /sbin/ldconfig                                YES (cached)\nD: opening  db index       /var/lib/rpm/Providename 0x400 mode=0x0\nD:  Requires: libc.so.6()(64bit)                            YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.14)(64bit)                  YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.15)(64bit)                  YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.17)(64bit)                  YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.2.5)(64bit)                 YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.3)(64bit)                   YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.3.4)(64bit)                 YES (db provides)\nD:  Requires: libc.so.6(GLIBC_2.4)(64bit)                   YES (db provides)\nD:  Requires: libpthread.so.0()(64bit)                      YES (db provides)\nD:  Requires: libpthread.so.0(GLIBC_2.2.5)(64bit)           YES (db provides)\nD:  Requires: libpthread.so.0(GLIBC_2.3.2)(64bit)           YES (db provides)\nD:  Requires: rpmlib(CompressedFileNames) <= 3.0.4-1        YES (rpmlib provides)\nD:  Requires: rpmlib(FileDigests) <= 4.6.0-1                YES (rpmlib provides)\nD:  Requires: rpmlib(PayloadFilesHavePrefix) <= 4.0-1       YES (rpmlib provides)\nD:  Requires: rpmlib(PayloadIsXz) <= 5.2-1                  YES (rpmlib provides)\nD:  Requires: rtld(GNU_HASH)                                YES (db provides)\nD:  read h#     851 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD: Conflicts: filesystem < 3                                NO  \nD: opening  db index       /var/lib/rpm/Obsoletename 0x400 mode=0x0\nD: ========== +++ libdb-utils-5.3.28-19.fc26 x86_64/linux 0x2\nD:  Requires: libc.so.6()(64bit)                            YES (cached)\nD:  Requires: libc.so.6(GLIBC_2.14)(64bit)                  YES (cached)\nD:  Requires: libc.so.6(GLIBC_2.2.5)(64bit)                 YES (cached)\nD:  Requires: libc.so.6(GLIBC_2.3)(64bit)                   YES (cached)\nD:  Requires: libc.so.6(GLIBC_2.3.4)(64bit)                 YES (cached)\nD:  Requires: libc.so.6(GLIBC_2.4)(64bit)                   YES (cached)\nD:  Requires: libdb(x86-64) = 5.3.28-19.fc26                YES (added provide)\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  Requires: libpthread.so.0()(64bit)                      YES (cached)\nD:  Requires: libpthread.so.0(GLIBC_2.2.5)(64bit)           YES (cached)\nD:  Requires: rpmlib(CompressedFileNames) <= 3.0.4-1        YES (rpmlib provides)\nD:  Requires: rpmlib(FileDigests) <= 4.6.0-1                YES (rpmlib provides)\nD:  Requires: rpmlib(PayloadFilesHavePrefix) <= 4.0-1       YES (rpmlib provides)\nD:  Requires: rpmlib(PayloadIsXz) <= 5.2-1                  YES (rpmlib provides)\nD:  Requires: rtld(GNU_HASH)                                YES (cached)\nD: ========== --- libdb-5.3.28-17.fc26 x86_64/linux 0x2\nD:  read h#      70 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     228 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     376 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     417 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     446 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     453 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     501 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     550 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     683 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     763 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     801 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#     827 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1063 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1360 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1575 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1639 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1658 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1814 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    1860 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  read h#    2108 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD: ========== --- libdb-utils-5.3.28-17.fc26 x86_64/linux 0x2\nD:  read h#    1021 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nD:  Requires: libdb-utils                                   YES (added provide)\nD:  Requires: libdb-utils                                   YES (added provide)\nD:  Requires: /usr/bin/db_stat                              YES (added files)\nD: ========== recording tsort relations\nD:  Requires: libdb(x86-64) = 5.3.28-19.fc26                YES (added provide)\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD:  Requires: libdb(x86-64) = 5.3.28-17.fc26                YES (added provide)\nD:  Requires: libdb-5.3.so()(64bit)                         YES (added provide)\nD: ========== tsorting packages (order, #predecessors, #succesors, depth)\nD:     0    0    1    1   +libdb-5.3.28-19.fc26.x86_64\nD:     1    0    0    2     +libdb-utils-5.3.28-19.fc26.x86_64\nD:     2    0    1    1   -libdb-utils-5.3.28-17.fc26.x86_64\nD:     3    0    0    2     -libdb-5.3.28-17.fc26.x86_64\nD: installing binary packages\nD: closed   db index       /var/lib/rpm/Packages\nD: closed   db index       /var/lib/rpm/Obsoletename\nD: closed   db index       /var/lib/rpm/Conflictname\nD: closed   db index       /var/lib/rpm/Providename\nD: closed   db index       /var/lib/rpm/Requirename\nD: closed   db index       /var/lib/rpm/Basenames\nD: closed   db index       /var/lib/rpm/Name\nD: closed   db environment /var/lib/rpm\nD: opening  db environment /var/lib/rpm cdb:0x401\nD: opening  db index       /var/lib/rpm/Packages (none) mode=0x42\nD: sanity checking 4 elements\nD: opening  db index       /var/lib/rpm/Name (none) mode=0x42\nD:  read h#     750 Header SHA1 digest: OK (fd008120d31275ac46e0759e0e41ef7d9d4f9fbc)\nD:  read h#    1547 Header SHA1 digest: OK (137fb7a99f7ae0f5a59fd12b724a29c348be1e60)\nD: Plugin: calling hook tsm_pre in selinux plugin\nD: Plugin: calling hook tsm_pre in systemd_inhibit plugin\nD: System shutdown blocked (fd 12)\nD: opening  db index       /var/lib/rpm/Transfiletriggername (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Dirnames (none) mode=0x42\nD: unknown: libdb-utils-5.3.28-17.fc26.x86_64 has 30 files\nD: Plugin: calling hook psm_pre in selinux plugin\nD: unknown: libdb-5.3.28-17.fc26.x86_64 has 7 files\nD: Plugin: calling hook psm_pre in selinux plugin\nD: running pre-transaction scripts\nD: computing 74 file fingerprints\nD: opening  db index       /var/lib/rpm/Basenames (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Group (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Requirename (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Providename (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Conflictname (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Obsoletename (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Triggername (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Installtid (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Sigmd5 (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Sha1header (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Filetriggername (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Recommendname (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Suggestname (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Supplementname (none) mode=0x42\nD: opening  db index       /var/lib/rpm/Enhancename (none) mode=0x42\nPreparing packages...\nD: computing file dispositions\nD: 0x00000028     4096      2542694           -1 /\nD: ========== +++ libdb-5.3.28-19.fc26 x86_64-linux 0x2\nD: Expected size:       767222 = lead(96)+sigs(4324)+pad(4)+data(762798)\nD:   Actual size:       767222\nD: libdb-5.3.28-19.fc26.x86_64: Header SHA1 digest: OK (cc6f9b160a1c8a2f128b48d77a88bd8c1009d710)\nD:   install: libdb-5.3.28-19.fc26.x86_64 has 7 files\nD: Plugin: calling hook psm_pre in selinux plugin\nD:  read h#    1814 Header V3 RSA/SHA256 Signature, key ID 64dab85d: OK\nlibdb-5.3.28-19.fc26.x86_64\nD: ========== Directories not explicitly included in package:\nD:          0 /usr/lib64/\nD:          1 /usr/share/doc/\nD:          3 /usr/share/licenses/\nD: ==========\nD: create     100755  1 (   0,   0)1853896 /usr/lib64/libdb-5.3.so;59288a17\nufdio:      57 writes,  1853896 total bytes in 0.000611 secs\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/lib64/libdb-5.3.so;59288a17, system_u:object_r:lib_t:s0) \nD: create     120777  1 (   0,   0)    12 /usr/lib64/libdb-5.so;59288a17\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/lib64/libdb-5.so;59288a17, system_u:object_r:lib_t:s0) \nD: create     040755  1 (   0,   0)     0 /usr/share/doc/libdb\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/share/doc/libdb, system_u:object_r:usr_t:s0) \nD: create     100644  1 (   0,   0)   240 /usr/share/doc/libdb/README;59288a17\nufdio:       1 writes,      240 total bytes in 0.000014 secs\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/share/doc/libdb/README;59288a17, system_u:object_r:usr_t:s0) \nD: create     040755  1 (   0,   0)     0 /usr/share/licenses/libdb\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/share/licenses/libdb, system_u:object_r:usr_t:s0) \nD: create     100644  1 (   0,   0)  7310 /usr/share/licenses/libdb/LICENSE;59288a17\nufdio:       1 writes,     7310 total bytes in 0.000011 secs\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/share/licenses/libdb/LICENSE;59288a17, system_u:object_r:usr_t:s0) \nD: create     100644  1 (   0,   0) 26530 /usr/share/licenses/libdb/lgpl-2.1.txt;59288a17\nufdio:       1 writes,    26530 total bytes in 0.000018 secs\nD: Plugin: calling hook fsm_file_prepare in selinux plugin\nD: lsetfilecon: (/usr/share/licenses/libdb/lgpl-2.1.txt;59288a17, system_u:object_r:usr_t:s0) \nfdio:      94 reads,  1889100 total bytes in 0.053953 secs\nD: adding \"libdb\" to Name index.\nD: adding 7 entries to Basenames index.\nD: adding \"System Environment/Libraries\" to Group index.\nD: adding 18 entries to Requirename index.\nD: adding 3 entries to Providename index.\nD: adding 1 entries to Conflictname index.\nD: adding 5 entries to Dirnames index.\nD: adding 1 entries to Installtid index.\nD: adding 1 entries to Sigmd5 index.\nD: adding \"cc6f9b160a1c8a2f128b48d77a88bd8c1009d710\" to Sha1header index.\nD: %post(libdb-5.3.28-19.fc26.x86_64): scriptlet start\nD: %post(libdb-5.3.28-19.fc26.x86_64): execv(/sbin/ldconfig) pid 32495\nD: Plugin: calling hook scriptlet_fork_post in selinux plugin\nD: setexecfilecon: (/sbin/ldconfig) \nD: %post(libdb-5.3.28-19.fc26.x86_64): waitpid(32495) rc 32495 status 0\nD: %triggerin(openldap-servers-2.4.44-10.fc26.x86_64): scriptlet start\nfdio:       2 writes,      368 total bytes in 0.000032 secs\nD: %triggerin(openldap-servers-2.4.44-10.fc26.x86_64): execv(/bin/sh) pid 32496\nD: Plugin: calling hook scriptlet_fork_post in selinux plugin\nD: setexecfilecon: (/bin/sh) \n+ '[' 2 -eq 2 ']'\n++ rpm -q '--qf=%{version}\\n' libdb\n++ wc -l\n++ sort -u\n++ sed 's/\\.[0-9]*$//'\n+ '[' 1 '!=' 1 ']'\n+ rm -f /var/lib/ldap/rpm_upgrade_libdb\n+ exit 0\nD: %triggerin(openldap-servers-2.4.44-10.fc26.x86_64): waitpid(32496) rc 32496 status 0\nerror: rpmdb: DB_LOCK->lock_put: Lock is no longer valid\nerror: db5 error(22) from dbcursor->c_close: Invalid argument\n\n\nAnd upgrade has not finished yet"
							},
							{
								"isprivate": "0",
								"commentid": "10452608",
								"comment_count": "49",
								"who": {
									"text": "lslebodn",
									"name": "Lukas Slebodnik"
								},
								"bug_when": "2017-05-26 21:21:13 +0000",
								"thetext": "rpm is busy (100%CPU) even after 60 minutes; so I killed it.\n\nSo it looks like I was really lucky that openldap-servers was installed in all my cases even though it was not running anywhere. I am so sorry that I was so pessimistic and a little bit frustrated."
							},
							{
								"isprivate": "0",
								"commentid": "10454712",
								"comment_count": "50",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2017-05-29 06:33:10 +0000",
								"thetext": "(In reply to Lukas Slebodnik from comment #43)\n> Pannu, what did you test and where/which machine?\n\nIt's Panu, with a single n, BTW.\n\nI'm sure I tested something different than you did. Which is the whole point: people HAVE tested the fix in good faith without seeing the crashes you're seeing. Not everybody has openldap-servers installed, and (thank goodness) not many packages are naughty enough to call rpm from scriptlets. \n\nRunning rpm queries manually during the upgrade would have the same effect so it's not all just about naughty packages either.\n\nIn any case, good thing is it did get caught before going further, updates-testing served its purpose."
							},
							{
								"isprivate": "0",
								"commentid": "10454813",
								"comment_count": "51",
								"who": {
									"text": "ignatenko",
									"name": "Igor Gnatenko"
								},
								"bug_when": "2017-05-29 07:27:21 +0000",
								"thetext": "*** Bug 1455750 has been marked as a duplicate of this bug. ***"
							},
							{
								"isprivate": "0",
								"commentid": "10460136",
								"comment_count": "52",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-05-30 19:40:13 +0000",
								"thetext": "For the record, we're transferring the blocker status from this bug to https://bugzilla.redhat.com/show_bug.cgi?id=1397087 , which is the specific bug we really voted on as a blocker issue. It's not really appropriate to grant blocker status to tracker bugs, as their 'meaning' could change over time - say in this case, we could resolve the current issue but then some much smaller bug which caused an issue only very rarely (and maybe only on a secondary arch) could be set as blocking this tracker, and then that would instantly 'become' a release blocker. Which we don't want."
							},
							{
								"isprivate": "0",
								"commentid": "10463048",
								"comment_count": "53",
								"who": {
									"text": "ignatenko",
									"name": "Igor Gnatenko"
								},
								"bug_when": "2017-05-31 11:52:30 +0000",
								"thetext": "*** Bug 1456788 has been marked as a duplicate of this bug. ***"
							},
							{
								"isprivate": "0",
								"commentid": "10463050",
								"comment_count": "54",
								"who": {
									"text": "ignatenko",
									"name": "Igor Gnatenko"
								},
								"bug_when": "2017-05-31 11:52:35 +0000",
								"thetext": "*** Bug 1456002 has been marked as a duplicate of this bug. ***"
							},
							{
								"isprivate": "0",
								"commentid": "10468553",
								"comment_count": "55",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-01 12:44:41 +0000",
								"thetext": "libdb-5.3.28-21.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
							},
							{
								"isprivate": "0",
								"commentid": "10470757",
								"comment_count": "56",
								"who": {
									"text": "pwhalen",
									"name": "Paul Whalen"
								},
								"bug_when": "2017-06-02 02:10:19 +0000",
								"thetext": "using libdb-5.3.28-21.fc26 armhfp and aarch64 successfully upgraded with dnf-plugin-system-upgrade+local repo"
							},
							{
								"isprivate": "0",
								"commentid": "10471093",
								"comment_count": "57",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-06-02 05:30:40 +0000",
								"thetext": "It'd be really great if people could help test the new update hard: test that it fixes the actual bug, test it in the scenarios that caused trouble with -18 and -19, etc. We want to get this fix out for Beta, but we don't want to send it unless we're sure it's good. Thanks a lot!"
							},
							{
								"isprivate": "0",
								"commentid": "10472354",
								"comment_count": "58",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-02 13:00:16 +0000",
								"thetext": "libdb-5.3.28-21.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf"
							},
							{
								"isprivate": "0",
								"commentid": "10472359",
								"comment_count": "59",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-02 13:00:54 +0000",
								"thetext": "libdb-5.3.28-21.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
							},
							{
								"isprivate": "0",
								"commentid": "10472661",
								"comment_count": "60",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-06-02 14:35:20 +0000",
								"thetext": "I did a check with ppc64le and the issue is still here. This is what I did\n- installed F-25 \"minimal\"\n- updated libdb to libdb-5.3.28-21.fc25.ppc64le (downloaded from ppc koji)\n- created a side repo for F-26 libdb containing libdb-5.3.28-21.fc26.ppc64le (downloaded from primary koji)\n- run \"dnf distro-sync --releasever 26\" with the side repo enabled\n- and got a hung after\n...\n  Cleanup     : crypto-policies-20160921-4.gitf3018dd.fc25.noarch  614/708 \n  Cleanup     : krb5-libs-1.14.4-7.fc25.ppc64le                    615/708"
							},
							{
								"isprivate": "0",
								"commentid": "10472783",
								"comment_count": "61",
								"who": {
									"text": "mattdm",
									"name": "Matthew Miller"
								},
								"bug_when": "2017-06-02 15:09:49 +0000",
								"thetext": "(In reply to Dan Hork from comment #60)\n> I did a check with ppc64le and the issue is still here. This is what I did\n> - installed F-25 \"minimal\"\n> - updated libdb to libdb-5.3.28-21.fc25.ppc64le (downloaded from ppc koji)\n> - created a side repo for F-26 libdb containing libdb-5.3.28-21.fc26.ppc64le\n> (downloaded from primary koji)\n> - run \"dnf distro-sync --releasever 26\" with the side repo enabled\n> - and got a hung after\n> ...\n>   Cleanup     : crypto-policies-20160921-4.gitf3018dd.fc25.noarch  614/708 \n>   Cleanup     : krb5-libs-1.14.4-7.fc25.ppc64le                    615/708\n\nDan, do you get hangs with dnf system-upgrade? It's just doing an online update that is problematic?"
							},
							{
								"isprivate": "0",
								"commentid": "10472796",
								"comment_count": "62",
								"who": {
									"text": "mtasaka",
									"name": "Mamoru TASAKA"
								},
								"bug_when": "2017-06-02 15:19:23 +0000",
								"thetext": "Well, my recognition is that \n* -18 and -19 applied a patch which are supposed to fix hang issue in -17, but it caused segv\n* -21 removed the patch applied on -18 and -19, so -21 is effencially same as -17, and while segv is gone, hang issue in -17 \"should\" reappear.\n\nAm I right?"
							},
							{
								"isprivate": "0",
								"commentid": "10472809",
								"comment_count": "63",
								"who": {
									"text": "mtasaka",
									"name": "Mamoru TASAKA"
								},
								"bug_when": "2017-06-02 15:20:59 +0000",
								"thetext": "(In reply to Mamoru TASAKA from comment #62)\n> Well, my recognition is that \n> * -18 and -19 applied a patch which are supposed to fix hang issue in -17,\n> but it caused segv\n> * -21 removed the patch applied on -18 and -19, so -21 is effencially same\n> as -17, and while segv is gone, hang issue in -17 \"should\" reappear.\n> \n> Am I right?\n\nOops, removing patch was done in -20, -21 introduced other patch, sorry."
							},
							{
								"isprivate": "0",
								"commentid": "10472904",
								"comment_count": "64",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-06-02 15:38:35 +0000",
								"thetext": "(In reply to Matthew Miller from comment #61)\n> (In reply to Dan Hork from comment #60)\n> > I did a check with ppc64le and the issue is still here. This is what I did\n> > - installed F-25 \"minimal\"\n> > - updated libdb to libdb-5.3.28-21.fc25.ppc64le (downloaded from ppc koji)\n> > - created a side repo for F-26 libdb containing libdb-5.3.28-21.fc26.ppc64le\n> > (downloaded from primary koji)\n> > - run \"dnf distro-sync --releasever 26\" with the side repo enabled\n> > - and got a hung after\n> > ...\n> >   Cleanup     : crypto-policies-20160921-4.gitf3018dd.fc25.noarch  614/708 \n> >   Cleanup     : krb5-libs-1.14.4-7.fc25.ppc64le                    615/708\n> \n> Dan, do you get hangs with dnf system-upgrade? It's just doing an online\n> update that is problematic?\n\n- installed F-25 \"minimal\"\n- created a side repo for F-26 libdb containing libdb-5.3.28-21.fc26.ppc64le (downloaded from primary koji)\n- run \"dnf system-upgrade download --releasever 26\" with the side repo enabled\n- run \"dnf system-upgrade reboot\"\n- and got a hung at\n [620/714]  Cleanup : crypto-policies-20160921-4.gitf3018dd.fc25.noarch\non the console"
							},
							{
								"isprivate": "0",
								"commentid": "10472915",
								"comment_count": "65",
								"who": {
									"text": "mattdm",
									"name": "Matthew Miller"
								},
								"bug_when": "2017-06-02 15:39:47 +0000",
								"thetext": "Well, that answers that. :( Thanks Dan."
							},
							{
								"isprivate": "0",
								"commentid": "10472928",
								"comment_count": "66",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-06-02 15:42:59 +0000",
								"thetext": "Dan: did you check the correct libdb version was actually included in the distro-sync / upgrade transactions?"
							},
							{
								"isprivate": "0",
								"commentid": "10472963",
								"comment_count": "67",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-06-02 15:46:16 +0000",
								"thetext": "(In reply to Adam Williamson from comment #66)\n> Dan: did you check the correct libdb version was actually included in the\n> distro-sync / upgrade transactions?\n\nit's listed in the \"download\" phase, so it should be then also installed/updated\n\n...\n libcroco                                                  ppc64le                         0.6.12-1.fc26                                                 fedora                         121 k\n libcrypt-nss                                              ppc64le                         2.25-4.fc26                                                   fedora                          53 k\n libcurl                                                   ppc64le                         7.53.1-7.fc26                                                 fedora                         294 k\n libdb                                                     ppc64le                         5.3.28-21.fc26                                                libdb                          798 k\n libdb-utils                                               ppc64le                         5.3.28-21.fc26                                                libdb                          150 k\n libedit                                                   ppc64le                         3.1-17.20160618cvs.fc26                                       fedora                         107 k\n libfdisk                                                  ppc64le                         2.29.1-2.fc26                                                 fedora                         248 k\n libffi                                                    ppc64le                         3.1-10.fc26                                                   fedora                          35 k\n libgcc                                                    ppc64le                         7.1.1-1.fc26                                                  fedora                          76 k\n..."
							},
							{
								"isprivate": "0",
								"commentid": "10474622",
								"comment_count": "68",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-04 05:10:25 +0000",
								"thetext": "libdb-5.3.28-21.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-a4c41ecc27"
							},
							{
								"isprivate": "0",
								"commentid": "10475802",
								"comment_count": "69",
								"who": {
									"text": "pkubat",
									"name": "Petr Kubat"
								},
								"bug_when": "2017-06-05 06:15:51 +0000",
								"thetext": "Hi Dan,\ncan you reproduce this issue using debugging output so that we can see where dnf freezes? Running with \"--rpmverbosity debug\" should do the trick.\n\nAlso are you able to reproduce this even after updating libdb to the latest version for F25 (https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf) before running the upgrade to F26?"
							},
							{
								"isprivate": "0",
								"commentid": "10476162",
								"comment_count": "70",
								"who": {
									"text": "besser82",
									"name": "Bjrn 'besser82' Esser"
								},
								"bug_when": "2017-06-05 08:02:30 +0000",
								"thetext": "Looking at https://bugzilla.redhat.com/show_bug.cgi?id=1443415#c60 and https://bugzilla.redhat.com/show_bug.cgi?id=1443415#c64, Dan tried both options: with updating to -21 libdb on F25 and without."
							},
							{
								"isprivate": "0",
								"commentid": "10476263",
								"comment_count": "71",
								"who": {
									"text": "pkubat",
									"name": "Petr Kubat"
								},
								"bug_when": "2017-06-05 08:21:45 +0000",
								"thetext": ">Dan tried both options: with updating to -21 libdb on F25 and without.\n\nMissed that, thanks!\n\nIn any case the debug output would still be immensely helpful as I am currently unable to reproduce the hang on a ppc64le box."
							},
							{
								"isprivate": "0",
								"commentid": "10476284",
								"comment_count": "72",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-06-05 08:26:43 +0000",
								"thetext": "(In reply to Petr Kubat from comment #69)\n> Hi Dan,\n> can you reproduce this issue using debugging output so that we can see where\n> dnf freezes? Running with \"--rpmverbosity debug\" should do the trick.\n> \n> Also are you able to reproduce this even after updating libdb to the latest\n> version for F25\n> (https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf) before\n> running the upgrade to F26?\n\nPetr, I'll check with you off-line and give you login info for the machine I use for reproducing the problem.\n\nFor debugging purposes I think we should stick to the online update using \"dnf distro-sync\", I couldn't access the console when running the off-line upgrade."
							},
							{
								"isprivate": "0",
								"commentid": "10476729",
								"comment_count": "73",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-06-05 10:21:56 +0000",
								"thetext": "Seems I can't reproduce the issue any more with an up-to-date F-25 system, maybe something in the updates pushed over the weekend made the change."
							},
							{
								"isprivate": "0",
								"commentid": "10476737",
								"comment_count": "74",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-06-05 10:25:15 +0000",
								"thetext": "For the record - the first in my procedure in comment #60 should read as \"install and update F-25 minimal\"."
							},
							{
								"isprivate": "0",
								"commentid": "10477022",
								"comment_count": "75",
								"who": {
									"text": "besser82",
									"name": "Bjrn 'besser82' Esser"
								},
								"bug_when": "2017-06-05 12:04:14 +0000",
								"thetext": "I cannot reproduce any hangs during the dist-upgrade when updating from an up-2-date fc24 or fc25, when having -21 libdb installed *before* upgrading to fc26."
							},
							{
								"isprivate": "0",
								"commentid": "10477029",
								"comment_count": "76",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-05 12:07:11 +0000",
								"thetext": "libdb-5.3.28-21.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
							},
							{
								"isprivate": "0",
								"commentid": "10477241",
								"comment_count": "77",
								"who": {
									"text": "pmatilai",
									"name": "Panu Matilainen"
								},
								"bug_when": "2017-06-05 13:01:19 +0000",
								"thetext": "(In reply to Bjrn \"besser82\" Esser from comment #75)\n> I cannot reproduce any hangs during the dist-upgrade when updating from an\n> up-2-date fc24 or fc25, when having -21 libdb installed *before* upgrading\n> to fc26.\n\nRight, and that's exactly the procedure that MUST be used, testing anything else is useless because it WILL fail unless libdb is updated to -21 first in a separate transaction.\n\nBased on the messages this seems to be working except with ppc64le from which we're seeing a bit mixed results. Which makes me suspect maybe ppc64le has a different issue on top of the one being fixed here."
							},
							{
								"isprivate": "0",
								"commentid": "10480074",
								"comment_count": "78",
								"who": {
									"text": "pkubat",
									"name": "Petr Kubat"
								},
								"bug_when": "2017-06-06 08:06:47 +0000",
								"thetext": "To extend upon Panu's comment:\n\nThe difference between upgrading from F24/25 with libdb updated to -21 and upgrading without the -21 libdb update already installed is that in the latter case (newly installed) libdb relies only on rpm's transaction lock to see whether it should rebuild rpmdb's environment due to VERSION_MISMATCH (change of libdb regions' internal structures) fixing the original glibc issue of bug 1394862. However since this is a feature of the -21 build there is a window in the update process after the new glibc is already installed and before the libdb -21 build gets installed during which an external process might freeze when accessing rpmdb's environment due to not being able to work with new glibc internals.\n\nIn the former case, having the libdb -21 build already installed on the system before running the upgrade to F26 makes libdb able to use its own internal flock-style lock of the environment (that is part of the fix for bug 1394862) during the upgrade instead of relying on the rpm's transaction lock (though the hack is still there to be able to install libdb -21 f24/25 build in the first place) so it would definitely be more safer running the upgrade this way.\n\nIn either of those cases I have yet to see a hang/crash get reproduced (if you can, let me know!)."
							},
							{
								"isprivate": "0",
								"commentid": "10481938",
								"comment_count": "79",
								"who": {
									"text": "menantea",
									"name": "Menanteau Guy"
								},
								"bug_when": "2017-06-06 15:17:43 +0000",
								"thetext": "I still have the problem in my side,\n1 - installed F-25 ppc64le \"minimal\"\n2 - created a side repo for F-25 libdb containing libdb-5.3.28-21.fc25.ppc64le \nand libdb-utils-5.3.28-21.fc25.ppc64le (downloaded from secondary koji)\n3 - do a \"dnf update\" and check new libdbxx -21 fc25 are installed\n4 - created a side repo for F-26 libdb containing libdb-5.3.28-21.fc26.ppc64le and libdb-utils-5.3.28-21.fc26.ppc64le (downloaded from primary koji)\n5 - run \"dnf system-upgrade download --releasever 26\" with the side repo F-26 enabled and check libdbxx -21 fc25 will be upgraded by libdbxx -21 fc26\n6 - run \"dnf system-upgrade reboot\"\n- and got a hung at \n[643/739] Cleanup crypto-policies-20160921-4.gitf3018dd.fc25.noarch...\n\nNote that I hung the same way without creation of F-26 repo of step 4 (only f25 updated with libdb -21 fc25 and no libdb repo F-26 before the system-upgrade)."
							},
							{
								"isprivate": "0",
								"commentid": "10481969",
								"comment_count": "80",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-06-06 15:24:11 +0000",
								"thetext": "I tried today again and can't reproduce it on ppoc64le. Guy, could you store the list of installed rpms from the F-25 system before starting the update? I suspect something changed between Friday and Monday in the F-25 updates, so I would compare my list with yours."
							},
							{
								"isprivate": "0",
								"commentid": "10482200",
								"comment_count": "81",
								"who": {
									"text": "menantea",
									"name": "Menanteau Guy"
								},
								"bug_when": "2017-06-06 16:23:30 +0000",
								"thetext": "Created attachment 1285467\ndnf list installed after \"dnf update\"\n\ndnf_list_installed.after_update is the list done just after the fc25 ppc64le installation update"
							},
							{
								"isprivate": "0",
								"commentid": "10482205",
								"comment_count": "82",
								"who": {
									"text": "menantea",
									"name": "Menanteau Guy"
								},
								"bug_when": "2017-06-06 16:24:21 +0000",
								"thetext": "Created attachment 1285468\nbefore update\n\ndnf_list_installed.before_upgrade is the list done after the fc25 ppc64le installation update + install of packages \"createrepo, wget, libdb -21 and libdb-utils -21\" (and dependencies)."
							},
							{
								"isprivate": "0",
								"commentid": "10486556",
								"comment_count": "83",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-07 17:40:51 +0000",
								"thetext": "libdb-5.3.28-21.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
							},
							{
								"isprivate": "0",
								"commentid": "10487164",
								"comment_count": "84",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-07 20:15:42 +0000",
								"thetext": "libdb-5.3.28-21.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf"
							},
							{
								"isprivate": "0",
								"commentid": "10488132",
								"comment_count": "85",
								"who": {
									"text": "skumari",
									"name": "Sinny Kumari"
								},
								"bug_when": "2017-06-08 06:41:10 +0000",
								"thetext": "(In reply to Dan Hork from comment #17)\n> s390x is affected as well\n\nUpgrade issue seems to be fixed for s390x as well. Did following:\n- Installed F25 and \"dnf update\"\n- created side repo for F-26 with latest libdb and libdb-utils package from s390-koji  (libdb-utils-5.3.28-21.fc26.s390x and libdb-5.3.28-21.fc26.s390x)\n- Ran \"dnf distro-sync --releasever 26\" with the side repo enabled\n- distro-sync finished successfully\n- Rebooted system successfully"
							},
							{
								"isprivate": "0",
								"commentid": "10488805",
								"comment_count": "86",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-06-08 09:57:00 +0000",
								"thetext": "Seems I can reproduce Guy's hang, with libdb-5.3.28-21.fc25.ppc64le updated before the upgrade starts."
							},
							{
								"isprivate": "0",
								"commentid": "10488846",
								"comment_count": "87",
								"who": {
									"text": "menantea",
									"name": "Menanteau Guy"
								},
								"bug_when": "2017-06-08 10:10:42 +0000",
								"thetext": "Upgrade of f25 ppc64le to f26 succeed when I use \"dnf distro-sync\" process described by Sinny (comment #85) instead of \"dnf system-upgrade\" process used by openqa test (comment #1) and described by Paul (comment #8)"
							},
							{
								"isprivate": "0",
								"commentid": "10490097",
								"comment_count": "88",
								"who": {
									"text": "dan",
									"name": "Dan Hork"
								},
								"bug_when": "2017-06-08 15:53:19 +0000",
								"thetext": "this is log from my stuck upgrade on ppc64le with libdb-5.3.28-21.fc25.ppc64le installed\n\n...\nD: ========== +++ crypto-policies-20160921-4.gitf3018dd.fc25 noarch-linux 0x0\nD:     erase: crypto-policies-20160921-4.gitf3018dd.fc25.noarch has 46 files\nD: Plugin: calling hook psm_pre in selinux plugin\nD: skip       100644  1 (   0,   0)  2856 /usr/share/man/man8/update-crypto-policies.8.gz\nD: skip       100644  1 (   0,   0) 26432 /usr/share/licenses/crypto-policies/COPYING.LESSER\nD: skip       040755  2 (   0,   0)  4096 /usr/share/licenses/crypto-policies\nD: skip       100644  1 (   0,   0)    70 /usr/share/crypto-policies/reload-cmds.sh\nD: skip       100644  1 (   0,   0)   606 /usr/share/crypto-policies/default-config\nD: skip       100644  1 (   0,   0)    87 /usr/share/crypto-policies/LEGACY/openssl.txt\nD: skip       100644  1 (   0,   0)   431 /usr/share/crypto-policies/LEGACY/nss.txt\nD: skip       100644  1 (   0,   0)   142 /usr/share/crypto-policies/LEGACY/krb5.txt\nD: skip       100644  1 (   0,   0)   312 /usr/share/crypto-policies/LEGACY/java.txt\nD: skip       100644  1 (   0,   0)   438 /usr/share/crypto-policies/LEGACY/gnutls28.txt\nD: skip       100644  1 (   0,   0)   496 /usr/share/crypto-policies/LEGACY/gnutls.txt\nD: skip       100644  1 (   0,   0)    64 /usr/share/crypto-policies/LEGACY/bind.txt\nD: skip       100644  1 (   0,   0)   103 /usr/share/crypto-policies/FUTURE/openssl.txt\nD: skip       100644  1 (   0,   0)   400 /usr/share/crypto-policies/FUTURE/nss.txt\nD: skip       100644  1 (   0,   0)   111 /usr/share/crypto-policies/FUTURE/krb5.txt\nD: skip       100644  1 (   0,   0)   386 /usr/share/crypto-policies/FUTURE/java.txt\nD: skip       100644  1 (   0,   0)   420 /usr/share/crypto-policies/FUTURE/gnutls28.txt\nD: skip       100644  1 (   0,   0)   465 /usr/share/crypto-policies/FUTURE/gnutls.txt\nD: skip       100644  1 (   0,   0)   105 /usr/share/crypto-policies/FUTURE/bind.txt\nD: skip       100644  1 (   0,   0)   160 /usr/share/crypto-policies/EMPTY/openssl.txt\nD: skip       100644  1 (   0,   0)   145 /usr/share/crypto-policies/EMPTY/nss.txt\nD: skip       100644  1 (   0,   0)    22 /usr/share/crypto-policies/EMPTY/krb5.txt\nD: skip       100644  1 (   0,   0)   594 /usr/share/crypto-policies/EMPTY/java.txt\nD: skip       100644  1 (   0,   0)    36 /usr/share/crypto-policies/EMPTY/gnutls28.txt\nD: skip       100644  1 (   0,   0)    36 /usr/share/crypto-policies/EMPTY/gnutls.txt\nD: skip       100644  1 (   0,   0)   123 /usr/share/crypto-policies/EMPTY/bind.txt\nD: skip       100644  1 (   0,   0)    97 /usr/share/crypto-policies/DEFAULT/openssl.txt\nD: skip       100644  1 (   0,   0)   418 /usr/share/crypto-policies/DEFAULT/nss.txt\nD: skip       100644  1 (   0,   0)   125 /usr/share/crypto-policies/DEFAULT/krb5.txt\nD: skip       100644  1 (   0,   0)   345 /usr/share/crypto-policies/DEFAULT/java.txt\nD: skip       100644  1 (   0,   0)   420 /usr/share/crypto-policies/DEFAULT/gnutls28.txt\nD: skip       100644  1 (   0,   0)   465 /usr/share/crypto-policies/DEFAULT/gnutls.txt\nD: skip       100644  1 (   0,   0)    70 /usr/share/crypto-policies/DEFAULT/bind.txt\nD: skip       040755  6 (   0,   0)  4096 /usr/share/crypto-policies\nD: skip       100755  1 (   0,   0)  2362 /usr/bin/update-crypto-policies\nD: skip       040755  2 (   0,   0)  4096 /etc/crypto-policies/local.d\nD: skip       100644  1 (   0,   0)   606 /etc/crypto-policies/config\nD: skip       120777  1 (   0,   0)    46 /etc/crypto-policies/back-ends/openssl.config\nD: skip       120777  1 (   0,   0)    42 /etc/crypto-policies/back-ends/nss.config\nD: skip       120777  1 (   0,   0)    43 /etc/crypto-policies/back-ends/krb5.config\nD: skip       120777  1 (   0,   0)    43 /etc/crypto-policies/back-ends/java.config\nD: skip       120777  1 (   0,   0)    47 /etc/crypto-policies/back-ends/gnutls28.config\nD: skip       120777  1 (   0,   0)    45 /etc/crypto-policies/back-ends/gnutls.config\nD: skip       120777  1 (   0,   0)    43 /etc/crypto-policies/back-ends/bind.config\nD: skip       040755  2 (   0,   0)  4096 /etc/crypto-policies/back-ends\nD: skip       040755  5 (   0,   0)  4096 /etc/crypto-policies\nfdio:       2 writes,      759 total bytes in 0.000020 secs\nD:   --- h#     186 crypto-policies-20160921-4.gitf3018dd.fc25.noarch\nD: adding \"crypto-policies\" to Name index.\nD: adding 46 entries to Basenames index.\nD: adding \"Unspecified\" to Group index.\nD: adding 8 entries to Requirename index.\nD: adding 2 entries to Providename index.\nD: adding 14 entries to Dirnames index.\nD: adding 1 entries to Installtid index.\nD: adding 1 entries to Sigmd5 index.\nD: adding \"9f33e91a20fa838c5e85706350d2b9c7e5d4ac2c\" to Sha1header index.\nD: ========== +++ krb5-libs-1.14.4-7.fc25 ppc64le-linux 0x2\nD:     erase: krb5-libs-1.14.4-7.fc25.ppc64le has 41 files\nD: Plugin: calling hook psm_pre in selinux plugin\nD: %triggerun(krb5-libs-1.15.1-8.fc26.ppc64le): scriptlet start\nD: %triggerun(krb5-libs-1.15.1-8.fc26.ppc64le): execv(/bin/sh) pid 3867\nD: Plugin: calling hook scriptlet_fork_post in selinux plugin\nD: setexecfilecon: (/bin/sh) \n++ rpm -q --qf '%{VERSION}\\n' krb5-libs\n++ sort -V\n++ tr -d '\\n'\n++ head -n 1\n+ old_ver=1.14.4\n++ rpm -q --qf '%{RELEASE}\\n' krb5-libs\n++ sort -V\n++ head -n 1\n++ tr -d '\\n'\n+ old_rel=7.fc25\n+ old_rel=7\n+ [[ 1.14.4 < 1.15.1 ]]\n+ grep -q 'includedir /etc/krb5.conf.d' /etc/krb5.conf\n+ exit 0\nD: %triggerun(krb5-libs-1.15.1-8.fc26.ppc64le): waitpid(3867) rc 3867 status 0\n  Cleanup     : krb5-libs-1.14.4-7.fc25.ppc64le                                                                                                                                       613/706 \nD: skip       040755  2 (   0,   0)  4096 /var/kerberos/krb5/user\nD: skip       040755  3 (   0,   0)  4096 /var/kerberos/krb5\nD: skip       040755  3 (   0,   0)  4096 /var/kerberos\nD: skip       100644  1 (   0,   0) 13970 /usr/share/man/man5/krb5.conf.5.gz\nD: skip       100644  1 (   0,   0)  1176 /usr/share/man/man5/k5login.5.gz\nD: skip       100644  1 (   0,   0)  1207 /usr/share/man/man5/k5identity.5.gz\nD: skip       100644  1 (   0,   0)    39 /usr/share/man/man5/.k5login.5.gz\nD: skip       100644  1 (   0,   0)    42 /usr/share/man/man5/.k5identity.5.gz\nD: skip       100644  1 (   0,   0)   410 /usr/share/locale/en_US/LC_MESSAGES/mit-krb5.mo\nD: skip       100644  1 (   0,   0) 61301 /usr/share/licenses/krb5-libs/LICENSE\nD: skip       040755  2 (   0,   0)  4096 /usr/share/licenses/krb5-libs\nD: skip       100644  1 (   0,   0) 15120 /usr/share/doc/krb5-libs/README\nD: skip       100644  1 (   0,   0) 61301 /usr/share/doc/krb5-libs/NOTICE\nD: skip       040755  2 (   0,   0)  4096 /usr/share/doc/krb5-libs\nD: skip       100755  1 (   0,   0)135408 /usr/lib64/libkrb5support.so.0.1\nD: skip       120777  1 (   0,   0)    21 /usr/lib64/libkrb5support.so.0\nD: skip       100755  1 (   0,   0)1199384 /usr/lib64/libkrb5.so.3.3\nD: skip       120777  1 (   0,   0)    14 /usr/lib64/libkrb5.so.3\nD: skip       100755  1 (   0,   0) 68576 /usr/lib64/libkrad.so.0.0\nD: skip       120777  1 (   0,   0)    14 /usr/lib64/libkrad.so.0\nD: skip       100755  1 (   0,   0)135224 /usr/lib64/libkdb5.so.8.0\nD: skip       120777  1 (   0,   0)    14 /usr/lib64/libkdb5.so.8\nD: skip       100755  1 (   0,   0)267296 /usr/lib64/libk5crypto.so.3.1\nD: skip       120777  1 (   0,   0)    18 /usr/lib64/libk5crypto.so.3\nD: skip       100755  1 (   0,   0)202424 /usr/lib64/libgssrpc.so.4.2\nD: skip       120777  1 (   0,   0)    16 /usr/lib64/libgssrpc.so.4\nD: skip       100755  1 (   0,   0)402960 /usr/lib64/libgssapi_krb5.so.2.2\nD: skip       120777  1 (   0,   0)    21 /usr/lib64/libgssapi_krb5.so.2\nD: skip       100755  1 (   0,   0) 68584 /usr/lib64/krb5/plugins/tls/k5tls.so\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/tls\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/preauth\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/libkrb5\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/kdb\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/authdata\nD: skip       040755  7 (   0,   0)  4096 /usr/lib64/krb5/plugins\nD: skip       040755  3 (   0,   0)  4096 /usr/lib64/krb5\nD: skip       120777  1 (   0,   0)    42 /etc/krb5.conf.d/crypto-policies\nD: skip       040755  2 (   0,   0)  4096 /etc/krb5.conf.d\nD: skip       100644  1 (   0,   0)   677 /etc/krb5.conf\nD: skip       040755  2 (   0,   0)  4096 /etc/gss/mech.d\nD: skip       040755  3 (   0,   0)  4096 /etc/gss\nD: %postun(krb5-libs-1.14.4-7.fc25.ppc64le): scriptlet start\nD: %postun(krb5-libs-1.14.4-7.fc25.ppc64le): execv(/sbin/ldconfig) pid 3879\nD: Plugin: calling hook scriptlet_fork_post in selinux plugin\nD: setexecfilecon: (/sbin/ldconfig) \nD: %postun(krb5-libs-1.14.4-7.fc25.ppc64le): waitpid(3879) rc 3879 status 0"
							},
							{
								"isprivate": "0",
								"commentid": "10490141",
								"comment_count": "89",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-08 16:04:29 +0000",
								"thetext": "libdb-5.3.28-21.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-9d674be444"
							},
							{
								"isprivate": "0",
								"commentid": "10490167",
								"comment_count": "90",
								"who": {
									"text": "updates",
									"name": "Fedora Update System"
								},
								"bug_when": "2017-06-08 16:10:32 +0000",
								"thetext": "libdb-5.3.28-21.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-6e056b68bf"
							},
							{
								"isprivate": "0",
								"commentid": "10490652",
								"comment_count": "91",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-06-08 19:23:37 +0000",
								"thetext": "As this is supposed to be a *tracking* bug, can someone file a new bug for the outstanding ppc64le issue and mark it as fixing this bug? I'll edit the updates to *not* close this bug."
							},
							{
								"isprivate": "0",
								"commentid": "10490658",
								"comment_count": "92",
								"who": {
									"text": "awilliam",
									"name": "Adam Williamson"
								},
								"bug_when": "2017-06-08 19:26:32 +0000",
								"thetext": "sorry, of course I meant \"mark it as blocking this bug\" not \"mark it as fixing this bug\"."
							},
							{
								"isprivate": "0",
								"commentid": "10499102",
								"comment_count": "93",
								"who": {
									"text": "labbott",
									"name": "Laura Abbott"
								},
								"bug_when": "2017-06-12 20:33:15 +0000",
								"thetext": "*** Bug 1460147 has been marked as a duplicate of this bug. ***"
							},
							{
								"isprivate": "0",
								"commentid": "10665030",
								"comment_count": "94",
								"who": {
									"text": "ignatenko",
									"name": "Igor Gnatenko"
								},
								"bug_when": "2017-08-02 11:06:43 +0000",
								"thetext": "*** Bug 1476493 has been marked as a duplicate of this bug. ***"
							},
							{
								"isprivate": "0",
								"commentid": "11555099",
								"comment_count": "95",
								"who": {
									"text": "bcotton",
									"name": "Fedora End Of Life"
								},
								"bug_when": "2018-05-03 08:29:45 +0000",
								"thetext": "This message is a reminder that Fedora 26 is nearing its end of life.\nApproximately 4 (four) weeks from now Fedora will stop maintaining\nand issuing updates for Fedora 26. It is Fedora's policy to close all\nbug reports from releases that are no longer maintained. At that time\nthis bug will be closed as EOL if it remains open with a Fedora  'version'\nof '26'.\n\nPackage Maintainer: If you wish for this bug to remain open because you\nplan to fix it in a currently maintained version, simply change the 'version'\nto a later Fedora version.\n\nThank you for reporting this issue and we are sorry that we were not\nable to fix it before Fedora 26 is end of life. If you would still like\nto see this bug fixed and are able to reproduce it against a later version\nof Fedora, you are encouraged  change the 'version' to a later Fedora\nversion prior this bug is closed as described in the policy above.\n\nAlthough we aim to fix as many bugs as possible during every release's\nlifetime, sometimes those efforts are overtaken by events. Often a\nmore recent Fedora release includes newer upstream software that fixes\nbugs or makes them obsolete."
							},
							{
								"isprivate": "0",
								"commentid": "11648581",
								"comment_count": "96",
								"who": {
									"text": "bcotton",
									"name": "Fedora End Of Life"
								},
								"bug_when": "2018-05-29 12:12:31 +0000",
								"thetext": "Fedora 26 changed to end-of-life (EOL) status on 2018-05-29. Fedora 26\nis no longer maintained, which means that it will not receive any\nfurther security or bug fix updates. As a result we are closing this bug.\n\nIf you can reproduce this bug against a currently maintained version of\nFedora please feel free to reopen this bug against that version. If you\nare unable to reopen this bug, please file a new report against the\ncurrent release. If you experience problems, please add a comment to this\nbug.\n\nThank you for reporting this bug and we are sorry it could not be fixed."
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "10490679",
						"comment_count": "0",
						"who": {
							"text": "dan",
							"name": "Dan Hork"
						},
						"bug_when": "2017-06-08 19:39:08 +0000",
						"thetext": "Created attachment 1286216\nscript to prepare the system for upgrade\n\nUpgrade from f25 to f26 gets stuck when latest libdb is used. This is log from my upgrade on ppc64le with libdb-5.3.28-21.fc25.ppc64le installed\n\n...\nD: ========== +++ crypto-policies-20160921-4.gitf3018dd.fc25 noarch-linux 0x0\nD:     erase: crypto-policies-20160921-4.gitf3018dd.fc25.noarch has 46 files\nD: Plugin: calling hook psm_pre in selinux plugin\nD: skip       100644  1 (   0,   0)  2856 /usr/share/man/man8/update-crypto-policies.8.gz\nD: skip       100644  1 (   0,   0) 26432 /usr/share/licenses/crypto-policies/COPYING.LESSER\nD: skip       040755  2 (   0,   0)  4096 /usr/share/licenses/crypto-policies\nD: skip       100644  1 (   0,   0)    70 /usr/share/crypto-policies/reload-cmds.sh\nD: skip       100644  1 (   0,   0)   606 /usr/share/crypto-policies/default-config\nD: skip       100644  1 (   0,   0)    87 /usr/share/crypto-policies/LEGACY/openssl.txt\nD: skip       100644  1 (   0,   0)   431 /usr/share/crypto-policies/LEGACY/nss.txt\nD: skip       100644  1 (   0,   0)   142 /usr/share/crypto-policies/LEGACY/krb5.txt\nD: skip       100644  1 (   0,   0)   312 /usr/share/crypto-policies/LEGACY/java.txt\nD: skip       100644  1 (   0,   0)   438 /usr/share/crypto-policies/LEGACY/gnutls28.txt\nD: skip       100644  1 (   0,   0)   496 /usr/share/crypto-policies/LEGACY/gnutls.txt\nD: skip       100644  1 (   0,   0)    64 /usr/share/crypto-policies/LEGACY/bind.txt\nD: skip       100644  1 (   0,   0)   103 /usr/share/crypto-policies/FUTURE/openssl.txt\nD: skip       100644  1 (   0,   0)   400 /usr/share/crypto-policies/FUTURE/nss.txt\nD: skip       100644  1 (   0,   0)   111 /usr/share/crypto-policies/FUTURE/krb5.txt\nD: skip       100644  1 (   0,   0)   386 /usr/share/crypto-policies/FUTURE/java.txt\nD: skip       100644  1 (   0,   0)   420 /usr/share/crypto-policies/FUTURE/gnutls28.txt\nD: skip       100644  1 (   0,   0)   465 /usr/share/crypto-policies/FUTURE/gnutls.txt\nD: skip       100644  1 (   0,   0)   105 /usr/share/crypto-policies/FUTURE/bind.txt\nD: skip       100644  1 (   0,   0)   160 /usr/share/crypto-policies/EMPTY/openssl.txt\nD: skip       100644  1 (   0,   0)   145 /usr/share/crypto-policies/EMPTY/nss.txt\nD: skip       100644  1 (   0,   0)    22 /usr/share/crypto-policies/EMPTY/krb5.txt\nD: skip       100644  1 (   0,   0)   594 /usr/share/crypto-policies/EMPTY/java.txt\nD: skip       100644  1 (   0,   0)    36 /usr/share/crypto-policies/EMPTY/gnutls28.txt\nD: skip       100644  1 (   0,   0)    36 /usr/share/crypto-policies/EMPTY/gnutls.txt\nD: skip       100644  1 (   0,   0)   123 /usr/share/crypto-policies/EMPTY/bind.txt\nD: skip       100644  1 (   0,   0)    97 /usr/share/crypto-policies/DEFAULT/openssl.txt\nD: skip       100644  1 (   0,   0)   418 /usr/share/crypto-policies/DEFAULT/nss.txt\nD: skip       100644  1 (   0,   0)   125 /usr/share/crypto-policies/DEFAULT/krb5.txt\nD: skip       100644  1 (   0,   0)   345 /usr/share/crypto-policies/DEFAULT/java.txt\nD: skip       100644  1 (   0,   0)   420 /usr/share/crypto-policies/DEFAULT/gnutls28.txt\nD: skip       100644  1 (   0,   0)   465 /usr/share/crypto-policies/DEFAULT/gnutls.txt\nD: skip       100644  1 (   0,   0)    70 /usr/share/crypto-policies/DEFAULT/bind.txt\nD: skip       040755  6 (   0,   0)  4096 /usr/share/crypto-policies\nD: skip       100755  1 (   0,   0)  2362 /usr/bin/update-crypto-policies\nD: skip       040755  2 (   0,   0)  4096 /etc/crypto-policies/local.d\nD: skip       100644  1 (   0,   0)   606 /etc/crypto-policies/config\nD: skip       120777  1 (   0,   0)    46 /etc/crypto-policies/back-ends/openssl.config\nD: skip       120777  1 (   0,   0)    42 /etc/crypto-policies/back-ends/nss.config\nD: skip       120777  1 (   0,   0)    43 /etc/crypto-policies/back-ends/krb5.config\nD: skip       120777  1 (   0,   0)    43 /etc/crypto-policies/back-ends/java.config\nD: skip       120777  1 (   0,   0)    47 /etc/crypto-policies/back-ends/gnutls28.config\nD: skip       120777  1 (   0,   0)    45 /etc/crypto-policies/back-ends/gnutls.config\nD: skip       120777  1 (   0,   0)    43 /etc/crypto-policies/back-ends/bind.config\nD: skip       040755  2 (   0,   0)  4096 /etc/crypto-policies/back-ends\nD: skip       040755  5 (   0,   0)  4096 /etc/crypto-policies\nfdio:       2 writes,      759 total bytes in 0.000020 secs\nD:   --- h#     186 crypto-policies-20160921-4.gitf3018dd.fc25.noarch\nD: adding \"crypto-policies\" to Name index.\nD: adding 46 entries to Basenames index.\nD: adding \"Unspecified\" to Group index.\nD: adding 8 entries to Requirename index.\nD: adding 2 entries to Providename index.\nD: adding 14 entries to Dirnames index.\nD: adding 1 entries to Installtid index.\nD: adding 1 entries to Sigmd5 index.\nD: adding \"9f33e91a20fa838c5e85706350d2b9c7e5d4ac2c\" to Sha1header index.\nD: ========== +++ krb5-libs-1.14.4-7.fc25 ppc64le-linux 0x2\nD:     erase: krb5-libs-1.14.4-7.fc25.ppc64le has 41 files\nD: Plugin: calling hook psm_pre in selinux plugin\nD: %triggerun(krb5-libs-1.15.1-8.fc26.ppc64le): scriptlet start\nD: %triggerun(krb5-libs-1.15.1-8.fc26.ppc64le): execv(/bin/sh) pid 3867\nD: Plugin: calling hook scriptlet_fork_post in selinux plugin\nD: setexecfilecon: (/bin/sh) \n++ rpm -q --qf '%{VERSION}\\n' krb5-libs\n++ sort -V\n++ tr -d '\\n'\n++ head -n 1\n+ old_ver=1.14.4\n++ rpm -q --qf '%{RELEASE}\\n' krb5-libs\n++ sort -V\n++ head -n 1\n++ tr -d '\\n'\n+ old_rel=7.fc25\n+ old_rel=7\n+ [[ 1.14.4 < 1.15.1 ]]\n+ grep -q 'includedir /etc/krb5.conf.d' /etc/krb5.conf\n+ exit 0\nD: %triggerun(krb5-libs-1.15.1-8.fc26.ppc64le): waitpid(3867) rc 3867 status 0\n  Cleanup     : krb5-libs-1.14.4-7.fc25.ppc64le                                                                                                                                       613/706 \nD: skip       040755  2 (   0,   0)  4096 /var/kerberos/krb5/user\nD: skip       040755  3 (   0,   0)  4096 /var/kerberos/krb5\nD: skip       040755  3 (   0,   0)  4096 /var/kerberos\nD: skip       100644  1 (   0,   0) 13970 /usr/share/man/man5/krb5.conf.5.gz\nD: skip       100644  1 (   0,   0)  1176 /usr/share/man/man5/k5login.5.gz\nD: skip       100644  1 (   0,   0)  1207 /usr/share/man/man5/k5identity.5.gz\nD: skip       100644  1 (   0,   0)    39 /usr/share/man/man5/.k5login.5.gz\nD: skip       100644  1 (   0,   0)    42 /usr/share/man/man5/.k5identity.5.gz\nD: skip       100644  1 (   0,   0)   410 /usr/share/locale/en_US/LC_MESSAGES/mit-krb5.mo\nD: skip       100644  1 (   0,   0) 61301 /usr/share/licenses/krb5-libs/LICENSE\nD: skip       040755  2 (   0,   0)  4096 /usr/share/licenses/krb5-libs\nD: skip       100644  1 (   0,   0) 15120 /usr/share/doc/krb5-libs/README\nD: skip       100644  1 (   0,   0) 61301 /usr/share/doc/krb5-libs/NOTICE\nD: skip       040755  2 (   0,   0)  4096 /usr/share/doc/krb5-libs\nD: skip       100755  1 (   0,   0)135408 /usr/lib64/libkrb5support.so.0.1\nD: skip       120777  1 (   0,   0)    21 /usr/lib64/libkrb5support.so.0\nD: skip       100755  1 (   0,   0)1199384 /usr/lib64/libkrb5.so.3.3\nD: skip       120777  1 (   0,   0)    14 /usr/lib64/libkrb5.so.3\nD: skip       100755  1 (   0,   0) 68576 /usr/lib64/libkrad.so.0.0\nD: skip       120777  1 (   0,   0)    14 /usr/lib64/libkrad.so.0\nD: skip       100755  1 (   0,   0)135224 /usr/lib64/libkdb5.so.8.0\nD: skip       120777  1 (   0,   0)    14 /usr/lib64/libkdb5.so.8\nD: skip       100755  1 (   0,   0)267296 /usr/lib64/libk5crypto.so.3.1\nD: skip       120777  1 (   0,   0)    18 /usr/lib64/libk5crypto.so.3\nD: skip       100755  1 (   0,   0)202424 /usr/lib64/libgssrpc.so.4.2\nD: skip       120777  1 (   0,   0)    16 /usr/lib64/libgssrpc.so.4\nD: skip       100755  1 (   0,   0)402960 /usr/lib64/libgssapi_krb5.so.2.2\nD: skip       120777  1 (   0,   0)    21 /usr/lib64/libgssapi_krb5.so.2\nD: skip       100755  1 (   0,   0) 68584 /usr/lib64/krb5/plugins/tls/k5tls.so\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/tls\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/preauth\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/libkrb5\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/kdb\nD: skip       040755  2 (   0,   0)  4096 /usr/lib64/krb5/plugins/authdata\nD: skip       040755  7 (   0,   0)  4096 /usr/lib64/krb5/plugins\nD: skip       040755  3 (   0,   0)  4096 /usr/lib64/krb5\nD: skip       120777  1 (   0,   0)    42 /etc/krb5.conf.d/crypto-policies\nD: skip       040755  2 (   0,   0)  4096 /etc/krb5.conf.d\nD: skip       100644  1 (   0,   0)   677 /etc/krb5.conf\nD: skip       040755  2 (   0,   0)  4096 /etc/gss/mech.d\nD: skip       040755  3 (   0,   0)  4096 /etc/gss\nD: %postun(krb5-libs-1.14.4-7.fc25.ppc64le): scriptlet start\nD: %postun(krb5-libs-1.14.4-7.fc25.ppc64le): execv(/sbin/ldconfig) pid 3879\nD: Plugin: calling hook scriptlet_fork_post in selinux plugin\nD: setexecfilecon: (/sbin/ldconfig) \nD: %postun(krb5-libs-1.14.4-7.fc25.ppc64le): waitpid(3879) rc 3879 status 0\n\n\n\nVersion-Release number of selected component (if applicable):\nlibdb-5.3.28-21.fc25\nlibdb-5.3.28-21.fc26\n\nHow reproducible:\n100%\n\nSteps to Reproduce:\n- installed F-25 \"minimal\" from \"netinstall\" iso (so system is GA + updates)\n- updated libdb to libdb-5.3.28-21.fc25.ppc64le (downloaded from ppc koji)\n- created a side repo for F-26 libdb containing libdb-5.3.28-21.fc26.ppc64le (downloaded from primary koji)\n- run \"dnf distro-sync --releasever 26\" with the side repo enabled\n- and got a hung after\n...\n  Cleanup     : crypto-policies-20160921-4.gitf3018dd.fc25.noarch  614/708 \n  Cleanup     : krb5-libs-1.14.4-7.fc25.ppc64le                    615/708\n\n\nActual results:\nupgrade is stuck\n\n\nExpected results:\nupgrade is finished\n\n\nAdditional info:\nWe definitely see the problem on ppc64le, but we will check ppc64 (and others) too."
					},
					{
						"isprivate": "0",
						"commentid": "10491659",
						"comment_count": "1",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-09 05:54:23 +0000",
						"thetext": "Thanks Dan for providing the log!\n\nSince the upgrade process fails not long after touching the rpmdb via krb5-libs it would seem the environment got rebuilt at that point even with all checks in place via -21.fc25 (check for libdb's lock and check for rpm's transaction log)"
					},
					{
						"isprivate": "0",
						"commentid": "10492266",
						"comment_count": "2",
						"who": {
							"text": "menantea",
							"name": "Menanteau Guy"
						},
						"bug_when": "2017-06-09 09:39:12 +0000",
						"thetext": "Keep in mind it works successfully when I upgrade without krb5-libs by adding the option: exclude=krb5-libs\nsee description of https://bugzilla.redhat.com/show_bug.cgi?id=1443415#c0"
					},
					{
						"isprivate": "0",
						"commentid": "10492271",
						"comment_count": "3",
						"who": {
							"text": "dan",
							"name": "Dan Hork"
						},
						"bug_when": "2017-06-09 09:40:25 +0000",
						"thetext": "And I got a hung on ppc64 as well, but on a different place (much earlier)\n\n...\nD: %triggerpostun(systemd-231-15.fc25.ppc64): running <lua> scriptlet.\nD: %triggerpostun(systemd-233-3.fc26.ppc64): running <lua> scriptlet.\nfdio:       2 writes,      162 total bytes in 0.000018 secs\nD: %postun(ebtables-2.0.10-21.fc25.ppc64): scriptlet start\nD: %postun(ebtables-2.0.10-21.fc25.ppc64): execv(/bin/sh) pid 4240\nD: Plugin: calling hook scriptlet_fork_post in selinux plugin\nD: setexecfilecon: (/bin/sh) \n+ '[' 1 -ge 1 ']'\n+ systemctl try-restart ebtables.service\n+ /sbin/ldconfig\nD: %postun(ebtables-2.0.10-21.fc25.ppc64): waitpid(4240) rc 4240 status 0\n  Cleanup     : e2fsprogs-libs-1.43.3-1.fc25.ppc64                      517/730 \nD:   --- h#     256 ebtables-2.0.10-21.fc25.ppc64\nD: adding \"ebtables\" to Name index.\nD: adding 38 entries to Basenames index.\nD: adding \"System Environment/Base\" to Group index.\nD: adding 40 entries to Requirename index.\nD: adding 26 entries to Providename index.\nD: adding 1 entries to Conflictname index.\nD: adding 9 entries to Dirnames index.\nD: adding 1 entries to Installtid index.\nD: adding 1 entries to Sigmd5 index.\nD: adding \"a43cf5611f45537556cc133fe32f99b6c945057a\" to Sha1header index.\nD: ========== +++ e2fsprogs-libs-1.43.3-1.fc25 ppc64-linux 0x2\nD:     erase: e2fsprogs-libs-1.43.3-1.fc25.ppc64 has 4 files\nD: Plugin: calling hook psm_pre in selinux plugin\nD: skip       100755  1 (   0,   0)532864 /usr/lib64/libext2fs.so.2.4\nD: skip       120777  1 (   0,   0)    16 /usr/lib64/libext2fs.so.2\nD: skip       100755  1 (   0,   0) 70320 /usr/lib64/libe2p.so.2.3\nD: skip       120777  1 (   0,   0)    13 /usr/lib64/libe2p.so.2\nD: %postun(e2fsprogs-libs-1.43.3-1.fc25.ppc64): scriptlet start\nD: %postun(e2fsprogs-libs-1.43.3-1.fc25.ppc64): execv(/sbin/ldconfig) pid 4246\nD: Plugin: calling hook scriptlet_fork_post in selinux plugin\nD: setexecfilecon: (/sbin/ldconfig) \nD: %postun(e2fsprogs-libs-1.43.3-1.fc25.ppc64): waitpid(4246) rc 4246 status 0"
					},
					{
						"isprivate": "0",
						"commentid": "10492895",
						"comment_count": "4",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-09 13:04:02 +0000",
						"thetext": "I think I have found the root of the problem.\n\nIn the case the libdb -21 update would be installed before the upgrade to F26 takes place and the environment gets recreated with new libdb internal structures (through another rpm/dnf command call), scriplets run during the upgrade could still access the rpmdb even though glibc's pthread internals were changed...\nI have modified libdb's checks to be more restrictive and return a failure when a possible pthread version mismatch is encountered and libdb cannot safely rebuild its environment. Dan, Guy, could you try reproducing the issue with this build?\n\nhttps://koji.fedoraproject.org/koji/taskinfo?taskID=19926708"
					},
					{
						"isprivate": "0",
						"commentid": "10493120",
						"comment_count": "5",
						"who": {
							"text": "dan",
							"name": "Dan Hork"
						},
						"bug_when": "2017-06-09 13:58:05 +0000",
						"thetext": "My ppc64 test looks good now, it went over the e2fsprogs-libs-1.43.3-1.fc25.ppc64 cleanup and issues the expecetd warnings at krb5-libs\n\n...\n  Cleanup     : libmount-2.28.2-2.fc25.ppc64                                                                                                                                          610/706 \n  Cleanup     : libblkid-2.28.2-2.fc25.ppc64                                                                                                                                          611/706 \n  Cleanup     : crypto-policies-20160921-4.gitf3018dd.fc25.noarch                                                                                                                     612/706 \nerror: db5 error(-30969) from dbenv->open: BDB0091 DB_VERSION_MISMATCH: Database environment version mismatch\nerror: cannot open Packages index using db5 -  (-30969)\nerror: cannot open Packages database in /var/lib/rpm\nerror: db5 error(-30969) from dbenv->open: BDB0091 DB_VERSION_MISMATCH: Database environment version mismatch\nerror: cannot open Packages index using db5 -  (-30969)\nerror: cannot open Packages database in /var/lib/rpm\nerror: db5 error(-30969) from dbenv->open: BDB0091 DB_VERSION_MISMATCH: Database environment version mismatch\nerror: cannot open Packages index using db5 -  (-30969)\nerror: cannot open Packages database in /var/lib/rpm\nerror: db5 error(-30969) from dbenv->open: BDB0091 DB_VERSION_MISMATCH: Database environment version mismatch\nerror: cannot open Packages index using db5 -  (-30969)\nerror: cannot open Packages database in /var/lib/rpm\n  Cleanup     : krb5-libs-1.14.4-7.fc25.ppc64                                                                                                                                         613/706 \n  Cleanup     : coreutils-8.25-17.fc25.ppc64                                                                                                                                          614/706 \n..."
					},
					{
						"isprivate": "0",
						"commentid": "10493219",
						"comment_count": "6",
						"who": {
							"text": "menantea",
							"name": "Menanteau Guy"
						},
						"bug_when": "2017-06-09 14:28:31 +0000",
						"thetext": "If I update my f25 ppc64le VM with your libdb -22 before the upgrade to f26, everything works well. \"dnf -y --releasever=26 system-upgrade download\"  and \"dnf system-upgrade reboot\" are ok and the system is upgraded successfully.\nThanks"
					},
					{
						"isprivate": "0",
						"commentid": "10494596",
						"comment_count": "7",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2017-06-09 20:55:16 +0000",
						"thetext": "Petr: could this issue also be the cause of the RPM database corruption that people are now reporting sometimes happens after updating to -21 on F24/F25? See https://bugzilla.redhat.com/show_bug.cgi?id=1397087 discussion..."
					},
					{
						"isprivate": "0",
						"commentid": "10496819",
						"comment_count": "8",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-12 07:31:45 +0000",
						"thetext": "No, I do not think so. This should only be caused by updating to glibc (with new internal structures) after a separate transaction updating libdb to -21 is already completed.\n\nI have yet to look into what happened with the F24/25 updates but afaics there should not be any reason to drop the current patches since the issue happens after the update goes through and is easily fixable with \"rpmdb --rebuilddb\" ..."
					},
					{
						"isprivate": "0",
						"commentid": "10498774",
						"comment_count": "9",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2017-06-12 17:48:58 +0000",
						"thetext": "I would've liked to discuss it with you, but it only became clear there were still issues on Friday evening (your time) and it didn't seem practical to do nothing until today.\n\nFor a stable release of an operating system, \"oh don't worry that you can't install anything and your system is printing terrifying errors, you can just run this cryptic command as root at a console to fix it\" really isn't a good look.  Given that we had to make a call with the people who were around at the time, trying to prevent this happening to more people seemed like the best idea. Fixing upgrades to a pre-release seems substantially less important than not causing highly alarming bugs for people running stable releases."
					},
					{
						"isprivate": "0",
						"commentid": "10504279",
						"comment_count": "10",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-14 08:49:50 +0000",
						"thetext": "Fixing this still needs some more work.\nPlain out failing when a possible pthread version mismatch is encountered (which is based on comparing the modify timestamp of libpthread.so file with what is saved in libdb's environment) makes the dnf update process fail in the \"verify\" step even though it should be able to access the environment as it still has the old version of libpthread loaded."
					},
					{
						"isprivate": "0",
						"commentid": "10543059",
						"comment_count": "11",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-27 07:33:53 +0000",
						"thetext": "libdb-5.3.28-24.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-2b68e14594"
					},
					{
						"isprivate": "0",
						"commentid": "10545181",
						"comment_count": "12",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-27 17:21:16 +0000",
						"thetext": "libdb-5.3.28-24.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-014d67fa9d"
					},
					{
						"isprivate": "0",
						"commentid": "10545210",
						"comment_count": "13",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-27 17:26:59 +0000",
						"thetext": "libdb-5.3.28-24.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-372bb1edb3"
					},
					{
						"isprivate": "0",
						"commentid": "10545673",
						"comment_count": "14",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-27 20:26:35 +0000",
						"thetext": "libdb-5.3.28-24.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-2b68e14594"
					},
					{
						"isprivate": "0",
						"commentid": "10556432",
						"comment_count": "15",
						"who": {
							"text": "jvavra",
							"name": "Jakub Vavra"
						},
						"bug_when": "2017-06-30 10:05:30 +0000",
						"thetext": "The fixed version on F24 ppc64le is not available, the version available in updates-testing is libdb-5.3.28-21.fc24.ppc64le."
					},
					{
						"isprivate": "0",
						"commentid": "10556444",
						"comment_count": "16",
						"who": {
							"text": "dan",
							"name": "Dan Hork"
						},
						"bug_when": "2017-06-30 10:09:27 +0000",
						"thetext": "(In reply to Jakub Vavra from comment #15)\n> The fixed version on F24 ppc64le is not available, the version available in\n> updates-testing is libdb-5.3.28-21.fc24.ppc64le.\n\nI'm building f25+f24 updates-testing in ppc koji now, should be available soon for download"
					},
					{
						"isprivate": "0",
						"commentid": "10556605",
						"comment_count": "17",
						"who": {
							"text": "jvavra",
							"name": "Jakub Vavra"
						},
						"bug_when": "2017-06-30 11:26:17 +0000",
						"thetext": "With the packages libdb-5.3.28-24.fc24.ppc64le.rpm and libdb-utils-5.3.28-24.fc24.ppc64le.rpm built and provided by pkubat the upgrade worked fine."
					},
					{
						"isprivate": "0",
						"commentid": "10558428",
						"comment_count": "18",
						"who": {
							"text": "pwhalen",
							"name": "Paul Whalen"
						},
						"bug_when": "2017-06-30 20:32:14 +0000",
						"thetext": "Upgrade from f25->f26 completed on armhfp with libdb-5.3.28-24."
					},
					{
						"isprivate": "0",
						"commentid": "10560504",
						"comment_count": "19",
						"who": {
							"text": "normand",
							"name": "Michel Normand"
						},
						"bug_when": "2017-07-03 06:52:20 +0000",
						"thetext": "with f26 compose 20170701 and \nfc24: 4.11.6-101.fc24.ppc64le or\nfc25: 4.11.6-201.fc25.ppc64le  \nstill hang in cleanup phase."
					},
					{
						"isprivate": "0",
						"commentid": "10560524",
						"comment_count": "20",
						"who": {
							"text": "normand",
							"name": "Michel Normand"
						},
						"bug_when": "2017-07-03 06:59:11 +0000",
						"thetext": "to complete my previous comment #19, the libdb versions used when failure is:\n===\n$grep -HnE libdb ~/Desktop/upgrade_run-dnf.rpm.log \n/home/normand/Desktop/upgrade_run-dnf.rpm.log:14:Jul 02 01:37:44 INFO Upgraded: libdb-5.3.28-21.fc24.ppc64le\n/home/normand/Desktop/upgrade_run-dnf.rpm.log:43:Jul 02 01:38:17 INFO Upgraded: libdb-utils-5.3.28-21.fc24.ppc64le\n/home/normand/Desktop/upgrade_run-dnf.rpm.log:66:Jul 02 01:38:26 INFO Cleanup: libdb-utils-5.3.28-14.fc24.ppc64le\n/home/normand/Desktop/upgrade_run-dnf.rpm.log:78:Jul 02 01:38:26 INFO Cleanup: libdb-5.3.28-14.fc24.ppc64le\n/home/normand/Desktop/upgrade_run-dnf.rpm.log:140:Jul 02 01:42:13 INFO Upgraded: libdb-5.3.28-21.fc26.ppc64le\n/home/normand/Desktop/upgrade_run-dnf.rpm.log:248:Jul 02 01:42:13 INFO Upgraded: libdb-utils-5.3.28-21.fc26.ppc64le\n==="
					},
					{
						"isprivate": "0",
						"commentid": "10576001",
						"comment_count": "21",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-07-07 23:01:08 +0000",
						"thetext": "libdb-5.3.28-24.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "10577667",
						"comment_count": "22",
						"who": {
							"text": "normand",
							"name": "Michel Normand"
						},
						"bug_when": "2017-07-10 06:58:27 +0000",
						"thetext": "last tested ppc64/ppc64le compose 20170707 still hangs while cleanup\nsimilar as previous comment #19.\nAnd the grep of libdb is similar as comment #20  with older version\nversus expected libdb-5.3.28-24 of comment #21"
					},
					{
						"isprivate": "0",
						"commentid": "10577734",
						"comment_count": "23",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-07-10 07:30:14 +0000",
						"thetext": "(In reply to Michel Normand from comment #22)\n> last tested ppc64/ppc64le compose 20170707 still hangs while cleanup\n> similar as previous comment #19.\n> And the grep of libdb is similar as comment #20  with older version\n> versus expected libdb-5.3.28-24 of comment #21\n\nI am not sure if I understand the comment correctly but this issue is fixed in libdb-5.3.28-24. If you are trying to update to libdb-5.3.28-21 instead (as per comment 20) then yes the update will most likely hang.\n\nAs for the updates for F24/25, I have submitted them to stable earlier today so they should be available soon."
					},
					{
						"isprivate": "0",
						"commentid": "10585054",
						"comment_count": "24",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-07-12 01:50:11 +0000",
						"thetext": "libdb-5.3.28-24.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "10585239",
						"comment_count": "25",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-07-12 03:22:05 +0000",
						"thetext": "libdb-5.3.28-24.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "10587183",
						"comment_count": "26",
						"who": {
							"text": "normand",
							"name": "Michel Normand"
						},
						"bug_when": "2017-07-12 12:20:45 +0000",
						"thetext": "The mirrors for f24  are not yet in sync today,\nwill have to wait more time. (same pb for f25)\n===\n[michel@fc24ppc64le ~]$ dnf list upgrade libdb\nLast metadata expiration check: 0:00:13 ago on Wed Jul 12 07:42:16 2017.\nInstalled Packages\nlibdb.ppc64le      5.3.28-14.fc24 @anaconda\nAvailable Packages\nlibdb.ppc64le      5.3.28-21.fc24  updates\n==="
					}
				]
			}
		},
		{
			"bug_id": 1464032,
			"feedback": [
				{
					"bug_id": 1464032,
					"comment": {
						"id": 628789,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works great!  LGTM!  =)",
						"timestamp": "2017-06-29 03:31:56",
						"update_id": 91024,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/307632fc7188138f052f244345e779451863879298f2e6d73023011a05b1f1f6?s=24&d=retro",
							"email": "besser82.fpo@gmail.com",
							"groups": [
								{
									"name": "proventesters"
								},
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "designteam"
								},
								{
									"name": "shogun-ca"
								},
								{
									"name": "alt-gtk-de-sig"
								}
							],
							"id": 206,
							"name": "besser82",
							"openid": "besser82.id.fedoraproject.org"
						},
						"user_id": 206
					},
					"comment_id": 628789,
					"karma": 1
				},
				{
					"bug_id": 1464032,
					"comment": {
						"id": 628790,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works great!  LGTM!  =)",
						"timestamp": "2017-06-29 03:32:04",
						"update_id": 91025,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/307632fc7188138f052f244345e779451863879298f2e6d73023011a05b1f1f6?s=24&d=retro",
							"email": "besser82.fpo@gmail.com",
							"groups": [
								{
									"name": "proventesters"
								},
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "designteam"
								},
								{
									"name": "shogun-ca"
								},
								{
									"name": "alt-gtk-de-sig"
								}
							],
							"id": 206,
							"name": "besser82",
							"openid": "besser82.id.fedoraproject.org"
						},
						"user_id": 206
					},
					"comment_id": 628790,
					"karma": 1
				},
				{
					"bug_id": 1464032,
					"comment": {
						"id": 629500,
						"karma": 1,
						"karma_critpath": 1,
						"text": "upgraded completed on armhfp.",
						"timestamp": "2017-06-30 20:26:25",
						"update_id": 91023,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/f10909406582318e3ebdf96e827351c846709a4f1aba17f5dc241c7efb6aa8d0?s=24&d=retro",
							"email": "pwhalen@redhat.com",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "sysadmin-releng"
								},
								{
									"name": "sysadmin-secondary"
								},
								{
									"name": "iot"
								},
								{
									"name": "arm-qa"
								},
								{
									"name": "fedora-arm"
								},
								{
									"name": "gitarm"
								},
								{
									"name": "gitfedora-arm-installer"
								}
							],
							"id": 1201,
							"name": "pwhalen",
							"openid": "pwhalen.id.fedoraproject.org"
						},
						"user_id": 1201
					},
					"comment_id": 629500
				},
				{
					"bug_id": 1464032,
					"comment": {
						"id": 629566,
						"karma": 1,
						"karma_critpath": 1,
						"text": "No regressions noted.",
						"timestamp": "2017-06-30 20:56:40",
						"update_id": 91024,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/e62cb974458dc33fcf2225462b8765e0aadcbbd698560c8f8dad6c3e23d5e47e?s=24&d=retro",
							"email": "dhgutteridge@hotmail.com",
							"groups": [
								{
									"name": "ipausers"
								}
							],
							"id": 194,
							"name": "dhgutteridge",
							"openid": "dhgutteridge.id.fedoraproject.org"
						},
						"user_id": 194
					},
					"comment_id": 629566
				},
				{
					"bug_id": 1464032,
					"comment": {
						"id": 632718,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works for me.",
						"timestamp": "2017-07-08 21:43:49",
						"update_id": 91025,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/0fa05851f1f2f54b981d3c0ab58e0a15cc1384567409b91e76ec2e2078d47e5e?s=24&d=retro",
							"email": "jonathanecalloway@gmail.com",
							"id": 1359,
							"name": "jonathancalloway",
							"openid": "jonathancalloway.id.fedoraproject.org"
						},
						"user_id": 1359
					},
					"comment_id": 632718,
					"karma": 1
				}
			],
			"parent": true,
			"security": true,
			"title": "libdb: Reads DB_CONFIG from the current working directory",
			"bugzilla": {
				"bug_id": "1464032",
				"alias": "CVE-2017-10140",
				"creation_ts": "2017-06-22 10:17:52 +0000",
				"short_desc": "CVE-2017-10140 libdb: Reads DB_CONFIG from the current working directory",
				"delta_ts": "2023-09-07 18:53:40 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Security",
				"priority": "medium",
				"bug_severity": "medium",
				"depends_on": [
					"1464033",
					"1464034",
					"1464035",
					"1471978"
				],
				"blocked": [
					{
						"bug_id": "1464038",
						"error": "NotPermitted"
					}
				],
				"external_bugs": {
					"text": "RHSA-2019:0366",
					"name": "Red Hat Product Errata"
				},
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "10530968",
						"comment_count": "0",
						"who": {
							"text": "anemec",
							"name": "Andrej Nemec"
						},
						"bug_when": "2017-06-22 10:17:52 +0000",
						"thetext": "\nIt was found that Berkeley DB reads the DB_CONFIG configuration file from the current working directory by default. This happens when calling db_create() with dbenv=NULL; or using the dbm_open() function. \n\nReferences:\n\nhttp://seclists.org/oss-sec/2017/q2/452\nhttp://www.postfix.org/announcements/postfix-3.2.2.html\n\nProposed patch:\n\nhttp://seclists.org/oss-sec/2017/q2/475"
					},
					{
						"isprivate": "0",
						"commentid": "10530977",
						"comment_count": "1",
						"who": {
							"text": "anemec",
							"name": "Andrej Nemec"
						},
						"bug_when": "2017-06-22 10:18:44 +0000",
						"thetext": "Created libdb tracking bugs for this issue:\n\nAffects: fedora-all [bug 1464033]\n\n\nCreated libdb4 tracking bugs for this issue:\n\nAffects: fedora-all [bug 1464035]\n\n\nCreated postfix tracking bugs for this issue:\n\nAffects: fedora-all [bug 1464034]"
					},
					{
						"isprivate": "0",
						"commentid": "10531489",
						"comment_count": "2",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-22 12:30:18 +0000",
						"thetext": "Easy to reproduce with a simple application that creates and opens a database without explicitly specifying a database environment - a private (in-memory) environment is created instead.\n\nThe patch makes sense to me (functionality-wise, the actual change would be better located elsewhere), libdb should not try parsing DB_HOME/DB_CONFIG if DB_HOME is not set.\n\nWill touch base with upstream first to see if they have any plans for fixing this yet."
					},
					{
						"isprivate": "0",
						"commentid": "10579123",
						"comment_count": "3",
						"who": {
							"text": "scorneli",
							"name": "Stefan Cornelius"
						},
						"bug_when": "2017-07-10 14:21:53 +0000",
						"thetext": "(In reply to Petr Kubat from comment #2)\n> Easy to reproduce with a simple application that creates and opens a\n> database without explicitly specifying a database environment - a private\n> (in-memory) environment is created instead.\n> \n> The patch makes sense to me (functionality-wise, the actual change would be\n> better located elsewhere), libdb should not try parsing DB_HOME/DB_CONFIG if\n> DB_HOME is not set.\n> \n> Will touch base with upstream first to see if they have any plans for fixing\n> this yet.\n\nAny response so far?"
					},
					{
						"isprivate": "0",
						"commentid": "10579155",
						"comment_count": "4",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-07-10 14:29:35 +0000",
						"thetext": "(In reply to Stefan Cornelius from comment #3)\n> Any response so far?\n\nNothing other that they see it as an issue themselves and that they will sent us the patch once they have it fixed.\n\nI have provided them with the reproducer I used and the downstream patch I have hotfixed the issue with so hopefully this should not take long."
					},
					{
						"isprivate": "0",
						"commentid": "10581717",
						"comment_count": "6",
						"who": {
							"text": "scorneli",
							"name": "Stefan Cornelius"
						},
						"bug_when": "2017-07-11 08:56:29 +0000",
						"thetext": "Patch used by Fedora:\nhttp://pkgs.fedoraproject.org/cgit/rpms/libdb.git/commit/?id=8047fa8580659fcae740c25e91b490539b8453eb"
					},
					{
						"isprivate": "0",
						"commentid": "10714748",
						"comment_count": "9",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-08-17 06:03:29 +0000",
						"thetext": "libdb upstream got back to me today saying they are ok with the patch I sent them (and use for our version of libdb) and that we should keep on using it."
					},
					{
						"isprivate": "0",
						"commentid": "11041051",
						"comment_count": "10",
						"who": {
							"text": "stephane+rh",
							"name": "Stephane Chazelas"
						},
						"bug_when": "2017-11-28 16:37:18 +0000",
						"thetext": "Reminds me of\n\nhttps://bugs.launchpad.net/ubuntu/+source/libnss-db/+bug/531976\nCVE-2010-0826\nhttps://bugzilla.redhat.com/show_bug.cgi?id=580187"
					},
					{
						"isprivate": "0",
						"commentid": "11592568",
						"comment_count": "12",
						"who": {
							"text": "anemec",
							"name": "Andrej Nemec"
						},
						"bug_when": "2018-05-14 11:59:05 +0000",
						"thetext": "Statement:\n\nThis issue affects the versions of libdb as shipped with Red Hat Satellite 6.0, 6.1 and 6.2. This package no longer ships with Satellite 6.3. Red Hat Product Security has rated this issue as having security impact of Moderate. A future update may address this issue. For additional information, refer to the Issue Severity Classification: https://access.redhat.com/security/updates/classification/."
					},
					{
						"isprivate": "0",
						"commentid": "12466335",
						"comment_count": "13",
						"who": {
							"text": "errata-xmlrpc",
							"name": "errata-xmlrpc"
						},
						"bug_when": "2019-02-18 16:55:37 +0000",
						"thetext": "This issue has been addressed in the following products:\n\n  Red Hat JBoss Core Services\n\nVia RHSA-2019:0366 https://access.redhat.com/errata/RHSA-2019:0366"
					},
					{
						"isprivate": "0",
						"commentid": "13797780",
						"comment_count": "16",
						"who": {
							"text": "scorneli",
							"name": "Stefan Cornelius"
						},
						"bug_when": "2020-04-14 10:38:15 +0000",
						"thetext": "Mitigation:\n\nDo not use an application using libdb if an untrusted user can create a DB_CONFIG file in its working directory."
					}
				]
			}
		},
		{
			"bug_id": 1464033,
			"feedback": [
				{
					"bug_id": 1464033,
					"comment": {
						"id": 628789,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works great!  LGTM!  =)",
						"timestamp": "2017-06-29 03:31:56",
						"update_id": 91024,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/307632fc7188138f052f244345e779451863879298f2e6d73023011a05b1f1f6?s=24&d=retro",
							"email": "besser82.fpo@gmail.com",
							"groups": [
								{
									"name": "proventesters"
								},
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "designteam"
								},
								{
									"name": "shogun-ca"
								},
								{
									"name": "alt-gtk-de-sig"
								}
							],
							"id": 206,
							"name": "besser82",
							"openid": "besser82.id.fedoraproject.org"
						},
						"user_id": 206
					},
					"comment_id": 628789,
					"karma": 1
				},
				{
					"bug_id": 1464033,
					"comment": {
						"id": 628790,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works great!  LGTM!  =)",
						"timestamp": "2017-06-29 03:32:04",
						"update_id": 91025,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/307632fc7188138f052f244345e779451863879298f2e6d73023011a05b1f1f6?s=24&d=retro",
							"email": "besser82.fpo@gmail.com",
							"groups": [
								{
									"name": "proventesters"
								},
								{
									"name": "packager"
								},
								{
									"name": "provenpackager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "ambassadors"
								},
								{
									"name": "designteam"
								},
								{
									"name": "shogun-ca"
								},
								{
									"name": "alt-gtk-de-sig"
								}
							],
							"id": 206,
							"name": "besser82",
							"openid": "besser82.id.fedoraproject.org"
						},
						"user_id": 206
					},
					"comment_id": 628790,
					"karma": 1
				},
				{
					"bug_id": 1464033,
					"comment": {
						"id": 629500,
						"karma": 1,
						"karma_critpath": 1,
						"text": "upgraded completed on armhfp.",
						"timestamp": "2017-06-30 20:26:25",
						"update_id": 91023,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/f10909406582318e3ebdf96e827351c846709a4f1aba17f5dc241c7efb6aa8d0?s=24&d=retro",
							"email": "pwhalen@redhat.com",
							"groups": [
								{
									"name": "packager"
								},
								{
									"name": "ipausers"
								},
								{
									"name": "fedora-contributor"
								},
								{
									"name": "signed_fpca"
								},
								{
									"name": "fedorabugs"
								},
								{
									"name": "sysadmin-releng"
								},
								{
									"name": "sysadmin-secondary"
								},
								{
									"name": "iot"
								},
								{
									"name": "arm-qa"
								},
								{
									"name": "fedora-arm"
								},
								{
									"name": "gitarm"
								},
								{
									"name": "gitfedora-arm-installer"
								}
							],
							"id": 1201,
							"name": "pwhalen",
							"openid": "pwhalen.id.fedoraproject.org"
						},
						"user_id": 1201
					},
					"comment_id": 629500
				},
				{
					"bug_id": 1464033,
					"comment": {
						"id": 629566,
						"karma": 1,
						"karma_critpath": 1,
						"text": "No regressions noted.",
						"timestamp": "2017-06-30 20:56:40",
						"update_id": 91024,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/e62cb974458dc33fcf2225462b8765e0aadcbbd698560c8f8dad6c3e23d5e47e?s=24&d=retro",
							"email": "dhgutteridge@hotmail.com",
							"groups": [
								{
									"name": "ipausers"
								}
							],
							"id": 194,
							"name": "dhgutteridge",
							"openid": "dhgutteridge.id.fedoraproject.org"
						},
						"user_id": 194
					},
					"comment_id": 629566
				},
				{
					"bug_id": 1464033,
					"comment": {
						"id": 632718,
						"karma": 1,
						"karma_critpath": 1,
						"text": "Works for me.",
						"timestamp": "2017-07-08 21:43:49",
						"update_id": 91025,
						"user": {
							"avatar": "https://seccdn.libravatar.org/avatar/0fa05851f1f2f54b981d3c0ab58e0a15cc1384567409b91e76ec2e2078d47e5e?s=24&d=retro",
							"email": "jonathanecalloway@gmail.com",
							"id": 1359,
							"name": "jonathancalloway",
							"openid": "jonathancalloway.id.fedoraproject.org"
						},
						"user_id": 1359
					},
					"comment_id": 632718,
					"karma": 1
				}
			],
			"security": true,
			"title": "libdb: Reads DB_CONFIG from the current working directory [fedora-all]",
			"bugzilla": {
				"bug_id": "1464033",
				"creation_ts": "2017-06-22 10:18:31 +0000",
				"short_desc": "CVE-2017-10140 libdb: Reads DB_CONFIG from the current working directory [fedora-all]",
				"delta_ts": "2017-08-12 17:12:22 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Security, SecurityTracking",
				"priority": "medium",
				"bug_severity": "medium",
				"blocked": [
					{
						"bug_id": "1464032",
						"alias": "CVE-2017-10140",
						"creation_ts": "2017-06-22 10:17:52 +0000",
						"short_desc": "CVE-2017-10140 libdb: Reads DB_CONFIG from the current working directory",
						"delta_ts": "2023-09-07 18:53:40 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1464033",
							"1464034",
							"1464035",
							"1471978"
						],
						"blocked": [
							{
								"bug_id": "1464038",
								"error": "NotPermitted"
							}
						],
						"external_bugs": {
							"text": "RHSA-2019:0366",
							"name": "Red Hat Product Errata"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "10530968",
								"comment_count": "0",
								"who": {
									"text": "anemec",
									"name": "Andrej Nemec"
								},
								"bug_when": "2017-06-22 10:17:52 +0000",
								"thetext": "\nIt was found that Berkeley DB reads the DB_CONFIG configuration file from the current working directory by default. This happens when calling db_create() with dbenv=NULL; or using the dbm_open() function. \n\nReferences:\n\nhttp://seclists.org/oss-sec/2017/q2/452\nhttp://www.postfix.org/announcements/postfix-3.2.2.html\n\nProposed patch:\n\nhttp://seclists.org/oss-sec/2017/q2/475"
							},
							{
								"isprivate": "0",
								"commentid": "10530977",
								"comment_count": "1",
								"who": {
									"text": "anemec",
									"name": "Andrej Nemec"
								},
								"bug_when": "2017-06-22 10:18:44 +0000",
								"thetext": "Created libdb tracking bugs for this issue:\n\nAffects: fedora-all [bug 1464033]\n\n\nCreated libdb4 tracking bugs for this issue:\n\nAffects: fedora-all [bug 1464035]\n\n\nCreated postfix tracking bugs for this issue:\n\nAffects: fedora-all [bug 1464034]"
							},
							{
								"isprivate": "0",
								"commentid": "10531489",
								"comment_count": "2",
								"who": {
									"text": "pkubat",
									"name": "Petr Kubat"
								},
								"bug_when": "2017-06-22 12:30:18 +0000",
								"thetext": "Easy to reproduce with a simple application that creates and opens a database without explicitly specifying a database environment - a private (in-memory) environment is created instead.\n\nThe patch makes sense to me (functionality-wise, the actual change would be better located elsewhere), libdb should not try parsing DB_HOME/DB_CONFIG if DB_HOME is not set.\n\nWill touch base with upstream first to see if they have any plans for fixing this yet."
							},
							{
								"isprivate": "0",
								"commentid": "10579123",
								"comment_count": "3",
								"who": {
									"text": "scorneli",
									"name": "Stefan Cornelius"
								},
								"bug_when": "2017-07-10 14:21:53 +0000",
								"thetext": "(In reply to Petr Kubat from comment #2)\n> Easy to reproduce with a simple application that creates and opens a\n> database without explicitly specifying a database environment - a private\n> (in-memory) environment is created instead.\n> \n> The patch makes sense to me (functionality-wise, the actual change would be\n> better located elsewhere), libdb should not try parsing DB_HOME/DB_CONFIG if\n> DB_HOME is not set.\n> \n> Will touch base with upstream first to see if they have any plans for fixing\n> this yet.\n\nAny response so far?"
							},
							{
								"isprivate": "0",
								"commentid": "10579155",
								"comment_count": "4",
								"who": {
									"text": "pkubat",
									"name": "Petr Kubat"
								},
								"bug_when": "2017-07-10 14:29:35 +0000",
								"thetext": "(In reply to Stefan Cornelius from comment #3)\n> Any response so far?\n\nNothing other that they see it as an issue themselves and that they will sent us the patch once they have it fixed.\n\nI have provided them with the reproducer I used and the downstream patch I have hotfixed the issue with so hopefully this should not take long."
							},
							{
								"isprivate": "0",
								"commentid": "10581717",
								"comment_count": "6",
								"who": {
									"text": "scorneli",
									"name": "Stefan Cornelius"
								},
								"bug_when": "2017-07-11 08:56:29 +0000",
								"thetext": "Patch used by Fedora:\nhttp://pkgs.fedoraproject.org/cgit/rpms/libdb.git/commit/?id=8047fa8580659fcae740c25e91b490539b8453eb"
							},
							{
								"isprivate": "0",
								"commentid": "10714748",
								"comment_count": "9",
								"who": {
									"text": "pkubat",
									"name": "Petr Kubat"
								},
								"bug_when": "2017-08-17 06:03:29 +0000",
								"thetext": "libdb upstream got back to me today saying they are ok with the patch I sent them (and use for our version of libdb) and that we should keep on using it."
							},
							{
								"isprivate": "0",
								"commentid": "11041051",
								"comment_count": "10",
								"who": {
									"text": "stephane+rh",
									"name": "Stephane Chazelas"
								},
								"bug_when": "2017-11-28 16:37:18 +0000",
								"thetext": "Reminds me of\n\nhttps://bugs.launchpad.net/ubuntu/+source/libnss-db/+bug/531976\nCVE-2010-0826\nhttps://bugzilla.redhat.com/show_bug.cgi?id=580187"
							},
							{
								"isprivate": "0",
								"commentid": "11592568",
								"comment_count": "12",
								"who": {
									"text": "anemec",
									"name": "Andrej Nemec"
								},
								"bug_when": "2018-05-14 11:59:05 +0000",
								"thetext": "Statement:\n\nThis issue affects the versions of libdb as shipped with Red Hat Satellite 6.0, 6.1 and 6.2. This package no longer ships with Satellite 6.3. Red Hat Product Security has rated this issue as having security impact of Moderate. A future update may address this issue. For additional information, refer to the Issue Severity Classification: https://access.redhat.com/security/updates/classification/."
							},
							{
								"isprivate": "0",
								"commentid": "12466335",
								"comment_count": "13",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2019-02-18 16:55:37 +0000",
								"thetext": "This issue has been addressed in the following products:\n\n  Red Hat JBoss Core Services\n\nVia RHSA-2019:0366 https://access.redhat.com/errata/RHSA-2019:0366"
							},
							{
								"isprivate": "0",
								"commentid": "13797780",
								"comment_count": "16",
								"who": {
									"text": "scorneli",
									"name": "Stefan Cornelius"
								},
								"bug_when": "2020-04-14 10:38:15 +0000",
								"thetext": "Mitigation:\n\nDo not use an application using libdb if an untrusted user can create a DB_CONFIG file in its working directory."
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "10530971",
						"comment_count": "0",
						"who": {
							"text": "anemec",
							"name": "Andrej Nemec"
						},
						"bug_when": "2017-06-22 10:18:31 +0000",
						"thetext": "\nThis is an automatically created tracking bug!  It was created to ensure\nthat one or more security vulnerabilities are fixed in affected versions\nof fedora-all.\n\nFor comments that are specific to the vulnerability please use bugs filed\nagainst the \"Security Response\" product referenced in the \"Blocks\" field.\n\nFor more information see:\nhttp://fedoraproject.org/wiki/Security/TrackingBugs\n\nWhen submitting as an update, use the fedpkg template provided in the next\ncomment(s).  This will include the bug IDs of this tracking bug as well as\nthe relevant top-level CVE bugs.\n\nPlease also mention the CVE IDs being fixed in the RPM changelog and the\nfedpkg commit message.\n\nNOTE: this issue affects multiple supported versions of Fedora. While only\none tracking bug has been filed, please correct all affected versions at\nthe same time.  If you need to fix the versions independent of each other,\nyou may clone this bug as appropriate."
					},
					{
						"isprivate": "0",
						"commentid": "10530976",
						"comment_count": "1",
						"who": {
							"text": "anemec",
							"name": "Andrej Nemec"
						},
						"bug_when": "2017-06-22 10:18:40 +0000",
						"thetext": "Use the following template to for the 'fedpkg update' request to submit an\nupdate for this issue as it contains the top-level parent bug(s) as well as\nthis tracking bug.  This will ensure that all associated bugs get updated\nwhen new packages are pushed to stable.\n\n=====\n\n# bugfix, security, enhancement, newpackage (required)\ntype=security\n\n# testing, stable\nrequest=testing\n\n# Bug numbers: 1234,9876\nbugs=1464032\n\n# Description of your update\nnotes=Security fix for [PUT CVEs HERE]\n\n# Enable request automation based on the stable/unstable karma thresholds\nautokarma=True\nstable_karma=3\nunstable_karma=-3\n\n# Automatically close bugs when this marked as stable\nclose_bugs=True\n\n# Suggest that users restart after update\nsuggest_reboot=False\n\n======\n\nAdditionally, you may opt to use the bodhi web interface to submit updates:\n\nhttps://bodhi.fedoraproject.org/updates/new"
					},
					{
						"isprivate": "0",
						"commentid": "10542996",
						"comment_count": "2",
						"who": {
							"text": "pkubat",
							"name": "Petr Kubat"
						},
						"bug_when": "2017-06-27 07:10:02 +0000",
						"thetext": "Libdb upstream has been notified and is working on solving the issue.\n\nIn the meantime I have hotfixed this for libdb by disabling any DB_CONFIG parsing when db_home is not set:\nhttp://pkgs.fedoraproject.org/cgit/rpms/libdb.git/commit/?id=8047fa8580659fcae740c25e91b490539b8453eb"
					},
					{
						"isprivate": "0",
						"commentid": "10543058",
						"comment_count": "3",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-27 07:33:48 +0000",
						"thetext": "libdb-5.3.28-24.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-2b68e14594"
					},
					{
						"isprivate": "0",
						"commentid": "10545179",
						"comment_count": "4",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-27 17:21:11 +0000",
						"thetext": "libdb-5.3.28-24.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-014d67fa9d"
					},
					{
						"isprivate": "0",
						"commentid": "10545208",
						"comment_count": "5",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-27 17:26:42 +0000",
						"thetext": "libdb-5.3.28-24.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-372bb1edb3"
					},
					{
						"isprivate": "0",
						"commentid": "10545672",
						"comment_count": "6",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-06-27 20:26:32 +0000",
						"thetext": "libdb-5.3.28-24.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-2b68e14594"
					},
					{
						"isprivate": "0",
						"commentid": "10575999",
						"comment_count": "7",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-07-07 23:00:49 +0000",
						"thetext": "libdb-5.3.28-24.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "10585053",
						"comment_count": "8",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-07-12 01:50:08 +0000",
						"thetext": "libdb-5.3.28-24.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "10585234",
						"comment_count": "9",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-07-12 03:21:47 +0000",
						"thetext": "libdb-5.3.28-24.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report."
					}
				]
			}
		}
	],
	"builds": [
		{
			"epoch": 0,
			"nvr": "libdb-5.3.28-24.fc25",
			"release_id": 15,
			"signed": true,
			"type": "rpm",
			"package": {
				"armv7hl": [
					{
						"name": "libdb-java-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "libdb",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "libdb-java",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "libdb-devel-static",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "libdb-utils",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "libdb-debuginfo",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "libdb-tcl-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "libdb-cxx",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "libdb-tcl",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "libdb-sql-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "libdb-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "libdb-sql",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "libdb-cxx-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "armv7hl"
					}
				],
				"i686": [
					{
						"name": "libdb-sql",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "i686"
					},
					{
						"name": "libdb-utils",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "i686"
					},
					{
						"name": "libdb-tcl-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "i686"
					},
					{
						"name": "libdb-sql-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "i686"
					},
					{
						"name": "libdb-tcl",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "i686"
					},
					{
						"name": "libdb-java",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "i686"
					},
					{
						"name": "libdb-debuginfo",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "i686"
					},
					{
						"name": "libdb-cxx",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "i686"
					},
					{
						"name": "libdb",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "i686"
					},
					{
						"name": "libdb-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "i686"
					},
					{
						"name": "libdb-java-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "i686"
					},
					{
						"name": "libdb-devel-static",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "i686"
					},
					{
						"name": "libdb-cxx-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "i686"
					}
				],
				"noarch": [
					{
						"name": "libdb-devel-doc",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "noarch"
					}
				],
				"src": [
					{
						"name": "libdb",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "src"
					}
				],
				"x86_64": [
					{
						"name": "libdb-java",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "x86_64"
					},
					{
						"name": "libdb",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "x86_64"
					},
					{
						"name": "libdb-sql-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "x86_64"
					},
					{
						"name": "libdb-cxx",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "x86_64"
					},
					{
						"name": "libdb-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "x86_64"
					},
					{
						"name": "libdb-java-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "x86_64"
					},
					{
						"name": "libdb-cxx-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "x86_64"
					},
					{
						"name": "libdb-tcl",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "x86_64"
					},
					{
						"name": "libdb-devel-static",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "x86_64"
					},
					{
						"name": "libdb-tcl-devel",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "x86_64"
					},
					{
						"name": "libdb-debuginfo",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "x86_64"
					},
					{
						"name": "libdb-utils",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "x86_64"
					},
					{
						"name": "libdb-sql",
						"version": "5.3.28",
						"release": "24.fc25",
						"arch": "x86_64"
					}
				]
			}
		}
	],
	"close_bugs": true,
	"comments": [
		{
			"id": 627898,
			"text": "This update has been submitted for testing by pkubat. ",
			"timestamp": "2017-06-27 07:34:41",
			"update_id": 91024,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 628095,
			"text": "This update has been pushed to testing.",
			"timestamp": "2017-06-27 17:27:57",
			"update_id": 91024,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"bug_feedback": [
				{
					"bug": {
						"bug_id": 1464032,
						"parent": true,
						"security": true,
						"title": "libdb: Reads DB_CONFIG from the current working directory"
					},
					"bug_id": 1464032,
					"comment_id": 628789,
					"karma": 1
				},
				{
					"bug": {
						"bug_id": 1464033,
						"security": true,
						"title": "libdb: Reads DB_CONFIG from the current working directory [fedora-all]"
					},
					"bug_id": 1464033,
					"comment_id": 628789,
					"karma": 1
				},
				{
					"bug": {
						"bug_id": 1394862,
						"title": "libdb: Assumes that internal condition variable layout never changes"
					},
					"bug_id": 1394862,
					"comment_id": 628789,
					"karma": 1
				},
				{
					"bug": {
						"bug_id": 1460003,
						"title": "upgrade f25 to f26 get stuck in Cleanup: krb5-list"
					},
					"bug_id": 1460003,
					"comment_id": 628789,
					"karma": 1
				}
			],
			"id": 628789,
			"karma": 1,
			"karma_critpath": 1,
			"text": "Works great!  LGTM!  =)",
			"timestamp": "2017-06-29 03:31:56",
			"update_id": 91024,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/307632fc7188138f052f244345e779451863879298f2e6d73023011a05b1f1f6?s=24&d=retro",
				"email": "besser82.fpo@gmail.com",
				"groups": [
					{
						"name": "proventesters"
					},
					{
						"name": "packager"
					},
					{
						"name": "provenpackager"
					},
					{
						"name": "ipausers"
					},
					{
						"name": "fedora-contributor"
					},
					{
						"name": "signed_fpca"
					},
					{
						"name": "fedorabugs"
					},
					{
						"name": "ambassadors"
					},
					{
						"name": "designteam"
					},
					{
						"name": "shogun-ca"
					},
					{
						"name": "alt-gtk-de-sig"
					}
				],
				"id": 206,
				"name": "besser82",
				"openid": "besser82.id.fedoraproject.org"
			},
			"user_id": 206
		},
		{
			"id": 628826,
			"karma": 1,
			"text": "works for me",
			"timestamp": "2017-06-29 07:06:35",
			"update_id": 91024,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/2087ddb84fdf1774c00fc96323f629621c9046b99eee2aa497044f598f3979d4?s=24&d=retro",
				"email": "yuwatana@redhat.com",
				"groups": [
					{
						"name": "packager"
					}
				],
				"id": 125,
				"name": "yuwata",
				"openid": "yuwata.id.fedoraproject.org"
			},
			"user_id": 125
		},
		{
			"id": 628924,
			"karma": -1,
			"text": "THIS IS UNACCEPTABLE - STOP PLAY AROUND WITH THE MOST IMPORTANT PART OF A DISTRIBUTION: Please be aware that this update is expected to cause **DB_VERSION_MISMATCH** errors during installation if you are still running an older release of libdb. These errors are a result of packages calling rpm commands during installation and have so far been found harmless",
			"timestamp": "2017-06-29 15:53:06",
			"update_id": 91024,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/c82951c2d404ca0cfea20f51b040175ba4d1624f51e8ec366e75565b672e943d?s=24&d=retro",
				"email": "h.reindl@thelounge.net",
				"id": 182,
				"name": "hreindl",
				"openid": "hreindl.id.fedoraproject.org"
			},
			"user_id": 182
		},
		{
			"bug_feedback": [
				{
					"bug": {
						"bug_id": 1464032,
						"parent": true,
						"security": true,
						"title": "libdb: Reads DB_CONFIG from the current working directory"
					},
					"bug_id": 1464032,
					"comment_id": 629566
				},
				{
					"bug": {
						"bug_id": 1464033,
						"security": true,
						"title": "libdb: Reads DB_CONFIG from the current working directory [fedora-all]"
					},
					"bug_id": 1464033,
					"comment_id": 629566
				},
				{
					"bug": {
						"bug_id": 1394862,
						"title": "libdb: Assumes that internal condition variable layout never changes"
					},
					"bug_id": 1394862,
					"comment_id": 629566
				},
				{
					"bug": {
						"bug_id": 1460003,
						"title": "upgrade f25 to f26 get stuck in Cleanup: krb5-list"
					},
					"bug_id": 1460003,
					"comment_id": 629566
				}
			],
			"id": 629566,
			"karma": 1,
			"karma_critpath": 1,
			"text": "No regressions noted.",
			"timestamp": "2017-06-30 20:56:40",
			"update_id": 91024,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/e62cb974458dc33fcf2225462b8765e0aadcbbd698560c8f8dad6c3e23d5e47e?s=24&d=retro",
				"email": "dhgutteridge@hotmail.com",
				"groups": [
					{
						"name": "ipausers"
					}
				],
				"id": 194,
				"name": "dhgutteridge",
				"openid": "dhgutteridge.id.fedoraproject.org"
			},
			"user_id": 194
		},
		{
			"id": 630119,
			"karma": 1,
			"text": "works for me in a VM",
			"timestamp": "2017-07-02 13:32:42",
			"update_id": 91024,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/054959f4db5d1ad8f22cae1ba73e26ebfd3edd6690c21cc7ee00608f294ff22a?s=24&d=retro",
				"email": "cserpentis@gmail.com",
				"groups": [
					{
						"name": "packager"
					},
					{
						"name": "ipausers"
					},
					{
						"name": "fedora-contributor"
					},
					{
						"name": "signed_fpca"
					},
					{
						"name": "fedorabugs"
					}
				],
				"id": 739,
				"name": "cserpentis",
				"openid": "cserpentis.id.fedoraproject.org"
			},
			"user_id": 739
		},
		{
			"id": 632071,
			"karma": 1,
			"text": "No problem",
			"timestamp": "2017-07-07 13:17:28",
			"update_id": 91024,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/4dfa31e963873203ebe47d817c7fb5e6d082728f5a8d7e17396fd419d58fb0fe?s=24&d=retro",
				"email": "alciregi@posteo.net",
				"groups": [
					{
						"name": "packager"
					},
					{
						"name": "ask-fedora"
					},
					{
						"name": "cvsl10n"
					},
					{
						"name": "respins-sig"
					},
					{
						"name": "wikiedit"
					},
					{
						"name": "l10n"
					},
					{
						"name": "signed_fpca"
					},
					{
						"name": "advocates"
					},
					{
						"name": "ambassadors"
					},
					{
						"name": "fedora-join"
					},
					{
						"name": "fedora-contributor"
					},
					{
						"name": "ipausers"
					},
					{
						"name": "neuro-sig"
					},
					{
						"name": "qa"
					},
					{
						"name": "fedorabugs"
					},
					{
						"name": "common-issues-triage"
					}
				],
				"id": 3508,
				"name": "alciregi",
				"openid": "alciregi.id.fedoraproject.org"
			},
			"user_id": 3508
		},
		{
			"id": 633107,
			"text": "This update has been submitted for stable by pkubat. ",
			"timestamp": "2017-07-10 06:09:30",
			"update_id": 91024,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 633846,
			"text": "This update has been pushed to stable.",
			"timestamp": "2017-07-12 03:24:55",
			"update_id": 91024,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		}
	],
	"content_type": "rpm",
	"critpath": true,
	"date_pushed": "2017-07-11 18:56:33",
	"date_stable": "2017-07-11 18:56:33",
	"date_submitted": "2017-06-27 07:34:41",
	"date_testing": "2017-06-27 16:17:46",
	"karma": 4,
	"meets_testing_requirements": true,
	"notes": "Security fix for DB_CONFIG parsing when db_home is not set.\n\nThis update also introduces modified fixes for rhbz#1394862 once again and additionally fixes ppc specific hangs described in rhbz#1460003.\n\nPlease be aware that this update is expected to cause **DB_VERSION_MISMATCH** errors during installation if you are still running an older release of libdb. These errors are a result of packages calling rpm commands during installation and have so far been found harmless.\n\nYou can also run into issues with dnf plugins that do the same. As these plugins are run after the rpm transaction has already gone through successfully they should also be harmless. However, in this case a rebuild of rpmdb's environment will be needed. Detailed information on how to achieve this can be found in the links below.\n\nFor more information please take a look at:\n\nhttps://fedoraproject.org/wiki/Common_F26_bugs#upgrade-libdb\nhttps://fedoraproject.org/wiki/Common_F26_bugs#libdb-rebuilddb\n",
	"pushed": true,
	"release": {
		"branch": "f25",
		"candidate_tag": "f25-updates-candidate",
		"composed_by_bodhi": true,
		"dist_tag": "f25",
		"id_prefix": "FEDORA",
		"long_name": "Fedora 25",
		"mail_template": "fedora_errata_template",
		"name": "F25",
		"override_tag": "f25-override",
		"package_manager": "dnf",
		"pending_signing_tag": "f25-signing-pending",
		"pending_stable_tag": "f25-updates-pending",
		"pending_testing_tag": "f25-updates-testing-pending",
		"stable_tag": "f25-updates",
		"state": "archived",
		"testing_repository": "updates-testing",
		"testing_tag": "f25-updates-testing",
		"version": "25"
	},
	"require_bugs": true,
	"require_testcases": true,
	"severity": "medium",
	"stable_karma": 3,
	"status": "stable",
	"suggest": "unspecified",
	"title": "libdb-5.3.28-24.fc25",
	"type": "security",
	"url": "https://bodhi.fedoraproject.org/updates/FEDORA-2017-372bb1edb3",
	"unstable_karma": -3,
	"updateid": "FEDORA-2017-372bb1edb3",
	"user": {
		"avatar": "https://seccdn.libravatar.org/avatar/e456c9b9b2e75cd60657ae9f6d54c94a5e16a63e2747675184ad44b0a7230287?s=24&d=retro",
		"email": "pkubat@redhat.com",
		"groups": [
			{
				"name": "packager"
			}
		],
		"id": 2917,
		"name": "pkubat",
		"openid": "pkubat.id.fedoraproject.org"
	},
	"version_hash": "1199f4dc89ceaa94e645554b6014eb4ccbfe2eac"
}
