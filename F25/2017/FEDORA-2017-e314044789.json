{
	"alias": "FEDORA-2017-e314044789",
	"autokarma": true,
	"bugs": [
		{
			"bug_id": 1466752,
			"security": true,
			"title": "CVE-2017-9224 CVE-2017-9225 CVE-2017-9226 CVE-2017-9227 CVE-2017-9228 CVE-2017-9229 oniguruma: various flaws [fedora-all]",
			"bugzilla": {
				"bug_id": "1466752",
				"creation_ts": "2017-06-30 11:32:18 +0000",
				"short_desc": "CVE-2017-9224 CVE-2017-9225 CVE-2017-9226 CVE-2017-9227 CVE-2017-9228 CVE-2017-9229 oniguruma: various flaws [fedora-all]",
				"delta_ts": "2017-09-27 05:26:01 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Reopened, Security, SecurityTracking",
				"priority": "medium",
				"bug_severity": "medium",
				"blocked": [
					{
						"bug_id": "1466730",
						"alias": "CVE-2017-9224",
						"creation_ts": "2017-06-30 10:48:46 +0000",
						"short_desc": "CVE-2017-9224 oniguruma: Out-of-bounds stack read in match_at() during regular expression searching",
						"delta_ts": "2020-12-14 08:59:46 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1466749",
							"1466750",
							"1466751",
							"1466752",
							"1466753",
							"1554537"
						],
						"blocked": [
							{
								"bug_id": "1466748",
								"error": "NotPermitted"
							},
							{
								"bug_id": "1491035",
								"error": "NotPermitted"
							}
						],
						"external_bugs": {
							"text": "RHSA-2018:1296",
							"name": "Red Hat Product Errata"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "10556525",
								"comment_count": "0",
								"who": {
									"text": "amaris",
									"name": "Adam Mariš"
								},
								"bug_when": "2017-06-30 10:48:46 +0000",
								"thetext": "An issue was discovered in Oniguruma 6.2.0, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5. A stack out-of-bounds read occurs in match_at() during regular expression searching. A logical error involving order of validation and access in match_at() could result in an out-of-bounds read from a stack buffer.\n\nUpstream bug:\n\nhttps://github.com/kkos/oniguruma/issues/57\n\nUpstream patch:\n\nhttps://github.com/kkos/oniguruma/commit/690313a061f7a4fa614ec5cc8368b4f2284e059b"
							},
							{
								"isprivate": "0",
								"commentid": "10556639",
								"comment_count": "1",
								"who": {
									"text": "amaris",
									"name": "Adam Mariš"
								},
								"bug_when": "2017-06-30 11:34:51 +0000",
								"thetext": "Created oniguruma tracking bugs for this issue:\n\nAffects: epel-7 [bug 1466750]\nAffects: fedora-all [bug 1466752]\n\n\nCreated php tracking bugs for this issue:\n\nAffects: fedora-all [bug 1466751]\n\n\nCreated ruby tracking bugs for this issue:\n\nAffects: fedora-all [bug 1466749]\n\n\nCreated ruby193-ruby tracking bugs for this issue:\n\nAffects: openshift-1 [bug 1466753]"
							},
							{
								"isprivate": "0",
								"commentid": "10647141",
								"comment_count": "2",
								"who": {
									"text": "dmoppert",
									"name": "Doran Moppert"
								},
								"bug_when": "2017-07-31 04:04:18 +0000",
								"thetext": "Exploiting this flaw results in a single byte read beyond the end of the input string, which is stack-allocated in the reproducer but could plausibly also be heap-allocated.  Information about the byte read may under some circumstances be leaked to the attacker, but their opportunity to control this or repeatedly exploit it to learn useful information is very small."
							},
							{
								"isprivate": "0",
								"commentid": "10771855",
								"comment_count": "3",
								"who": {
									"text": "vondruch",
									"name": "Vít Ondruch"
								},
								"bug_when": "2017-09-06 13:39:36 +0000",
								"thetext": "This is not vulnerable according to the upstream:\n\n~~~\n> CVE-2017-9224 https://github.com/kkos/oniguruma/issues/57\n\nnot affected.\n\n% ruby <<'END'\nstr   = [ 0xc7, 0xd6, 0xfe, 0xea, 0xe0, 0xe2, 0x00 ].pack('c*')\ninput = [0xf1, 0x5c, 0x69, 0x53, 0x53, 0x53, 0x53, 0x3c, 0x30, 0x53,\n        0x59, 0x54, 0x52, 0x33, 0x7c, 0x2e, 0x5c, 0xe2, 0x48, 0x5c,\n        0x7a, 0x53, 0x00, 0x06, 0x00, 0x00, 0x27, 0x19, 0x00, 0x54,\n        0x52, 0x54, 0x52, 0x33, 0x7c, 0x2e, 0x53, 0xe2, 0x48].pack('c*')\n\nre = Regexp.new(input.force_encoding('Shift_JIS'), Regexp::IGNORECASE)\nre.match str.force_encoding('Shift_JIS')\nEND\nTraceback (most recent call last):\n        1: from -:8:in `<main>'\n-:8:in `match': invalid byte sequence in Shift_JIS (ArgumentError)\n~~~"
							},
							{
								"isprivate": "0",
								"commentid": "10771881",
								"comment_count": "4",
								"who": {
									"text": "vondruch",
									"name": "Vít Ondruch"
								},
								"bug_when": "2017-09-06 13:41:09 +0000",
								"thetext": "(In reply to Vít Ondruch from comment #3)\nSpeaking in Ruby context ..."
							},
							{
								"isprivate": "0",
								"commentid": "11551572",
								"comment_count": "6",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2018-05-03 05:06:33 +0000",
								"thetext": "This issue has been addressed in the following products:\n\n  Red Hat Software Collections for Red Hat Enterprise Linux 6\n  Red Hat Software Collections for Red Hat Enterprise Linux 6.7 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.3 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS\n\nVia RHSA-2018:1296 https://access.redhat.com/errata/RHSA-2018:1296"
							}
						]
					},
					{
						"bug_id": "1466733",
						"alias": "CVE-2017-9225",
						"creation_ts": "2017-06-30 10:56:10 +0000",
						"short_desc": "CVE-2017-9225 oniguruma: Out-of-bounds stack write in onigenc_unicode_get_case_fold_codes_by_str() during regular expression compilation",
						"delta_ts": "2021-10-21 11:54:08 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1466749",
							"1466750",
							"1466751",
							"1466752",
							"1466753"
						],
						"blocked": [
							{
								"bug_id": "1466748",
								"error": "NotPermitted"
							}
						],
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "10556536",
								"comment_count": "0",
								"who": {
									"text": "amaris",
									"name": "Adam Mariš"
								},
								"bug_when": "2017-06-30 10:56:10 +0000",
								"thetext": "An issue was discovered in Oniguruma 6.2.0, as used in Oniguruma-mod in\nRuby through 2.4.1 and mbstring in PHP through 7.1.5. A stack\nout-of-bounds write in onigenc_unicode_get_case_fold_codes_by_str()\noccurs during regular expression compilation. Code point 0xFFFFFFFF is\nnot properly handled in unicode_unfold_key(). A malformed regular\nexpression could result in 4 bytes being written off the end of a stack\nbuffer of expand_case_fold_string() during the call to\nonigenc_unicode_get_case_fold_codes_by_str(), a typical stack buffer\noverflow.\n \nUpstream bug:\n\nhttps://github.com/kkos/oniguruma/issues/56\n\nUpstream patch:\n\nhttps://github.com/kkos/oniguruma/commit/166a6c3999bf06b4de0ab4ce6b088a468cc4029f"
							},
							{
								"isprivate": "0",
								"commentid": "10556632",
								"comment_count": "1",
								"who": {
									"text": "amaris",
									"name": "Adam Mariš"
								},
								"bug_when": "2017-06-30 11:33:55 +0000",
								"thetext": "Created oniguruma tracking bugs for this issue:\n\nAffects: epel-7 [bug 1466750]\nAffects: fedora-all [bug 1466752]\n\n\nCreated php tracking bugs for this issue:\n\nAffects: fedora-all [bug 1466751]\n\n\nCreated ruby tracking bugs for this issue:\n\nAffects: fedora-all [bug 1466749]\n\n\nCreated ruby193-ruby tracking bugs for this issue:\n\nAffects: openshift-1 [bug 1466753]"
							},
							{
								"isprivate": "0",
								"commentid": "10647119",
								"comment_count": "2",
								"who": {
									"text": "dmoppert",
									"name": "Doran Moppert"
								},
								"bug_when": "2017-07-31 03:40:35 +0000",
								"thetext": "This flaw was introduced upstream in commit https://github.com/kkos/oniguruma/commit/d8366441 (2016-04-16, post v5.9.6).\n\nPreviously, the functionality of unicode_unfold_key() was provided by a simple hash table (st.c) and was not prone to such overflows."
							},
							{
								"isprivate": "0",
								"commentid": "10771888",
								"comment_count": "4",
								"who": {
									"text": "vondruch",
									"name": "Vít Ondruch"
								},
								"bug_when": "2017-09-06 13:42:33 +0000",
								"thetext": "Ruby is not vulnerable according to Ruby upstream:\n\n~~~\n> CVE-2017-9225 https://github.com/kkos/oniguruma/issues/56\n\nnot affected.\n\n% ruby <<'END'\nstr = \"\\x3f\\xff\\x63\\x7f\\xff\\xff\\xff\\xff\\x4d\\x22\\x00\\x00\".force_encoding('UTF-32BE')\nRegexp.new(str)\nEND\nTraceback (most recent call last):\n        2: from -:2:in `<main>'\n        1: from -:2:in `new'\n-:2:in `initialize': invalid multibyte character:\n/\\x3F\\u{FF637FFF}\\u{FFFFFF4D}\\x22\\x00\\x00/ (RegexpError)\n~~~"
							}
						]
					},
					{
						"bug_id": "1466736",
						"alias": "CVE-2017-9226",
						"creation_ts": "2017-06-30 11:02:11 +0000",
						"short_desc": "CVE-2017-9226 oniguruma: Heap buffer overflow in next_state_val() during regular expression compilation",
						"delta_ts": "2020-12-14 08:59:49 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1466749",
							"1466750",
							"1466751",
							"1466752",
							"1466753",
							"1554537",
							"1788387",
							"1788388",
							"1788389"
						],
						"blocked": [
							{
								"bug_id": "1466748",
								"error": "NotPermitted"
							},
							{
								"bug_id": "1491035",
								"error": "NotPermitted"
							}
						],
						"external_bugs": {
							"text": "RHSA-2018:1296",
							"name": "Red Hat Product Errata"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "10556556",
								"comment_count": "0",
								"who": {
									"text": "amaris",
									"name": "Adam Mariš"
								},
								"bug_when": "2017-06-30 11:02:11 +0000",
								"thetext": "An issue was discovered in Oniguruma 6.2.0, as used in Oniguruma-mod in\nRuby through 2.4.1 and mbstring in PHP through 7.1.5. A heap\nout-of-bounds write or read occurs in next_state_val() during regular\nexpression compilation. Octal numbers larger than 0xff are not handled\ncorrectly in fetch_token() and fetch_token_in_cc(). A malformed regular\nexpression containing an octal number in the form of '\\700' would\nproduce an invalid code point value larger than 0xff in\nnext_state_val(), resulting in an out-of-bounds write memory\ncorruption.\n \nUpstream bug:\n\nhttps://github.com/kkos/oniguruma/issues/55\n\nUpstream patch:\n\nhttps://github.com/kkos/oniguruma/commit/f015fbdd95f76438cd86366467bb2b39870dd7c6"
							},
							{
								"isprivate": "0",
								"commentid": "10556628",
								"comment_count": "1",
								"who": {
									"text": "amaris",
									"name": "Adam Mariš"
								},
								"bug_when": "2017-06-30 11:32:27 +0000",
								"thetext": "Created oniguruma tracking bugs for this issue:\n\nAffects: epel-7 [bug 1466750]\nAffects: fedora-all [bug 1466752]\n\n\nCreated php tracking bugs for this issue:\n\nAffects: fedora-all [bug 1466751]\n\n\nCreated ruby tracking bugs for this issue:\n\nAffects: fedora-all [bug 1466749]\n\n\nCreated ruby193-ruby tracking bugs for this issue:\n\nAffects: openshift-1 [bug 1466753]"
							},
							{
								"isprivate": "0",
								"commentid": "10647205",
								"comment_count": "2",
								"who": {
									"text": "dmoppert",
									"name": "Doran Moppert"
								},
								"bug_when": "2017-07-31 04:49:25 +0000",
								"thetext": "Further upstream patch:\n\nhttps://github.com/kkos/oniguruma/commit/b4bf968"
							},
							{
								"isprivate": "0",
								"commentid": "10647212",
								"comment_count": "3",
								"who": {
									"text": "dmoppert",
									"name": "Doran Moppert"
								},
								"bug_when": "2017-07-31 04:55:51 +0000",
								"thetext": "Exploiting this requires attacker control of the regular expression to be compiled.  By inserting invalid octal sequences, the attacker can cause the application to read or write a single word up to 256 bytes away from the intended target.  The writes seem to all pass through BIT_SET(), limiting the outcome of any exploit that manages to cause a write."
							},
							{
								"isprivate": "0",
								"commentid": "10771896",
								"comment_count": "6",
								"who": {
									"text": "vondruch",
									"name": "Vít Ondruch"
								},
								"bug_when": "2017-09-06 13:44:07 +0000",
								"thetext": "Ruby is not vulnerable according to upstream:\n\n~~~\n> CVE-2017-9226 https://github.com/kkos/oniguruma/issues/55\n\nnot affected.\n\n% ruby <<'END'\nstr = '[\\\\6000'.force_encoding('KOI8-R')\nRegexp.new(str).match('a')\nEND\nTraceback (most recent call last):\n        2: from -:2:in `<main>'\n        1: from -:2:in `new'\n-:2:in `initialize': invalid escape code: /[\\6000/ (RegexpError)\n~~~"
							},
							{
								"isprivate": "0",
								"commentid": "11551574",
								"comment_count": "8",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2018-05-03 05:06:50 +0000",
								"thetext": "This issue has been addressed in the following products:\n\n  Red Hat Software Collections for Red Hat Enterprise Linux 6\n  Red Hat Software Collections for Red Hat Enterprise Linux 6.7 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.3 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS\n\nVia RHSA-2018:1296 https://access.redhat.com/errata/RHSA-2018:1296"
							},
							{
								"isprivate": "0",
								"commentid": "13496734",
								"comment_count": "9",
								"who": {
									"text": "mcooper",
									"name": "Mark Cooper"
								},
								"bug_when": "2020-01-07 04:38:00 +0000",
								"thetext": "The above regular expression can cause a segfault or an ASAN heap buffer overflow with version 5.9.2 of oniguruma which is included in the following containers:\n - openshift4/ose-metering-hadoop\n - openshift4/ose-metering-hive\n - openshift4/ose-metering-presto\n\nThe above containers include oniguruma but do not use it. This includes faq and jq which are present in the above containers (depend on oniguruma) and are only used for initial setup/installation of the Operator."
							}
						]
					},
					{
						"bug_id": "1466739",
						"alias": "CVE-2017-9227",
						"creation_ts": "2017-06-30 11:06:19 +0000",
						"short_desc": "CVE-2017-9227 oniguruma: Out-of-bounds stack read in mbc_enc_len() during regular expression searching",
						"delta_ts": "2020-12-14 08:59:53 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1466749",
							"1466750",
							"1466751",
							"1466752",
							"1466753",
							"1554537"
						],
						"blocked": [
							{
								"bug_id": "1466748",
								"error": "NotPermitted"
							}
						],
						"external_bugs": {
							"text": "RHSA-2018:1296",
							"name": "Red Hat Product Errata"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "10556566",
								"comment_count": "0",
								"who": {
									"text": "amaris",
									"name": "Adam Mariš"
								},
								"bug_when": "2017-06-30 11:06:19 +0000",
								"thetext": "An issue was discovered in Oniguruma 6.2.0, as used in Oniguruma-mod in\nRuby through 2.4.1 and mbstring in PHP through 7.1.5. A stack\nout-of-bounds read occurs in mbc_enc_len() during regular expression\nsearching. Invalid handling of reg->dmin in forward_search_range()\ncould result in an invalid pointer dereference, as an out-of-bounds\nread from a stack buffer.\n \nUpstream bug:\n\nhttps://github.com/kkos/oniguruma/issues/58\n\nUpstream patch:\n\nhttps://github.com/kkos/oniguruma/commit/9690d3ab1f9bcd2db8cbe1fe3ee4a5da606b8814"
							},
							{
								"isprivate": "0",
								"commentid": "10556631",
								"comment_count": "1",
								"who": {
									"text": "amaris",
									"name": "Adam Mariš"
								},
								"bug_when": "2017-06-30 11:33:27 +0000",
								"thetext": "Created oniguruma tracking bugs for this issue:\n\nAffects: epel-7 [bug 1466750]\nAffects: fedora-all [bug 1466752]\n\n\nCreated php tracking bugs for this issue:\n\nAffects: fedora-all [bug 1466751]\n\n\nCreated ruby tracking bugs for this issue:\n\nAffects: fedora-all [bug 1466749]\n\n\nCreated ruby193-ruby tracking bugs for this issue:\n\nAffects: openshift-1 [bug 1466753]"
							},
							{
								"isprivate": "0",
								"commentid": "10766940",
								"comment_count": "2",
								"who": {
									"text": "dominik.mierzejewski",
									"name": "Dominik Mierzejewski"
								},
								"bug_when": "2017-09-05 10:03:49 +0000",
								"thetext": "How is ruby affected? Was this reported to ruby developers?"
							},
							{
								"isprivate": "0",
								"commentid": "10767015",
								"comment_count": "3",
								"who": {
									"text": "vondruch",
									"name": "Vít Ondruch"
								},
								"bug_when": "2017-09-05 10:25:36 +0000",
								"thetext": "Yes, it was.\n\nThis is the short answer:\n\n~~~\nI don't think the CVEs directly apply to us.  See below.  In short, We\ncheck validity of strings before matching.\n~~~\n\nAnd for this specific issue, this is the long version:\n\n~~~\n> CVE-2017-9227 https://github.com/kkos/oniguruma/issues/58\n\nnot affected.\n\n% ruby <<'END'\nstr   = [ 0xc7, 0xd6, 0xfe, 0xea, 0xe0, 0xe2, 0x00 ].pack('c*')\ninput = [0x6a, 0x00, 0x01, 0x6c, 0x7b, 0x00, 0x01, 0x6c, 0x7b, 0x32,\n        0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d,\n        0x7b, 0x32, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b, 0x32,\n        0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x6a,\n        0x00, 0x01, 0x6c, 0x7b, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d,\n        0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d,\n        0x1d, 0x1d, 0x32, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b,\n        0x32, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b, 0x32, 0x32,\n        0x7d, 0x7b, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b, 0x32,\n        0x32, 0x7d, 0x7b, 0x32, 0x7d].pack('c*')\n\nre = Regexp.new(input.force_encoding('UTF-8'), Regexp::IGNORECASE)\nre.match str.force_encoding('UTF-8')\nEND\nTraceback (most recent call last):\n        1: from -:14:in `<main>'\n-:14:in `match': invalid byte sequence in UTF-8 (ArgumentError)\n~~~\n\nBut they are still awaiting for upstream (Oniguruma) response."
							},
							{
								"isprivate": "0",
								"commentid": "10767107",
								"comment_count": "4",
								"who": {
									"text": "dominik.mierzejewski",
									"name": "Dominik Mierzejewski"
								},
								"bug_when": "2017-09-05 10:47:59 +0000",
								"thetext": "Thank you for the clarification, Vit. Could you please have the advisory at https://access.redhat.com/security/cve/CVE-2017-9227 updated to say that ruby is not affected, then?"
							},
							{
								"isprivate": "0",
								"commentid": "10767121",
								"comment_count": "5",
								"who": {
									"text": "vondruch",
									"name": "Vít Ondruch"
								},
								"bug_when": "2017-09-05 10:56:06 +0000",
								"thetext": "(In reply to Dominik Mierzejewski from comment #4)\nUnfortunately, this is not in my hands. This should be:\n\n1) Officially clarified by upstream.\n2) The portal should be updated by Red Hat Security team."
							},
							{
								"isprivate": "0",
								"commentid": "10774271",
								"comment_count": "6",
								"who": {
									"text": "dmoppert",
									"name": "Doran Moppert"
								},
								"bug_when": "2017-09-07 02:55:28 +0000",
								"thetext": "Thanks Vit!\n\nRuby's string validation blocks the obvious reproducer, but I wasn't confident enough that other paths couldn't reach it to mark Ruby as notaffected.\n\nIf you receive further info from upstream, please needinfo or mail me directly and I'll make sure these bugs and the CVE pages are updated correctly."
							},
							{
								"isprivate": "0",
								"commentid": "11551576",
								"comment_count": "9",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2018-05-03 05:06:54 +0000",
								"thetext": "This issue has been addressed in the following products:\n\n  Red Hat Software Collections for Red Hat Enterprise Linux 6\n  Red Hat Software Collections for Red Hat Enterprise Linux 6.7 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.3 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS\n\nVia RHSA-2018:1296 https://access.redhat.com/errata/RHSA-2018:1296"
							}
						]
					},
					{
						"bug_id": "1466740",
						"alias": "CVE-2017-9228",
						"creation_ts": "2017-06-30 11:16:28 +0000",
						"short_desc": "CVE-2017-9228 oniguruma: Out-of-bounds heap write in bitset_set_range()",
						"delta_ts": "2020-12-14 08:59:57 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1466749",
							"1466750",
							"1466751",
							"1466752",
							"1466753",
							"1554537"
						],
						"blocked": [
							{
								"bug_id": "1466748",
								"error": "NotPermitted"
							},
							{
								"bug_id": "1491035",
								"error": "NotPermitted"
							}
						],
						"external_bugs": {
							"text": "RHSA-2018:1296",
							"name": "Red Hat Product Errata"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "10556577",
								"comment_count": "0",
								"who": {
									"text": "amaris",
									"name": "Adam Mariš"
								},
								"bug_when": "2017-06-30 11:16:28 +0000",
								"thetext": "An issue was discovered in Oniguruma 6.2.0, as used in Oniguruma-mod in\nRuby through 2.4.1 and mbstring in PHP through 7.1.5. A heap\nout-of-bounds write occurs in bitset_set_range() during regular\nexpression compilation due to an uninitialized variable from an\nincorrect state transition. An incorrect state transition in\nparse_char_class() could create an execution path that leaves a\ncritical local variable uninitialized until it's used as an index,\nresulting in an out-of-bounds write memory corruption. \nUpstream bug:\n\nhttps://github.com/kkos/oniguruma/issues/60\n\nUpstream patch:\n\nhttps://github.com/kkos/oniguruma/commit/3b63d12038c8d8fc278e81c942fa9bec7c704c8b"
							},
							{
								"isprivate": "0",
								"commentid": "10556635",
								"comment_count": "1",
								"who": {
									"text": "amaris",
									"name": "Adam Mariš"
								},
								"bug_when": "2017-06-30 11:34:23 +0000",
								"thetext": "Created oniguruma tracking bugs for this issue:\n\nAffects: epel-7 [bug 1466750]\nAffects: fedora-all [bug 1466752]\n\n\nCreated php tracking bugs for this issue:\n\nAffects: fedora-all [bug 1466751]\n\n\nCreated ruby tracking bugs for this issue:\n\nAffects: fedora-all [bug 1466749]\n\n\nCreated ruby193-ruby tracking bugs for this issue:\n\nAffects: openshift-1 [bug 1466753]"
							},
							{
								"isprivate": "0",
								"commentid": "10647192",
								"comment_count": "2",
								"who": {
									"text": "dmoppert",
									"name": "Doran Moppert"
								},
								"bug_when": "2017-07-31 04:26:35 +0000",
								"thetext": "Note also the second upstream patch:\n\nhttps://github.com/kkos/oniguruma/commit/ddbf55698b5f7ffdfa737b0b8e0079af1fdd7cb1"
							},
							{
								"isprivate": "0",
								"commentid": "10647321",
								"comment_count": "3",
								"who": {
									"text": "dmoppert",
									"name": "Doran Moppert"
								},
								"bug_when": "2017-07-31 06:10:07 +0000",
								"thetext": "The attack demonstrated here gives very limited control - it looks like in the best case, up to 8 bits in a range determined by uninitialised (stack) data can be set to 1."
							},
							{
								"isprivate": "0",
								"commentid": "10771907",
								"comment_count": "4",
								"who": {
									"text": "vondruch",
									"name": "Vít Ondruch"
								},
								"bug_when": "2017-09-06 13:45:57 +0000",
								"thetext": "Ruby is not vulnerable according to upstream:\n\n~~~\n> CVE-2017-9228 https://github.com/kkos/oniguruma/issues/60\n\nnot affected.\n\n% ruby <<'END'\nstr = [ 0xc7, 0xd6, 0xfe, 0xea, 0xe0, 0xe2, 0x00 ].pack('c*')\npattern = \"\\x5b\\x5c\\x48\\x2d\\xb0\\x30\\x8d\\x30\\x2a\\x5b\\x5d\\x20\\x20\\x5d\" +\n          \"\\xf9\\x54\\x00\\x7f\\x5c\\x63\\xef\\xef\\xef\\xef\\x52\\xf7\\xf7\\x52\" +\n          \"\\xf7\\xeb\\xeb\\x70\\x2b\\xf7\\x7b\\x30\\x2c\\x32\\x7d\"\nre = Regexp.new(pattern.force_encoding('GB18030'), Regexp::IGNORECASE)\nre.match str.force_encoding('GB18030')\nEND\nTraceback (most recent call last):\n        2: from -:5:in `<main>'\n        1: from -:5:in `new'\n-:5:in `initialize': too short control escape: /[\\H-\\x{B0308D30}*[]\n]\\x{F954}\\x00\\x7F\\c\\x{EFEF}\\x{EFEF}R\\x{F7F7}R\\x{F7EB}\\x{EB70}+\\x{F77B}0,2}/i\n(RegexpError)\n~~~"
							},
							{
								"isprivate": "0",
								"commentid": "10798006",
								"comment_count": "5",
								"who": {
									"text": "mtasaka",
									"name": "Mamoru TASAKA"
								},
								"bug_when": "2017-09-15 07:13:19 +0000",
								"thetext": "(In reply to Doran Moppert from comment #2)\n> Note also the second upstream patch:\n> \n> https://github.com/kkos/oniguruma/commit/\n> ddbf55698b5f7ffdfa737b0b8e0079af1fdd7cb1\n\nOn Fedora, I submitted oniguruma-6.1.3-3.fc25 .\noniguruma on F-26 and above already contains this fix.\n(F-24 is EOL)"
							},
							{
								"isprivate": "0",
								"commentid": "11551577",
								"comment_count": "7",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2018-05-03 05:07:02 +0000",
								"thetext": "This issue has been addressed in the following products:\n\n  Red Hat Software Collections for Red Hat Enterprise Linux 6\n  Red Hat Software Collections for Red Hat Enterprise Linux 6.7 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.3 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS\n\nVia RHSA-2018:1296 https://access.redhat.com/errata/RHSA-2018:1296"
							}
						]
					},
					{
						"bug_id": "1466746",
						"alias": "CVE-2017-9229",
						"creation_ts": "2017-06-30 11:27:17 +0000",
						"short_desc": "CVE-2017-9229 oniguruma: Invalid pointer dereference in left_adjust_char_head()",
						"delta_ts": "2020-12-14 09:00:00 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1466749",
							"1466750",
							"1466751",
							"1466752",
							"1466753",
							"1554537"
						],
						"blocked": [
							{
								"bug_id": "1466748",
								"error": "NotPermitted"
							},
							{
								"bug_id": "1491035",
								"error": "NotPermitted"
							}
						],
						"external_bugs": {
							"text": "RHSA-2018:1296",
							"name": "Red Hat Product Errata"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "10556607",
								"comment_count": "0",
								"who": {
									"text": "amaris",
									"name": "Adam Mariš"
								},
								"bug_when": "2017-06-30 11:27:17 +0000",
								"thetext": "An issue was discovered in Oniguruma 6.2.0, as used in Oniguruma-mod in\nRuby through 2.4.1 and mbstring in PHP through 7.1.5. A SIGSEGV occurs\nin left_adjust_char_head() during regular expression compilation.\nInvalid handling of reg->dmax in forward_search_range() could result in\nan invalid pointer dereference, normally as an immediate\ndenial-of-service condition.\n \nUpstream bug:\n\nhttps://github.com/kkos/oniguruma/issues/59\n\nUpstream patch:\n\nhttps://github.com/kkos/oniguruma/commit/b690371bbf97794b4a1d3f295d4fb9a8b05d402d"
							},
							{
								"isprivate": "0",
								"commentid": "10556629",
								"comment_count": "1",
								"who": {
									"text": "amaris",
									"name": "Adam Mariš"
								},
								"bug_when": "2017-06-30 11:32:57 +0000",
								"thetext": "Created oniguruma tracking bugs for this issue:\n\nAffects: epel-7 [bug 1466750]\nAffects: fedora-all [bug 1466752]\n\n\nCreated php tracking bugs for this issue:\n\nAffects: fedora-all [bug 1466751]\n\n\nCreated ruby tracking bugs for this issue:\n\nAffects: fedora-all [bug 1466749]\n\n\nCreated ruby193-ruby tracking bugs for this issue:\n\nAffects: openshift-1 [bug 1466753]"
							},
							{
								"isprivate": "0",
								"commentid": "10771912",
								"comment_count": "3",
								"who": {
									"text": "vondruch",
									"name": "Vít Ondruch"
								},
								"bug_when": "2017-09-06 13:47:21 +0000",
								"thetext": "Ruby is not vulnerable according to upstream:\n\n~~~\n> CVE-2017-9229 https://github.com/kkos/oniguruma/issues/59\n\nnot affected.\n\n% ruby <<'END'\nstr = [ 0xc7, 0xd6, 0xfe, 0xea, 0xe0, 0xe2, 0x00 ].pack('c*')\ninp = \"\\x00\\x7c\\x2e\\x7b\\x39\\x7d\\x7b\\x39\\x30\\x7d\\x7b\\x39\\x7d\\x7b\\x2c\\x39\\x30\\x30\\x7d\\x30\"\nre = Regexp.new(inp.force_encoding('EUC-JP'))\nmd = re.match str.force_encoding('EUC-JP')\np re, md\nEND\n/\\x00|.{9}{90}{9}{,900}0/\n#<MatchData \"\\x00\">\n%\n~~~"
							},
							{
								"isprivate": "0",
								"commentid": "11551578",
								"comment_count": "5",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2018-05-03 05:07:18 +0000",
								"thetext": "This issue has been addressed in the following products:\n\n  Red Hat Software Collections for Red Hat Enterprise Linux 6\n  Red Hat Software Collections for Red Hat Enterprise Linux 6.7 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.3 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS\n  Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS\n\nVia RHSA-2018:1296 https://access.redhat.com/errata/RHSA-2018:1296"
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "10556621",
						"comment_count": "0",
						"who": {
							"text": "amaris",
							"name": "Adam Mariš"
						},
						"bug_when": "2017-06-30 11:32:18 +0000",
						"thetext": "\nThis is an automatically created tracking bug!  It was created to ensure\nthat one or more security vulnerabilities are fixed in affected versions\nof fedora-all.\n\nFor comments that are specific to the vulnerability please use bugs filed\nagainst the \"Security Response\" product referenced in the \"Blocks\" field.\n\nFor more information see:\nhttp://fedoraproject.org/wiki/Security/TrackingBugs\n\nWhen submitting as an update, use the fedpkg template provided in the next\ncomment(s).  This will include the bug IDs of this tracking bug as well as\nthe relevant top-level CVE bugs.\n\nPlease also mention the CVE IDs being fixed in the RPM changelog and the\nfedpkg commit message.\n\nNOTE: this issue affects multiple supported versions of Fedora. While only\none tracking bug has been filed, please correct all affected versions at\nthe same time.  If you need to fix the versions independent of each other,\nyou may clone this bug as appropriate."
					},
					{
						"isprivate": "0",
						"commentid": "10556624",
						"comment_count": "1",
						"who": {
							"text": "amaris",
							"name": "Adam Mariš"
						},
						"bug_when": "2017-06-30 11:32:22 +0000",
						"thetext": "Use the following template to for the 'fedpkg update' request to submit an\nupdate for this issue as it contains the top-level parent bug(s) as well as\nthis tracking bug.  This will ensure that all associated bugs get updated\nwhen new packages are pushed to stable.\n\n=====\n\n# bugfix, security, enhancement, newpackage (required)\ntype=security\n\n# testing, stable\nrequest=testing\n\n# Bug numbers: 1234,9876\nbugs=1466730,1466733,1466736,1466739,1466740,1466746\n\n# Description of your update\nnotes=Security fix for [PUT CVEs HERE]\n\n# Enable request automation based on the stable/unstable karma thresholds\nautokarma=True\nstable_karma=3\nunstable_karma=-3\n\n# Automatically close bugs when this marked as stable\nclose_bugs=True\n\n# Suggest that users restart after update\nsuggest_reboot=False\n\n======\n\nAdditionally, you may opt to use the bodhi web interface to submit updates:\n\nhttps://bodhi.fedoraproject.org/updates/new"
					},
					{
						"isprivate": "0",
						"commentid": "10557783",
						"comment_count": "2",
						"who": {
							"text": "mtasaka",
							"name": "Mamoru TASAKA"
						},
						"bug_when": "2017-06-30 15:56:49 +0000",
						"thetext": "So would you check the updates already pushed 20 days ago?\n\nhttps://bodhi.fedoraproject.org/updates/FEDORA-2017-ee01a2ced6\nhttps://bodhi.fedoraproject.org/updates/FEDORA-2017-60997f0d14\nhttps://bodhi.fedoraproject.org/updates/FEDORA-2017-e2d6d0067f"
					},
					{
						"isprivate": "0",
						"commentid": "10569283",
						"comment_count": "3",
						"who": {
							"text": "mtasaka",
							"name": "Mamoru TASAKA"
						},
						"bug_when": "2017-07-06 04:05:12 +0000",
						"thetext": "Updates are already pushed before this bug is filed. Closing."
					},
					{
						"isprivate": "0",
						"commentid": "10572583",
						"comment_count": "4",
						"who": {
							"text": "amaris",
							"name": "Adam Mariš"
						},
						"bug_when": "2017-07-07 07:02:12 +0000",
						"thetext": "(In reply to Mamoru TASAKA from comment #3)\n> Updates are already pushed before this bug is filed. Closing.\n\nThanks!"
					},
					{
						"isprivate": "0",
						"commentid": "10797981",
						"comment_count": "5",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-09-15 07:09:54 +0000",
						"thetext": "oniguruma-6.1.3-3.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-e314044789"
					},
					{
						"isprivate": "0",
						"commentid": "10800770",
						"comment_count": "6",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-09-16 05:27:10 +0000",
						"thetext": "oniguruma-6.1.3-3.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-e314044789"
					},
					{
						"isprivate": "0",
						"commentid": "10833966",
						"comment_count": "7",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2017-09-27 05:26:01 +0000",
						"thetext": "oniguruma-6.1.3-3.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report."
					}
				]
			}
		}
	],
	"builds": [
		{
			"epoch": 0,
			"nvr": "oniguruma-6.1.3-3.fc25",
			"release_id": 15,
			"signed": true,
			"type": "rpm",
			"package": {
				"armv7hl": [
					{
						"name": "oniguruma",
						"version": "6.1.3",
						"release": "3.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "oniguruma-debuginfo",
						"version": "6.1.3",
						"release": "3.fc25",
						"arch": "armv7hl"
					},
					{
						"name": "oniguruma-devel",
						"version": "6.1.3",
						"release": "3.fc25",
						"arch": "armv7hl"
					}
				],
				"i686": [
					{
						"name": "oniguruma-devel",
						"version": "6.1.3",
						"release": "3.fc25",
						"arch": "i686"
					},
					{
						"name": "oniguruma-debuginfo",
						"version": "6.1.3",
						"release": "3.fc25",
						"arch": "i686"
					},
					{
						"name": "oniguruma",
						"version": "6.1.3",
						"release": "3.fc25",
						"arch": "i686"
					}
				],
				"src": [
					{
						"name": "oniguruma",
						"version": "6.1.3",
						"release": "3.fc25",
						"arch": "src"
					}
				],
				"x86_64": [
					{
						"name": "oniguruma-debuginfo",
						"version": "6.1.3",
						"release": "3.fc25",
						"arch": "x86_64"
					},
					{
						"name": "oniguruma-devel",
						"version": "6.1.3",
						"release": "3.fc25",
						"arch": "x86_64"
					},
					{
						"name": "oniguruma",
						"version": "6.1.3",
						"release": "3.fc25",
						"arch": "x86_64"
					}
				]
			}
		}
	],
	"close_bugs": true,
	"comments": [
		{
			"id": 660054,
			"text": "This update has been submitted for testing by mtasaka. ",
			"timestamp": "2017-09-15 07:09:48",
			"update_id": 96814,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 660668,
			"text": "This update has been pushed to testing.",
			"timestamp": "2017-09-16 05:32:07",
			"update_id": 96814,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 664645,
			"text": "This update has reached 7 days in testing and can be pushed to stable now if the maintainer wishes",
			"timestamp": "2017-09-23 06:00:37",
			"update_id": 96814,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 665234,
			"text": "This update has been submitted for stable by mtasaka. ",
			"timestamp": "2017-09-25 03:08:51",
			"update_id": 96814,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 666161,
			"text": "This update has been pushed to stable.",
			"timestamp": "2017-09-27 05:27:59",
			"update_id": 96814,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		}
	],
	"content_type": "rpm",
	"date_pushed": "2017-09-26 19:35:44",
	"date_stable": "2017-09-26 19:35:44",
	"date_submitted": "2017-09-15 07:09:48",
	"date_testing": "2017-09-16 03:28:01",
	"meets_testing_requirements": true,
	"notes": "This new package includes additional fixes for CVE-2017-9228 .",
	"pushed": true,
	"release": {
		"branch": "f25",
		"candidate_tag": "f25-updates-candidate",
		"composed_by_bodhi": true,
		"dist_tag": "f25",
		"id_prefix": "FEDORA",
		"long_name": "Fedora 25",
		"mail_template": "fedora_errata_template",
		"name": "F25",
		"override_tag": "f25-override",
		"package_manager": "dnf",
		"pending_signing_tag": "f25-signing-pending",
		"pending_stable_tag": "f25-updates-pending",
		"pending_testing_tag": "f25-updates-testing-pending",
		"stable_tag": "f25-updates",
		"state": "archived",
		"testing_repository": "updates-testing",
		"testing_tag": "f25-updates-testing",
		"version": "25"
	},
	"require_bugs": true,
	"require_testcases": true,
	"severity": "unspecified",
	"stable_karma": 2,
	"status": "stable",
	"suggest": "unspecified",
	"title": "oniguruma-6.1.3-3.fc25",
	"type": "security",
	"url": "https://bodhi.fedoraproject.org/updates/FEDORA-2017-e314044789",
	"unstable_karma": -30,
	"updateid": "FEDORA-2017-e314044789",
	"user": {
		"avatar": "https://seccdn.libravatar.org/avatar/1bde75495a81d910b3a931eff5b35c45f7a0ce64f32cd3774cff20dbb6a556ce?s=24&d=retro",
		"email": "mtasaka@tbz.t-com.ne.jp",
		"groups": [
			{
				"name": "packager"
			},
			{
				"name": "provenpackager"
			},
			{
				"name": "ipausers"
			},
			{
				"name": "fedora-contributor"
			},
			{
				"name": "signed_fpca"
			},
			{
				"name": "fedorabugs"
			},
			{
				"name": "trust admins"
			}
		],
		"id": 152,
		"name": "mtasaka",
		"openid": "mtasaka.id.fedoraproject.org"
	},
	"version_hash": "da19fc037008b6d0b3a64a394ce21a90723c8114"
}
