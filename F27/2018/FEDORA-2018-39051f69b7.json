{
	"alias": "FEDORA-2018-39051f69b7",
	"autokarma": true,
	"bugs": [
		{
			"bug_id": 1509469,
			"security": true,
			"title": "freeipa: ipa: Incorret behavior of Two factor authentication for Authn/TOTP defined users [fedora-all]",
			"bugzilla": {
				"bug_id": "1509469",
				"creation_ts": "2017-11-03 20:59:46 +0000",
				"short_desc": "freeipa: ipa: Incorret behavior of Two factor authentication for Authn/TOTP defined users [fedora-all]",
				"delta_ts": "2019-05-02 21:42:34 +0000",
				"bug_status": "CLOSED",
				"resolution": "CURRENTRELEASE",
				"keywords": "Reopened, Security, SecurityTracking",
				"priority": "medium",
				"bug_severity": "medium",
				"blocked": [
					{
						"bug_id": "1509468",
						"creation_ts": "2017-11-03 20:59:19 +0000",
						"short_desc": "ipa: Incorrect behavior of Two factor authentication for Authn/TOTP defined users",
						"delta_ts": "2021-05-24 08:07:25 +0000",
						"bug_status": "CLOSED",
						"resolution": "NOTABUG",
						"keywords": "Security",
						"priority": "medium",
						"bug_severity": "medium",
						"depends_on": [
							"1509469"
						],
						"blocked": [
							{
								"bug_id": "1509470",
								"error": "NotPermitted"
							}
						],
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "10953279",
								"comment_count": "0",
								"who": {
									"text": "psampaio",
									"name": "Pedro Sampaio"
								},
								"bug_when": "2017-11-03 20:59:19 +0000",
								"thetext": "A flaw was found in ipa where the two-factor authentication is not properly enforced for Authn/TOTP defined users.\n\nReference(s):\n\nhttps://bugzilla.redhat.com/show_bug.cgi?id=1508498\n\nUpstream bug:\n\nhttps://pagure.io/freeipa/issue/7262"
							},
							{
								"isprivate": "0",
								"commentid": "10953283",
								"comment_count": "1",
								"who": {
									"text": "psampaio",
									"name": "Pedro Sampaio"
								},
								"bug_when": "2017-11-03 20:59:58 +0000",
								"thetext": "Created freeipa tracking bugs for this issue:\n\nAffects: fedora-all [bug 1509469]"
							},
							{
								"isprivate": "0",
								"commentid": "15094244",
								"comment_count": "2",
								"who": {
									"text": "cbuissar",
									"name": "Cedric Buissart"
								},
								"bug_when": "2021-05-24 08:07:25 +0000",
								"thetext": "Not considered a security flaw : \nFrom the description, if an user is hammering too much against ipa-otpd, it may crash. This forces users to re-authenticate (using their password only, not 2nd factor).\n\nStatus:\nUpstream fixes for master : \nhttps://pagure.io/freeipa/c/a2e8d98\nhttps://pagure.io/freeipa/c/fe65008\nhttps://pagure.io/freeipa/c/ab63668 (tests only)\n\nfixed in : \n- freeipa 4.5 latest (not tagged release)\n- freeipa 4.6.5\n- freeipa 4.7.1\n- freeipa 4.8.0\n\nAll versions of freeipa shipped in RHEL-8 and latest version of RHEL-7 are fixed."
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "10953280",
						"comment_count": "0",
						"who": {
							"text": "psampaio",
							"name": "Pedro Sampaio"
						},
						"bug_when": "2017-11-03 20:59:46 +0000",
						"thetext": "\nThis is an automatically created tracking bug!  It was created to ensure\nthat one or more security vulnerabilities are fixed in affected versions\nof fedora-all.\n\nFor comments that are specific to the vulnerability please use bugs filed\nagainst the \"Security Response\" product referenced in the \"Blocks\" field.\n\nFor more information see:\nhttp://fedoraproject.org/wiki/Security/TrackingBugs\n\nWhen submitting as an update, use the fedpkg template provided in the next\ncomment(s).  This will include the bug IDs of this tracking bug as well as\nthe relevant top-level CVE bugs.\n\nPlease also mention the CVE IDs being fixed in the RPM changelog and the\nfedpkg commit message.\n\nNOTE: this issue affects multiple supported versions of Fedora. While only\none tracking bug has been filed, please correct all affected versions at\nthe same time.  If you need to fix the versions independent of each other,\nyou may clone this bug as appropriate."
					},
					{
						"isprivate": "0",
						"commentid": "10953281",
						"comment_count": "1",
						"who": {
							"text": "psampaio",
							"name": "Pedro Sampaio"
						},
						"bug_when": "2017-11-03 20:59:54 +0000",
						"thetext": "Use the following template to for the 'fedpkg update' request to submit an\nupdate for this issue as it contains the top-level parent bug(s) as well as\nthis tracking bug.  This will ensure that all associated bugs get updated\nwhen new packages are pushed to stable.\n\n=====\n\n# bugfix, security, enhancement, newpackage (required)\ntype=security\n\n# testing, stable\nrequest=testing\n\n# Bug numbers: 1234,9876\nbugs=1509468,1509469\n\n# Description of your update\nnotes=Security fix for [PUT CVEs HERE]\n\n# Enable request automation based on the stable/unstable karma thresholds\nautokarma=True\nstable_karma=3\nunstable_karma=-3\n\n# Automatically close bugs when this marked as stable\nclose_bugs=True\n\n# Suggest that users restart after update\nsuggest_reboot=False\n\n======\n\nAdditionally, you may opt to use the bodhi web interface to submit updates:\n\nhttps://bodhi.fedoraproject.org/updates/new"
					},
					{
						"isprivate": "0",
						"commentid": "11185147",
						"comment_count": "2",
						"who": {
							"text": "rcritten",
							"name": "Rob Crittenden"
						},
						"bug_when": "2018-01-15 16:58:13 +0000",
						"thetext": "Upstream ticket:\nhttps://pagure.io/freeipa/issue/7262"
					},
					{
						"isprivate": "0",
						"commentid": "11554730",
						"comment_count": "3",
						"who": {
							"text": "bcotton",
							"name": "Fedora End Of Life"
						},
						"bug_when": "2018-05-03 08:24:53 +0000",
						"thetext": "This message is a reminder that Fedora 26 is nearing its end of life.\nApproximately 4 (four) weeks from now Fedora will stop maintaining\nand issuing updates for Fedora 26. It is Fedora's policy to close all\nbug reports from releases that are no longer maintained. At that time\nthis bug will be closed as EOL if it remains open with a Fedora  'version'\nof '26'.\n\nPackage Maintainer: If you wish for this bug to remain open because you\nplan to fix it in a currently maintained version, simply change the 'version'\nto a later Fedora version.\n\nThank you for reporting this issue and we are sorry that we were not\nable to fix it before Fedora 26 is end of life. If you would still like\nto see this bug fixed and are able to reproduce it against a later version\nof Fedora, you are encouraged  change the 'version' to a later Fedora\nversion prior this bug is closed as described in the policy above.\n\nAlthough we aim to fix as many bugs as possible during every release's\nlifetime, sometimes those efforts are overtaken by events. Often a\nmore recent Fedora release includes newer upstream software that fixes\nbugs or makes them obsolete."
					},
					{
						"isprivate": "0",
						"commentid": "11652080",
						"comment_count": "4",
						"who": {
							"text": "jkurik",
							"name": "Jan Kurik"
						},
						"bug_when": "2018-05-29 17:16:23 +0000",
						"thetext": "Fedora 26 changed to end-of-life (EOL) status on 2018-05-29. Fedora 26\nis no longer maintained, which means that it will not receive any\nfurther security or bug fix updates. As a result we are closing this bug.\n\nIf you can reproduce this bug against a currently maintained version of\nFedora please feel free to reopen this bug against that version. If you\nare unable to reopen this bug, please file a new report against the\ncurrent release. If you experience problems, please add a comment to this\nbug.\n\nThank you for reporting this bug and we are sorry it could not be fixed."
					},
					{
						"isprivate": "0",
						"commentid": "11718091",
						"comment_count": "5",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-06-19 12:32:03 +0000",
						"thetext": "freeipa-4.6.4-1.fc27 has been submitted as an update to Fedora 27. https://bodhi.fedoraproject.org/updates/FEDORA-2018-0492828909"
					},
					{
						"isprivate": "0",
						"commentid": "11929912",
						"comment_count": "6",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-08-20 08:56:29 +0000",
						"thetext": "freeipa-4.6.4-2.fc27 has been submitted as an update to Fedora 27. https://bodhi.fedoraproject.org/updates/FEDORA-2018-39051f69b7"
					},
					{
						"isprivate": "0",
						"commentid": "11932034",
						"comment_count": "7",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-08-20 15:50:35 +0000",
						"thetext": "freeipa-4.6.4-2.fc27 has been pushed to the Fedora 27 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2018-39051f69b7"
					},
					{
						"isprivate": "0",
						"commentid": "11959740",
						"comment_count": "8",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-08-28 11:55:21 +0000",
						"thetext": "freeipa-4.6.4-2.fc27 has been pushed to the Fedora 27 stable repository. If problems still persist, please make note of it in this bug report."
					},
					{
						"isprivate": "0",
						"commentid": "11982403",
						"comment_count": "9",
						"who": {
							"text": "frenaud",
							"name": "Florence Blanc-Renaud"
						},
						"bug_when": "2018-09-04 13:40:14 +0000",
						"thetext": "Moving back to post as an additional fix is needed, see BZ 1622168"
					},
					{
						"isprivate": "0",
						"commentid": "11983210",
						"comment_count": "10",
						"who": {
							"text": "frenaud",
							"name": "Florence Blanc-Renaud"
						},
						"bug_when": "2018-09-04 15:00:15 +0000",
						"thetext": "Fixed upstream\nmaster:\nhttps://pagure.io/freeipa/c/fe650087b0dd35b3dd23347e98647fdc526614f8\nhttps://pagure.io/freeipa/c/ab636682c4a0274d411c702ca62a6d26ab8b7869\n\nipa-4-5:\nhttps://pagure.io/freeipa/c/b2d4d7a23f4288ed5f840626bb090c57c66950fa\nhttps://pagure.io/freeipa/c/84883e41ad09cb32f3af9d88db5aad2682877494\n\nipa-4-6:\nhttps://pagure.io/freeipa/c/b0b37d4ed92585f980443ad8dcbee29c38ac3bc9\nhttps://pagure.io/freeipa/c/d0b23ec375db02090abb2a5ff5a83d5ff756b871\n\nipa-4-7:\nhttps://pagure.io/freeipa/c/2dae9e28b3b508f43af293ae8602f9208ed3c4e0\nhttps://pagure.io/freeipa/c/56ec7c8c2cca40c71b7129ab07aa5bac64239133"
					},
					{
						"isprivate": "0",
						"commentid": "12241954",
						"comment_count": "11",
						"who": {
							"text": "bcotton",
							"name": "Ben Cotton"
						},
						"bug_when": "2018-11-27 14:42:12 +0000",
						"thetext": "This message is a reminder that Fedora 27 is nearing its end of life.\nOn 2018-Nov-30  Fedora will stop maintaining and issuing updates for\nFedora 27. It is Fedora's policy to close all bug reports from releases\nthat are no longer maintained. At that time this bug will be closed as\nEOL if it remains open with a Fedora  'version' of '27'.\n\nPackage Maintainer: If you wish for this bug to remain open because you\nplan to fix it in a currently maintained version, simply change the 'version' \nto a later Fedora version.\n\nThank you for reporting this issue and we are sorry that we were not \nable to fix it before Fedora 27 is end of life. If you would still like \nto see this bug fixed and are able to reproduce it against a later version \nof Fedora, you are encouraged  change the 'version' to a later Fedora \nversion prior this bug is closed as described in the policy above.\n\nAlthough we aim to fix as many bugs as possible during every release's \nlifetime, sometimes those efforts are overtaken by events. Often a \nmore recent Fedora release includes newer upstream software that fixes \nbugs or makes them obsolete."
					}
				]
			}
		},
		{
			"bug_id": 1550555,
			"title": "freeipa 4.6.1->4.6.3 upgrade breaks in ipa-server-upgrade: No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'",
			"bugzilla": {
				"bug_id": "1550555",
				"creation_ts": "2018-03-01 12:51:57 +0000",
				"short_desc": "freeipa 4.6.1->4.6.3 upgrade breaks in ipa-server-upgrade: No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'",
				"delta_ts": "2018-08-28 11:55:11 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"keywords": "Reopened",
				"priority": "unspecified",
				"bug_severity": "urgent",
				"blocked": [
					{
						"bug_id": "1577805",
						"creation_ts": "2018-05-14 07:37:30 +0000",
						"short_desc": "4.5.0 -> 4.5.4 upgrade breaks in ipa-server-upgrade: No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'",
						"delta_ts": "2018-10-30 10:59:54 +0000",
						"bug_status": "CLOSED",
						"resolution": "ERRATA",
						"keywords": "Reopened, ZStream",
						"priority": "urgent",
						"bug_severity": "urgent",
						"depends_on": [
							"1550555"
						],
						"blocked": [
							{
								"bug_id": "1579203",
								"creation_ts": "2018-05-17 07:22:54 +0000",
								"short_desc": "4.5.0 -> 4.5.4 upgrade breaks in ipa-server-upgrade: No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg' [rhel-7.5.z]",
								"delta_ts": "2018-06-26 16:49:20 +0000",
								"bug_status": "CLOSED",
								"resolution": "ERRATA",
								"keywords": "Reopened, ZStream",
								"priority": "urgent",
								"bug_severity": "urgent",
								"depends_on": [
									"1577805"
								],
								"external_bugs": {
									"text": "RHBA-2018:1985",
									"name": "Red Hat Product Errata"
								},
								"long_desc": [
									{
										"isprivate": "0",
										"commentid": "11607254",
										"comment_count": "0",
										"who": {
											"text": "toneata",
											"name": "Oneata Mircea Teodor"
										},
										"bug_when": "2018-05-17 07:22:54 +0000",
										"thetext": "This bug has been copied from bug #1577805 and has been proposed to be backported to 7.5 z-stream (EUS)."
									},
									{
										"isprivate": "0",
										"commentid": "11640400",
										"comment_count": "3",
										"who": {
											"text": "amore",
											"name": "anuja"
										},
										"bug_when": "2018-05-28 09:30:06 +0000",
										"thetext": "Verified using version :\nipa-server-4.5.4-10.el7.x86_64\nSteps :\n1: Install CA-less ipa-server on 4.5.4-10.el7.x86_64\n2: Upgrade to ipa-server-4.5.4-10.el7_5.2.x86_64\n3: tail /var/log/ipaupgrade.log\n\nAdditional info:\nAVC errors are observed :\nhttps://bugzilla.redhat.com/show_bug.cgi?id=1553256"
									},
									{
										"isprivate": "0",
										"commentid": "11640438",
										"comment_count": "5",
										"who": {
											"text": "amore",
											"name": "anuja"
										},
										"bug_when": "2018-05-28 09:35:08 +0000",
										"thetext": "Verified using path:\n\n7.5 GA(0-day) -> 7.5.2\n7.4.z -> 7.5.2\n7.5.1 -> 7.5.2\n\nNo errors were observed"
									},
									{
										"isprivate": "0",
										"commentid": "11742493",
										"comment_count": "11",
										"who": {
											"text": "errata-xmlrpc",
											"name": "errata-xmlrpc"
										},
										"bug_when": "2018-06-26 16:49:05 +0000",
										"thetext": "Since the problem described in this bug report should be\nresolved in a recent advisory, it has been closed with a\nresolution of ERRATA.\n\nFor information on the advisory, and where to find the updated\nfiles, follow the link below.\n\nIf the solution does not work for you, open a new bug report.\n\nhttps://access.redhat.com/errata/RHBA-2018:1985"
									}
								]
							}
						],
						"external_bugs": {
							"text": "RHBA-2018:3187",
							"name": "Red Hat Product Errata"
						},
						"long_desc": [
							{
								"isprivate": "0",
								"commentid": "11591678",
								"comment_count": "0",
								"who": {
									"text": "abokovoy",
									"name": "Alexander Bokovoy"
								},
								"bug_when": "2018-05-14 07:37:30 +0000",
								"thetext": "This is a clone of Fedora 27 bug but we are getting the same error from CentOS 7.5 users too.\n\nipa-server-upgrade fails with \"Upgrade failed with [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\"\n\nCA-less + Let's Encrypt certificate actually\n\n\n+++ This bug was initially created as a clone of Bug #1550555 +++\n\nDescription of problem:\nUpgrading from FreeIPA 4.6.1 to 4.6.3, on F27. This installation with external CA. ipa-server-upgrade fails at:\n\nipaserver.install.ipa_server_upgrade: ERROR: IPA server upgrade failed: Inspect /var/log/ipaupgrade.log and run command ipa-server-upgrade manually.\nipapython.admintool: DEBUG:   File \"/usr/lib/python3.6/site-packages/ipapython/admintool.py\", line 174, in execute\n    return_value = self.run()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/ipa_server_upgrade.py\", line 50, in run\n    server.upgrade()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/server/upgrade.py\", line 1999, in upgrade\n    upgrade_configuration()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/server/upgrade.py\", line 1686, in upgrade_configuration\n    ca.backup_config()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/dogtaginstance.py\", line 475, in backup_config\n    shutil.copy(path, path + '.ipabkp')\n  File \"/usr/lib64/python3.6/shutil.py\", line 241, in copy\n    copyfile(src, dst, follow_symlinks=follow_symlinks)\n  File \"/usr/lib64/python3.6/shutil.py\", line 120, in copyfile\n    with open(src, 'rb') as fsrc:\n\nipapython.admintool: DEBUG: The ipa-server-upgrade command failed, exception: FileNotFoundError: [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\nipapython.admintool: ERROR: [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\nipapython.admintool: ERROR: The ipa-server-upgrade command failed. See /var/log/ipaupgrade.log for more information\n\n--- Additional comment from James Ettle on 2018-03-01 15:05:36 EET ---\n\nHad to roll back to 4.6.1, now back in action. So at least ipa-server-upgrade didn't hose the database...\n\n--- Additional comment from Florence Blanc-Renaud on 2018-03-01 19:17:24 EET ---\n\nUpstream ticket:\nhttps://pagure.io/freeipa/issue/7409\n\n--- Additional comment from Florence Blanc-Renaud on 2018-03-07 14:49:45 EET ---\n\nFixed upstream\nmaster:\nhttps://pagure.io/freeipa/c/95a45a2b0942a9ac38d5418b23821f7da1ce28a3\nipa-4-6:\nhttps://pagure.io/freeipa/c/f24a3aeb1f39a790b61bd362718cb2fd16cf9f43\n\n--- Additional comment from James Ettle on 2018-03-07 21:22:25 EET ---\n\nHold on, hold on. What do I have to do to test this without risking a broken database and having to start all over again?\n\n--- Additional comment from Rob Crittenden on 2018-03-07 23:57:04 EET ---\n\nJust update to the fixed packages and that should do it.\n\nEven if the upgrade failed it wouldn't corrupt the database.\n\n--- Additional comment from James Ettle on 2018-03-08 00:08:05 EET ---\n\nReopening. This is not fixed. Downgrading again.\n\n# rpm -q freeipa-server\nfreeipa-server-4.6.3-2.fc27.x86_64\n\n# systemctl status ipa\n● ipa.service - Identity, Policy, Audit\n   Loaded: loaded (/usr/lib/systemd/system/ipa.service; enabled; vendor preset: disabled)\n   Active: failed (Result: exit-code) since Wed 2018-03-07 22:06:01 GMT; 39s ago\n  Process: 20965 ExecStart=/usr/sbin/ipactl start (code=exited, status=1/FAILURE)\n Main PID: 20965 (code=exited, status=1/FAILURE)\n\nMar 07 22:06:00 skipper.cb.ettle ipactl[20965]: [Verifying that root certificate is published]\nMar 07 22:06:00 skipper.cb.ettle ipactl[20965]: IPA server upgrade failed: Inspect /var/log/ipaupgrade.log and run command ipa-serve\nMar 07 22:06:00 skipper.cb.ettle ipactl[20965]: [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\nMar 07 22:06:00 skipper.cb.ettle ipactl[20965]: The ipa-server-upgrade command failed. See /var/log/ipaupgrade.log for more informat\nMar 07 22:06:00 skipper.cb.ettle ipactl[20965]: See the upgrade log for more details and/or run /usr/sbin/ipa-server-upgrade again\nMar 07 22:06:00 skipper.cb.ettle ipactl[20965]: Aborting ipactl\nMar 07 22:06:01 skipper.cb.ettle systemd[1]: ipa.service: Main process exited, code=exited, status=1/FAILURE\nMar 07 22:06:01 skipper.cb.ettle systemd[1]: Failed to start Identity, Policy, Audit.\nMar 07 22:06:01 skipper.cb.ettle systemd[1]: ipa.service: Unit entered failed state.\nMar 07 22:06:01 skipper.cb.ettle systemd[1]: ipa.service: Failed with result 'exit-code'.\n\n\nEnd of /var/log/ipaupgrade.log:\n\n\n2018-03-07T22:06:00Z ERROR IPA server upgrade failed: Inspect /var/log/ipaupgrade.log and run command ipa-server-upgrade manually.\n2018-03-07T22:06:00Z DEBUG   File \"/usr/lib/python3.6/site-packages/ipapython/admintool.py\", line 174, in execute\n    return_value = self.run()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/ipa_server_upgrade.py\", line 50, in run\n    server.upgrade()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/server/upgrade.py\", line 1999, in upgrade\n    upgrade_configuration()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/server/upgrade.py\", line 1686, in upgrade_configuration\n    ca.backup_config()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/dogtaginstance.py\", line 475, in backup_config\n    shutil.copy(path, path + '.ipabkp')\n  File \"/usr/lib64/python3.6/shutil.py\", line 241, in copy\n    copyfile(src, dst, follow_symlinks=follow_symlinks)\n  File \"/usr/lib64/python3.6/shutil.py\", line 120, in copyfile\n    with open(src, 'rb') as fsrc:\n\n2018-03-07T22:06:00Z DEBUG The ipa-server-upgrade command failed, exception: FileNotFoundError: [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\n2018-03-07T22:06:00Z ERROR [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\n2018-03-07T22:06:00Z ERROR The ipa-server-upgrade command failed. See /var/log/ipaupgrade.log for more information\n\n--- Additional comment from James Ettle on 2018-03-09 01:06:00 EET ---\n\nLooking at the SRPM those commits from Comment 3 simply aren't in 4.6.3-2 (ipaserver/install/server/upgrade.py). Patch0001 only deals with KRA-related stuff, but seems to be matching against code from that commit...\n\n--- Additional comment from Rob Crittenden on 2018-03-12 20:52:25 EET ---\n\nYou're right, I missed a patch. There were two issues, one hiding the other. I'll spin up a new build.\n\n--- Additional comment from Fedora Update System on 2018-03-13 16:15:06 EET ---\n\nfreeipa-4.6.3-3.fc27 has been submitted as an update to Fedora 27. https://bodhi.fedoraproject.org/updates/FEDORA-2018-0a4399f314\n\n--- Additional comment from James Ettle on 2018-03-13 21:19:12 EET ---\n\nOK - 4.6.3-3.fc27.x86_64 updated cleanly. Server rebooted, confirmed login with OTP, NFS and web interface work. Thanks, Rob!\n\n--- Additional comment from Fedora Update System on 2018-03-14 03:39:18 EET ---\n\nfreeipa-4.6.3-3.fc27 has been pushed to the Fedora 27 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2018-0a4399f314"
							},
							{
								"isprivate": "0",
								"commentid": "11597802",
								"comment_count": "4",
								"who": {
									"text": "frenaud",
									"name": "Florence Blanc-Renaud"
								},
								"bug_when": "2018-05-15 07:13:09 +0000",
								"thetext": "Hi,\n\nI don't think this is the same issue as Bug #1550555 because the problem happens at a different moment.\nFollowing a discussion on IRC with joko, he provided the following logs:\n\n--------------------\n2018-05-14T19:53:07Z DEBUG Executing upgrade plugin: update_ca_renewal_master\n2018-05-14T19:53:07Z DEBUG raw: update_ca_renewal_master\n2018-05-14T19:53:07Z DEBUG Loading StateFile from '/var/lib/ipa/sysrestore/sysrestore.state'\n2018-05-14T19:53:07Z DEBUG Loading Index file from '/var/lib/ipa/sysrestore/sysrestore.index'\n2018-05-14T19:53:07Z DEBUG certmonger request for RA cert not found\n2018-05-14T19:53:07Z DEBUG Destroyed connection context.ldap2_140692280089040\n2018-05-14T19:53:07Z ERROR Upgrade failed with [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\n2018-05-14T19:53:07Z DEBUG Traceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/ipaserver/install/upgradeinstance.py\", line 220, in __upgrade\n    self.modified = (ld.update(self.files) or self.modified)\n  File \"/usr/lib/python2.7/site-packages/ipaserver/install/ldapupdate.py\", line 911, in update\n    self._run_updates(all_updates)\n  File \"/usr/lib/python2.7/site-packages/ipaserver/install/ldapupdate.py\", line 883, in _run_updates\n    self._run_update_plugin(update['plugin'])\n  File \"/usr/lib/python2.7/site-packages/ipaserver/install/ldapupdate.py\", line 859, in _run_update_plugin\n    restart_ds, updates = self.api.Updater[plugin_name]()\n  File \"/usr/lib/python2.7/site-packages/ipalib/frontend.py\", line 1470, in __call__\n    return self.execute(**options)\n  File \"/usr/lib/python2.7/site-packages/ipaserver/install/plugins/ca_renewal_master.py\", line 106, in execute\n    paths.CA_CS_CFG_PATH, 'subsystem.select', '=')\n  File \"/usr/lib/python2.7/site-packages/ipaserver/install/installutils.py\", line 578, in get_directive\n    fd = open(filename, \"r\")\nIOError: [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\n\n2018-05-14T19:53:07Z DEBUG Traceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/ipaserver/install/service.py\", line 504, in start_creation\n    run_step(full_msg, method)\n  File \"/usr/lib/python2.7/site-packages/ipaserver/install/service.py\", line 494, in run_step\n    method()\n  File \"/usr/lib/python2.7/site-packages/ipaserver/install/upgradeinstance.py\", line 228, in __upgrade\n    raise RuntimeError(e)\nRuntimeError: [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\n\n2018-05-14T19:53:07Z DEBUG   [error] RuntimeError: [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\n2018-05-14T19:53:07Z DEBUG   [cleanup]: stopping directory server\n2018-05-14T19:53:07Z DEBUG Destroyed connection context.ldap2_140692311895056\n2018-05-14T19:53:07Z DEBUG Starting external process\n2018-05-14T19:53:07Z DEBUG args=/bin/systemctl stop dirsrv@MICROLAB-NTUA-GR.service\n2018-05-14T19:53:08Z DEBUG Process finished, return code=0\n2018-05-14T19:53:08Z DEBUG stdout=\n2018-05-14T19:53:08Z DEBUG stderr=\n2018-05-14T19:53:08Z DEBUG   duration: 1 seconds\n2018-05-14T19:53:08Z DEBUG   [cleanup]: restoring configuration\n2018-05-14T19:53:08Z DEBUG Loading StateFile from '/var/lib/ipa/sysrestore/sysrestore.state'\n2018-05-14T19:53:08Z DEBUG Loading StateFile from '/var/lib/ipa/sysrestore/sysrestore.state'\n2018-05-14T19:53:08Z DEBUG Saving StateFile to '/var/lib/ipa/sysrestore/sysrestore.state'\n2018-05-14T19:53:08Z DEBUG Loading StateFile from '/var/lib/ipa/sysrestore/sysrestore.state'\n2018-05-14T19:53:08Z DEBUG Loading StateFile from '/var/lib/ipa/sysrestore/sysrestore.state'\n2018-05-14T19:53:08Z DEBUG Saving StateFile to '/var/lib/ipa/sysrestore/sysrestore.state'\n2018-05-14T19:53:08Z DEBUG Loading StateFile from '/var/lib/ipa/sysrestore/sysrestore.state'\n2018-05-14T19:53:08Z DEBUG   duration: 0 seconds\n2018-05-14T19:53:08Z ERROR IPA server upgrade failed: Inspect /var/log/ipaupgrade.log and run command ipa-server-upgrade manually.\n2018-05-14T19:53:08Z DEBUG   File \"/usr/lib/python2.7/site-packages/ipapython/admintool.py\", line 172, in execute\n    return_value = self.run()\n  File \"/usr/lib/python2.7/site-packages/ipaserver/install/ipa_server_upgrade.py\", line 48, in run\n    raise admintool.ScriptError(str(e))\n\n2018-05-14T19:53:08Z DEBUG The ipa-server-upgrade command failed, exception: ScriptError: ('IPA upgrade failed.', 1)\n2018-05-14T19:53:08Z ERROR ('IPA upgrade failed.', 1)\n2018-05-14T19:53:08Z ERROR The ipa-server-upgrade command failed. See /var/log/ipaupgrade.log for more information\n\n----------\n\nIt looks like the upgrade plugin update_ca_renewal_master is executed even though there is no CA installed. One of the first steps of the plugin is to check if ca.is_configured(), which is equivalent to looking for a [pki-tomcatd] section in /var/lib/ipa/sysrestore/sysrestore.state. The plugin should be skipped when the CA is not configured, but the logs show that it gets executed.\n\nI asked the user to provide the sysrestore.state content, we'll be able to know more when we have this information available. Note: the logs confirm he's using IPA version 4.5.4-10.el7.centos."
							},
							{
								"isprivate": "0",
								"commentid": "11598602",
								"comment_count": "5",
								"who": {
									"text": "frenaud",
									"name": "Florence Blanc-Renaud"
								},
								"bug_when": "2018-05-15 11:32:41 +0000",
								"thetext": "sysrestore.state contains\n[pki-tomcatd]\ninstalled = true\n\nwhich means that the CA was installed on the host. It's probable that CA installation went wrong (or some files were manually deleted) and this is a different issue from 1550555.\n\nAfter discussion with ab, we agreed to backport the fix for 1550555 to 4.5 anyway because the upgrade would show a WARNING that may be misleading."
							},
							{
								"isprivate": "0",
								"commentid": "11599569",
								"comment_count": "7",
								"who": {
									"text": "frenaud",
									"name": "Florence Blanc-Renaud"
								},
								"bug_when": "2018-05-15 15:12:46 +0000",
								"thetext": "Fixed upstream\nipa-4-5:\nhttps://pagure.io/freeipa/c/035f1cb24a228ba40b3e124d78a507be22aa52bd"
							},
							{
								"isprivate": "0",
								"commentid": "11809809",
								"comment_count": "12",
								"who": {
									"text": "ndehadra",
									"name": "Nikhil Dehadrai"
								},
								"bug_when": "2018-07-19 07:14:25 +0000",
								"thetext": "IPA version :\nipa-server-4.6.4-2.el7.x86_64\n\nVerified the bug using following steps:\n1: Install CA-less ipa-server.\n2: Upgrade to RHEL 7.6. \n3: tail /var/log/ipaupgrade.log, no errors mentioned in the bug are observed.\n\nTested for following paths:\n1. RHEL 75z > 7.6\n2. RHEL 75-0day > 7.6\n3. RHEL 74z > 7.6\n\n\nThus on the basis of above observations marking the status of bug to 'VERIFIED'."
							},
							{
								"isprivate": "0",
								"commentid": "12157404",
								"comment_count": "15",
								"who": {
									"text": "errata-xmlrpc",
									"name": "errata-xmlrpc"
								},
								"bug_when": "2018-10-30 10:58:39 +0000",
								"thetext": "Since the problem described in this bug report should be\nresolved in a recent advisory, it has been closed with a\nresolution of ERRATA.\n\nFor information on the advisory, and where to find the updated\nfiles, follow the link below.\n\nIf the solution does not work for you, open a new bug report.\n\nhttps://access.redhat.com/errata/RHBA-2018:3187"
							}
						]
					}
				],
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "11337611",
						"comment_count": "0",
						"who": {
							"text": "james",
							"name": "James"
						},
						"bug_when": "2018-03-01 12:51:57 +0000",
						"thetext": "Description of problem:\nUpgrading from FreeIPA 4.6.1 to 4.6.3, on F27. This installation with external CA. ipa-server-upgrade fails at:\n\nipaserver.install.ipa_server_upgrade: ERROR: IPA server upgrade failed: Inspect /var/log/ipaupgrade.log and run command ipa-server-upgrade manually.\nipapython.admintool: DEBUG:   File \"/usr/lib/python3.6/site-packages/ipapython/admintool.py\", line 174, in execute\n    return_value = self.run()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/ipa_server_upgrade.py\", line 50, in run\n    server.upgrade()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/server/upgrade.py\", line 1999, in upgrade\n    upgrade_configuration()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/server/upgrade.py\", line 1686, in upgrade_configuration\n    ca.backup_config()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/dogtaginstance.py\", line 475, in backup_config\n    shutil.copy(path, path + '.ipabkp')\n  File \"/usr/lib64/python3.6/shutil.py\", line 241, in copy\n    copyfile(src, dst, follow_symlinks=follow_symlinks)\n  File \"/usr/lib64/python3.6/shutil.py\", line 120, in copyfile\n    with open(src, 'rb') as fsrc:\n\nipapython.admintool: DEBUG: The ipa-server-upgrade command failed, exception: FileNotFoundError: [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\nipapython.admintool: ERROR: [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\nipapython.admintool: ERROR: The ipa-server-upgrade command failed. See /var/log/ipaupgrade.log for more information"
					},
					{
						"isprivate": "0",
						"commentid": "11337686",
						"comment_count": "1",
						"who": {
							"text": "james",
							"name": "James"
						},
						"bug_when": "2018-03-01 13:05:36 +0000",
						"thetext": "Had to roll back to 4.6.1, now back in action. So at least ipa-server-upgrade didn't hose the database..."
					},
					{
						"isprivate": "0",
						"commentid": "11339152",
						"comment_count": "2",
						"who": {
							"text": "frenaud",
							"name": "Florence Blanc-Renaud"
						},
						"bug_when": "2018-03-01 17:17:24 +0000",
						"thetext": "Upstream ticket:\nhttps://pagure.io/freeipa/issue/7409"
					},
					{
						"isprivate": "0",
						"commentid": "11356059",
						"comment_count": "3",
						"who": {
							"text": "frenaud",
							"name": "Florence Blanc-Renaud"
						},
						"bug_when": "2018-03-07 12:49:45 +0000",
						"thetext": "Fixed upstream\nmaster:\nhttps://pagure.io/freeipa/c/95a45a2b0942a9ac38d5418b23821f7da1ce28a3\nipa-4-6:\nhttps://pagure.io/freeipa/c/f24a3aeb1f39a790b61bd362718cb2fd16cf9f43"
					},
					{
						"isprivate": "0",
						"commentid": "11357980",
						"comment_count": "4",
						"who": {
							"text": "james",
							"name": "James"
						},
						"bug_when": "2018-03-07 19:22:25 +0000",
						"thetext": "Hold on, hold on. What do I have to do to test this without risking a broken database and having to start all over again?"
					},
					{
						"isprivate": "0",
						"commentid": "11358487",
						"comment_count": "5",
						"who": {
							"text": "rcritten",
							"name": "Rob Crittenden"
						},
						"bug_when": "2018-03-07 21:57:04 +0000",
						"thetext": "Just update to the fixed packages and that should do it.\n\nEven if the upgrade failed it wouldn't corrupt the database."
					},
					{
						"isprivate": "0",
						"commentid": "11358512",
						"comment_count": "6",
						"who": {
							"text": "james",
							"name": "James"
						},
						"bug_when": "2018-03-07 22:08:05 +0000",
						"thetext": "Reopening. This is not fixed. Downgrading again.\n\n# rpm -q freeipa-server\nfreeipa-server-4.6.3-2.fc27.x86_64\n\n# systemctl status ipa\n● ipa.service - Identity, Policy, Audit\n   Loaded: loaded (/usr/lib/systemd/system/ipa.service; enabled; vendor preset: disabled)\n   Active: failed (Result: exit-code) since Wed 2018-03-07 22:06:01 GMT; 39s ago\n  Process: 20965 ExecStart=/usr/sbin/ipactl start (code=exited, status=1/FAILURE)\n Main PID: 20965 (code=exited, status=1/FAILURE)\n\nMar 07 22:06:00 skipper.cb.ettle ipactl[20965]: [Verifying that root certificate is published]\nMar 07 22:06:00 skipper.cb.ettle ipactl[20965]: IPA server upgrade failed: Inspect /var/log/ipaupgrade.log and run command ipa-serve\nMar 07 22:06:00 skipper.cb.ettle ipactl[20965]: [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\nMar 07 22:06:00 skipper.cb.ettle ipactl[20965]: The ipa-server-upgrade command failed. See /var/log/ipaupgrade.log for more informat\nMar 07 22:06:00 skipper.cb.ettle ipactl[20965]: See the upgrade log for more details and/or run /usr/sbin/ipa-server-upgrade again\nMar 07 22:06:00 skipper.cb.ettle ipactl[20965]: Aborting ipactl\nMar 07 22:06:01 skipper.cb.ettle systemd[1]: ipa.service: Main process exited, code=exited, status=1/FAILURE\nMar 07 22:06:01 skipper.cb.ettle systemd[1]: Failed to start Identity, Policy, Audit.\nMar 07 22:06:01 skipper.cb.ettle systemd[1]: ipa.service: Unit entered failed state.\nMar 07 22:06:01 skipper.cb.ettle systemd[1]: ipa.service: Failed with result 'exit-code'.\n\n\nEnd of /var/log/ipaupgrade.log:\n\n\n2018-03-07T22:06:00Z ERROR IPA server upgrade failed: Inspect /var/log/ipaupgrade.log and run command ipa-server-upgrade manually.\n2018-03-07T22:06:00Z DEBUG   File \"/usr/lib/python3.6/site-packages/ipapython/admintool.py\", line 174, in execute\n    return_value = self.run()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/ipa_server_upgrade.py\", line 50, in run\n    server.upgrade()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/server/upgrade.py\", line 1999, in upgrade\n    upgrade_configuration()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/server/upgrade.py\", line 1686, in upgrade_configuration\n    ca.backup_config()\n  File \"/usr/lib/python3.6/site-packages/ipaserver/install/dogtaginstance.py\", line 475, in backup_config\n    shutil.copy(path, path + '.ipabkp')\n  File \"/usr/lib64/python3.6/shutil.py\", line 241, in copy\n    copyfile(src, dst, follow_symlinks=follow_symlinks)\n  File \"/usr/lib64/python3.6/shutil.py\", line 120, in copyfile\n    with open(src, 'rb') as fsrc:\n\n2018-03-07T22:06:00Z DEBUG The ipa-server-upgrade command failed, exception: FileNotFoundError: [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\n2018-03-07T22:06:00Z ERROR [Errno 2] No such file or directory: '/var/lib/pki/pki-tomcat/conf/ca/CS.cfg'\n2018-03-07T22:06:00Z ERROR The ipa-server-upgrade command failed. See /var/log/ipaupgrade.log for more information"
					},
					{
						"isprivate": "0",
						"commentid": "11362391",
						"comment_count": "7",
						"who": {
							"text": "james",
							"name": "James"
						},
						"bug_when": "2018-03-08 23:06:00 +0000",
						"thetext": "Looking at the SRPM those commits from Comment 3 simply aren't in 4.6.3-2 (ipaserver/install/server/upgrade.py). Patch0001 only deals with KRA-related stuff, but seems to be matching against code from that commit..."
					},
					{
						"isprivate": "0",
						"commentid": "11371264",
						"comment_count": "8",
						"who": {
							"text": "rcritten",
							"name": "Rob Crittenden"
						},
						"bug_when": "2018-03-12 18:52:25 +0000",
						"thetext": "You're right, I missed a patch. There were two issues, one hiding the other. I'll spin up a new build."
					},
					{
						"isprivate": "0",
						"commentid": "11374219",
						"comment_count": "9",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-03-13 14:15:06 +0000",
						"thetext": "freeipa-4.6.3-3.fc27 has been submitted as an update to Fedora 27. https://bodhi.fedoraproject.org/updates/FEDORA-2018-0a4399f314"
					},
					{
						"isprivate": "0",
						"commentid": "11375562",
						"comment_count": "10",
						"who": {
							"text": "james",
							"name": "James"
						},
						"bug_when": "2018-03-13 19:19:12 +0000",
						"thetext": "OK - 4.6.3-3.fc27.x86_64 updated cleanly. Server rebooted, confirmed login with OTP, NFS and web interface work. Thanks, Rob!"
					},
					{
						"isprivate": "0",
						"commentid": "11376460",
						"comment_count": "11",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-03-14 01:39:18 +0000",
						"thetext": "freeipa-4.6.3-3.fc27 has been pushed to the Fedora 27 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2018-0a4399f314"
					},
					{
						"isprivate": "0",
						"commentid": "11599566",
						"comment_count": "12",
						"who": {
							"text": "frenaud",
							"name": "Florence Blanc-Renaud"
						},
						"bug_when": "2018-05-15 15:11:41 +0000",
						"thetext": "Fixed upstream\nipa-4-5:\nhttps://pagure.io/freeipa/c/035f1cb24a228ba40b3e124d78a507be22aa52bd"
					},
					{
						"isprivate": "0",
						"commentid": "11701195",
						"comment_count": "13",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-06-13 15:36:20 +0000",
						"thetext": "freeipa-4.6.4-1.fc27 has been submitted as an update to Fedora 27. https://bodhi.fedoraproject.org/updates/FEDORA-2018-0492828909"
					},
					{
						"isprivate": "0",
						"commentid": "11704587",
						"comment_count": "14",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-06-14 13:48:36 +0000",
						"thetext": "freeipa-4.6.4-1.fc27 has been pushed to the Fedora 27 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2018-0492828909"
					},
					{
						"isprivate": "0",
						"commentid": "11929910",
						"comment_count": "15",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-08-20 08:56:20 +0000",
						"thetext": "freeipa-4.6.4-2.fc27 has been submitted as an update to Fedora 27. https://bodhi.fedoraproject.org/updates/FEDORA-2018-39051f69b7"
					},
					{
						"isprivate": "0",
						"commentid": "11932033",
						"comment_count": "16",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-08-20 15:50:30 +0000",
						"thetext": "freeipa-4.6.4-2.fc27 has been pushed to the Fedora 27 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2018-39051f69b7"
					},
					{
						"isprivate": "0",
						"commentid": "11959737",
						"comment_count": "17",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-08-28 11:55:11 +0000",
						"thetext": "freeipa-4.6.4-2.fc27 has been pushed to the Fedora 27 stable repository. If problems still persist, please make note of it in this bug report."
					}
				]
			}
		},
		{
			"bug_id": 1619029,
			"title": "ipa-dnskeysyncd fails in clean Fedora 27 domain controller deployment due to missing dbus-python dependency",
			"bugzilla": {
				"bug_id": "1619029",
				"creation_ts": "2018-08-19 18:15:33 +0000",
				"short_desc": "ipa-dnskeysyncd fails in clean Fedora 27 domain controller deployment due to missing dbus-python dependency",
				"delta_ts": "2018-08-28 11:55:07 +0000",
				"bug_status": "CLOSED",
				"resolution": "ERRATA",
				"priority": "unspecified",
				"bug_severity": "high",
				"long_desc": [
					{
						"isprivate": "0",
						"commentid": "11928458",
						"comment_count": "0",
						"who": {
							"text": "awilliam",
							"name": "Adam Williamson"
						},
						"bug_when": "2018-08-19 18:15:33 +0000",
						"thetext": "I was just looking at logs of a failed Fedora 27 test in openQA and noticed that ipa-dnskeysyncd was crashing constantly; that didn't seem related to the bug I was actually investigating, so I checked the logs from a *passed* test too, and sure enough, the same thing happens there. It seems that these crashes don't actually cause anything the tests do to fail, so we hadn't noticed it before.\n\nThe service keeps starting up, crashing, then waiting a while (due to systemd service holdoff times), then starting again and crashing again. It crashes like this:\n\nAug 17 10:14:49 ipa001.domain.local systemd[1]: ipa-dnskeysyncd.service: Service hold-off time over, scheduling restart.\nAug 17 10:14:49 ipa001.domain.local systemd[1]: Stopped IPA key daemon.\nAug 17 10:14:49 ipa001.domain.local audit[1]: SERVICE_START pid=1 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:init_t:s0 msg='unit=ipa-dnskeysyncd comm=\"systemd>\nAug 17 10:14:49 ipa001.domain.local audit[1]: SERVICE_STOP pid=1 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:init_t:s0 msg='unit=ipa-dnskeysyncd comm=\"systemd\">\nAug 17 10:14:49 ipa001.domain.local systemd[1]: Started IPA key daemon.\nAug 17 10:14:49 ipa001.domain.local audit[1]: SERVICE_START pid=1 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:init_t:s0 msg='unit=ipa-dnskeysyncd comm=\"systemd>\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]: Traceback (most recent call last):\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:   File \"/usr/libexec/ipa/ipa-dnskeysyncd\", line 28, in <module>\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:     api.finalize()\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:   File \"/usr/lib/python2.7/site-packages/ipalib/plugable.py\", line 738, in finalize\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:     self.__do_if_not_done('load_plugins')\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:   File \"/usr/lib/python2.7/site-packages/ipalib/plugable.py\", line 425, in __do_if_not_done\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:     getattr(self, name)()\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:   File \"/usr/lib/python2.7/site-packages/ipalib/plugable.py\", line 619, in load_plugins\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:     self.add_package(package)\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:   File \"/usr/lib/python2.7/site-packages/ipalib/plugable.py\", line 646, in add_package\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:     module = importlib.import_module(name)\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:   File \"/usr/lib64/python2.7/importlib/__init__.py\", line 37, in import_module\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:     __import__(name)\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:   File \"/usr/lib/python2.7/site-packages/ipaserver/plugins/certmap.py\", line 22, in <module>\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]:     import dbus\nAug 17 10:14:50 ipa001.domain.local ipa-dnskeysyncd[8422]: ImportError: No module named dbus\n\nwhich looks a lot like a missing dependency on dbus-python, probably in python2-ipaserver, which is where /usr/lib/python2.7/site-packages/ipaserver/plugins/certmap.py comes from.\n\nThis doesn't seem to be happening on F28 or newer. I think this may be because we never run this as Python 2 in F28+, and python3-ipaserver *does* have a dependency on python3-dbus. In F27 it seems both python3-ipaserver *and* python2-ipaserver get installed, and obviously there's still a Python 2 codepath that hits this bug."
					},
					{
						"isprivate": "0",
						"commentid": "11929509",
						"comment_count": "1",
						"who": {
							"text": "abokovoy",
							"name": "Alexander Bokovoy"
						},
						"bug_when": "2018-08-20 07:04:22 +0000",
						"thetext": "Building: https://koji.fedoraproject.org/koji/taskinfo?taskID=29195007"
					},
					{
						"isprivate": "0",
						"commentid": "11929908",
						"comment_count": "2",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-08-20 08:56:15 +0000",
						"thetext": "freeipa-4.6.4-2.fc27 has been submitted as an update to Fedora 27. https://bodhi.fedoraproject.org/updates/FEDORA-2018-39051f69b7"
					},
					{
						"isprivate": "0",
						"commentid": "11932031",
						"comment_count": "3",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-08-20 15:50:27 +0000",
						"thetext": "freeipa-4.6.4-2.fc27 has been pushed to the Fedora 27 testing repository. If problems still persist, please make note of it in this bug report.\nSee https://fedoraproject.org/wiki/QA:Updates_Testing for\ninstructions on how to install test updates.\nYou can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2018-39051f69b7"
					},
					{
						"isprivate": "0",
						"commentid": "11959735",
						"comment_count": "4",
						"who": {
							"text": "updates",
							"name": "Fedora Update System"
						},
						"bug_when": "2018-08-28 11:55:07 +0000",
						"thetext": "freeipa-4.6.4-2.fc27 has been pushed to the Fedora 27 stable repository. If problems still persist, please make note of it in this bug report."
					}
				]
			}
		}
	],
	"builds": [
		{
			"epoch": 0,
			"nvr": "freeipa-4.6.4-2.fc27",
			"release_id": 17,
			"signed": true,
			"type": "rpm",
			"package": {
				"aarch64": [
					{
						"name": "freeipa-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "aarch64"
					},
					{
						"name": "freeipa-server-trust-ad",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "aarch64"
					},
					{
						"name": "freeipa-server",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "aarch64"
					},
					{
						"name": "freeipa-client",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "aarch64"
					},
					{
						"name": "freeipa-client-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "aarch64"
					},
					{
						"name": "freeipa-debugsource",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "aarch64"
					},
					{
						"name": "freeipa-server-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "aarch64"
					},
					{
						"name": "freeipa-server-trust-ad-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "aarch64"
					}
				],
				"armv7hl": [
					{
						"name": "freeipa-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "armv7hl"
					},
					{
						"name": "freeipa-server",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "armv7hl"
					},
					{
						"name": "freeipa-client",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "armv7hl"
					},
					{
						"name": "freeipa-server-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "armv7hl"
					},
					{
						"name": "freeipa-server-trust-ad-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "armv7hl"
					},
					{
						"name": "freeipa-client-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "armv7hl"
					},
					{
						"name": "freeipa-debugsource",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "armv7hl"
					},
					{
						"name": "freeipa-server-trust-ad",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "armv7hl"
					}
				],
				"i686": [
					{
						"name": "freeipa-debugsource",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "i686"
					},
					{
						"name": "freeipa-client-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "i686"
					},
					{
						"name": "freeipa-server-trust-ad",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "i686"
					},
					{
						"name": "freeipa-client",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "i686"
					},
					{
						"name": "freeipa-server",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "i686"
					},
					{
						"name": "freeipa-server-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "i686"
					},
					{
						"name": "freeipa-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "i686"
					},
					{
						"name": "freeipa-server-trust-ad-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "i686"
					}
				],
				"noarch": [
					{
						"name": "python3-ipaserver",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "noarch"
					},
					{
						"name": "python2-ipaclient",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "noarch"
					},
					{
						"name": "python3-ipalib",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "noarch"
					},
					{
						"name": "python3-ipatests",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "noarch"
					},
					{
						"name": "python2-ipaserver",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "noarch"
					},
					{
						"name": "python3-ipaclient",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "noarch"
					},
					{
						"name": "freeipa-python-compat",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "noarch"
					},
					{
						"name": "freeipa-server-dns",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "noarch"
					},
					{
						"name": "freeipa-client-common",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "noarch"
					},
					{
						"name": "python2-ipatests",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "noarch"
					},
					{
						"name": "freeipa-common",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "noarch"
					},
					{
						"name": "freeipa-server-common",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "noarch"
					},
					{
						"name": "python2-ipalib",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "noarch"
					}
				],
				"ppc64": [
					{
						"name": "freeipa-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64"
					},
					{
						"name": "freeipa-debugsource",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64"
					},
					{
						"name": "freeipa-server-trust-ad-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64"
					},
					{
						"name": "freeipa-server",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64"
					},
					{
						"name": "freeipa-client",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64"
					},
					{
						"name": "freeipa-server-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64"
					},
					{
						"name": "freeipa-client-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64"
					},
					{
						"name": "freeipa-server-trust-ad",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64"
					}
				],
				"ppc64le": [
					{
						"name": "freeipa-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64le"
					},
					{
						"name": "freeipa-server-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64le"
					},
					{
						"name": "freeipa-server-trust-ad",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64le"
					},
					{
						"name": "freeipa-server",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64le"
					},
					{
						"name": "freeipa-debugsource",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64le"
					},
					{
						"name": "freeipa-server-trust-ad-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64le"
					},
					{
						"name": "freeipa-client",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64le"
					},
					{
						"name": "freeipa-client-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "ppc64le"
					}
				],
				"s390x": [
					{
						"name": "freeipa-server",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "s390x"
					},
					{
						"name": "freeipa-server-trust-ad",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "s390x"
					},
					{
						"name": "freeipa-client",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "s390x"
					},
					{
						"name": "freeipa-debugsource",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "s390x"
					},
					{
						"name": "freeipa-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "s390x"
					},
					{
						"name": "freeipa-server-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "s390x"
					},
					{
						"name": "freeipa-server-trust-ad-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "s390x"
					},
					{
						"name": "freeipa-client-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "s390x"
					}
				],
				"src": [
					{
						"name": "freeipa",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "src"
					}
				],
				"x86_64": [
					{
						"name": "freeipa-server-trust-ad",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "x86_64"
					},
					{
						"name": "freeipa-client",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "x86_64"
					},
					{
						"name": "freeipa-server-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "x86_64"
					},
					{
						"name": "freeipa-debugsource",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "x86_64"
					},
					{
						"name": "freeipa-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "x86_64"
					},
					{
						"name": "freeipa-client-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "x86_64"
					},
					{
						"name": "freeipa-server-trust-ad-debuginfo",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "x86_64"
					},
					{
						"name": "freeipa-server",
						"version": "4.6.4",
						"release": "2.fc27",
						"arch": "x86_64"
					}
				]
			}
		}
	],
	"close_bugs": true,
	"comments": [
		{
			"id": 824318,
			"text": "This update has been submitted for testing by abbra. ",
			"timestamp": "2018-08-20 08:56:09",
			"update_id": 121062,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 824320,
			"text": "This update has obsoleted [freeipa-4.6.4-1.fc27](https://bodhi.fedoraproject.org/updates/FEDORA-2018-0492828909), and has inherited its bugs and notes.",
			"timestamp": "2018-08-20 08:56:12",
			"update_id": 121062,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 824522,
			"text": "This update has been pushed to testing.",
			"timestamp": "2018-08-20 15:50:49",
			"update_id": 121062,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 824665,
			"karma": 1,
			"text": "works",
			"timestamp": "2018-08-20 23:23:06",
			"update_id": 121062,
			"user": {
				"avatar": "https://seccdn.libravatar.org/avatar/79ac61c12f86c9346a7dbe5bd721fba6f04165895bb56a05224e7edc684f7f39?s=24&d=retro",
				"email": "lobocode@gmail.com",
				"id": 4444,
				"name": "lobocode",
				"openid": "lobocode.id.fedoraproject.org"
			},
			"user_id": 4444
		},
		{
			"id": 826946,
			"text": "This update has reached 7 days in testing and can be pushed to stable now if the maintainer wishes",
			"timestamp": "2018-08-27 18:00:27",
			"update_id": 121062,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 826993,
			"text": "This update has been submitted for batched by abbra. ",
			"timestamp": "2018-08-27 19:41:50",
			"update_id": 121062,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 826994,
			"text": "This update has been submitted for stable by abbra. ",
			"timestamp": "2018-08-27 19:41:58",
			"update_id": 121062,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		},
		{
			"id": 827233,
			"text": "This update has been pushed to stable.",
			"timestamp": "2018-08-28 11:55:32",
			"update_id": 121062,
			"user": {
				"avatar": "https://apps.fedoraproject.org/img/icons/bodhi-24.png",
				"id": 91,
				"name": "bodhi",
				"openid": "bodhi.id.fedoraproject.org"
			},
			"user_id": 91
		}
	],
	"content_type": "rpm",
	"date_pushed": "2018-08-28 11:55:03",
	"date_stable": "2018-08-28 11:55:03",
	"date_submitted": "2018-08-20 08:56:09",
	"date_testing": "2018-08-20 15:50:09",
	"karma": 1,
	"meets_testing_requirements": true,
	"notes": "dbus-python dependency was added to freeipa-server to make sure ipa-dnskeysyncd is usable. ipa-dnskeysyncd is still using Python 2 in Fedora 27.\n\n----\n\nUpdate to upstream 4.6.4\n\n----\n\nDon't try to back up CS.cfg during upgrade if CA is not configured\n\n",
	"pushed": true,
	"release": {
		"branch": "f27",
		"candidate_tag": "f27-updates-candidate",
		"composed_by_bodhi": true,
		"dist_tag": "f27",
		"id_prefix": "FEDORA",
		"long_name": "Fedora 27",
		"mail_template": "fedora_errata_template",
		"name": "F27",
		"override_tag": "f27-override",
		"package_manager": "dnf",
		"pending_signing_tag": "f27-signing-pending",
		"pending_stable_tag": "f27-updates-pending",
		"pending_testing_tag": "f27-updates-testing-pending",
		"stable_tag": "f27-updates",
		"state": "archived",
		"testing_repository": "updates-testing",
		"testing_tag": "f27-updates-testing",
		"version": "27"
	},
	"require_bugs": true,
	"require_testcases": true,
	"requirements": "",
	"severity": "low",
	"stable_karma": 2,
	"status": "stable",
	"suggest": "reboot",
	"test_gating_status": "ignored",
	"title": "freeipa-4.6.4-2.fc27",
	"type": "security",
	"url": "https://bodhi.fedoraproject.org/updates/FEDORA-2018-39051f69b7",
	"unstable_karma": -2,
	"updateid": "FEDORA-2018-39051f69b7",
	"user": {
		"avatar": "https://seccdn.libravatar.org/avatar/4c1558b281e35884af7130053458974b37461e46548b7e4dfea6bb085cd9d123?s=24&d=retro",
		"email": "abokovoy@redhat.com",
		"groups": [
			{
				"name": "packager"
			},
			{
				"name": "ipausers"
			},
			{
				"name": "fedora-contributor"
			},
			{
				"name": "signed_fpca"
			},
			{
				"name": "fedorabugs"
			},
			{
				"name": "bind-dyndb-ldap"
			},
			{
				"name": "gitfreeipa"
			},
			{
				"name": "gitslapi-nis"
			},
			{
				"name": "gitfreeipa-docs"
			}
		],
		"id": 1242,
		"name": "abbra",
		"openid": "abbra.id.fedoraproject.org"
	},
	"version_hash": "3a41bc54358fb26c7ebd0d8377b0459146ffc8fa"
}
